{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/systems/userinput/paths.js","webpack:///./src/utils/configs.js","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/three-utils.js","webpack:///./src/assets/stylesheets/media-browser.scss?0be5","webpack:///./src/utils/media-url-utils.js","webpack:///./src/utils/async-utils.js","webpack:///./src/utils/i18n.js","webpack:///./src/loaders/HubsTextureLoader.js","webpack:///./src/loaders/HubsBasisTextureLoader.js","webpack:///./src/utils/media-utils.js","webpack:///./src/utils/history.js","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/utils/qs_truthy.js","webpack:///./src/react-components/if-feature.js","webpack:///./src/react-components/dialog-container.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/assets/stylesheets/entry.scss?b35b","webpack:///./src/assets/stylesheets/settings-menu.scss?dfca","webpack:///./src/assets/stylesheets/ui-root.scss?bfe5","webpack:///./src/assets/stylesheets/room-info-dialog.scss?711f","webpack:///./src/assets/stylesheets/presence-log.scss?bad0","webpack:///./src/utils/focus-utils.js","webpack:///./src/assets/stylesheets/preferences-screen.scss?19f0","webpack:///./src/object-types.js","webpack:///./src/assets/stylesheets/2d-hud.scss?803e","webpack:///./src/assets/stylesheets/invite-dialog.scss?d073","webpack:///./src/utils/avatar-utils.js","webpack:///./src/systems/camera-system.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/images/app-logo.png","webpack:///./src/assets/images/company-logo.png","webpack:///./src/assets/images/editor-logo.png","webpack:///./src/utils/permissions-utils.js","webpack:///./src/assets/stylesheets/client-info-dialog.scss?2a21","webpack:///./src/telemetry.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/assets/stylesheets/presence-list.scss?0256","webpack:///./src/assets/stylesheets/message-entry.scss?0102","webpack:///./src/assets/models/DuckyMesh.glb","webpack:///./src/utils/fullscreen.js","webpack:///./src/utils/next-tick.js","webpack:///./src/assets/stylesheets/room-settings-dialog.scss?5fe3","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/assets/stylesheets/profile.scss?02af","webpack:///./src/assets/stylesheets/tweet-dialog.scss?1649","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/image-bitmap-utils.js","webpack:///./src/assets/stylesheets/sign-in-dialog.scss?f596","webpack:///./src/utils/theme.js","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/components/virtual-gamepad-controls.css?9949","webpack:///./src/assets/stylesheets/tip.scss?ea93","webpack:///./src/constants.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/react-components/state-link.js","webpack:///./src/assets/stylesheets/create-object-dialog.scss?63e4","webpack:///./src/assets/stylesheets/link-dialog.scss?7296","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/utils/component-utils.js","webpack:///./src/utils/detect-touchscreen.js","webpack:///./src/react-components/sign-in-dialog.js","webpack:///./src/components/hoverable-visuals.js","webpack:///./src/utils/scene-url-utils.js","webpack:///./src/assets/waternormals.jpg","webpack:///./src/assets/stylesheets/preload-overlay.scss?4ec6","webpack:///./src/components/environment-map.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/loaders/basis_transcoder.wasm","webpack:///./src/loaders/basis_transcoder.worker.js","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/App.js","webpack:///./src/react-components/avatar-preview.js","webpack:///./src/assets/stylesheets/change-scene-dialog.scss?0c1a","webpack:///./src/assets/stylesheets/oauth-dialog.scss?c704","webpack:///./src/webxr-bypass-hacks.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/react-components/unless-feature.js","webpack:///./src/utils/auth-channel.js","webpack:///./src/utils/animation.js","webpack:///./src/utils/easing.js","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/assets/images/dropdown_arrow.png","webpack:///./src/assets/images/dropdown_arrow@2x.png","webpack:///./src/utils/logging.js","webpack:///./src/utils/mask-email.js","webpack:///./src/react-components/room-info-dialog.js","webpack:///./src/react-components/media-tiles.js","webpack:///./src/utils/webgl.js","webpack:///./src/assets/models/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/sfx/emoji.mp3","webpack:///./src/assets/stylesheets/avatar-preview.scss?c714","webpack:///./src/systems/scene-preview-camera-system.js","webpack:///./src/utils/crypto.js","webpack:///./src/utils/link-channel.js","webpack:///./src/assets/stylesheets/chat-command-help.scss?592c","webpack:///./src/assets/images/mic_denied.png","webpack:///./src/assets/images/mic_denied@2x.png","webpack:///./src/assets/images/send_message.svgi","webpack:///./src/assets/models/LoadingEnvironment.glb","webpack:///./src/assets/stylesheets/promote-client-dialog.scss?a2eb","webpack:///./src/assets/stylesheets/close-room-dialog.scss?83fa","webpack:///./src/assets/stylesheets/help-dialog.scss?21ba","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/animation.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/css-class.js","webpack:///./src/components/duck.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/components/skybox.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/components/water.js","webpack:///./src/components/simple-water.js","webpack:///./src/components/particle-emitter.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/assets/stylesheets/loader.scss?288f","webpack:///./src/assets/images/giphy_logo.png","webpack:///./src/assets/images/emojis/emoji_0.png","webpack:///./src/assets/images/emojis/emoji_1.png","webpack:///./src/assets/images/emojis/emoji_2.png","webpack:///./src/assets/images/emojis/emoji_3.png","webpack:///./src/assets/images/emojis/emoji_4.png","webpack:///./src/assets/images/emojis/emoji_5.png","webpack:///./src/assets/images/emojis/emoji_6.png","webpack:///./src/assets/models/emojis/emoji_0.glb","webpack:///./src/assets/models/emojis/emoji_1.glb","webpack:///./src/assets/models/emojis/emoji_2.glb","webpack:///./src/assets/models/emojis/emoji_3.glb","webpack:///./src/assets/models/emojis/emoji_4.glb","webpack:///./src/assets/models/emojis/emoji_5.glb","webpack:///./src/assets/models/emojis/emoji_6.glb","webpack:///./src/assets/images/media-error.gif","webpack:///./src/assets/images/audio.png","webpack:///./src/assets/camera_tool.glb","webpack:///./src/assets/images/mic_granted.png","webpack:///./src/assets/images/mic_granted@2x.png","webpack:///./src/assets/images/mic_small.png","webpack:///./src/assets/images/mic_small@2x.png","webpack:///./src/assets/images/add-owner.png","webpack:///./src/assets/images/remove-owner.png","webpack:///./src/assets/images/mobile_screen_entry.svgi","webpack:///./src/assets/images/desktop_screen_entry.svgi","webpack:///./src/assets/images/generic_vr_entry.svgi","webpack:///./src/assets/images/gearvr_entry.svgi","webpack:///./src/assets/images/daydream_entry.svgi","webpack:///./src/assets/stylesheets/avatar-url-dialog.scss?3a38","webpack:///./src/assets/images/link_dialog_header.svg","webpack:///./src/assets/stylesheets/feedback-dialog.scss?48e3","webpack:///./src/assets/stylesheets/leave-room-dialog.scss?9cfa","webpack:///./src/assets/images/spawn_message.svgi","webpack:///./src/assets/images/discord.svgi","webpack:///./src/assets/images/hmd-icon.svgi","webpack:///./src/assets/stylesheets/avatar-editor.scss?b806","webpack:///./src/assets/images/mic_level.png","webpack:///./src/assets/images/mic_level@2x.png","webpack:///./src/assets/images/speaker_level.png","webpack:///./src/assets/images/speaker_level@2x.png","webpack:///./src/assets/sfx/tone.webm","webpack:///./src/assets/sfx/tone.mp3","webpack:///./src/assets/sfx/tone.ogg","webpack:///./src/assets/sfx/tone.wav","webpack:///./src/assets/images/spawn.svgi","webpack:///./src/assets/images/share_screen_active.svgi","webpack:///./src/assets/images/share_screen.svgi","webpack:///./src/assets/images/share_camera_active.svgi","webpack:///./src/assets/images/share_camera.svgi","webpack:///./src/assets/images/pen.svgi","webpack:///./src/assets/images/pen_active.svgi","webpack:///./src/assets/images/camera.svgi","webpack:///./src/assets/images/camera_active.svgi","webpack:///./src/assets/images/mic-0.svgi","webpack:///./src/assets/images/mic-1.svgi","webpack:///./src/assets/images/mic-2.svgi","webpack:///./src/assets/images/mic-3.svgi","webpack:///./src/assets/images/mic-4.svgi","webpack:///./src/assets/images/mic-5.svgi","webpack:///./src/assets/images/mic-6.svgi","webpack:///./src/assets/images/mic-7.svgi","webpack:///./src/assets/images/mic-off-0.svgi","webpack:///./src/assets/images/mic-off-1.svgi","webpack:///./src/assets/images/mic-off-2.svgi","webpack:///./src/assets/images/mic-off-3.svgi","webpack:///./src/assets/images/mic-off-4.svgi","webpack:///./src/assets/images/mic-off-5.svgi","webpack:///./src/assets/images/mic-off-6.svgi","webpack:///./src/assets/images/mic-off-7.svgi","webpack:///./src/assets/stylesheets/spectating-label.scss?4b63","webpack:///./src/systems/render-manager/unlit-batch.vert","webpack:///./src/systems/render-manager/unlit-batch.frag","webpack:///./src/assets/images/spritesheets/sprite-system-action-spritesheet.png","webpack:///./src/assets/images/spritesheets/sprite-system-notice-spritesheet.png","webpack:///./src/systems/sprites/sprite.vert","webpack:///./src/systems/sprites/sprite.frag","webpack:///./src/utils/debug-log.js","webpack:///./src/assets/stylesheets/hub.scss?ad84","webpack:///./src/utils/audio-context-fix.js","webpack:///./src/utils/threejs-positional-audio-updatematrixworld.js","webpack:///./src/components/scale-in-screen-space.js","webpack:///./src/components/bone-mute-state-indicator.js","webpack:///./src/components/bone-visibility.js","webpack:///./src/components/fader.js","webpack:///./src/components/icon-button.js","webpack:///./src/components/text-button.js","webpack:///./src/components/block-button.js","webpack:///./src/components/mute-button.js","webpack:///./src/components/kick-button.js","webpack:///./src/components/close-vr-notice-button.js","webpack:///./src/components/leave-room-button.js","webpack:///./src/components/visible-if-permitted.js","webpack:///./src/components/visibility-on-content-types.js","webpack:///./src/components/hide-when-pinned-and-forbidden.js","webpack:///./src/components/networked-avatar.js","webpack:///./src/components/pinnable.js","webpack:///./src/components/drop-object-button.js","webpack:///./src/components/remove-networked-object-button.js","webpack:///./src/components/camera-focus-button.js","webpack:///./src/components/visible-to-owner.js","webpack:///./src/components/emit-state-change.js","webpack:///./src/components/action-to-event.js","webpack:///./src/components/action-to-remove.js","webpack:///./src/components/emit-scene-event-on-remove.js","webpack:///./src/components/follow-in-fov.js","webpack:///./src/components/matrix-auto-update.js","webpack:///./src/components/hover-menu.js","webpack:///./src/components/disable-frustum-culling.js","webpack:///./src/components/set-active-camera.js","webpack:///./src/components/track-pose.js","webpack:///./src/components/replay.js","webpack:///./src/components/visibility-by-path.js","webpack:///./src/components/billboard.js","webpack:///./src/components/periodic-full-syncs.js","webpack:///./src/components/set-max-resolution.js","webpack:///./src/systems/frame-scheduler.js","webpack:///./src/systems/app-mode.js","webpack:///./src/systems/permissions.js","webpack:///./src/systems/exit-on-blur.js","webpack:///./src/systems/auto-pixel-ratio.js","webpack:///./src/systems/listed-media.js","webpack:///./src/systems/linked-media.js","webpack:///./src/components/owned-object-limiter.js","webpack:///./src/components/owned-object-cleanup-timeout.js","webpack:///./src/components/set-unowned-body-kinematic.js","webpack:///./src/components/networked-counter.js","webpack:///./src/components/set-yxz-order.js","webpack:///./src/components/nav-mesh-helper.js","webpack:///./src/components/tools/drawing-manager.js","webpack:///./src/components/mute-mic.js","webpack:///./src/components/in-world-hud.js","webpack:///./src/components/emoji.js","webpack:///./src/components/emoji-hud.js","webpack:///./src/components/virtual-gamepad-controls.js","webpack:///./src/components/ik-controller.js","webpack:///./src/components/hand-controls2.js","webpack:///./src/components/hover-visuals.js","webpack:///./src/components/offset-relative-to.js","webpack:///./src/components/player-info.js","webpack:///./src/components/hand-poses.js","webpack:///./src/components/hud-controller.js","webpack:///./src/components/freeze-controller.js","webpack:///./src/components/visibility-while-frozen.js","webpack:///./src/components/stats-plus.js","webpack:///./src/utils/mirror-utils.js","webpack:///./src/components/media-views.js","webpack:///./src/components/avatar-volume-controls.js","webpack:///./src/components/pinch-to-move.js","webpack:///./src/components/pitch-yaw-rotator.js","webpack:///./src/components/position-at-box-shape-border.js","webpack:///./src/components/pin-networked-object-button.js","webpack:///./src/components/mirror-media-button.js","webpack:///./src/components/close-mirrored-media-button.js","webpack:///./src/components/unmute-video-button.js","webpack:///./src/components/destroy-at-extreme-distances.js","webpack:///./src/components/camera-tool.js","webpack:///./src/components/clone-media-button.js","webpack:///./src/utils/vr-interstitial.js","webpack:///./src/components/open-media-button.js","webpack:///./src/components/refresh-media-button.js","webpack:///./src/components/tweet-media-button.js","webpack:///./src/components/remix-avatar-button.js","webpack:///./src/components/transform-object-button.js","webpack:///./src/components/scale-button.js","webpack:///./src/components/teleporter.js","webpack:///./src/components/cylinder-texture.js","webpack:///./src/components/tags.js","webpack:///./src/components/hubs-text.js","webpack:///./src/components/inspect-button.js","webpack:///./src/systems/userinput/sets.js","webpack:///./src/utils/vr-caps-detect.js","webpack:///./src/utils/share.js","webpack:///./src/react-components/state-route.js","webpack:///./src/react-components/promote-client-dialog.js","webpack:///./src/react-components/client-info-dialog.js","webpack:///./src/react-components/loader.js","webpack:///./src/react-components/auto-exit-warning.js","webpack:///./src/react-components/svgi.js","webpack:///./src/react-components/entry-buttons.js","webpack:///./src/react-components/profile-entry-panel.js","webpack:///./src/react-components/media-browser.js","webpack:///./src/react-components/create-object-dialog.js","webpack:///./src/react-components/change-scene-dialog.js","webpack:///./src/react-components/avatar-url-dialog.js","webpack:///./src/react-components/invite-dialog.js","webpack:///./src/react-components/invite-team-dialog.js","webpack:///./src/react-components/link-dialog.js","webpack:///./src/react-components/safari-dialog.js","webpack:///./src/react-components/room-settings-dialog.js","webpack:///./src/react-components/close-room-dialog.js","webpack:///./src/systems/tips.js","webpack:///./src/react-components/tip.js","webpack:///./src/react-components/webrtc-screenshare-unsupported-dialog.js","webpack:///./src/react-components/webassembly-unsupported-dialog.js","webpack:///./src/react-components/webvr-recommend-dialog.js","webpack:///./src/react-components/feedback-dialog.js","webpack:///./src/react-components/help-dialog.js","webpack:///./src/react-components/leave-room-dialog.js","webpack:///./src/utils/media-sorting.js","webpack:///./src/react-components/object-info-dialog.js","webpack:///./src/react-components/oauth-dialog.js","webpack:///./src/react-components/tweet-dialog.js","webpack:///./src/react-components/lobby-chat-box.js","webpack:///./src/react-components/entry-start-panel.js","webpack:///./src/react-components/chat-command-help.js","webpack:///./src/utils/serialize-element.js","webpack:///./src/react-components/presence-list.js","webpack:///./src/react-components/chat-message.js","webpack:///./src/react-components/in-world-chat-box.js","webpack:///./src/react-components/avatar-editor.js","webpack:///./src/react-components/mic-level-widget.js","webpack:///./src/react-components/number-range-selector.js","webpack:///./src/react-components/preference-list-item.js","webpack:///./src/react-components/preferences-screen.js","webpack:///./src/react-components/output-level-widget.js","webpack:///./src/react-components/photo-message.js","webpack:///./src/react-components/video-message.js","webpack:///./src/react-components/image-message.js","webpack:///./src/react-components/presence-log.js","webpack:///./src/react-components/object-list.js","webpack:///./src/react-components/settings-menu.js","webpack:///./src/react-components/preload-overlay.js","webpack:///./src/react-components/2d-hud.js","webpack:///./src/react-components/spectating-label.js","webpack:///./src/react-components/ui-root.js","webpack:///./src/utils/hub-channel.js","webpack:///./src/utils/physics-utils.js","webpack:///./src/message-dispatch.js","webpack:///./src/scene-entry-manager.js","webpack:///./src/utils/pinned-entity-to-gltf.js","webpack:///./src/subscriptions.js","webpack:///./src/systems/personal-space-bubble.js","webpack:///./src/systems/idle-detector.js","webpack:///./src/systems/camera-tools.js","webpack:///./src/systems/userinput/devices/mouse.js","webpack:///./src/systems/userinput/array-backed-set.js","webpack:///./src/systems/userinput/devices/keyboard.js","webpack:///./src/systems/userinput/devices/hud.js","webpack:///./src/systems/userinput/devices/xbox-controller.js","webpack:///./src/systems/userinput/pose.js","webpack:///./src/systems/userinput/arm-model.js","webpack:///./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack:///./src/systems/userinput/devices/oculus-go-controller.js","webpack:///./src/systems/userinput/devices/gear-vr-controller.js","webpack:///./src/systems/userinput/devices/oculus-touch-controller.js","webpack:///./src/systems/userinput/devices/daydream-controller.js","webpack:///./src/systems/userinput/devices/vive-controller.js","webpack:///./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack:///./src/systems/userinput/devices/gyro.js","webpack:///./src/systems/interactions.js","webpack:///./src/systems/userinput/devices/app-aware-mouse.js","webpack:///./src/systems/userinput/devices/touchscreen/assignments.js","webpack:///./src/systems/userinput/devices/app-aware-touchscreen.js","webpack:///./src/systems/userinput/bindings/xforms.js","webpack:///./src/utils/dpad.js","webpack:///./src/systems/userinput/bindings/utils.js","webpack:///./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack:///./src/systems/userinput/bindings/touchscreen-user.js","webpack:///./src/systems/userinput/bindings/keyboard-debugging.js","webpack:///./src/systems/userinput/bindings/oculus-touch-user.js","webpack:///./src/systems/userinput/bindings/vive-user.js","webpack:///./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack:///./src/systems/userinput/bindings/xbox-controller-user.js","webpack:///./src/systems/userinput/bindings/daydream-user.js","webpack:///./src/systems/userinput/bindings/cardboard-user.js","webpack:///./src/systems/userinput/bindings/oculus-go-user.js","webpack:///./src/systems/userinput/resolve-action-sets.js","webpack:///./src/systems/userinput/devices/gamepad.js","webpack:///./src/systems/userinput/bindings/generic-gamepad.js","webpack:///./src/systems/userinput/userinput.js","webpack:///./src/systems/userinput/userinput-debug.js","webpack:///./src/systems/ui-hotkeys.js","webpack:///./src/systems/cursor-targetting-system.js","webpack:///./src/systems/cursor-toggling-system.js","webpack:///./src/systems/physics-system.js","webpack:///./src/systems/constraints-system.js","webpack:///./src/systems/two-point-stretching-system.js","webpack:///./src/systems/button-systems.js","webpack:///./src/systems/drawing-menu-system.js","webpack:///./src/systems/hover-menu-system.js","webpack:///./src/systems/super-spawner-system.js","webpack:///./src/systems/haptic-feedback-system.js","webpack:///./src/systems/render-manager/hubs-batch-raw-uniform-group.js","webpack:///./src/systems/render-manager-system.js","webpack:///./src/systems/interaction-sfx-system.js","webpack:///./src/utils/theme-sprites.js","webpack:///./src/systems/sprites.js","webpack:///./src/systems/waypoint-system.js","webpack:///./src/utils/mat4-pool.js","webpack:///./src/utils/get-current-player-height.js","webpack:///./src/systems/character-controller-system.js","webpack:///./src/systems/cursor-pose-tracking.js","webpack:///./src/systems/scale-in-screen-space.js","webpack:///./src/systems/audio-settings-system.js","webpack:///./src/systems/enter-vr-button-system.js","webpack:///./src/systems/hubs-systems.js","webpack:///./src/systems/capture-system.js","webpack:///./src/components/scalable-when-grabbed.js","webpack:///./src/components/cursor-controller.js","webpack:///./src/components/tools/pen.js","webpack:///./src/components/tools/pen-laser.js","webpack:///./src/utils/sharedbuffergeometry.js","webpack:///./src/utils/sharedbuffergeometrymanager.js","webpack:///./src/components/tools/networked-drawing.js","webpack:///./src/components/body-helper.js","webpack:///./src/components/shape-helper.js","webpack:///./src/network-schemas.js","webpack:///./src/hub.js","webpack:///./src/utils/concurrent-load-detector.js","webpack:///./src/utils/threejs-allocation-patches.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","5","exports","module","l","e","Promise","resolve","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","oe","err","console","error","jsonpArray","window","oldJsonpFunction","slice","paths","actions","log","toggleScreenShare","snapRotateLeft","snapRotateRight","angularVelocity","logDebugFrame","logInteractionState","debugUserInput","describeCurrentMasks","cameraDelta","lobbyCameraDelta","characterAcceleration","dCharSpeed","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","toggleFreeze","thaw","muteMic","toggleFly","toggleUI","waypointDeltaDistance","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","cursor","right","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","wake","left","pen","remove","rightHand","matrix","switchDrawMode","startTeleport","stopTeleport","thumb","index","middleRingPinky","leftHand","camera","exitMirror","startInspecting","stopInspecting","inspectZoom","inspectPanY","resetInspectView","nextCameraMode","haptics","actuators","device","mouse","coords","movementXY","buttonLeft","buttonRight","buttonMiddle","wheel","smartMouse","cursorPose","shouldMoveCamera","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","delta","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","anything","gyro","averageDeltaX","averageDeltaY","hud","penButton","keyboard","map","Map","k","path","this","toLowerCase","set","gamepad","gamepadIndex","button","buttonIndex","pressed","touched","axis","axisIndex","xbox","v","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","side","axes","wmrController","wmr","_objectSpread","grip","menu","joystick","vive","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3__","pdfjs_dist__WEBPACK_IMPORTED_MODULE_3___default","configs","isAdmin","forEach","x","el","document","querySelector","getAttribute","process","__webpack_public_path__","pdfjs","GlobalWorkerOptions","workerSrc","AVAILABLE_INTEGRATIONS","APP_CONFIG","theme","colorVars","style","createElement","innerHTML","join","head","prepend","features","feature","featureName","enableAll","localDevImages","image","imageName","cssUrl","url","images","link","linkName","defaultValue","links","setIsAdmin","_isAdmin","adjectives","nouns","generateHubName","randItem","Math","floor","random","charAt","toUpperCase","hasReticulumServer","RETICULUM_SERVER","isLocalClient","location","host","resolverLink","directReticulumHostAndPort","reticulumMeta","invalidatedReticulumMetaThisSession","getReticulumFetchUrl","absolute","port","href","getReticulumMeta","_getReticulumMeta","arguments","version","pool","phx_host","fetch","then","_ref2","_asyncToGenerator","res","json","_x5","phxHostOverride","URLSearchParams","search","qs","RETICULUM_SOCKET_SERVER","URL","protocol","getDirectReticulumFetchUrl","warn","invalidateReticulumMeta","_invalidateReticulumMeta","connectToReticulum","_connectToReticulum","debug","params","socketClass","Socket","getNewSocketUrl","_ref3","refreshDirectReticulumHostAndPort","RETICULUM_SOCKET_PROTOCOL","socketUrl","socketSettings","logger","kind","msg","socket","connect","onError","endPointPath","endPoint","pathname","newEndPoint","getLandingPageForPhoto","photoUrl","parsedUrl","replace","fetchReticulumAuthenticated","method","payload","token","APP","store","state","credentials","retUrl","headers","content-type","authorization","body","JSON","stringify","_ref","text","parse","_x","createAndRedirectToNewHub","_x2","_x3","_x4","_createAndRedirectToNewHub","sceneId","createUrl","hub","scene_id","Store","update","email","creatorAssignmentToken","creator_assignment_token","creatorAssignmentTokens","hubId","hub_id","embedToken","embed_token","embedTokens","getPresenceEntryForSession","presences","sessionId","presence","entries","find","metas","getPresenceContextForSession","context","getPresenceProfileForSession","profile","migrateChannelToSocket","oldChannel","channel","topic","bindings","item","on","event","callback","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","receive","status","discordBridgesForPresences","channels","values","discordBridges","Array","b","__webpack_exports__","getLastWorldPosition","getLastWorldQuaternion","disposeNode","setMatrixWorld","cloneObject3D","findNode","interpolateAffine","squareDistanceBetween","affixToWorldUp","calculateCameraTransformForWaypoint","calculateViewingDistance","rotateInPlaceAroundWorldUp","childMatch","tempVector3","THREE","Vector3","Quaternion","src","target","updateMatrices","setFromMatrixPosition","matrixWorld","decompose","disposeMaterial","mtrl","dispose","lightMap","bumpMap","normalMap","specularMap","envMap","node","Mesh","geometry","material","materialArray","MeshFaceMaterial","MultiMaterial","materials","IDENTITY","Matrix4","identity","object3D","matrixIsModified","applyMatrix","copy","parent","getInverse","multiply","position","quaternion","scale","childrenNeedMatrixWorldUpdate","cloneAnimationClip","sourceAnimationClip","cloneUUIDLookup","clonedTracks","tracks","keyframeTrack","sourceKeyframeTrack","nodeName","uuid","objectName","objectIndex","propertyName","propertyIndex","PropertyBinding","parseTrackName","undefined","clonedUUID","clonedKeyframeTrack","clone","cloneKeyframeTrack","AnimationClip","duration","source","preserveUUIDs","cloneLookup","parallelTraverse","a","children","sourceNode","clonedNode","traverse","animations","animationClip","isMesh","boundsTree","isSkinnedMesh","sourceBones","skeleton","bones","sourceBone","has","Error","bindMatrix","root","pred","nodes","concat","mat4","end","start","interpolated","startMat4","endMat4","progress","outMat4","setFromRotationMatrix","extractRotation","slerp","lerpVectors","setFromMatrixColumn","setFromMatrixScale","compose","posA","posB","objA","objB","distanceToSquared","inRotationMat4","inForward","outForward","outSide","worldUp","inMat4Copy","inMat4","multiplyScalar","sub","projectOnVector","normalize","crossVectors","makeBasis","setPosition","upAffixedCameraTransform","upAffixedWaypointTransform","detachFromWorldUp","cameraTransform","waypointTransform","fov","aspect","box","center","vrMode","halfYExtents","max","abs","y","min","halfXExtents","halfVertFOV","degToRad","halfHorFOV","atan","tan","length1","length2","length3","z","startRotation","endRotation","theta","makeRotationY","childInverse","newParentMatrix","child","multiplyMatrices","media-browser","mediaBrowser","facets","facet","pager","header-center","headerCenter","header-left","headerLeft","engine-attribution","engineAttribution","engine-attribution-contents","engineAttributionContents","favorites-header","favoritesHeader","search-clear","searchClear","search-icon","searchIcon","header","no-search","noSearch","nav","nav-right-pad","navRightPad","nav-source","navSource","nav-source-selected","navSourceSelected","nav-scroll-arrow","navScrollArrow","tiles","tile","info","attribution","creator","publisher","last-joined","lastJoined","tile-link","tileLink","tile-content","tileContent","avatar-tile","avatarTile","favorite","tile-actions","tileActions","create-tile","createTile","create-avatar-tile","createAvatarTile","tiles-variable","tilesVariable","page-number","pageNumber","pager-button-disabled","pagerButtonDisabled","header-right","headerRight","create-button","createButton","create-link","createLink","empty-string","emptyString","media-browser-inline","mediaBrowserInline","nonCorsProxyDomains","NON_CORS_PROXY_DOMAINS","split","CORS_PROXY_SERVER","commonKnownContentTypes","gltf","glb","png","jpg","jpeg","pdf","mp4","mp3","basis","farsparkEncodeUrl","str","btoa","encodeURIComponent","_","p1","String","fromCharCode","b64EncodeUnicode","scaledThumbnailUrlFor","width","height","extension","pathParts","extensionCandidate","pop","thumbnailUrl","THUMBNAIL_SERVER","urlHostname","hostname","isNonCorsProxyDomain","domain","endsWith","proxiedUrlFor","startsWith","getAbsoluteHref","baseUrl","relativeUrl","getAbsoluteUrl","getCustomGLTFParserURLResolver","gltfUrl","test","corsProxyPrefix","originalUrlParts","decodeURIComponent","substring","dataUrlRegex","guessContentType","matches","exec","originIsHubsServer","isHubsServer","origin","hubsSceneRegex","hubsAvatarRegex","_wrapRegExp","id","hubsRoomRegex","isLocalHubsUrl","isHubsSceneUrl","isLocalHubsSceneUrl","isHubsAvatarUrl","_ref4","isLocalHubsAvatarUrl","_ref5","_x6","isHubsRoomUrl","_ref6","_x7","idForAvatarUrl","match","groups","waitForEvent","waitForDOMContentLoaded","eventName","eventObj","addEventListener","once","readyState","lang","messages","_configs__WEBPACK_IMPORTED_MODULE_0__","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_1__","navigatorLang","navigator","languages","language","userLanguage","localeData","_messages","en","translations","configTranslations","messageKey","message","_match","subkey","reduce","acc","entry","HubsTextureLoader","constructor","manager","DefaultLoadingManager","load","onLoad","onProgress","texture","Texture","loadTextureAsync","catch","_this","imageLoader","createImageBitmap","ImageBitmapLoader","flipY","ImageLoader","setCrossOrigin","crossOrigin","setPath","cacheKey","resolveURL","loader","reject","loadAsync","Cache","needsUpdate","onUpdate","close","BasisTextureLoader","Loader","transcoderPath","transcoderBinary","transcoderPending","workerLimit","workerPool","workerNextTaskID","workerConfig","format","astcSupported","etcSupported","dxtSupported","pvrtcSupported","returnBuffer","assign","setTranscoderPath","setWorkerLimit","detectSupport","renderer","config","extensions","BASIS_FORMAT","cTFASTC_4x4","cTFBC3","cTFPVRTC1_4_RGBA","cTFETC1","FileLoader","ranDetect","AFRAME","scenes","setResponseType","buffer","_createTexture","worker","taskID","texturePending","_getWorker","_worker","_callbacks","_taskCosts","byteLength","_taskLoad","postMessage","type","mipmaps","hasAlpha","CompressedTexture","RGBA_ASTC_4x4_Format","cTFBC1","DXT_FORMAT_MAP","UnsignedByteType","RGB_ETC1_Format","cTFPVRTC1_4_RGB","RGB_PVRTC_4BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","minFilter","LinearFilter","LinearMipmapLinearFilter","magFilter","generateMipmaps","finally","_initTranscoder","binaryLoader","binaryContent","transcoderWasmFile","BasisWorker","onmessage","sort","terminate","cTFETC2","cTFBC4","cTFBC5","cTFBC7_M6_OPAQUE_ONLY","cTFBC7_M5","cTFATC_RGB","cTFATC_RGBA_INTERPOLATED_ALPHA","cTFRGBA32","cTFRGB565","cTFBGR565","cTFRGBA4444","DXT_FORMAT","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","linkify","Linkify","tlds","mediaAPIEndpoint","isMobile","utils","isMobileVR","resolveUrlCache","getDefaultResolveQuality","is360","useLowerQuality","resolveUrl","media_utils_asyncToGenerator","quality","bustCache","resultPromise","Content-Type","media","response","ok","statusText","upload","file","desiredContentType","formData","FormData","append","getDirectMediaAPIEndpoint","coerceToUrl","urlOrText","indexOf","addMedia","template","contentOrigin","contentSubtype","fitToBox","animate","mediaOptions","networked","parentEl","linkedEl","scene","entity","setAttribute","templateBody","importNode","content","firstElementChild","cloneNode","elAttrs","attributes","attrIdx","appendChild","needsToBeUploaded","File","els","querySelectorAll","components","getLatestMediaVersionOfSrc","fileIsOwned","matrixNeedsUpdate","orientation","reader","FileReader","onload","view","DataView","getUint16","offset","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","srcUrl","searchParams","meta","access_token","fileId","file_id","uploadPromotionTokens","promotionToken","promotion_token","MediaStream","NAF","clientId","detail","objectType","objectTypeForOriginAndContentType","contentType","emit","cloneMedia","sourceEl","ObjectContentOrigins","injectCustomShaderChunks","obj","vertexRegex","fragRegex","shaderUniforms","batchManagerSystem","systems","mapMaterials","hubs_InjectedCustomShaderChunks","validMaterials","includes","classList","contains","batchingEnabled","meshToEl","newMaterial","onBeforeCompile","shader","vertexShader","uniforms","hubs_IsFrozen","hubs_EnableSweepingEffect","hubs_SweepParams","hubs_InteractorOnePos","hubs_InteractorTwoPos","hubs_HighlightInteractorOne","hubs_HighlightInteractorTwo","hubs_Time","vlines","vindex","findIndex","line","unshift","flines","fragmentShader","findex","mediaHighlightFrag","getPromotionTokenForFile","mediaPos","addAndArrangeMedia","snapCount","mirrorOrientation","distance","pos","rotation","rotateY","PI","idx","cos","sin","localToWorld","visible","handler","dur","from","to","easing","eventType","textureLoader","createImageTexture","_createImageTexture","filter","Image","canvas","ctx","getContext","drawImage","CanvasTexture","encoding","sRGBEncoding","anisotropy","basisTextureLoader","HubsBasisTextureLoader","createBasisTexture","addMeshScaleAnimation","mesh","initialScale","onComplete","step","lastValue","anim","animatables","Number","MIN_VALUE","elasticity","loop","round","targets","complete","anime","closeExistingMediaMirror","mirrorTarget","firstChild","removeChild","pushOrUpdateHistory","history","newPathname","newSearch","newLength","__historyLength","__duplicate","isDuplicate","pushHistoryState","replaceHistoryState","pushHistoryPath","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","listen","go","sluglessPath","withSlug","SOUND_HOVER_OR_GRAB","SOUND_THAW","SOUND_PEN_STOP_DRAW","SOUND_PEN_UNDO_DRAW","SOUND_PEN_CHANGE_COLOR","SOUND_TOGGLE_MIC","SOUND_TELEPORT_START","SOUND_TELEPORT_END","SOUND_WAYPOINT_START","SOUND_WAYPOINT_END","SOUND_SNAP_ROTATE","SOUND_SPAWN_PEN","SOUND_PEN_START_DRAW","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","SOUND_ENTER_SCENE","SOUND_QUACK","SOUND_SPECIAL_QUACK","SOUND_CHAT_MESSAGE","SOUND_FREEZE","SOUND_PIN","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","SOUND_CAMERA_TOOL_COUNTDOWN","SOUND_PREFERENCE_MENU_SELECT","SOUND_SPAWN_EMOJI","SoundEffectsSystem","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","_assets_sfx_emoji_mp3__WEBPACK_IMPORTED_MODULE_15__","_assets_sfx_emoji_mp3__WEBPACK_IMPORTED_MODULE_15___default","_utils_three_utils__WEBPACK_IMPORTED_MODULE_16__","soundEnum","SOUND_PREFERENCE_MENU_HOVER","pendingAudioSourceNodes","pendingPositionalAudios","positionalAudiosStationary","positionalAudiosFollowingObject3Ds","audioContext","AudioContext","audioListener","AudioListener","add","evt","cameraEl","getObject3D","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","URL_SPAWN_EMOJI","loading","audioBufferPromise","arrayBuffer","decodeAudioData","sounds","sound","audioBuffer","enqueueSound","createBufferSource","destination","enqueuePositionalSound","positionalAudio","PositionalAudio","setBuffer","playPositionalSoundAt","matrixWorldNeedsUpdate","playPositionalSoundFollowing","playSoundOneShot","playSoundLooped","playSoundLoopedWithGain","gain","createGain","stopSoundNode","stop","stopPositionalAudio","inPositionalAudio","pendingIndex","isPlaying","tick","pendingPositionalAudio","play","positionalAudioAndObject3D","qsTruthy","qsGet","param","val","IfFeature","_utils_configs__WEBPACK_IMPORTED_MODULE_0__","props","DialogContainer","Component","super","_defineProperty","closable","currentTarget","onClose","onKeyDown","onContainerClicked","componentDidMount","componentWillUnmount","removeEventListener","render","react__WEBPACK_IMPORTED_MODULE_0___default","className","classNames","noOverlay","onClick","wide","allowOverflow","additionalClass","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_4__","icon","faTimes","title","PropTypes","isRequired","func","bool","string","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","React","createContext","Consumer","cloneElement","onMouseEnter","playSound","propTypes","entry-button-secondary","entryButtonSecondary","entry-panel","entryPanel","button-container","buttonContainer","secondary-action-button","secondaryActionButton","entry-button","entryButton","action-button","actionButton","collapse-button","collapseButton","favorite-button","favoriteButton","back","lobby-label","lobbyLabel","label","rename-button","renameButton","wide-button","wideButton","screen-sharing","screenSharing","checkbox","entry-dialog","entryDialog","favorited","bolded","subtitle","room-subtitle","roomSubtitle","lobby","profile-icon","profileIcon","button-subtitle","buttonSubtitle","audio-loader","audioLoader","webvr-link-container","webvrLinkContainer","webvr-link","webvrLink","secondary","secondary-button","secondaryButton","bottom-links-main","bottomLinksMain","bottom-links","bottomLinks","close-button","closeButton","settings-menu-drop","settingsMenuDrop","attach-point","attachPoint","contents","rows","row","row-no-margin","rowNoMargin","row-header","rowHeader","list-item","listItem","list-item-link","listItemLink","settings-menu-overlay-wrap","settingsMenuOverlayWrap","settings-menu-overlay","settingsMenuOverlay","settings-row","settingsRow","secondary-link-item","secondaryLinkItem","ui","ui-dialog","uiDialog","ui-interactive","uiInteractive","object-list","objectList","presence-info","presenceInfo","corner-button","cornerButton","nag-corner-button","nagCornerButton","choose-scene-button","chooseSceneButton","leave-button","leaveButton","interstitial","invite-tip","inviteTip","streaming-tip","streamingTip","streaming-tip-attach-point","streamingTipAttachPoint","streaming-tip-close","streamingTipClose","streaming-tip-message","streamingTipMessage","ui-dialog-box-contents","uiDialogBoxContents","backgrounded","in-room-favorite-button","inRoomFavoriteButton","help-button","helpButton","occupant-count","occupantCount","presence-info-selected","presenceInfoSelected","camera-mode-exit-button","cameraModeExitButton","corner-button-selected","cornerButtonSelected","invite-tip-attach-point","inviteTipAttachPoint","avatar-editor","avatarEditor","room-info","roomInfo","scene-screenshot","sceneScreenshot","scene-details","sceneDetails","scene-main","sceneMain","scene-name","sceneName","scene-creator","sceneCreator","scene-attributions","sceneAttributions","attribution-name","attributionName","attribution-author","attributionAuthor","description","hub-title","hubTitle","presence-log","presenceLog","presence-log-entry","presenceLogEntry","message-body","messageBody","message-body-multi","messageBodyMulti","message-body-mono","messageBodyMono","message-wrap","messageWrap","message-wrap-multi","messageWrapMulti","message-source","messageSource","message-source-link","messageSourceLink","icon-button","iconButton","spawn-message","spawnMessage","share","mediaBody","expired","presence-log-entry-with-button","presenceLogEntryWithButton","presence-log-in-room","presenceLogInRoom","presence-log-spawn","presenceLogSpawn","presence-log-entry-one-line","presenceLogEntryOneLine","presence-log-emoji","presenceLogEmoji","emoji","handleTextFieldFocus","handleTextFieldBlur","screenfull__WEBPACK_IMPORTED_MODULE_0__","screenfull__WEBPACK_IMPORTED_MODULE_0___default","_fullscreen__WEBPACK_IMPORTED_MODULE_1__","detect","require","browser","isExitingFullscreenDueToFocus","screenfull","isFullscreen","exit","focus","select","showFullScreenIfWasFullScreen","max-resolution-preference-item","maxResolutionPreferenceItem","number-with-range","numberWithRange","number-in-number-with-range","numberInNumberWithRange","preference-list-item","preferenceListItem","dropdown","content-container","contentContainer","panel-margin","panelMargin","dropdownArrow","preference-list-non-checkbox","preferenceListNonCheckbox","part","checkbox-margin","checkboxMargin","preferences-panel","preferencesPanel","scrolling-content","scrollingContent","section-bar","sectionBar","section-title","sectionTitle","row-name","rowName","reset-to-default-button","resetToDefaultButton","prev-option-scale","prevOptionScale","next-option-scale","nextOptionScale","prev-option-hovered-scale","prevOptionHoveredScale","next-option-hovered-scale","nextOptionHoveredScale","range-slider","rangeSlider","ObjectTypes","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","CAMERA","UNKNOWN","objectTypeForOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","prefix","suffix","panel","tip-cancel-text","tipCancelText","top-tip","topTip","container","top","column","bottom","hide","attach_video_share_mode","attachVideoShareMode","attach_video_share_failed","attachVideoShareFailed","attach_pen_mode","attachPenMode","attach_mute_mode","attachMuteMode","attach_freeze_mode","attachFreezeMode","top-tip-no-hud","topTipNoHud","tip-cancel","tipCancel","video-share-extra-options","videoShareExtraOptions","up","iconButtonIcon","spawn","small","large","disabled","video-share","videoShare","invite-container","inviteContainer","dialog","link-button","linkButton","enter-vr-button","enterVrButton","invite-button","inviteButton","enter-button","enterButton","invite-mini-button","inviteMiniButton","embed-text","embedText","invite-container-inverted","inviteContainerInverted","subscribe","embed-tip-wrap","embedTipWrap","embed-tip","embedTip","modal","invite-button-lowered","inviteButtonLowered","hide-small-screens","hideSmallScreens","link-code","linkCode","code-duration","codeDuration","invite-container-below-hud","inviteContainerBelowHud","code","keep-open","keepOpen","digit","digit_2","digit2","digit_3","digit3","code-loading-panel","codeLoadingPanel","hub-link-link","hubLinkLink","buttons","embed","embed-tip-attach-point","embedTipAttachPoint","AVATARS_API","AVATAR_TYPES","SKINNABLE","getAvatarType","avatarId","resp","avatars","fetchAvatar","_fetchAvatar","fetchSkinnableAvatar","avatar_id","gltf_url","avatar","getAvatarSrc","fetchAvatarGltfUrl","getAvatarThumbnailUrl","_getAvatarThumbnailUrl","files","thumbnail","MAT_NAME","ensureAvatarMaterial","materialForMesh","primitives","primitive","meshes","remixAvatar","_remixAvatar","parentId","parent_avatar_listing_id","customFOV","enableThirdPersonMode","getInspectable","inspectable","parentNode","q","orbit","owq","owp","cwq","cwp","rwq","UP","RIGHT","Object3D","dhQ","dvQ","rig","dh","dv","dz","dt","panY","getWorldQuaternion","setFromAxisAngle","applyQuaternion","premultiply","dPos","subVectors","zoom","addVectors","moveRigSoCameraLooksAtObject","oForw","distanceMod","getBox","getCenter","sceneEl","is","dist","CAMERA_MODE_FIRST_PERSON","CAMERA_MODE_THIRD_PERSON_NEAR","CAMERA_MODE_THIRD_PERSON_FAR","CAMERA_MODE_INSPECT","CAMERA_MODE_SCENE_PREVIEW","NEXT_MODES","[object Object]","CAMERA_LAYER_INSPECT","CAMERA_LAYER_BATCH_INSPECT","ensureLightsAreSeenByCamera","isLight","layers","enable","enableInspectLayer","batch","batchManager","batchForMesh","disableInspectLayer","disable","FALLOFF","CameraSystem","translation","uiRoot","entered","getElementById","quat","viewingCamera","viewingRig","avatarRig","characterController","fly","avatarPOV","enteredScene","avatarPOVRotator","viewingCameraRotator","userinput","interaction","hoverEl","rightRemote","hovered","leftRemote","inspect","temporarilyDisableRegularExit","uninspect","nextMode","headShouldBeVisible","playerHead","makeTranslation","horizontalDelta","verticalDelta","inspected","enableLights","localStorage","getItem","snapshot","audioTransform","audioListenerTargetTransform","bg","BoxGeometry","MeshBasicMaterial","color","BackSide","vr","setPoseTarget","getCamera","mask","mask0","cameras","mask1","hideEverythingButThisObject","audio","getAudio","showEverythingAsNormal","forEachMaterial","fn","isArray","names","chooseRandom","arr","fetchRandomDefaultAvatarId","_fetchRandomDefaultAvatarId","defaultAvatars","ducky","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","SCHEMA","definitions","additionalProperties","properties","displayName","pattern","personalAvatarId","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","hasOpenedShare","entryCount","settings","lastUsedMicDeviceId","preferences","muteMicOnEntry","enableOnScreenJoystickLeft","enableOnScreenJoystickRight","onlyShowNametagsInFreeze","allowMultipleHubsInstances","maxResolutionWidth","maxResolutionHeight","globalVoiceVolume","globalMediaVolume","snapRotationDegrees","materialQualitySetting","disableMovement","disableBackwardsMovement","disableStrafing","disableTeleporter","disableAutoPixelRatio","confirmedDiscordRooms","items","confirmedBroadcastedRooms","onLoadActions","action","args","$ref","EventTarget","jwtDecode","exp","Date","now","store_asyncToGenerator","_shouldResetAvatarOnInit","resetToRandomDefaultAvatar","setItem","dispatchEvent","CustomEvent","oauthFlowCredentials","Cookies","getJSON","_signOutOnExpiredAuthToken","credentialsAccountId","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","bumpEntryCount","currentEntryCount","enqueueOnLoadAction","executeOnLoadActions","clearOnLoadActions","arrayMerge","destinationArray","sourceArray","newState","mergeOpts","finalState","merge","valid","validate","showHoverEffect","isFrozen","isPinned","pinnable","pinned","isSpawner","isEmojiSpawner","canMove","hubChannel","can","networkedTemplate","isCamera","isPen","isEmoji","holdableButton","indexForComponent","component","schema","fullComponent","componentName","schemaComponent","authorizeOrSanitizeMessage","applyPersistentSync","nonAuthorizedSchemas","sanitizeMessageData","schemaDict","schemas","nonAuthorizedComponents","nonAuthorizedComponent","toString","initializeNonAuthorizedSchemas","nonAuthorizedIndices","authorizeEntityManipulation","entityMetadata","sender","senderPermissions","isCreator","pin_objects","spawn_and_move_media","spawn_camera","spawn_drawing","spawn_emoji","getPendingOrExistingEntityMetadata","networkId","pendingData","connection","adapter","getPendingDataForNetworkId","pinnableComponent","entities","getEntity","authorizeOrSanitizeMessageData","persistentSyncs","stashPersistentSync","entityData","currentData","currentComponents","dataType","from_session_id","emptyObject","isFirstSync","persistent","presenceState","permissions","sanitizedAny","stashedAny","PHOENIX_RELIABLE_NAF","onData","navigation-button","navigationButton","primary-action-buttons","primaryActionButtons","cancel","title-and-close","titleAndClose","object-display-string","objectDisplayString","cancel-text","cancelText","client-info-dialog","clientInfoDialog","community-identifier","communityIdentifier","client-info","clientInfo","client-profile-image","clientProfileImage","client-details","clientDetails","client-main","clientMain","action-button-sections","actionButtonSections","action-button-placeholder","actionButtonPlaceholder","left-action-buttons","leftActionButtons","right-action-buttons","rightActionButtons","button-icon","buttonIcon","primary-action-button","primaryActionButton","registerTelemetry","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","_utils_configs__WEBPACK_IMPORTED_MODULE_1__","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","computeObjectAABB","getScaleCoefficient","bounds","Box3","makeEmpty","boundingBox","computeBoundingBox","union","applyMatrix4","Euler","boxRoot","worldSpace","updateMatrixWorld","isEmpty","worldToLocal","dX","dY","dZ","client-link","clientLink","presence-list","presenceList","sign-in","signIn","self","moderator-badge","moderatorBadge","message-entry-input","messageEntryInput","message-entry","messageEntry","message-entry-disabled","messageEntryDisabled","message-entry-button","messageEntryButton","message-entry-spawn","messageEntrySpawn","message-entry-button-in-room","messageEntryButtonInRoom","message-entry-upload","messageEntryUpload","message-entry-in-room","messageEntryInRoom","message-entry-input-in-room","messageEntryInputInRoom","message-entry-input-no-spawn","messageEntryInputNoSpawn","message-entry-on-mobile","messageEntryOnMobile","hasEnteredFullScreenThisSession","shouldShowFullScreen","isIOS","enabled","willRequireUserGesture","showFullScreenIfAvailable","_showFullScreenIfAvailable","request","_showFullScreenIfWasFullScreen","nextTick","setTimeout","description-field","descriptionField","name-field","nameField","next-button","nextButton","continue-button","continueButton","room-settings-form","roomSettingsForm","select-container","selectContainer","permission","member-cap-container","memberCapContainer","permissions-group","permissionsGroup","permission-disabled","permissionDisabled","raycast","acceleratedRaycast","gltfCache","cache","count","retain","cacheItem","release","delete","inflightGltfs","extractZipFile","promisifyWorker","SketchfabZipWorker","defaultInflator","componentData","multiple","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","GLTFModelPlus","registerComponent","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","entityComponents","order","setFromQuaternion","matrixAutoUpdate","setObject3D","generateUUID","morphTargetInfluences","gltfIndex","inflatedEntity","isFirstInflation","objectInflations","objectInflation","promise","prop","_x9","attachTemplate","templateRoot","targetEls","getHubsComponentsExtension","extras","loadGLTF","_loadGLTF","preferredTechnique","jsonPreprocessor","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","GLTFLoader","setBasisTextureLoader","parser","createParser","oldHeightfieldNode","heightfield","light","range","decay","runMigration","MOZ_alt_materials","altMaterialIndex","DefaultMatrixAutoUpdate","isMeshStandardMaterial","MobileStandardMaterial","fromStandardMaterial","keys","revokeObjectURL","loadModel","_x8","_loadModel","useCache","resolveAsset","assetEl","default","inflate","init","loadTemplates","applySrc","model","removeObject","object3DMap","templateEl","lastSrc","inflatedEl","disposeLastInflatedEl","addObject","initMixer","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflateComponents","rewires","environmentMapComponent","applyEnvironmentMap","f","removeAttribute","profile-entry","profileEntry","form-submit","formSubmit","choose-avatar","chooseAvatar","form-field-text","formFieldText","logo","form","display-name","preview","edit-avatar","editAvatar","tweet-button","tweetButton","tweet","editor","editor-inner","editorInner","emoji-button","emojiButton","counter","posted","tweet-loader","tweetLoader","dialog-background","dialogBackground","findAncestorWithComponent","Blob","createObjectURL","putImageData","toDataURL","img","disposeImageBitmap","imageBitmap","HTMLImageElement","email-field","emailField","sign-in-form","signInForm","sign-in-complete","signInComplete","terms","applyThemeToTextButton","getThemeColor","_async_utils__WEBPACK_IMPORTED_MODULE_0__","DEFAULT_COLORS","action-color","action-label-color","action-color-disabled","action-color-highlight","action-text-color","action-subtitle-color","notice-background-color","notice-text-color","favorited-color","highlighted","actionColor","actionHoverColor","VERTEX_SHADER","FRAGMENT_SHADER","ShaderMaterial","parameters","UniformsUtils","UniformsLib","fog","uvTransform","Matrix3","diffuse","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","lights","transparent","alphaTest","skinning","morphTargets","vertexColors","mobileMaterial","emissiveIntensity","refreshUniforms","uvScaleMap","updateMatrix","touchZone","mockJoystickContainer","mockJoystick","inner","tip-root","tipRoot","tip-link","tipLink","tip","split-tip","splitTip","split-tip-icon","splitTipIcon","spawn_menu-icon","spawnMenuIcon","object_rotate_button-icon","objectRotateButtonIcon","object_scale_button-icon","objectScaleButtonIcon","object_recenter_button-icon","objectRecenterButtonIcon","tour-tip-root","tourTipRoot","COLLISION_LAYERS","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","DEFAULT_INTERACTABLE","UNOWNED_INTERACTABLE","DEFAULT_SPAWNER","nextItemId","outstanding","handlers","transfer","EMPTY_RESULT","URL_SOURCE_TO_TO_API_SOURCE","videos","youtube","gifs","sketchfab","poly","twitch","favorites","availableIntegrations","SOURCES","apiSource","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","locationSearchParams","isMy","singular","lastSavedUrl","isFetching","nextCursor","next_cursor","lastFetchedUrl","goBack","query","keepSource","keepNav","keepSelectAction","_stashedParams","_stashedSource","_sourceNavigate","selectAction","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","StateLink","handleClick","defaultPrevented","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","preventDefault","stateKey","stateValue","stateDetail","innerRef","ref","small-button","smallButton","input-border","inputBorder","left-side-of-input","leftSideOfInput","add-media-form","addMediaForm","cancel-icon","cancelIcon","upload-icon","uploadIcon","hide-file-input","hideFileInput","imageHeader","disableiOSZoom","detect_browser__WEBPACK_IMPORTED_MODULE_0__","detectOS","userAgent","lastTouchAtMs","ev","getTime","isDoubleTouch","registerComponentInstance","componentRegistry","deregisterComponentInstance","getCurrentStreamer","playerInfos","playerInfo","playerSessionId","streaming","hackyMobileSafariTest","hackyMobileSafariTestValue","hasTouchScreen","maxTouchPoints","msMaxTouchPoints","mQ","matchMedia","UA","detectTouchScreen","SignInDialog","stopPropagation","onSignIn","authStarted","react_intl__WEBPACK_IMPORTED_MODULE_2__","authComplete","styles","onContinue","continueText","onSubmit","required","placeholder","onFocus","onBlur","onChange","setState","_if_feature__WEBPACK_IMPORTED_MODULE_4__","rel","_dialog_container__WEBPACK_IMPORTED_MODULE_6__","_extends","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_utils_permissions_utils__WEBPACK_IMPORTED_MODULE_1__","interactorOneTransform","interactorTwoTransform","enableSweepingEffect","geometryRadius","sweepParams","isTouchscreen","time","showEffect","toggling","cursorTogglingSystem","interactorOne","interactorTwo","ready","held","options","leftToggledOff","rightToggledOff","toArray","worldY","elements","ms1","ms2","ms3","scaledRadius","sqrt","uniform","getReader","read","readChunk","done","isValidSceneUrl","_isValidSceneUrl","trim","_isValidGLB","isValidGLB","allowDisplayOfSceneLink","account_id","allow_promotion","allow_remixing","load-button","loadButton","treatment","screenshot","hub-name","hubName","main-panel","mainPanel","createDefaultEnvironmentMap","_createDefaultEnvironmentMap","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","RGBFormat","environmentMap","updateEnvironmentMap","App","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","mediaSearchStore","setQuality","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","depth","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","WebGLRenderer","forceWebVR","gammaOutput","gammaFactor","physicallyCorrectLights","setPixelRatio","devicePixelRatio","createImageBitmapFromURL","blob","ORBIT_ANGLE","DEG2RAD","DEFAULT_MARGIN","fitBoxInFrustum","margin","applyEuler","lookAt","AvatarPreview","Scene","PerspectiveCamera","clientWidth","clientHeight","controls","OrbitControls","enablePan","DirectionalLight","HemisphereLight","loadId","avatarGltfUrl","loadCurrentAvatarGltfUrl","clock","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","setAnimationLoop","getDelta","mixer","resize","parentElement","offsetWidth","offsetHeight","setSize","updateProjectionMatrix","resetCamera","setFromObject","domElement","imageBitmaps","oldProps","applyMaps","technique","previewMesh","idleAnimation","AnimationMixer","clipAction","setLoop","LoopRepeat","Infinity","idleAnimationAction","getImage","originalMaps","all","bm","toBlob","_this2","newLoadId","loadPreviewAvatar","onGltfLoaded","setAvatar","newProps","mapName","applyMap","applyMapToPreview","revertMap","react__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_warning_icon_png__WEBPACK_IMPORTED_MODULE_0___default","srcSet","_assets_images_warning_icon_2x_png__WEBPACK_IMPORTED_MODULE_1___default","react_intl__WEBPACK_IMPORTED_MODULE_4__","injectIntl","withRef","spoke-launch","spokeLaunch","change-scene-button","changeSceneButton","spoke-create","spokeCreate","oauth-discord-button","oauthDiscordButton","oauth-twitter-button","oauthTwitterButton","oauth-button","oauthButton","oauth-type-name","oauthTypeName","oauth-icon","oauthIcon","privacy-notice","privacyNotice","oauth-buttons","oauthButtons","twitter-message","twitterMessage","xr","requestDevice","getVRDisplays","MIN_VOLUME_THRESHOLD","calculateVolume","analyser","levels","getByteTimeDomainData","sum","amplitude","tempScaleFromPosition","tempScaleToPosition","getAudioFeedbackScale","fromObject","toObject","minScale","maxScale","volume","distanceTo","updateVolume","newRawVolume","newPerceivedVolume","mapLinear","E","prevVolume","getAnalyser","ikRootEl","analyserEl","loudest","_updateAnalysis","_runScheduledWork","schedule","createAnalyser","fftSize","Uint8Array","soundSource","unschedule","avatarIsQuiet","lastSeenVolume","registerSystem","mediaStream","stream","createMediaStreamSource","connectAnalyser","setScalar","minValue","maxValue","skinnedmesh","morphNumber","morphTargetDictionary","easeOutQuadratic","SPRITE_NAMES","MIC","MIC_HOVER","MIC_OFF","MIC_OFF_HOVER","micLevelForVolume","clamp","ceil","active","tooltip","tooltipText","activeTooltipText","prevSpriteName","hovering","onHover","onHoverOut","pause","textEl","audioAnalyser","spriteName","UnlessFeature","AuthChannel","signOut","_signedIn","signedIn","verifyAuthentication","authTopic","authToken","authPayload","leave","handleAuthCredentials","startAuthentication","_this3","_this4","addAnimationComponents","modelEl","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","isDebug","logFilter","maskEmail","emailParts","emailIdentity","emailDomain","RoomInfoDialog","hasDescription","hubDescription","hasScene","showSceneLink","toAttributionDiv","author","attributions","_dialog_container_js__WEBPACK_IMPORTED_MODULE_3__","Fragment","screenshot_url","sceneButtons","dayjs","extend","relativeTime","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","poly_model","twitch_stream","MediaTiles","onCopyAvatar","parent_scene_id","onCopyScene","isImage","isAvatar","imageAspect","innerWidth","imageWidth","imageHeight","imageSrc","isHub","getTileDimensions","thumbnailElement","muted","autoPlay","playsInline","publisherName","formatMessage","intl","handleEntryClicked","_state_link__WEBPACK_IMPORTED_MODULE_20__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_6__","faPencilAlt","onShowSimilar","faSearch","handleCopyAvatar","faClone","handleCopyScene","project_id","handleEntryInfoClicked","faInfo","faStar","faExternalLinkAlt","react_intl__WEBPACK_IMPORTED_MODULE_5__","last_activated_at","fromNow","faUsers","member_count","hasNext","hasPrevious","page","isVariableWidth","createTileWidth","createTileHeight","_if_feature__WEBPACK_IMPORTED_MODULE_17__","faPlus","entryToTile","handlePager","previousPage","faAngleLeft","nextPage","faAngleRight","array","number","patchWebGLRenderingContext","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","PlaneBufferGeometry","Camera","getError","checkFloatTextureSupport","ScenePreviewCameraSystem","_camera_system_js__WEBPACK_IMPORTED_MODULE_0__","_utils_three_utils__WEBPACK_IMPORTED_MODULE_1__","register","unregister","isGhost","hubsSystems","cameraSystem","tick2","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","charCodeAt","arrayBufferToString","keyPair","generateKey","publicKeyString","incomingPublicKeyString","iv","incomingPublicKey","secret","encryptedData","encrypt","base64value","ciphertext","atob","decrypt","LINK_ACTION_TIMEOUT","LinkChannel","onFinished","finished","getLetter","readyToSend","leftChannel","incoming","_generatePublicKeyAndEncryptedObject","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","_generateKeys","generateKeys","numOccupants","session_id","_decryptObject","decryptObject","command-help","commandHelp","command","cancel-button","cancelButton","confirm-button","confirmButton","help-dialog","helpDialog","docs-link","docsLink","tour-button","tourButton","zeroPos","zeroQuat","oneScale","bindingSetters","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","targetObject","getWorldPosition","getWorldScale","handleMatrixModification","cachedMatrixWorld","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","equals","includeInvisible","forceChildrenWorldUpdate","q1","m1","isVector3","inverse","animation","colorHelperFrom","Color","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","addEventListeners","eventNames","removeEventListeners","getRawProperty","splitDot","setRawProperty","targetValue","g","isRawProperty","autoplay","delay","dir","parseInt","startEvents","pauseEvents","resumeEvents","eventDetail","attrName","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targetsArray","updateConfigForDefault","updateConfigForRawColor","oldData","direction","createAndStartAnimation","cancelDelayedStart","paused","pausedWasPlaying","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","getPropertyType","cb","wait","clearTimeout","intensity","AmbientLight","registerLight","rendererSystem","prevData","applyColorCorrection","removeObject3D","initialForce","maxForce","physicsSystem","physics","hasBody","CANNON","Vec3","force","addComponent","removeComponent","beforeStep","isMine","currentScale","angle","applyForce","generateAndAddHeightfield","shape","mass","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","onQualityChanged","updateComponentState","castShadow","shadowMapResolution","shadowBias","shadowRadius","PointLight","shadow","bias","radius","prevWidth","prevHeight","mapSize","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","modifyGravityOnRelease","releaseGravity","reduceAngularFloat","gravitySpeedLimit","onGrab","onRelease","bodyHelper","isHeld","wasHeld","_makeStaticWhenAtRest","linearThreshold","linearSleepingThreshold","angularThreshold","angularSleepingThreshold","isAtRest","bodyInitialized","getLinearVelocity","getAngularVelocity","hasBeenHereBefore","gravity","setLocked","locked","angularDamping","linearDamping","collisionFilterMask","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","colliders","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","collidingLastFrame","setFromCenterAndSize","isColliding","containsPoint","onPauseStateChange","videoComponent","onVideoLoaded","video","togglePlaying","origDispatch","firstObject","Pathfinding","pathfinder","removeNavMeshData","loadMesh","zone","Geometry","fromBufferGeometry","setZoneData","createZone","zones","eventSource","events","eventListeners","_handleEvent","frustumBox","inverseLightMatrixWorld","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","expandByPoint","near","far","resizeShadowCameraFrustum","Layers","reflection","inWorldHud","exclusive","layer","oldValue","newValue","clip","activeClipIndex","mixerEl","currentActions","updateClip","clipName","clips","destroy","loadingObjectEnvMap","loadingObject","loadingObjectSrc","forceMeshBatching","forceImageBatching","disableBatching","playSoundEffect","moveTheParentNotTheMesh","showLoader","clearLoadingTimeout","onMediaLoaded","handleLinkedElRemoved","refresh","animating","getNetworkedEntity","networkedEl","updateScale","originalMeshMatrix","desiredObjectMatrix","scaleCoefficient","removeShape","loaderMixer","sfx","soundEffectsSystem","loadingSoundEffect","loadedSoundEffect","useFancyLoader","currentEnivronmentMap","loadingClip","loadingScaleClip","VectorKeyframeTrack","SHAPE","BOX","showLoaderTimeout","updateHoverableVisuals","boundingSphere","Sphere","hoverableVisuals","injectedCustomShaderChunks","getBoundingSphere","physicsShape","shouldUpdateScale","finish","minHalfExtent","registerLinkage","takeOwnership","forceLocalRefresh","srcChanged","canonicalUrl","canonicalAudioUrl","accessibleUrl","isLocalModelAsset","projection","origin_audio","expected_content_type","fetchContentType","raw","isHLS","linkedVideoTexture","linkedAudioSource","linkedMediaElementAudioSource","linkedMediaVideo","videoTexture","audioSource","mediaElementAudioSource","qsTime","startTime","hash","audioSrc","dirs","HULL","mayChangeScene","maxIndex","onNext","onPrev","onSnap","getHoverMenu","hoverMenu","prevButton","snapButton","pageLabel","pinnableElement","newIndex","quackPercentage","specialQuackPercentage","_handleGrabStart","rand","lerp","newRot","positionOnly","scenePreviewCameraSystem","startPoint","targetPoint","targetRotDelta","targetRotation","setFromEuler","performance","backwards","ranOnePass","streamerCamera","streamer","getStreamerCamera","translateZ","fromRot","toRot","isBotMode","CubeCamera","BoxBufferGeometry","PMREMGenerator","skybox_PMREMGenerator","PMREMCubeUVPacker","Sky","skyScene","cubeCamera","sky","_geometry","_inclination","_azimuth","_distance","updateSunPosition","turbidity","rayleigh","luminance","mieCoefficient","mieDirectionalG","inclination","azimuth","phi","sunPosition","generateEnvironmentMap","vrEnabled","pmremGenerator","renderTarget","pmremCubeUVPacker","cubeLods","CubeUVRenderTarget","recursive","skyIndex","requestAnimationFrame","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","spawnPoint","spawnScale","NaN","spawnCooldown","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","handleMediaLoaded","spawnedMediaScale","spawnedEntity","boxSize","divideScalar","hand","willAnimateFromCursor","spawning","activateCooldown","resetDynamicBody","sx","sy","sz","MobileWater","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","mirrorShader","ShaderChunk","TextureLoader","wrapS","wrapT","RepeatWrapping","Water","speed","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","mirrorCamera","setStyle","simple_water_Mesh","MeshStandardMaterial","MeshPhongMaterial","Vector2","Octave","alternate","SimpleWater","resolution","lowQuality","rotateX","waterUniforms","ripplesSpeed","ripplesScale","materialClass","specular","receiveShadow","dynamic","octaves","simplex","SimplexNoise","tideHeight","tideScale","tideSpeed","waveHeight","waveScale","waveSpeed","positionAttribute","octave","noise","setY","computeVertexNormals","vec2Equals","waterNormalsUrl","defaultSrcUrl","defaultSrcImage","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","particleEmitter","ParticleEmitter","updateParticles","setTexture","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","registerRootSceneComponent","mediaInflator","isControlled","hasVolume","templateName","owner","videoPaused","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","isHandCollisionTarget","TYPE","STATIC","collisionFilterGroup","euler","fit","FIT","MANUAL","halfExtents","w","canBeSpawnPoint","canBeOccupied","canBeClicked","willDisableMotion","willDisableTeleporting","willMaintainWorldUp","_componentName","found","attachTemplateToLocal","mediaLoaderAttributes","pageIndex","loop-animation","enterComponentMapping","leaveComponentMapping","targetEntity","HEIGHTFIELD","heightfieldDistance","heightfieldData","MESH","audioSettingsSystem","updateAudioSettings","loading-text","loadingText","avatar-url-dialog","avatarUrlDialog","form-frame","formFrame","leave-room","leaveRoom","_qs_truthy__WEBPACK_IMPORTED_MODULE_0__","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","scrollTop","scrollHeight","origConsoleInfo","origConsoleLog","origConsoleError","origConsoleWarn","objs","childNodes","firstObj","stack","toISOString","textContent","shouldScroll","onunhandledrejection","reason","onerror","resume","setInitial","_lastPosition","_lastOrientation","_lastListenerPosition","panner","listener","EPSILON","positionX","positionY","positionZ","setOrientation","baseScale","addedScale","didRegister","scaleInScreenSpaceSystem","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","lastVisible","fadeOut","beginTransition","fadeIn","_resolveFinish","mat","hoverImage","activeImage","activeHoverImage","disabledImage","updateButtonState","sprite","textHoverColor","textColor","backgroundHoverColor","backgroundColor","noop","dependencies","block","mute","kick","updateVisibility","canOrWillIfCreator","contentTypes","mediaLoader","mediaImage","mediaVideo","mediaPdf","currentContentType","matchesType","targetContentType","matchesSubtype","whenPinned","_updateUI","_updateUIOnStateChange","targetEl","pinnedAndForbidden","left_hand_pose","right_hand_pose","_fireEventsAndAnimate","pinStateChanged","didFireThisFrame","transformObjectSystem","transforming","wasTransforming","activateBody","track","selector","myCamera","getMyCamera","isVisible","shouldBeVisible","onStateChange","newOwner","transform","oneof","stateadded","stateremoved","withPermission","needsPermission","updatePermissions","hasPermission","onPermissionsUpdated","requireOwnership","targetPos","snappedRot","snappedQ","snappedXForm","snappedXFormWorld","tempVector","isHovered","hoveredEl","_hoveredFrames","_applyMaskedTargetRotation","started","reset","_updateMatrixAutoUpdate","dim","onFrozenStateChange","applyHoverState","menuPromise","hoverContainer","allowed","frustumCulled","currentActiveCamera","activeCameraEl","setActiveCamera","cursorPoseTrackingSystem","playhead","poseIndex","overflow","poses","timestamp","_updateBillboard","_updateIsInView","isInView","frustum","Frustum","frustumMatrix","boxTemp","expandBox","isInViewOfCamera","screenCamera","projectionMatrix","matrixWorldInverse","setFromMatrix","intersectsBox","playerCamera","cameraTools","ifMyCameraRenderingViewfinder","cameraTool","lastSync","syncAll","onStoreChanged","maxCanvasSize","registry","queues","frameIndex","queue","invert","inVRMode","class","permissionName","fetchPermissions","onTimeout","onEnterVR","isOculusBrowser","enteredVR","lastTimeoutCheck","exitTimeout","deltas","secondsSinceMeasurementStart","secondsSinceSceneVisible","maxPixelRatio","pixelRatioToTimesDecreased","disabledByPref","onPreferenceChange","visibilityState","medianFps","currentPixelRatio","getPixelRatio","shouldDecrease","shouldIncrease","newPixelRatio","toFixed","timesDecreased","system","addLinkageHandler","syncLinkage","elA","elB","_handlingLinkage","waitForMediaLoader","handlerA","handlerB","deregisterLinkage","syncedVideoAttributes","syncTolerance","updatePlaybackState","_syncCounterRegistration","timestamps","deregister","ttl","POSITIVE_INFINITY","setBodyKinematic","didThisOnce","clear","_destroyOldest","oldestEl","minTs","MAX_VALUE","ts","_destroy","teleporters","queryCollisionEntities","penSpawner","drawingToPen","drawingEl","createDrawing","createDrawingPromise","handNetworkedDrawingInit","drawing","destroyDrawing","networkedDrawing","getDrawingPromise","getDrawing","returnDrawing","bindAllEvents","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","enableMicrophone","removeState","addState","mic","cameraBtn","inviteBtn","background","updateButtonStates","onMicClick","onSpawnClick","onPenClick","onCameraClick","onInviteClick","emitDecayTime","emitFadeTime","emitEndTime","particleEmitterConfig","emojiHud","emojiUrls","lastLinearVelocity","lastAngularVelocity","particleConfig","originalParticleCount","initialized","linearVelocity","linearAcceleration","angularAcceleration","emojis","emoji_0","emoji_1","emoji_2","emoji_3","emoji_4","emoji_5","emoji_6","particles","emoji_particle_0","emoji_particle_1","emoji_particle_2","emoji_particle_3","emoji_particle_4","emoji_particle_5","emoji_particle_6","setOffsetVector","totalNumEmojis","spacing","offsetVector","sign","spawnerScale","spawnedScale","hudAngle","minHudAngle","maxHudAngle","hudDistance","spawnerPlatformWidth","spawnerPlatformSpacing","cameraWorldPosition","_onFrozen","_onThaw","spawnerEntities","spawnerEntity","requireHoverOnNonMobile","cameraObject3D","cylinder","_updateOffset","targetWorldPos","cameraForward","projectedCameraForward","angledCameraForward","defaultRight","transformDirection","projectOnPlane","DefaultUp","dot","angleTo","angleOffset","applyAxisAngle","HIDDEN_JOYSTICK_STYLE","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","leftMock","leftMockSmall","rightMock","rightMockSmall","enableLeft","enableRight","createLeftStick","createRightStick","inVr","moving","rotating","displacement","lookDy","lookDx","newEnableLeft","newEnableRight","leftStick","leftTouchZone","rightStick","rightTouchZone","nipplejs","fadeTime","off","preferenceScreenIsVisible","radian","enqueueRelativeMotion","enqueueInPlaceRotationAroundWorldUp","display","leftController","rightController","HAND_ROTATIONS","makeRotationFromEuler","leftEye","rightEye","neck","chest","rotationSpeed","alwaysUpdate","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hasConvergedHips","lastCameraTransform","forceIkUpdate","negate","hasNewCameraTransform","_hadFirstTick","epsilon","u","updateHand","_hasFirstTick","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","setAlwaysHidden","cameraWorld","POSES","poseForFingers","subpath","previous","current","handleLeftVisuals","handleRightVisuals","hadLeftVisualLastFrame","hadRightVisualLastFrame","interactingElement","hideVisual","selfDestruct","updateOffset","QUARTER_CIRCLE","rotateOnAxis","ensureAvatarNodes","some","originalRoot","scale-audio-feedback","avatarSrc","avatarType","identityName","isOwner","isRecording","applyProperties","updateDisplayName","applyDisplayName","handleModelError","isLocalPlayerInfo","networkedEntity","getCreator","playerPresence","updateDisplayNameFromPresenceMeta","presenceMeta","recording","roles","infoShouldBeHidden","nametagEl","identityNameEl","recordingBadgeEl","modBadgeEl","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","NETWORK_POSES","animatePose","networkField","getNetworkedAvatar","networkedAvatar","prev","curr","setHandPose","TWOPI","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hoverableChildren","pitch","RAD2DEG","yawDif","deltaAngle","forceHudVisible","hudLocked","hudOutOfView","frozen","wasInspecting","withinDistance","withoutPermission","visibleIfOwned","camWorldPos","objWorldPos","cam","hoverableSearch","hoverable","shouldNotBeVisible","isWithinDistance","isTransforming","toggle","onExpand","onCollapse","stats","threeStats","aframeStats","plugins","rStats","css","fps","caption","below","batchdraws","batchinstances","batchatlassize","createStats","statsEl","statsHeaderEl","statsTitleEl","collapseEl","insertBefore","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","vrStatsEnabled","initVRStats","lastUpdate","vrPanel","whiteSpace","baseline","depthTest","toggleVRStats","frame","stepDuration","batches","instanceCount","atlas","arrayDepth","calls","triangles","show","getCurrentMirroredMedia","mirrorEl","refreshButton","localRefreshButton","ONCE_TRUE","TYPE_IMG_PNG","parseGIF","GIFWorker","isFirefoxReality","audioIconTexture","audioIcon","VOLUME_LABELS","GIFTexture","frames","delays","disposals","_ctx","isVideoTexture","NearestFilter","frameStartTime","clearRect","rawImageData","delayTimes","loadCnt","createVideoOrAudioEl","preload","scaleToAspectRatio","ratio","disposeTexture","HTMLVideoElement","hls","stopLoad","detachMedia","textureCache","videoHeight","videoWidth","inflightTextures","errorImage","errorImageSrc","errorTexture","errorCacheItem","timeFmt","h","tickRate","updateHoverMenu","tryUpdateVideoPlaybackState","ensureOwned","isMineOrLocal","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","videoMutedAt","localSnapCount","isSnapping","videoIsLive","onSnapImageLoaded","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","timeLabel","volumeLabel","updateVolumeLabel","getNetworkOwner","currentTime","media_views_asyncToGenerator","_ignorePauseStateChanges","_playbackStateChangeTimeout","audioSourceEl","cleanUp","createVideoTextureAudioSourceEl","_refreshMediaMirror","refreshMediaMirror","createMediaElementSource","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","Audio","setNodeSource","updateLiveState","currentLevel","videoWasLive","details","live","HLS","Events","LEVEL_LOADED","LEVEL_SWITCHED","SphereBufferGeometry","DoubleSide","_audioSyncInterval","clearInterval","videoEl","audioEl","isReady","VideoTexture","streamClientId","getMediaStream","srcObject","getVideoTracks","isSupported","setupHls","xhrSetup","xhr","buildAbsoluteURL","loadSource","attachMedia","ERROR","fatal","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","setupInterval","setInterval","isNoLongerSrc","canPlayType","poll","mayModifyPlayHead","volumeModRight","volumeModLeft","disconnect","currentSrcIsRetained","_this5","inflightKey","createGIFTexture","uvs","uv","isCompressedTexture","canvasContext","_this6","_this7","renderTask","loadingSrc","getDocument","numPages","getPage","viewport","getViewport","pw","ph","currentPageTextureIsRetained","SMALL_STEP","BIG_STEP","numBars","pinchDelta","rotatePitchAndYaw","opq","oq","pq","yq","initialUpDot","initialForwardDotUp","newUpDot","newForwardDotUp","scenePreviewNode","pendingXRotation","HALF_PI","THREE_HALF_PI","forward","zero","halfExtent","_updateBox","_setupTarget","opening","wasVisible","scaleChanged","previousScaleX","previousScaleY","previousScaleZ","isAnimating","targetPosition","pointOnBoxFace","pointOnBoxFaceToCamera","boxCenter","tempParentWorldScale","boxFaceNormal","forceNewExtents","targetSquareDistance","targetDir","targetHalfExtentStr","targetHalfExtent","targetCameraDot","halfExtentStr","cameraAngleDotBoxNormal","squareDistance","targetScale","finalScale","tipSelector","labelSelector","tipEl","labelEl","onHovered","onUnhovered","wasPinned","_discordBridges","canPin","mirror_media_button_asyncToGenerator","close_mirrored_media_button_asyncToGenerator","xMin","xMax","yMin","yMax","zMin","zMax","_checkForDestroy","cameraModelPromise","cameraModelSrc","pathsMap","player-right-controller","player-left-controller","right-cursor","left-cursor","videoCodec","codec","MediaRecorder","isTypeSupported","videoMimeType","hasWebGL2","allowVideo","CAPTURE_WIDTH","CAPTURE_HEIGHT","CAPTURE_DURATIONS","snapCanvas","pixels","imageData","createImageData","bitmap","captureDuration","captureAudio","showCameraViewfinder","WebGLRenderTarget","stencil","viewfinderInViewThisFrame","updateUI","screen","selfieScreen","labelActionBackground","labelBackground","durationLabel","recordIcon","recordAlphaIcon","snapMenu","recordButton","nextDurationButton","prevDurationButton","snapClicked","cancelSnapping","changeDuration","stopButton","stopRecording","captureAudioButton","captureAudioIcon","updateRenderTargetNextTick","updateViewfinder","newIdx","trackTarget","isPhoto","snapCountdown","countdownInterval","camera_tool_asyncToGenerator","takeSnapshotNextTick","beginRecording","hasDuration","isRecordingUnbound","videoRecorder","showActionLabelBackground","videoContext","videoCanvas","videoImageData","videoPixels","captureStream","attachBlankAudio","oscillator","createOscillator","createMediaStreamDestination","setValueAtTime","addTrack","getAudioTracks","selfAudio","getInput","mimeType","chunks","recordingStartTime","ondataavailable","videoCountdown","videoCountdownInterval","_free","onstop","recordingDuration","playerIsBehindCamera","MAX_DURATION_TO_LIMIT_LOOPS","heldLeftHand","heldRightHand","heldRightRemote","heldThisFrame","grabPath","isHolding","updateSnapMenuOrientation","isHoldingTrigger","isHoldingSnapshotTrigger","snapTriggerTimeout","releaseInterval","tock","playerHud","hudEl","playerHudWasVisible","spriteSystem","bubbleSystem","invaders","tmpVRFlag","tmpOnAfterRender","onAfterRender","videoRenderTarget","setRenderTarget","srcX0","srcY0","srcX1","srcY1","dest","dstX0","dstY0","dstX1","dstY1","gl","srcFramebuffer","__webglFramebuffer","destFramebuffer","bindFramebuffer","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","blitFramebuffer","COLOR_BUFFER_BIT","LINEAR","readRenderTargetPixels","snapPixels","RENDER_WIDTH","pixelsToPNG","heldLeftRemote","grabberId","grabberPaths","playerWorld","playerToCamera","cameraForwardPoint","cameraForwardWorld","_isIn2DInterstitial","_exitAction","getUserGesture","handleExitTo2DInterstitial","_handleExitTo2DInterstitial","isLower","exitAction","nonFullscreen","exitVR","vrNotice","exit2DInterstitialAndEnterVR","_exit2DInterstitialAndEnterVR","enterVR","isIn2DInterstitial","onlyOpenLink","open_media_button_asyncToGenerator","exitImmersive","refresh_media_button_asyncToGenerator","isNonLiveVideo","onVideoIsLiveUpdate","SHORTLINK_DOMAIN","twitter","remix_avatar_button_asyncToGenerator","copying","AMMO_BODY_ATTRIBUTES","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","v2","q2","eps","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","startQ","dxStore","dxApplied","dyAll","dyStore","dyApplied","raycasters","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","plane","wireframe","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","PI_AROUND_Y","pInv","startPlaneCasting","raycaster","sign2","dxAll","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","intersection","modify","FORWARD","TWO_PI","calculatePlaneMatrix","planeMatrix","planeUp","planeForward","planeRight","planePosition","camPosition","planeForLeftCursor","planeForRightCursor","isScaling","planeRotation","initialIntersectionPoint","intersectionPoint","initialObjectScale","desiredObjectScale","deltaScale","objectMatrix","dragVector","currentObjectScale","objectToScale","objectPosition","objectToCam","startScaling","didGetObjectReferences","leftEventer","leftCursorController","leftRaycaster","rightCursorController","rightRaycaster","raycastOnPlane","initialDistanceToObject","transformSelectedObjectSystem","endScaling","dotFactor","scaleFactor","RayCurve","numPoints","BufferGeometry","vertices","addAttribute","BufferAttribute","setDynamic","drawMode","TriangleStripDrawMode","parabolicCurve","p0","v0","out","setDirection","cross","setWidth","setPoint","checkLineIntersection","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","isValidNormalsAngle","face","LANDING_NORMAL","vecHelper","confirm","collisionEntities","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","teleportEntity","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","stopPlayingTeleportSound","teleportingSound","isTeleportingDisabled","timeTeleporting","teleportTo","playerScale","collidedIndex","timeSegment","percentToDraw","segmentT","hitEntityOpacity","easeOutIn","dRadii","outerScale","easeIn","outerTorus","torus","radiusTubular","segmentsRadial","segmentsTubular","segmentsHeight","openEnded","isTagged","tag","isHoldable","offersHandConstraint","offersRemoteConstraint","togglesHoveredActionSet","singleActionButton","isHoverMenuChild","isStatic","didUpdateOnce","constraintsSystem","MAX_ANISOTROPY","computeWidth","wrapPixels","wrapCount","widthFactor","FONTS","roboto","font","ch","chars","yoffset","digitsum","digits","xadvance","computeFontWidthFactor","loadTexture","align","oneOf","anchor","letterSpacing","lineHeight","tabSize","xOffset","zOffset","shaderData","getShaderData","shaderObject","shaders","Shader","createTextGeometry","updateFont","currentFont","updateGeometry","updateLayout","parseSide","pages","layout","geometryComponent","textScale","descender","TypeError","ascender","geometryUpdateBase","geometryUpdateData","newLineRegex","tabRegex","isFinite","common","initializedInTick","sets","VR_DEVICE_AVAILABILITY","yes","no","maybe","GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST","getAvailableVREntryTypes","_getAvailableVREntryTypes","ua","isSamsungBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","isMaybeDaydreamCompatibleDevice","capabilities","canPresent","canShare","opts","tweetLink","StateRoute","_this$props","routeProps","_objectWithoutProperties","react_default","es_Route","PromoteClientDialog","dialog_container","promote_client_dialog_extends","index_es","onConfirm","ClientInfoDialog","client_info_dialog_defineProperty","avatarThumbnailUrl","performConditionalSignIn","client_info_dialog_asyncToGenerator","addOwner","getPresenceEntry","showNonHistoriedDialog","removeOwner","unhide","mayKick","mayMute","targetIsOwner","targetIsCreator","targetIsSignedIn","signed_in","mayAddOwner","mayRemoveOwner","isHidden","client_info_dialog_extends","add_owner_default","remove_owner_default","loader_defineProperty","loadingNum","loadedNum","doneWithInitialLoad","loadingTimeout","tryFinishLoading","environmentSceneLoaded","onLoaded","onObjectLoading","onObjectLoaded","nomore","loaderStyles","usual","locale","unless_feature","AutoExitWarning","secondsRemaining","wrap_with_audio","onCancel","InlineSVG","filteredProps","svgi_extends","dangerouslySetInnerHTML","__html","InlineSVGButton","EntryButton","autoFocus","cx","iconSrc","prefixMessageId","mediumMessageId","isInHMD","TwoDEntryButton","entryButtonProps","entry_buttons_objectSpread","MobileScreenEntryImg","DesktopScreenEntryImg","GenericEntryButton","GenericVREntryImg","DaydreamEntryButton","DaydreamEntryImg","ProfileEntryPanel","profile_entry_panel_defineProperty","getStateFromProfile","hasChangedNowOrPreviously","profile_entry_panel_asyncToGenerator","storeUpdated","nameInput","setAvatarFromMediaResult","refetchAvatar","componentDidUpdate","_prevProps","prevState","react_fontawesome_index_es","saveStateAndFinish","htmlFor","displayNameOverride","spellCheck","inp","avatar_preview","state_link","hideDelete","returnToProfile","sourceNavigateWithNoNav","if_feature","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","MediaBrowser","media_browser_defineProperty","showNav","selectNextResult","clearStashedQueryOnClose","getStoreAndHistoryState","selectEntry","inputRef","getUrlSource","suggestions","forceNow","_sendQueryTimeout","filterQueryNavigate","lucky_query","handleQueryUpdated","handleFacetClicked","similar_to","similar_name","onMediaSearchResultEntrySelected","sourceNavigate","pushExitMediaBrowserHistory","isSceneApiType","isAvatarApiType","clearStashedQuery","pageNavigate","browserDiv","sourceChanged","showCustomOption","hideSearch","showEmptyStringOnNoResult","handleCustomClicked","showCustomMediaDialog","activeFilter","darkened","blur","faLink","faCloudUploadAlt","handleSourceClicked","selected","media_tiles","attributionHostnames","giphy.com","giphyLogo","media.giphy.com","instructions","desktopTips","references","mobileInstructions","desktopInstructions","lastUrl","fileInputId","CreateObjectDialog","create_object_dialog_defineProperty","fileName","attributionImage","validity","fileInput","onCreate","other","create_object_dialog_objectWithoutProperties","uploadButton","faPaperclip","filenameLabel","urlInput","onUrlChange","create_object_dialog_extends","onCreateClicked","onFileChange","ChangeSceneDialog","change_scene_dialog_defineProperty","submitting","setCustomValidity","urlValidationPromise","change_scene_dialog_asyncToGenerator","checkValidity","reportValidity","changeSceneForm","AvatarUrlDialog","avatar_url_dialog_defineProperty","onChangeClicked","InviteDialog","invite_dialog_defineProperty","copyButtonActive","shareButtonActive","entryCode","embedUrl","entryCodeString","num","pad","shortLinkText","shortLink","isModal","readOnly","copyClicked","allowShare","shareClicked","showEmbedTip","hasPush","onSubscribeChanged","checked","isSubscribed","InviteTeamDialog","invite_team_dialog_defineProperty","inviteButtonText","requestSupport","invite_team_dialog_extends","inviteClicked","LinkDialog","LinkDialogHeader","SafariDialog","safari_dialog_defineProperty","copyLinkButtonText","onCopyClicked","copyLinkClicked","safari_dialog_extends","RoomSettingsDialog","room_settings_dialog_defineProperty","initialSettings","renderCheckbox","member_permission","member_permissions","room_settings_dialog_objectSpread","showRoomAccessSettings","maxRoomSize","room_settings_dialog_extends","autoComplete","room_size","onRoomAccessSettingsChange","newMemberPermissions","CloseRoomDialog","close_room_dialog_extends","LOCAL_CLOSE_TIPS","KEEP_ACTIVE_AFTER_GLOBAL_CLOSE","localStorageCache","finishedScopes","tipPlatform","platformTips","desktop","mobile","standalone","isTipFinished","markTipFinished","storeData","handleTipClose","fullTip","scope","tips","resetTips","VALIDATORS","look","activeSets","rightCursorHoldingPen","leftCursorHoldingPen","locomotion","accel","turning","spawn_menu","mediaCounter","freeze_gesture","rightCursorHoldingInteractable","leftCursorHoldingInteractable","rightCursorHoveringOnInteractable","leftCursorHoveringOnInteractable","menu_hover","invite","rightCursorHoldingCamera","leftCursorHoldingCamera","object_grab","object_rotate_button","object_scale_button","object_recenter_button","object_pin","object_zoom","object_scale","pen_color","pen_size","pen_mode","freeze_mode","video_share_mode","mute_mode","feedback","activeTips","_finishedScopes","_performStep","_userinput","_mediaCounter","prevTop","prevBottom","chosenTip","finishCount","Tip","tipRegion","broadcastTarget","rootStyles","tipBody","WebRTCScreenshareUnsupportedDialog","webrtc_screenshare_unsupported_dialog_extends","flexDirection","alignItems","fontSize","WebAssemblyUnsupportedDialog","webassembly_unsupported_dialog_extends","WebVRRecommendDialog","webvr_recommend_dialog_extends","FeedbackDialog","feedback_dialog_extends","frameBorder","marginHeight","marginWidth","HelpDialog","help_dialog_extends","LeaveRoomDialog","leave_room_dialog_extends","messageType","destinationUrl","SORT_ORDER_VIDEO","SORT_ORDER_AUDIO","SORT_ORDER_IMAGE","SORT_ORDER_PDF","SORT_ORDER_MODEL","SORT_ORDER_UNIDENTIFIED","mediaSortOrder","mediaSort","el1","el2","ObjectInfoDialog","object_info_dialog_defineProperty","mediaEntities","targetMatrix","enqueueWaypointTravelTo","snapToNavMesh","willMaintainInitialOrientation","updateMediaEntities","navigateNext","navigatePrev","navigate","pin","unpin","onPinChanged","toggleLights","targetIndex","onNavigated","_isRemoving","exitAfterRemove","object_info_dialog_extends","entryStyles","faChevronLeft","enqueueWaypointTravel","faChevronRight","OAuthDialog","renderSignInDisclaimer","renderTweetDisclaimer","oauthInfo","oauth_dialog_extends","emojiPlugin","createEmojiPlugin","hashtagPlugin","createHashtagPlugin","linkifyPlugin","createLinkifyPlugin","counterPlugin","createCounterPlugin","addEmoji","editorState","contentState","getCurrentContent","entityKey","createEntity","emojiUnicode","getLastCreatedEntityKey","currentSelectionState","getSelection","emojiAddedContent","emojiEndPos","blockSize","afterRemovalContentState","Modifier","removeRange","targetSelection","getSelectionAfter","insertText","getAnchorOffset","blockKey","getAnchorKey","getBlockForKey","getLength","newEditorState","EditorState","forceSelection","TweetDialog","createEditorStateWithText","editorRef","sendTweet","media_stored_file_url","getPlainText","posting","renderPostedDialog","tweet_dialog_extends","renderTweetDialog","EmojiSuggestions","EmojiSelect","CharCounter","draft_js_plugins_editor_lib_default","emojiSuggestions","limit","LobbyChatBox","lobby_chat_box_defineProperty","pendingMessage","onSendMessage","textRows","pendingMessageTextareaHeight","pendingMessageFieldHeight","discordSnippet","occupantSnippet","messageEntryPlaceholder","sendMessage","messageEntrySubmit","sendMessageIcon","EntryStartPanel","entering","onEnteringCanceled","ChatCommandHelp","commands","commandHelpOnTop","onTop","matchingPrefix","defaultStylesByTagName","noStyleTags","BASE","HEAD","HTML","META","NOFRAME","NOSCRIPT","PARAM","SCRIPT","STYLE","TITLE","tagNames","computeDefaultStyleByTagName","tagName","defaultStyle","element","computedStyle","getComputedStyle","warmSerializeElement","navigateToClientInfo","currentParams","PresenceList","presence_list_defineProperty","faVideo","hmd","hmdIcon","faMobileAlt","discord","discordIcon","faDesktop","getPresenceIcon","isBot","isEntering","messageId","badge","renderExpandedList","domForPresence","onSignOut","expanded","messageCanvas","emojiRegex","CHAT_MESSAGE_TEXTURE_SIZE","messageBodyDom","fromSessionId","includeFromLink","multiLine","wrapStyle","mono","messageBodyClasses","includeClientLink","onFromClick","words","outWords","word","wordWrap","cleanedBody","Linkify_default","toEmojis","renderChatMessage","allowEmojiRender","isOneLine","entryDom","ReactDOM","xhtml","nodeType","Node","ELEMENT_NODE","cssTexts","cssText","ii","cssPropName","outerHTML","serializeElement","unmountComponentAtNode","meshEntity","blobUrl","meshMaterial","spawnChatMessage","_spawnChatMessage","ChatMessage","maySpawn","InWorldChatBox","in_world_chat_box_defineProperty","chat_command_help_ChatCommandHelp","accept","onObjectCreated","enableSpawning","faCamera","spawnMessageIcon","defaultEditors","useEditorWhitelist","editorWhitelist","avatar_editor_asyncToGenerator","AvatarEditor","avatar_editor_defineProperty","baseAvatarResults","editorLinks","previewGltfUrl","creatorAttribution","inputFiles","base_gltf_url","gltfs","randomAvatarResult","base","KHR_binary_glTF","bin","getWrappedInstance","filesToUpload","uploading","fileUploads","avatar_editor_objectSpread","createOrUpdateAvatar","onSave","getPreviewUrl","baseSid","avatarResult","propName","sid","dropdown_arrow_default","dropdown_arrow_2x_default","paddingBottom","ext","editors","uploadAvatar","textField","textarea","selectListingGrid","mapField","avatar_editor_extends","handleGltfLoaded","confirmDelete","deleteAvatar","has_listings","MicLevelWidget","mic_level_widget_defineProperty","startAnalyser","stopAnalyser","micUpdateInterval","micLevelMovingAverage","MovingAverage","average","movingAverage","micClip","muteOnEntry","viewBox","fill","xmlns","cy","fillOpacity","hasAudioTrack","mic_level_default","mic_level_2x_default","mic_denied_default","mic_denied_2x_default","NumberRangeSelector","number_range_selector_defineProperty","isDragging","myRoot","createRef","stopDragging","drag","clientX","offsetLeft","currentValue","onMouseDown","PREFERENCE_LIST_ITEM_TYPE","CHECK_BOX","SELECT","NUMBER_WITH_RANGE","MAX_RESOLUTION","MaxResolutionPreferenceItem","tabIndex","PreferenceListItem","preference_list_item_defineProperty","selectHovered","forceUpdate","UNSAFE_componentWillMount","renderControls","storedPref","prefType","storeKey","defaultBool","preference_list_item_MaxResolutionPreferenceItem","defaultString","preference_list_item_extends","onMouseLeave","number_range_selector_NumberRangeSelector","defaultNumber","isCheckbox","faUndo","addLocaleData","PreferencesScreen","preference_list_item_PreferenceListItem","general","advanced","OutputLevelWidget","output_level_widget_defineProperty","tonePlaying","playTestTone","toneClip","webmTone","mp3Tone","oggTone","wavTone","testToneTimeout","iconClass","speaker_level_default","speaker_level_2x_default","PhotoMessage","landingPageUrl","onShareClicked","VideoMessage","ImageMessage","spawnImage","PresenceLog","presence_log_defineProperty","entryClasses","presenceLogChat","oldName","newName","inRoom","presenceClasses","domForEntry","THUMBNAIL_TITLE","DISPLAY_IMAGE","faMusic","faImage","faNewspaper","faQuestion","faCube","ObjectList","object_list_defineProperty","inspecting","domForEntity","onInspectObject","onMouseOut","onMouseOver","resourceName","httpIndex","lessHost","hostSplit","substr","getDisplayString","faCubes","SettingsMenu","settings_menu_defineProperty","unexpand","showAsOverlay","onMouseUp","acanvas","renderExpandedMenu","rowClasses","hideExtranousItems","showRoomSettings","showCloseRoom","showRoomInfo","hubScene","showRoomSection","showStreamerMode","onCloseOverlay","faUserAlt","faCog","showPreferencesScreen","faDoorClosed","faInfoCircle","toggleStreamerMode","bottomLink","faBars","isStreaming","PreloadOverlay","onLoadClicked","MIC_ICONS","Mic0","Mic1","Mic2","Mic3","Mic4","Mic5","Mic6","Mic7","MicOff0","MicOff1","MicOff2","MicOff3","MicOff4","MicOff5","MicOff6","MicOff7","TopHUD","_2d_hud_defineProperty","showVideoShareOptions","lastActiveMediaSource","micLevel","cameraDisabled","penDisabled","mediaDisabled","getDisplayMedia","videoShareMediaSource","onEndShareVideo","onShareVideo","onShareVideoNotCapable","videoShareExtraOptionTypes","primaryVideoShareType","showExtrasOnHover","hideVideoSharingButtonTimeout","capitalize","iconForType","ShareScreenIconActive","ShareCameraIconActive","ShareScreenIcon","ShareCameraIcon","handleVideoShareClicked","videoSharingButtons","buildVideoSharingButtons","tipDivForType","cancelFunc","watching","onWatchEnded","showVideoShareFailed","hideVideoShareFailedTip","activeTip","micIcon","unselectable","uiStyles","onToggleMute","sourceNavigateToDefaultSource","SpawnIcon","onSpawnPen","isCursorHoldingPen","PenIconActive","PenIcon","onSpawnCamera","hasActiveCamera","CameraIconActive","CameraIcon","showStreamingTip","hideStreamingTip","react_components_2d_hud","SpectatingLabel","avatarEditorDebug","HMD_MIC_REGEXES","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","enumerateDevices","isMobilePhoneOrVR","AUTO_EXIT_TIMER_SECONDS","UIRoot","ui_root_defineProperty","enterInVR","showShareDialog","broadcastTipDismissed","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","showPrefs","waitingOnAudio","audioTrack","audioTrackClone","micDevices","autoExitTimerStartedAt","autoExitTimerInterval","autoExitMessage","secondsRemainingBeforeAutoExit","exited","objectInfo","objectSrc","isObjectListExpanded","isPresenceListExpanded","startAutoExitTimer","disableAutoExitOnIdle","endAutoExitTimer","signInMessageId","authChannel","signInCompleteMessageId","signInContinueTextId","onContinueAfterSignIn","ui_root_asyncToGenerator","subscriptions","isFavorited","initialIsFavorited","sceneLoaded","mediaSource","updateSubscribedState","forcedVREntryType","enterDaydream","enter2D","secondsSinceStart","checkForAutoExit","onConcurrentLoad","onIdleDetected","onActivityDetected","exitScene","grantedMicLabels","setMediaStreamToDefault","beginOrSkipAudioSetup","performDirectEntryFlow","availableVREntryTypes","_ref7","constraints","deviceId","exact","fetchAudioTrack","setupNewMediaStream","hasAudio","ideal","_ref9","getUserMedia","recreateAudioStream","_ref10","setLocalMediaStream","mediaStreamForMicAnalysis","fetchMicDevices","micDeviceId","micDeviceIdForMicLabel","micLabelForMediaStream","entry_step","onAudioReadyButton","hasHmdMicrophone","selectedMicLabel","enterScene","linkChannel","generateCode","updateScene","ui_root_objectSpread","DialogClass","closeDialog","beginStreaming","endStreaming","_ref16","broadcastedRoomConfirmed","onInterstitialPromptClicked","roomUnavailableReason","platformUnsupportedReason","exitSubtitleId","sendEnteringCancelledEvent","promptForNameAndAvatarBeforeEntry","hubIsBound","toggleFavorited","entryFavoriteButton","lobby_chat_box","entryDisallowed","attemptLink","sendEnteringEvent","handleForceEntry","entry_start_panel_EntryStartPanel","faArrowLeft","granted","onMicGrantButton","mic_granted_default","mic_granted_2x_default","subtitleId","mic_level_widget_MicLevelWidget","output_level_widget_OutputLevelWidget","selectedMicDeviceId","micDeviceChanged","mic_small_default","mic_small_2x_default","shouldShowHmdMicWarning","warning_icon_default","warning_icon_2x_default","overlay","showSafariDialog","safari_dialog_SafariDialog","showWebAssemblyDialog","webassembly_unsupported_dialog_WebAssemblyUnsupportedDialog","exitEventHandler","prevProps","showSignInDialog","showContextualSignInDialog","willCompileAndUploadMaterials","compileAndUploadMaterials","onSceneLoaded","onAframeStateChanged","onShareVideoEnabled","onShareVideoDisabled","onShareVideoFailed","playerRig","ui-root","in-modal-or-overlay","isInModalOrOverlay","isExited","showPreload","isLoading","serviceWorker","showOAuthDialog","showInterstitialPrompt","oauth_dialog_OAuthDialog","onCloseOAuthDialog","renderExitedPane","react_components_loader","onLoadingFinished","preferences_screen_PreferencesScreen","renderInterstitialPrompt","renderBotMode","enteredOrWatching","enteredOrWatchingOrPreload","inEntryFlow","isWaitingForAutoExit","auto_exit_warning","state_route","renderDevicePanel","renderMicPanel","renderAudioSetupPanel","renderEntryStartPanel","dialogBoxContentsClassNames","showSettingsAsOverlay","presenceLogEntries","switchToInspectingObject","showMediaBrowser","hasTopTip","clientInfoClientId","getClientInfoClientId","showClientInfo","showObjectInfo","hasEmbedPresence","hasDiscordBridges","showBroadcastTip","showInviteTip","showChooseSceneButton","streamerName","Provider","preload_overlay_PreloadOverlay","onPreloadLoadClicked","profile_entry_panel","ui_root_extends","avatar_editor_AvatarEditor","onAvatarSaved","react_components_media_browser","renderDialog","updateHub","closeHub","createObject","changeScene","setAvatarUrl","client_info_dialog_ClientInfoDialog","object_info_dialog_ObjectInfoDialog","presence_log_PresenceLog","tip_Tip","confirmBroadcastedRoom","in_world_chat_box","inviteStyles","toggleShareDialog","onMiniInviteClicked","invite_dialog_InviteDialog","entry_code","initialIsSubscribed","link_dialog_LinkDialog","object_list_ObjectList","expand","presence_list_PresenceList","settings_menu_SettingsMenu","spectating_label_SpectatingLabel","topHud","toggleMute","shareVideo","endShareVideo","showWebRTCScreenshareUnsupportedDialog","isSupportAvailable","MS_PER_DAY","MS_PER_MONTH","isSameMonth","da","db","getFullYear","getMonth","HUB_CREATOR_PERMISSIONS","VALID_PERMISSIONS","HubChannel","hub_channel_defineProperty","Presence","_permissions","postgrest_role","nextRefresh","hub_channel_asyncToGenerator","entryDisplayType","vrDisplay","isPresenting","initialOccupantCount","initialOccupants","entryEvent","hub_channel_objectSpread","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEntered","msSinceLastEntered","getDate","isSameDay","object_type","update_hub","close_hub","subscription","allow","creatorAssignmentTokenEntry","_getCreatorAssignmentToken","perms_token","setPermissionsFromToken","auth_token","oauth_url","gltfNode","fileAccessToken","gltf_node","file_access_token","permsToken","_blockedSessionIds","unblock","completeSync","Set","canEnterRoom","migrateToSocket","presenceBindings","onJoin","caller","onLeave","onSync","endRecording","exceedsDensityThreshold","subtree","boundingData","isHighDensity","leftResult","rightResult","traverseMeshesAndAddShapes","shapePrefix","shapes","meshRoot","group","__proto__","roots","_roots","isGeometryHighDensity","navMesh","groupEnd","MessageDispatch","entryManager","addToPresenceLog","remountUI","message_dispatch_defineProperty","commandParts","dispatchCommand","activeElement","scales","curScale","captureSystem","setDebug","debugEnabled","rename","available","forceEnableTouchscreen","SceneEntryManager","scene_entry_manager_defineProperty","whenSceneLoaded","_entered","scene_entry_manager_asyncToGenerator","waypointSystem","session","verbose","_setupPlayerRig","_setupBlocking","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","_runBot","sendEnteredEvent","hasLoaded","localMediaStream","getTracks","_setPlayerInfoFromProfile","avatarScale","_lastFetchedAvatarId","kickedClientId","_unpinElement","removeEntity","removeEntitiesOfClient","storedPromotionToken","gltfComponents","equalArray","every","mediaSrc","mediaVersion","mediaContentSubtype","pinnedEntityToGltf","_signInAndPinOrUnpinElement","_pinElement","_disableSignInOnPinAction","spawnMediaInfrontOfPlayer","or","handlePinEvent","currentVideoShareEntity","sendObjectSpawnedEvent","_forceExitFrom2DInterstitial","forceExitFrom2DInterstitial","contentEditable","clipboardData","getData","dataTransfer","isHandlingVideoShare","shareVideoMediaStream","isDisplayMedia","newStream","frameRate","removeTrack","delaySpawn","audioInput","dataInput","crossorigin","onchange","getRecording","mozCaptureStream","INIT_TIMEOUT_MS","urlBase64ToUint8Array","base64String","base64","repeat","rawData","outputArray","Subscriptions","subscriptions_defineProperty","registration","vapidPublicKey","_isSubscribed","subscriptions_asyncToGenerator","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","invaderPos","bubblePos","createSphereGizmo","WireframeGeometry","LineSegments","bubbles","tickCount","_updateInvaders","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","setInvaderFlag","distanceSquared","radiusSum","flushInvadingFlagsForIndex","invading","meshName","targetMesh","useMaterial","invadingOpacity","findInvaderMesh","alwaysHidden","radiusSquared","applyInvasionToMesh","updateBoneVisibility","IDLE_TIMEOUT_MS","CHARACTER_ACCELERATION_PATH","BASIC_ACTIVITY_PATHS","resetTimeout","idleTimeout","lastInputCheck","onIdleTimeout","basicActivity","activityPath","cameraEls","cameraUpdateCount","ticks","updateMyCamera","playerModelEl","updatePlayerHead","headEl","myCameraTool","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","MouseDevice","queueEvent","passive","deltaX","deltaY","deltaMode","middle","clientY","innerHeight","movementX","movementY","mouseDownLeftThisFrame","mouseDownRightThisFrame","mouseDownMiddleThisFrame","write","didStopProcessingEarly","setVector2","setValueType","ArrayBackedSet","initialItems","oncontextmenu","KeyboardDevice","seenKeys","HudDevice","XboxControllerDevice","buttonMap","buttonId","axisMap","axisId","getGamepads","connected","xboxPaths","hapticActuators","Pose","fromOriginAndDirection","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","EYES_TO_ELBOW","FOREARM","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","fromArray","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","TRIGGER","OculusGoControllerDevice","sittingToStandingMatrix","rayObject","rayMatrixWorld","setPose","setMatrix4","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","gamepads","WindowsMixedRealityControllerDevice","CircularBuffer","writePtr","difference","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","findHandCollisionTargetForHand","handCollisions","getCollisions","bodyUuidToData","notRemoteHoverTargets","remoteHoverTargets","findRemoteHoverTarget","isUI","updateCursorIntersection","leftRemoteHoverTarget","rightRemoteHoverTarget","getRightRemoteHoverTarget","getLeftRemoteHoverTarget","dropPath","hoverFn","previousState","tickInteractor","lostOwnership","calculateCursorPose","AppAwareMouseDevice","prevButtonLeft","clickedOnAnything","prevCursorPose","prevOrigin","prevDirection","cursorController","rawIntersections","cursorTargettingSystem","remoteHoverTarget","isInteractable","isStaticControlledMedia","isStaticMedia","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findByJob","findByTouch","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","x1","y1","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","framesUntilGrab","framesUntilUnassign","second","first","cameraMover","move","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","xforms","scalar","scaleExp","pow","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","copyIfTrue","copyVec2IfTrue","zeroIfDefined","true","rising","risingWithFrameDelay","falling","vec2Zero","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","diff_vec2","addSetsToBindings","mapping","setName","binding","togglePenWithP","togglePenWithHud","inspectZoomSpeed","keyboardMouseUserBindings","global","xform","priority","rightCursorHoldingUI","rightCursorHoveringOnVideo","inputFocused","rightCursorHoveringOnUI","touchCamDelta","touchscreenUserBindings","rightCursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","rightGripRisingGrab","leftGripRisingGrab","lowerButtons","upperButtons","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","leftHandHoveringOnNothing","leftCursorHoveringOnUI","leftCursorHoveringOnVideo","rightCursorHoveringOnNothing","leftCursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","leftCursorHoldingUI","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","rightCursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","rightHandHoveringOnNothing","wakeLeft","wakeRight","lButton","lAxis","lPose","lJoy","lJoyScaled","lJoyXScaled","lJoyYScaled","lJoyYDeadzoned","lTouch","lTouchScaled","lTouchXScaled","lTouchY","lTouchYScaled","lDpadNorth1","lDpadSouth1","lDpadEast1","lDpadWest1","lDpadCenter1","lDpadNorth2","lDpadSouth2","lDpadEast2","lDpadWest2","lDpadCenter2","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","touchCharacterAcceleration","lCharacterAcceleration","leftBoost","leftUndoDrawing","rButton","rAxis","rPose","rTouch","rJoy","rJoyYDeadzoned","rDpadNorth1","rDpadSouth1","rDpadEast1","rDpadWest1","rDpadCenter1","rDpadNorth2","rDpadSouth2","rDpadEast2","rDpadWest2","rDpadCenter2","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rightBoost","rTriggerRisingGrab","rGripRisingGrab","rightCursorDrop1","rightCursorDrop2","leftCursorDrop1","leftCursorDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","rightUndoDrawing","ensureFrozenViaDpad","ensureFrozenViaKeyboard","ensureFrozenViaButtons","thawViaDpad","thawViaKeyboard","thawViaButtons","freezeButtons","inspectButtons","rSnapRight1","rSnapLeft1","rSnapRight2","rSnapLeft2","keyboardSnapRight","keyboardSnapLeft","keyboardCharacterAcceleration","wasd_vec2","arrows_vec2","keyboardBoost","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","rightHandTeleporting","leftHandTeleporting","leftCursorHoveringOnPen","leftCursorHoveringOnCamera","viveWandUserBindings","indexUserBindings","viveFocusPlusUserBindings","viveCosmosUserBindings","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","scaledRightJoystickVertical","scaledLeftJoystickCursorDelta","deadzonedRightJoystickHorizontal","deadzonedRightJoystickVertical","deadzonedLeftJoystickHorizontal","deadzonedLeftJoystickVertical","disableForwardOnTrigger","scaledLeftJoystickHorizontal","scaledLeftJoystickVertical","scaledLeftJoystickForwardAcceleration","xboxControllerUserBindings","rightCursorHoldingNothing","touchpadRising","touchpadFalling","touchpadPressed","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","brushSizeDelta","cursorModDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadX","touchpadXForPen","touchpadY","touchpadYForPen","triggerRising","triggerFalling","dpadCenterStrip","dpadBottomCenterStrip","togglePen","dropBinding","leftTeleporter","rightTeleporter","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","satisfiedBy","notEmpty","isSubpath","canMask","masker","masked","maskerKey","maskerPath","maskedKey","maskedPath","isActive","toggleSet","pendingSetChanges","generation","generations","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","addExtraMappings","activeDevice","deleteExtraMappings","updateBindingsForVRMode","gamepadConnected","gamepadDevice","maybeToggleXboxMapping","vrAxesSum","mouseMovement","nonXboxActivity","hasXboxMapping","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","leftHandHoveringOnVideo","rightHandHoveringOnVideo","leftCursorHoldingNothing","resolveActionSets","activeSetsChanged","il","elem","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","PATHS_TO_SHOW","DELIMITER","replacer","userinputFrameStatus","pathsOutput","strings","maskers","logBindings","MEDIA_SEARCH_PATHS","CursorTargettingSystem","setDirty","dirty","observer","MutationObserver","observe","childList","populateEntities","shouldEnableRemote","remote","teleporting","woke","vrRemotePenIntersection","CursorTogglingSystem","domContentLoadedButComponentsMayNotHave","gotComponentReferences","rightHandTeleporter","leftHandTeleporter","gazeTeleporter","inspectingInVR","shouldEnableLeftRemote","shouldEnableRightRemote","MESSAGE_TYPES","CONSTANTS","BUFFER_CONFIG","WORLD_CONFIG","debugDrawMode","AmmoDebugConstants","DrawWireframe","PhysicsSystem","physics_system_defineProperty","debugRequested","enableDebug","disableDebug","objectMatricesFloatArray","bodyUuids","DYNAMIC","BODY_DATA_SIZE","MATRIX_OFFSET","LINEAR_VELOCITY_OFFSET","ANGULAR_VELOCITY_OFFSET","collisions","COLLISIONS_OFFSET","collidingIndex","objectMatricesIntArray","indexToUuid","ammoWorker","TRANSFER_DATA","Atomics","debugIndex","debugGeometry","setDrawRange","AmmoWorker","workerHelpers","WorkerHelpers","bodyHelpers","shapeHelpers","nextBodyUuid","nextShapeUuid","ArrayBuffer","MAX_BODIES","Int32Array","INIT","worldConfig","wasmUrl","ammoWasmUrl","BASE_ASSETS_PATH","READY","alive","init2","shapeHelper","BODY_READY","SHAPES_READY","bodyUuid","shapesUuid","SharedArrayBuffer","debugMesh","debugSharedArrayBuffer","DefaultBufferSize","Uint32Array","debugVertices","debugColors","debugMaterial","LineBasicMaterial","VertexColors","renderOrder","addBody","updateBody","removeBody","addShapes","removeShapes","addConstraint","constraintId","targetUuid","removeConstraint","registerBodyHelper","registerShapeHelper","ACTIVATION_STATE","ConstraintsSystem","prevLeftHand","prevRightHand","prevRightRemote","prevLeftRemote","constraintPairs","constraintTag","entityId","heldEntityId","activationState","ACTIVE_TAG","DISABLE_DEACTIVATION","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","existsAndHeldInEither","holderA","holderB","TwoPointStretchingSystem","stretching","stretched","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","initialStretchDistance","SingleActionButtonSystem","didInteractThisFrame","hovered2","HoldableButtonSystem","prevHeld","heldLeft","prevHeldLeft","hasButtonComponent","BUTTON_COMPONENT_NAMES","getHoverableButton","dispatch","HOVERED","UNHOVERED","HoverButtonSystem","button2","DrawingMenuSystem","drawing_menu_system_defineProperty","cameraWorldPos","drawingMenus","getMenuScale","remotes","undoDraw","serializeDrawing","lastIntersection","hideMenus","cursorControllers","getHovered","showMenu","handleButtons","scaleMenus","registerDrawingMenu","networkedDrawingEl","menuEl","undoButton","deleteButton","serializeButton","unregisterDrawingMenu","getSpecificHoverMenu","findHoverMenu","HoverMenuSystem","prevHoverMenu","hoverMenu2","prevHoverMenu2","SuperSpawnerSystem","maybeSpawn","superSpawner","isPermitted","performSpawn","copyState","STRENGTH","DROP","PICKUP","BUTTON_PRESSED","HOVER","STRETCH_BASE","STRETCH_DISTANCE","TELEPORTING","TELEPORTED","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","interactLeft","interactRight","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","leftRemoteStrength","buttonLeftStrength","buttonRightStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","tempVec3","tempVec4","INSTANCE_DATA_BYTE_LENGTH","DEFAULT_COLOR","HIDE_MATRIX","makeScale","sizeofInstances","inspectLayer","HubsBatchRawUniformGroup","BatchRawUniformGroup","maxInstances","hubs_sweepParams","hubs_interactorOnePos","hubs_isFrozen","hubs_interactorTwoPos","hubs_time","instanceId","setInstanceTransform","setInstanceColor","hideDueToPinning","highlightInteractorOne","highlightInteractorTwo","MAX_INSTANCES","UBO_BYTE_LENGTH","BatchManagerSystem","WeakMap","WebGL2RenderingContext","getParameter","MAX_UNIFORM_BLOCK_SIZE","ubo","BatchManager","unlit","unlitBatchVert","unlitBatchFrag","rootObject","batchedCount","addMesh","removeMesh","InteractionSfxSystem","colorShift","ColorShiftWorker","getThemeColorShifter","getImageData","ImageData","multiviewVertPrefix","nonmultiviewVertPrefix","multiviewFragPrefix","nonmultiviewFragPrefix","didRegisterWithSystem","didFailToRegister","registered","updateUVs","normalizedFrame","memo","spritesheet","missingSprites","ret","getSheetType","spritesheetAction","SHEET_TYPES","raycastOnSprite","vA","vB","vC","vD","intersectionInfo","intersect","ray","intersectTriangle","getHoverableVisuals","comp","createGeometry","maxSprites","mvCols","InterleavedBuffer","InterleavedBufferAttribute","indices","setIndex","ZEROS","SpriteSystem","sheetType","slots","indexWithSprite","notice","spriteWithIndex","multiview","vert","frag","domReady","spritesheetPng","spritesheetActionPng","spritesheetNoticePng","spritesheetTexture","RawShaderMaterial","u_spritesheet","RENDER_ORDER","HUD_ICONS","uniformsNeedUpdate","aEnableSweepingEffect","aSweepParams","enableSweepingEffectValue","setXY","spritesheetNotice","aUvs","aVertices","setXYZ","calculateIconTransform","backward","camToWaypoint","v1","waypoint","extractBasis","isOccupiableSpawnPoint","waypointData","isUnoccupiableSpawnPoint","loadTemplateAndAddToScene","templateId","loadTemplatesForWaypointData","templateIds","templatesToLoadForWaypointData","isOccupiedByMe","waypointComponent","isOccupied","unoccupyWaypoint","unoccupyWaypoints","waypointComponents","WaypointSystem","helperMat4","waypointForTemplateEl","elementsFromTemplatesFor","eventHandlers","lostOwnershipOfWaypoint","waypointPreviewAvatar","releaseAnyOccupiedWaypoints","currentWaypoint","teleportToWaypoint","iconEl","shouldLandWhenPossible","tryTeleportToOccupiableWaypoint","previouslyOccupiedWaypoints","tryToOccupy","didOccupy","wp","setupEventHandlersFor","onUnhover","onInteract","setupEventHandlers","waypointId","elementsFromTemplates","li","unregisterComponent","ri","getUnoccupiableSpawnPoint","candidates","mightNeedRespawn","ownershipLostTime","connectedClients","shouldTryToOccupy","isMineOrTakeOwnership","occupyWaypoint","tryToOccupyAnyOf","waypoints","candidate","currentMoveToSpawn","nextMoveToSpawn","waitOneTick","nextMoveToSpawnResolve","moveToUnoccupiableSpawnPoint","resolvedWaypointOrNull","currentMoveToSpawnResolve","waypointComponentOrNull","tickTemplateEl","elementFromTemplate","mat4Pool","getCurrentPlayerHeight","world","NAV_ZONE","qsAllowWaypointLerp","calculateDisplacementToDesiredPOV","translationCoordinateSpace","translated","localTranslation","povMat4","allowVerticalMovement","localDisplacement","displacementToDesiredPOV","SNAP_ROTATION_RADIAN","BASE_SPEED","CharacterControllerSystem","character_controller_system_defineProperty","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","isMotionDisabled","navMeshExists","findPositionOnNavMesh","inPosition","outPosition","initialOrientation","finalPosition","finalPOV","shouldUnoccupyWaypointsOnceMoving","snapRotatedPOV","newPOV","startPOVPosition","desiredPOVPosition","navMeshSnappedPOVPosition","interpolatedWaypoint","startTranslation","waypointPosition","activeWaypoint","waypointComponentData","waypointTravelTime","isInstant","waypointTravelStartTime","animationIsOver","travelByWaypoint","wasFlying","messageDispatch","didStopFlying","navNode","dXZ","zCharacterAcceleration","relativeMotion","lerpC","nextRelativeMotion","triedToMove","lengthSq","shouldRecomputeNavGroupAndNavNode","shouldResnapToNavMesh","squareDistNavMeshCorrection","findPOVPositionAboveNavMesh","startingFeetPosition","desiredFeetPosition","outPOVPosition","shouldRecomputeGroupAndNode","navGroup","inTransform","motion","getClosestNode","outPos","getGroup","clampStep","CursorPoseTrackingSystem","pairs","MIN_DISTANCE","ScaleInScreenSpaceSystem","scale_in_screen_space_defineProperty","parentScale","updateMediaAudioSettings","mediaDistanceModel","mediaRolloffFactor","mediaRefDistance","mediaMaxDistance","mediaConeInnerAngle","mediaConeOuterAngle","mediaConeOuterGain","updateAvatarAudioSettings","avatarDistanceModel","avatarRolloffFactor","avatarRefDistance","avatarMaxDistance","AudioSettingsSystem","audio_settings_system_defineProperty","defaultSettings","mediaVolume","audioSettings","mediaAudioSources","avatarAudioSources","onSceneReset","registerMediaAudioSource","unregisterMediaAudioSource","registerAvatarAudioSource","unregisterAvatarAudioSource","mediaAudioSource","avatarAudioSource","onSoundSourceSet","networkedAudioSource","EnterVRButtonSystem","wasGhost","enableButton","enterVREl","disableButton","DOMContentDidLoad","interactionSfxSystem","superSpawnerSystem","singleActionButtonSystem","holdableButtonSystem","hoverButtonSystem","hoverMenuSystem","hapticFeedbackSystem","drawingMenuSystem","enterVRButtonSystem","didInteractLeftThisFrame","didInteractRightThisFrame","_gotAudioTrack","_recorderTimeout","_initRecorder","_stream","_recorder","_tryAddingAudioTrack","addScalar","clampScalar","HIGHLIGHT","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","defaultDistance","minDistance","firstHitOnly","lineGeometry","Line","cameraPos","isGrabbing","intersectionIsValid","addScaledVector","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","DRAW_MODE","almostEquals","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","penVisible","penTipPosition","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","originalPosition","lastIntersectionDistance","penTip","penLaserAttributesUpdated","penLaserAttributes","laserVisible","laserInHand","laserOrigin","remoteLaserOrigin","laserTarget","_handleInput","_getIntersection","_updatePenTip","_updateLaser","_setPenVisible","_doDraw","_startDraw","_endDraw","penScaleMod","_changeRadius","_changeColor","_undoDraw","worldQuaternion","laserStartPosition","laserEndPosition","camerWorldPosition","lastIntersectedObject","getLastPoint","_getNormal","draw","directionToCamera","startDraw","endDraw","mod","InterpolationBuffer","tipMaterial","lineCurve","LineCurve3","TubeBufferGeometry","laser","laserTip","originBuffer","MODE_LERP","targetBuffer","originBufferPosition","targetBufferPosition","getPosition","laserTipVisible","SharedBufferGeometry","primitiveMode","maxBufferSize","geometries","addBuffer","restartPrimitive","addVertex","prevIdx","componentSize","diff","undo","normals","colors","addColor","addNormal","computeBoundingSpheres","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","onConnect","getNetworkId","drawingId","subscribeToDataChannel","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","sendDataGuaranteed","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","exporter","GLTFExporter","convertToTriangles","networked-drawing-buffer","parseChunks","includeCustomExtensions","asset","generator","createGLBBlob","NEGATIVE_INFINITY","temp","drawRange","attribute","getX","getY","getZ","originalGeometry","originalPositions","originalColors","originalNormals","positions","i2","i3","deserializeDrawing","setHex","copyArray","broadcastDataGuaranteed","didWork","pointCount","_draw","_updateBuffer","drawTime","datum","idxLength","parts","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawEndCap","_endLine","_addDegenerateTriangle","_restartPrimitive","_drawCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","down","segmentIndex","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","_getDeserializeButton","networkedDrawingBuffer","finishDrawing","ACTIVATION_STATES","ISLAND_SLEEPING","WANTS_DEACTIVATION","DISABLE_SIMULATION","angularFactor","KINEMATIC","emitCollisionEvents","disableCollision","scaleAutoUpdate","CYLINDER","SPHERE","CAPSULE","CONE","HACD","VHACD","maxHalfExtent","sphereRadius","cylinderAxis","bodyEl","registerNetworkSchemas","vectorRequiresUpdate","almostEqualVec3","requiresNetworkUpdate","BUILD_VERSION","HUD_BACKGROUND","isEmbed","firstSyncSource","syncSource","isTelemetryDisabled","instanceKey","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createMemoryHistory","createBrowserHistory","basename","qsVREntryType","userinputSets","Router","PUBLIC_URL","Route","react_components_ui_root","hub_objectSpread","hub_isBotMode","hub_store","hub_mediaSearchStore","mountUI","updateEnvironmentForHub","sceneUrl","isLegacyBundle","sceneErrorHandler","environmentScene","model_url","loadingEnvironment","defaultSpaceTopic","topics","glbAsset","assets","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","environmentEl","fader","updateUIForHub","enterSceneWhenLoaded","hub_asyncToGenerator","initProfile","WebAssembly","defaultRoomId","setRegistration","setRegistrationFailed","initialBatchImage","texImage2D","compressedTexImage2D","patchThreeAllocations","predicate","onFailure","actionError","_x10","_x11","sceneInfo","isInOAuth","exitOAuth","serializableDetail","getTwitterOAuthURL","_x12","handleEarlyVRMode","getVRDisplay","chatFocusTarget","RTCDataChannelEvent","buildNumber","reload","hasVREntryDevice","onFirstEnvironmentLoad","runBotMode","previewCamera","reorder","setupLobbyCamera","isReloading","retDeployReconnectInterval","retPhxChannel","setVapidPublicKey","vapid_public_key","_x13","pushSubscriptionEndpoint","getCurrentEndpoint","oauthFlowPermsToken","createHubChannelParams","push_subscription_endpoint","migrateToNewReticulumServer","deployNotification","ret_version","ret_pool","tryReconnect","_ref11","oldSocket","setSocket","teardown","_x14","_ref12","_x15","hubPhxChannel","isInitialJoin","presenceSync","setPhoenixChannel","_ref13","session_token","vrHudPresenceCount","sendProfileUpdate","__hadInitialSync","isSelf","currentMeta","_ref14","setClientId","setJoinToken","_x17","setHubChannel","setSubscribed","web_push","hub_requires_oauth","allowNAFTraffic","hubs","embedTokenEntry","onMediaSearchCancelled","objectsScene","objectsUrl","objectsEl","connectToScene","room","serverURL","newHostPollInterval","setReconnectionListeners","currentServerURL","serverUrl","newServerURL","getHost","sendViaPhoenix","reliable","isOpen","connectionState","nafrPayload","naf","reliableTransport","unreliableTransport","loadEnvironmentAndConnect","connectionErrorTimeout","connectError","isFull","handleHubChannelJoined","_x16","oauth_info","handleIncomingNAF","unparsedData","incomingMessage","userInfo","getAuthor","_createInWorldLogMessage","createInWorldLogMessage","stale_fields","titleParts","oldSlug","slug","entry_mode"],"mappings":"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AIsM,EAAiB,GASrB3B,EAAQ4B,MAAQ,CAACC,EAAWC,KAC1B,MAAMC,EACH/B,EAAQc,YAAcd,EAAQc,WAAWkB,QAAUhC,EAAQc,WAAWkB,OAAOH,IAC9EF,EAAeE,GACjB,OAAOE,GAAOD,SAAgBC,KAASA,GAGzC/B,EAAQiC,KAAO,CAACC,EAAUC,IAChBnC,EAAQc,YAAcd,EAAQc,WAAWsB,OAASpC,EAAQc,WAAWsB,MAAMF,IAAcC,EAGnGnC,EAAQqC,WAAaC,IACnBrC,EAAUqC,GAEZtC,EAAQC,QAAU,IAAMA,EAETD,mDChGf,MAAMuC,EAAa,CACjB,OACA,WACA,aACA,YACA,eACA,WACA,SACA,YACA,WACA,cACA,QACA,UACA,UACA,OACA,SACA,UACA,WACA,SACA,WACA,aACA,WACA,SACA,UACA,UACA,OACA,QACA,QACA,UACA,OACA,YACA,WACA,SACA,WACA,OACA,WACA,WACA,SACA,QACA,YACA,MACA,WACA,SACA,UACA,QACA,WACA,WACA,QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA,YACA,SACA,UACA,aACA,WACA,cACA,YACA,OACA,UACA,SACA,aACA,WACA,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AAkBvwH,eAAgBrpB,EAAE2lB,MAAM,KAAK,2HAhC5C6tI,eACA,CACjBI,eAAgB7pH,KAAUI,OAC1BwpH,MAAO5pH,KAAUG,uGCPrB,MAAM2pH,GAAyB,GAGzBC,GAAc,CAClBC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,SAAS,EACTC,UAAU,EACVC,OAAO,EACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAKHC,GAAW,CACf,IACA,OACA,UACA,OACA,UACA,QACA,QACA,IACA,OACA,MACA,MACA,aACA,OACA,KACA,SACA,SACA,UACA,SACA,OACA,OACA,MACA,WACA,UACA,WACA,KACA,MACA,UACA,MACA,MACA,KACA,KACA,KACA,QACA,WACA,aACA,SACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,SACA,MACA,QACA,MACA,MACA,SACA,QACA,SACA,KACA,OACA,MACA,OACA,OACA,OACA,OACA,QACA,MACA,OACA,WACA,SACA,KACA,SACA,WACA,SACA,IACA,QACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,SACA,UACA,SACA,QACA,SACA,OACA,SACA,QACA,MACA,UACA,MACA,MACA,QACA,QACA,KACA,WACA,QACA,KACA,QACA,OACA,QACA,KACA,QACA,IACA,KACA,MACA,QACA,OAGF,SAASC,GAA6BC,GACpC,MAAMC,EAAe,GACfC,EAAUlpJ,SAASsH,KAAKujB,YAAY7qB,SAASa,cAAcmoJ,IAC3DG,EAAgBC,iBAAiBF,GACvC,IAAK,IAAI72J,EAAI,EAAGA,EAAI82J,EAAc52J,OAAQF,IACxC42J,EAAaE,EAAc92J,IAAM82J,EAAcA,EAAc92J,IAG/D,OADA2N,SAASsH,KAAK+rB,YAAY61H,GACnBD,EAWF,SAASI,KACd,IAAK,IAAIh3J,EAAI,EAAGA,EAAIy2J,GAASv2J,OAAQF,IAC9B81J,GAAYW,GAASz2J,MACxB61J,GAAuBY,GAASz2J,IAAM02J,GAA6BD,GAASz2J,kPC5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","file":"assets/js/hub-2f07fc8928635334ea96.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t5: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"assets/js/\" + ({}[chunkId]||chunkId) + \"-\" + {}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// The chunk loading function for additional chunks\n \t// Since all referenced chunks are already included\n \t// in this file, this function is empty here.\n \t__webpack_require__.e = function requireEnsure() {\n \t\treturn Promise.resolve();\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/hubs\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1282,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export const paths = {};\r\npaths.noop = \"/noop\";\r\npaths.actions = {};\r\npaths.actions.log = \"/actions/log\";\r\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\r\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\r\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\r\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\r\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\r\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\r\npaths.actions.debugUserInput = {};\r\npaths.actions.debugUserInput.describeCurrentMasks = \"/actions/debugUserInput/describeCurrentMasks\";\r\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\r\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\r\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\r\npaths.actions.dCharSpeed = \"/actions/dCharSpeed\";\r\npaths.actions.boost = \"/actions/boost\";\r\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\r\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\r\npaths.actions.spawnPen = \"/actions/spawnPen\";\r\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\r\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\r\npaths.actions.thaw = \"/actions/thaw\";\r\npaths.actions.muteMic = \"/actions/muteMic\";\r\npaths.actions.toggleFly = \"/actions/toggleFly\";\r\npaths.actions.toggleUI = \"/actions/toggleUI\";\r\npaths.actions.waypointDeltaDistance = \"/actions/waypointDeltaDistance\";\r\npaths.actions.focusChat = \"/actions/focusChat\";\r\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\r\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\r\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\r\npaths.actions.mediaExit = \"/actions/mediaExit\";\r\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\r\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\r\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\r\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\r\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\r\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\r\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\r\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\r\npaths.actions.transformModifier = \"/actions/transformModifier\";\r\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\r\npaths.actions.cursor = {};\r\npaths.actions.cursor.right = {};\r\npaths.actions.cursor.right.pose = \"/actions/cursor/right/Pose\";\r\npaths.actions.cursor.right.hideLine = \"/actions/cursor/right/HideLine\";\r\npaths.actions.cursor.right.grab = \"/actions/cursor/right/Grab\";\r\npaths.actions.cursor.right.drop = \"/actions/cursor/right/Drop\";\r\npaths.actions.cursor.right.modDelta = \"/actions/cursor/right/ModDelta\";\r\npaths.actions.cursor.right.startDrawing = \"/actions/cursor/right/StartDrawing\";\r\npaths.actions.cursor.right.stopDrawing = \"/actions/cursor/right/StopDrawing\";\r\npaths.actions.cursor.right.undoDrawing = \"/actions/cursor/right/UndoDrawing\";\r\npaths.actions.cursor.right.penNextColor = \"/actions/cursor/right/PenNextColor\";\r\npaths.actions.cursor.right.penPrevColor = \"/actions/cursor/right/PenPrevColor\";\r\npaths.actions.cursor.right.scalePenTip = \"/actions/cursor/right/ScalePenTip\";\r\npaths.actions.cursor.right.scaleGrabbedGrabbable = \"/actions/cursor/right/ScaleGrabbedGrabbable\";\r\npaths.actions.cursor.right.mediaVolumeMod = \"/actions/cursor/right//mediaVolumeMod\";\r\npaths.actions.cursor.right.takeSnapshot = \"/actions/cursor/right/TakeSnapshot\";\r\npaths.actions.cursor.right.wake = \"/actions/cursor/right/wake\";\r\npaths.actions.cursor.left = {};\r\npaths.actions.cursor.left.pose = \"/actions/cursor/left/Pose\";\r\npaths.actions.cursor.left.hideLine = \"/actions/cursor/left/HideLine\";\r\npaths.actions.cursor.left.grab = \"/actions/cursor/left/Grab\";\r\npaths.actions.cursor.left.drop = \"/actions/cursor/left/Drop\";\r\npaths.actions.cursor.left.modDelta = \"/actions/cursor/left/ModDelta\";\r\npaths.actions.cursor.left.startDrawing = \"/actions/cursor/left/StartDrawing\";\r\npaths.actions.cursor.left.stopDrawing = \"/actions/cursor/left/StopDrawing\";\r\npaths.actions.cursor.left.undoDrawing = \"/actions/cursor/left/UndoDrawing\";\r\npaths.actions.cursor.left.penNextColor = \"/actions/cursor/left/PenNextColor\";\r\npaths.actions.cursor.left.penPrevColor = \"/actions/cursor/left/PenPrevColor\";\r\npaths.actions.cursor.left.scalePenTip = \"/actions/cursor/left/ScalePenTip\";\r\npaths.actions.cursor.left.scaleGrabbedGrabbable = \"/actions/cursor/left/ScaleGrabbedGrabbable\";\r\npaths.actions.cursor.left.mediaVolumeMod = \"/actions/cursor/left//mediaVolumeMod\";\r\npaths.actions.cursor.left.takeSnapshot = \"/actions/cursor/left/TakeSnapshot\";\r\npaths.actions.cursor.left.wake = \"/actions/cursor/left/wake\";\r\npaths.actions.pen = {};\r\npaths.actions.pen.remove = \"/actions/pen/remove\";\r\npaths.actions.rightHand = {};\r\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\r\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\r\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\r\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\r\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\r\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\r\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\r\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\r\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\r\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\r\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\r\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\r\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\r\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\r\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\r\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\r\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\r\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\r\npaths.actions.leftHand = {};\r\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\r\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\r\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\r\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\r\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\r\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\r\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\r\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\r\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\r\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\r\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\r\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\r\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\r\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\r\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\r\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\r\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\r\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\r\npaths.actions.camera = {};\r\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\r\npaths.actions.startInspecting = \"/actions/startInspecting\";\r\npaths.actions.stopInspecting = \"/actions/stopInspecting\";\r\npaths.actions.inspectZoom = \"/actions/inspectZoom\";\r\npaths.actions.inspectPanY = \"/actions/inspectPanY\";\r\npaths.actions.resetInspectView = \"/actions/resetInspectView\";\r\npaths.actions.nextCameraMode = \"/actions/nextCameraMode\";\r\npaths.haptics = {};\r\npaths.haptics.actuators = {};\r\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\r\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\r\n\r\npaths.device = {};\r\npaths.device.mouse = {};\r\npaths.device.mouse.coords = \"/device/mouse/coords\";\r\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\r\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\r\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\r\npaths.device.mouse.buttonMiddle = \"/device/mouse/buttonMiddle\";\r\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\r\npaths.device.smartMouse = {};\r\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\r\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\r\npaths.device.smartMouse.shouldMoveCamera = \"/device/smartMouse/shouldMoveCamera\";\r\npaths.device.touchscreen = {};\r\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\r\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\r\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\r\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\r\npaths.device.touchscreen.pinch = {};\r\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\r\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\r\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\r\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\r\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\r\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\r\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\r\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\r\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\r\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\r\npaths.device.touchscreen.anything = \"/device/touchscreen/anything\";\r\npaths.device.gyro = {};\r\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\r\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\r\npaths.device.hud = {};\r\npaths.device.hud.penButton = \"/device/hud/penButton\";\r\n\r\npaths.device.keyboard = {\r\n  map: new Map(),\r\n  key: function(k) {\r\n    let path = this.map.get(k);\r\n    if (path) {\r\n      return path;\r\n    }\r\n    path = `/device/keyboard/${k === \" \" ? \"space\" : k.toLowerCase()}`;\r\n    this.map.set(k, path);\r\n    return path;\r\n  }\r\n};\r\n\r\npaths.device.gamepad = gamepadIndex => ({\r\n  button: buttonIndex => ({\r\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\r\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\r\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\r\n  }),\r\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\r\n});\r\n\r\nconst xbox = \"/device/xbox/\";\r\npaths.device.xbox = {\r\n  v: name => `/vars/xbox/${name}`,\r\n  button: buttonName => ({\r\n    pressed: `${xbox}button/${buttonName}/pressed`,\r\n    touched: `${xbox}button/${buttonName}/touched`,\r\n    value: `${xbox}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${xbox}axis/${axisName}`;\r\n  },\r\n  axesSum: `${xbox}axis/sum`\r\n};\r\n\r\npaths.device.oculusgo = {\r\n  // TODO remove these in favor of the direct accessors\r\n  button: buttonName => ({\r\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\r\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\r\n    value: `/device/oculusgo/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/oculusgo/axis/${axisName}`;\r\n  },\r\n  //\r\n  trigger: {\r\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\r\n    touched: \"/device/oculusgo/button/trigger/touched\",\r\n    value: \"/device/oculusgo/button/trigger/value\"\r\n  },\r\n  touchpad: {\r\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\r\n    touched: \"/device/oculusgo/button/touchpad/touched\",\r\n    value: \"/device/oculusgo/button/touchpad/value\",\r\n    axisX: \"/device/oculusgo/axis/touchpadX\",\r\n    axisY: \"/device/oculusgo/axis/touchpadY\"\r\n  },\r\n  pose: \"/device/oculusgo/pose\",\r\n  matrix: \"/device/oculusgo/matrix\",\r\n  v: name => {\r\n    return `/vars/oculusgo/${name}`;\r\n  }\r\n};\r\n\r\nconst gearVRController = \"/device/gearVRController/\";\r\npaths.device.gearVRController = {\r\n  button: buttonName => ({\r\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\r\n    touched: `${gearVRController}button/${buttonName}/touched`,\r\n    value: `${gearVRController}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${gearVRController}axis/${axisName}`;\r\n  },\r\n  pose: `${gearVRController}pose`,\r\n  matrix: `${gearVRController}matrix`,\r\n  v: name => {\r\n    return `/vars/gearVRController/${name}`;\r\n  }\r\n};\r\n\r\nconst daydream = \"/device/daydream/\";\r\npaths.device.daydream = {\r\n  button: buttonName => ({\r\n    pressed: `${daydream}button/${buttonName}/pressed`,\r\n    touched: `${daydream}button/${buttonName}/touched`,\r\n    value: `${daydream}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${daydream}axis/${axisName}`;\r\n  },\r\n  pose: `${daydream}pose`,\r\n  matrix: `${daydream}matrix`\r\n};\r\n\r\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\r\npaths.device.rightOculusTouch = {\r\n  button: buttonName => ({\r\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\r\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\r\n    value: `${rightOculusTouch}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${rightOculusTouch}axis/${axisName}`;\r\n  },\r\n  axesSum: `${rightOculusTouch}axis/sum`,\r\n  pose: `${rightOculusTouch}pose`,\r\n  matrix: `${rightOculusTouch}matrix`\r\n};\r\n\r\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\r\npaths.device.leftOculusTouch = {\r\n  button: buttonName => ({\r\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\r\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\r\n    value: `${leftOculusTouch}button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `${leftOculusTouch}axis/${axisName}`;\r\n  },\r\n  axesSum: `${leftOculusTouch}axis/sum`,\r\n  pose: `${leftOculusTouch}pose`,\r\n  matrix: `${leftOculusTouch}matrix`\r\n};\r\n\r\npaths.device.vive = {};\r\npaths.device.vive.left = {\r\n  button: buttonName => ({\r\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\r\n    touched: `/device/vive/left/button/${buttonName}/touched`,\r\n    value: `/device/vive/left/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/vive/left/axis/${axisName}`;\r\n  },\r\n  axesSum: \"/device/vive/left/axis/sum\",\r\n  pose: `/device/vive/left/pose`,\r\n  matrix: `/device/vive/left/matrix`\r\n};\r\npaths.device.vive.right = {\r\n  button: buttonName => ({\r\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\r\n    touched: `/device/vive/right/button/${buttonName}/touched`,\r\n    value: `/device/vive/right/button/${buttonName}/value`\r\n  }),\r\n  axis: axisName => {\r\n    return `/device/vive/right/axis/${axisName}`;\r\n  },\r\n  axesSum: \"/device/vive/right/axis/sum\",\r\n  pose: `/device/vive/right/pose`,\r\n  matrix: `/device/vive/right/matrix`\r\n};\r\n\r\nfunction button(device, side, name) {\r\n  return {\r\n    pressed: `${device}${side}/button/${name}/pressed`,\r\n    touched: `${device}${side}/button/${name}/touched`,\r\n    value: `${device}${side}/button/${name}/value`\r\n  };\r\n}\r\n\r\nfunction axes(device, side, name) {\r\n  return {\r\n    axisX: `${device}${side}/axis/${name}X`,\r\n    axisY: `${device}${side}/axis/${name}Y`\r\n  };\r\n}\r\n\r\nfunction wmrController(side) {\r\n  const wmr = \"/device/wmr/\";\r\n  return {\r\n    touchpad: {\r\n      ...button(wmr, side, \"touchpad\"),\r\n      ...axes(wmr, side, \"touchpad\")\r\n    },\r\n    trigger: button(wmr, side, \"trigger\"),\r\n    grip: button(wmr, side, \"grip\"),\r\n    menu: button(wmr, side, \"menu\"),\r\n    joystick: axes(wmr, side, \"joystick\"),\r\n    pose: `${wmr}${side}/pose`,\r\n    matrix: `${wmr}${side}/matrix`\r\n  };\r\n}\r\npaths.device.wmr = {};\r\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\r\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\r\npaths.device.wmr.left = wmrController(\"left\");\r\npaths.device.wmr.right = wmrController(\"right\");\r\n","import appLogo from \"../assets/images/app-logo.png\";\r\nimport companyLogo from \"../assets/images/company-logo.png\";\r\nimport sceneEditorLogo from \"../assets/images/editor-logo.png\";\r\nimport pdfjs from \"pdfjs-dist\";\r\n\r\n// Read configs from global variable if available, otherwise use the process.env injected from build.\r\nconst configs = {};\r\nlet isAdmin = false;\r\n\r\n[\r\n  \"RETICULUM_SERVER\",\r\n  \"THUMBNAIL_SERVER\",\r\n  \"CORS_PROXY_SERVER\",\r\n  \"NON_CORS_PROXY_DOMAINS\",\r\n  \"SENTRY_DSN\",\r\n  \"GA_TRACKING_ID\",\r\n  \"SHORTLINK_DOMAIN\",\r\n  \"BASE_ASSETS_PATH\"\r\n].forEach(x => {\r\n  const el = document.querySelector(`meta[name='env:${x.toLowerCase()}']`);\r\n  configs[x] = el ? el.getAttribute(\"content\") : process.env[x];\r\n\r\n  if (x === \"BASE_ASSETS_PATH\" && configs[x]) {\r\n    // eslint-disable-next-line no-undef\r\n    __webpack_public_path__ = configs[x];\r\n\r\n    // Using external CDN to reduce build size\r\n    pdfjs.GlobalWorkerOptions.workerSrc = `${configs[x]}../assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js`;\r\n  }\r\n});\r\n\r\n// Also include configs that reticulum injects as a script in the page head.\r\n\r\nconfigs.AVAILABLE_INTEGRATIONS = window.AVAILABLE_INTEGRATIONS || {};\r\n\r\nif (window.APP_CONFIG) {\r\n  configs.APP_CONFIG = window.APP_CONFIG;\r\n  const { theme } = configs.APP_CONFIG;\r\n  if (theme) {\r\n    const colorVars = [];\r\n    for (const key in theme) {\r\n      if (!theme.hasOwnProperty(key)) continue;\r\n      colorVars.push(`--${key}: ${theme[key]};`);\r\n    }\r\n    const style = document.createElement(\"style\");\r\n    style.innerHTML = `:root{${colorVars.join(\"\\n\")}}`;\r\n    document.head.prepend(style);\r\n  }\r\n\r\n  if (!configs.APP_CONFIG.features) {\r\n    configs.APP_CONFIG.features = {};\r\n  }\r\n} else {\r\n  configs.APP_CONFIG = {\r\n    features: {}\r\n  };\r\n}\r\n\r\nconst isLocalDevelopment = process.env.NODE_ENV === \"development\";\r\n\r\nconfigs.feature = featureName => {\r\n  const value = configs.APP_CONFIG.features[featureName];\r\n  if (typeof value === \"boolean\" || featureName === \"enable_spoke\") {\r\n    const enableAll = isLocalDevelopment && !process.env.USE_FEATURE_CONFIG;\r\n    const forceEnableSpoke = featureName === \"enable_spoke\" && isAdmin;\r\n    return forceEnableSpoke || enableAll || value;\r\n  } else {\r\n    return value;\r\n  }\r\n};\r\n\r\nlet localDevImages = {};\r\nif (isLocalDevelopment) {\r\n  localDevImages = {\r\n    logo: appLogo,\r\n    company_logo: companyLogo,\r\n    editor_logo: sceneEditorLogo\r\n  };\r\n}\r\n\r\nconfigs.image = (imageName, cssUrl) => {\r\n  const url =\r\n    (configs.APP_CONFIG && configs.APP_CONFIG.images && configs.APP_CONFIG.images[imageName]) ||\r\n    localDevImages[imageName];\r\n  return url && cssUrl ? `url(${url})` : url;\r\n};\r\n\r\nconfigs.link = (linkName, defaultValue) => {\r\n  return (configs.APP_CONFIG && configs.APP_CONFIG.links && configs.APP_CONFIG.links[linkName]) || defaultValue;\r\n};\r\n\r\nconfigs.setIsAdmin = _isAdmin => {\r\n  isAdmin = _isAdmin;\r\n};\r\nconfigs.isAdmin = () => isAdmin;\r\n\r\nexport default configs;\r\n","const adjectives = [\r\n  \"able\",\r\n  \"absolute\",\r\n  \"acceptable\",\r\n  \"acclaimed\",\r\n  \"accomplished\",\r\n  \"accurate\",\r\n  \"aching\",\r\n  \"acrobatic\",\r\n  \"adorable\",\r\n  \"adventurous\",\r\n  \"basic\",\r\n  \"belated\",\r\n  \"beloved\",\r\n  \"calm\",\r\n  \"candid\",\r\n  \"capital\",\r\n  \"carefree\",\r\n  \"caring\",\r\n  \"cautious\",\r\n  \"celebrated\",\r\n  \"charming\",\r\n  \"daring\",\r\n  \"darling\",\r\n  \"dearest\",\r\n  \"each\",\r\n  \"eager\",\r\n  \"early\",\r\n  \"earnest\",\r\n  \"easy\",\r\n  \"easygoing\",\r\n  \"ecstatic\",\r\n  \"edible\",\r\n  \"fabulous\",\r\n  \"fair\",\r\n  \"faithful\",\r\n  \"familiar\",\r\n  \"famous\",\r\n  \"fancy\",\r\n  \"fantastic\",\r\n  \"far\",\r\n  \"generous\",\r\n  \"gentle\",\r\n  \"genuine\",\r\n  \"giant\",\r\n  \"handmade\",\r\n  \"handsome\",\r\n  \"handy\",\r\n  \"happy\",\r\n  \"icy\",\r\n  \"ideal\",\r\n  \"identical\",\r\n  \"keen\",\r\n  \"lasting\",\r\n  \"lavish\",\r\n  \"magnificent\",\r\n  \"majestic\",\r\n  \"mammoth\",\r\n  \"marvelous\",\r\n  \"natural\",\r\n  \"obedient\",\r\n  \"palatable\",\r\n  \"parched\",\r\n  \"passionate\",\r\n  \"pastel\",\r\n  \"peaceful\",\r\n  \"perfect\",\r\n  \"perfumed\",\r\n  \"quaint\",\r\n  \"qualified\",\r\n  \"radiant\",\r\n  \"rapid\",\r\n  \"rare\",\r\n  \"safe\",\r\n  \"sandy\",\r\n  \"satisfied\",\r\n  \"scaly\",\r\n  \"scarce\",\r\n  \"scared\",\r\n  \"scary\",\r\n  \"scented\",\r\n  \"scientific\",\r\n  \"secret\",\r\n  \"sentimental\",\r\n  \"talkative\",\r\n  \"tangible\",\r\n  \"tart\",\r\n  \"tasty\",\r\n  \"tattered\",\r\n  \"teeming\",\r\n  \"ultimate\",\r\n  \"uncommon\",\r\n  \"unconscious\",\r\n  \"understated\",\r\n  \"warm\",\r\n  \"active\",\r\n  \"adept\",\r\n  \"admirable\",\r\n  \"admired\",\r\n  \"adorable\",\r\n  \"adored\",\r\n  \"advanced\",\r\n  \"affectionate\",\r\n  \"beneficial\",\r\n  \"best\",\r\n  \"better\",\r\n  \"big\",\r\n  \"cheerful\",\r\n  \"cheery\",\r\n  \"chief\",\r\n  \"chilly\",\r\n  \"classic\",\r\n  \"clean\",\r\n  \"clear\",\r\n  \"clever\",\r\n  \"decent\",\r\n  \"decisive\",\r\n  \"deep\",\r\n  \"defiant\",\r\n  \"definitive\",\r\n  \"delectable\",\r\n  \"delicious\",\r\n  \"elaborate\",\r\n  \"elastic\",\r\n  \"elated\",\r\n  \"elegant\",\r\n  \"elementary\",\r\n  \"elliptical\",\r\n  \"fast\",\r\n  \"favorable\",\r\n  \"favorite\",\r\n  \"fearless\",\r\n  \"gifted\",\r\n  \"glamorous\",\r\n  \"gleaming\",\r\n  \"glittering\",\r\n  \"harmonious\",\r\n  \"imaginative\",\r\n  \"immense\",\r\n  \"jealous\",\r\n  \"kind\",\r\n  \"leafy\",\r\n  \"legal\",\r\n  \"mature\",\r\n  \"mean\",\r\n  \"nautical\",\r\n  \"neat\",\r\n  \"necessary\",\r\n  \"needy\",\r\n  \"oddball\",\r\n  \"offbeat\",\r\n  \"periodic\",\r\n  \"perky\",\r\n  \"personal\",\r\n  \"pertinent\",\r\n  \"petty\",\r\n  \"quarterly\",\r\n  \"ready\",\r\n  \"real\",\r\n  \"realistic\",\r\n  \"reasonable\",\r\n  \"regal\",\r\n  \"serene\",\r\n  \"shabby\",\r\n  \"sharp\",\r\n  \"shiny\",\r\n  \"showy\",\r\n  \"shy\",\r\n  \"silky\",\r\n  \"tempting\",\r\n  \"tense\",\r\n  \"terrific\",\r\n  \"testy\",\r\n  \"thankful\",\r\n  \"uniform\",\r\n  \"unique\",\r\n  \"vast\",\r\n  \"weary\",\r\n  \"wee\",\r\n  \"welcome\",\r\n  \"agile\",\r\n  \"alarmed\",\r\n  \"alert\",\r\n  \"alive\",\r\n  \"bleak\",\r\n  \"blissful\",\r\n  \"blushing\",\r\n  \"coarse\",\r\n  \"colorful\",\r\n  \"colossal\",\r\n  \"comfortable\",\r\n  \"compassionate\",\r\n  \"complete\",\r\n  \"delightful\",\r\n  \"dense\",\r\n  \"dependable\",\r\n  \"dependent\",\r\n  \"descriptive\",\r\n  \"detailed\",\r\n  \"determined\",\r\n  \"devoted\",\r\n  \"different\",\r\n  \"eminent\",\r\n  \"emotional\",\r\n  \"enchanted\",\r\n  \"enchanting\",\r\n  \"energetic\",\r\n  \"enormous\",\r\n  \"fine\",\r\n  \"finished\",\r\n  \"firm\",\r\n  \"firsthand\",\r\n  \"fixed\",\r\n  \"flashy\",\r\n  \"flawless\",\r\n  \"glorious\",\r\n  \"glossy\",\r\n  \"golden\",\r\n  \"good\",\r\n  \"gorgeous\",\r\n  \"graceful\",\r\n  \"healthy\",\r\n  \"heartfelt\",\r\n  \"hearty\",\r\n  \"helpful\",\r\n  \"impartial\",\r\n  \"impressive\",\r\n  \"jolly\",\r\n  \"jovial\",\r\n  \"lighthearted\",\r\n  \"likable\",\r\n  \"lined\",\r\n  \"mellow\",\r\n  \"melodic\",\r\n  \"memorable\",\r\n  \"mild\",\r\n  \"new\",\r\n  \"opulent\",\r\n  \"playful\",\r\n  \"pleasant\",\r\n  \"pleasing\",\r\n  \"plump\",\r\n  \"plush\",\r\n  \"polished\",\r\n  \"polite\",\r\n  \"reliable\",\r\n  \"relieved\",\r\n  \"remarkable\",\r\n  \"remote\",\r\n  \"respectful\",\r\n  \"responsible\",\r\n  \"simple\",\r\n  \"simplistic\",\r\n  \"sizzling\",\r\n  \"sleepy\",\r\n  \"slight\",\r\n  \"slim\",\r\n  \"smart\",\r\n  \"smooth\",\r\n  \"snappy\",\r\n  \"snoopy\",\r\n  \"thirsty\",\r\n  \"this\",\r\n  \"thorough\",\r\n  \"those\",\r\n  \"thoughtful\",\r\n  \"united\",\r\n  \"vibrant\",\r\n  \"vicious\",\r\n  \"wellmade\",\r\n  \"whimsical\",\r\n  \"whirlwind\",\r\n  \"zesty\",\r\n  \"amazing\",\r\n  \"ambitious\",\r\n  \"ample\",\r\n  \"amused\",\r\n  \"amusing\",\r\n  \"ancient\",\r\n  \"angelic\",\r\n  \"antique\",\r\n  \"bold\",\r\n  \"bossy\",\r\n  \"both\",\r\n  \"bouncy\",\r\n  \"bountiful\",\r\n  \"complex\",\r\n  \"conscious\",\r\n  \"considerate\",\r\n  \"constant\",\r\n  \"content\",\r\n  \"conventional\",\r\n  \"cooked\",\r\n  \"cool\",\r\n  \"cooperative\",\r\n  \"diligent\",\r\n  \"dimwitted\",\r\n  \"direct\",\r\n  \"discrete\",\r\n  \"envious\",\r\n  \"essential\",\r\n  \"ethical\",\r\n  \"euphoric\",\r\n  \"flippant\",\r\n  \"fluffy\",\r\n  \"flustered\",\r\n  \"focused\",\r\n  \"fond\",\r\n  \"gracious\",\r\n  \"grand\",\r\n  \"grandiose\",\r\n  \"granular\",\r\n  \"grateful\",\r\n  \"grave\",\r\n  \"great\",\r\n  \"hidden\",\r\n  \"high\",\r\n  \"hilarious\",\r\n  \"homely\",\r\n  \"incomparable\",\r\n  \"incredible\",\r\n  \"infamous\",\r\n  \"joyful\",\r\n  \"lively\",\r\n  \"loathsome\",\r\n  \"lonely\",\r\n  \"long\",\r\n  \"mindless\",\r\n  \"miniature\",\r\n  \"minor\",\r\n  \"misty\",\r\n  \"next\",\r\n  \"nice\",\r\n  \"nifty\",\r\n  \"nimble\",\r\n  \"orderly\",\r\n  \"organic\",\r\n  \"ornate\",\r\n  \"popular\",\r\n  \"posh\",\r\n  \"positive\",\r\n  \"potable\",\r\n  \"powerful\",\r\n  \"powerless\",\r\n  \"precious\",\r\n  \"present\",\r\n  \"prestigious\",\r\n  \"quick\",\r\n  \"rewarding\",\r\n  \"rich\",\r\n  \"right\",\r\n  \"sociable\",\r\n  \"soft\",\r\n  \"solid\",\r\n  \"some\",\r\n  \"sophisticated\",\r\n  \"soulful\",\r\n  \"sparkling\",\r\n  \"spectacular\",\r\n  \"speedy\",\r\n  \"spicy\",\r\n  \"spiffy\",\r\n  \"spirited\",\r\n  \"spiteful\",\r\n  \"splendid\",\r\n  \"spotless\",\r\n  \"spry\",\r\n  \"thrifty\",\r\n  \"tidy\",\r\n  \"tight\",\r\n  \"timely\",\r\n  \"tinted\",\r\n  \"unruly\",\r\n  \"untimely\",\r\n  \"violet\",\r\n  \"wicked\",\r\n  \"wide\",\r\n  \"wild\",\r\n  \"willing\",\r\n  \"winding\",\r\n  \"windy\",\r\n  \"zigzag\",\r\n  \"apprehensive\",\r\n  \"appropriate\",\r\n  \"artistic\",\r\n  \"assured\",\r\n  \"astonishing\",\r\n  \"bright\",\r\n  \"brilliant\",\r\n  \"bronze\",\r\n  \"coordinated\",\r\n  \"courageous\",\r\n  \"courteous\",\r\n  \"crafty\",\r\n  \"crazy\",\r\n  \"creamy\",\r\n  \"creative\",\r\n  \"crisp\",\r\n  \"distant\",\r\n  \"distinct\",\r\n  \"downright\",\r\n  \"evergreen\",\r\n  \"everlasting\",\r\n  \"every\",\r\n  \"evil\",\r\n  \"excellent\",\r\n  \"excitable\",\r\n  \"exemplary\",\r\n  \"exhausted\",\r\n  \"forthright\",\r\n  \"fortunate\",\r\n  \"fragrant\",\r\n  \"frank\",\r\n  \"free\",\r\n  \"frequent\",\r\n  \"fresh\",\r\n  \"friendly\",\r\n  \"frightened\",\r\n  \"frigid\",\r\n  \"gripping\",\r\n  \"grounded\",\r\n  \"honest\",\r\n  \"honorable\",\r\n  \"honored\",\r\n  \"hopeful\",\r\n  \"hospitable\",\r\n  \"hot\",\r\n  \"huge\",\r\n  \"infatuated\",\r\n  \"infinite\",\r\n  \"informal\",\r\n  \"insistent\",\r\n  \"instructive\",\r\n  \"juicy\",\r\n  \"jumbo\",\r\n  \"knowing\",\r\n  \"knowledgeable\",\r\n  \"longterm\",\r\n  \"loud\",\r\n  \"lovable\",\r\n  \"loving\",\r\n  \"modern\",\r\n  \"modest\",\r\n  \"monumental\",\r\n  \"normal\",\r\n  \"notable\",\r\n  \"outgoing\",\r\n  \"precious\",\r\n  \"pretty\",\r\n  \"prickly\",\r\n  \"primary\",\r\n  \"pristine\",\r\n  \"private\",\r\n  \"prize\",\r\n  \"productive\",\r\n  \"profitable\",\r\n  \"quiet\",\r\n  \"quintessential\",\r\n  \"roasted\",\r\n  \"robust\",\r\n  \"square\",\r\n  \"squiggly\",\r\n  \"stable\",\r\n  \"staid\",\r\n  \"starry\",\r\n  \"steel\",\r\n  \"stimulating\",\r\n  \"striking\",\r\n  \"striped\",\r\n  \"strong\",\r\n  \"studious\",\r\n  \"stunning\",\r\n  \"tough\",\r\n  \"trained\",\r\n  \"treasured\",\r\n  \"tremendous\",\r\n  \"triangular\",\r\n  \"tricky\",\r\n  \"unused\",\r\n  \"unusual\",\r\n  \"upbeat\",\r\n  \"virtual\",\r\n  \"witty\",\r\n  \"wonderful\",\r\n  \"wooden\",\r\n  \"worldly\",\r\n  \"youthful\",\r\n  \"attached\",\r\n  \"attentive\",\r\n  \"attractive\",\r\n  \"austere\",\r\n  \"authentic\",\r\n  \"automatic\",\r\n  \"aware\",\r\n  \"awesome\",\r\n  \"bubbly\",\r\n  \"bustling\",\r\n  \"busy\",\r\n  \"buttery\",\r\n  \"cuddly\",\r\n  \"cultured\",\r\n  \"curly\",\r\n  \"curvy\",\r\n  \"cute\",\r\n  \"cylindrical\",\r\n  \"downright\",\r\n  \"dramatic\",\r\n  \"excited\",\r\n  \"exciting\",\r\n  \"exotic\",\r\n  \"experienced\",\r\n  \"expert\",\r\n  \"frosty\",\r\n  \"fruitful\",\r\n  \"full\",\r\n  \"fumbling\",\r\n  \"funny\",\r\n  \"fussy\",\r\n  \"growing\",\r\n  \"grown\",\r\n  \"gummy\",\r\n  \"humble\",\r\n  \"humongous\",\r\n  \"hungry\",\r\n  \"intelligent\",\r\n  \"interesting\",\r\n  \"known\",\r\n  \"kooky\",\r\n  \"loyal\",\r\n  \"lucky\",\r\n  \"luminous\",\r\n  \"lustrous\",\r\n  \"luxurious\",\r\n  \"multicolored\",\r\n  \"mysterious\",\r\n  \"noteworthy\",\r\n  \"numb\",\r\n  \"nutritious\",\r\n  \"outstanding\",\r\n  \"overjoyed\",\r\n  \"proper\",\r\n  \"proud\",\r\n  \"prudent\",\r\n  \"punctual\",\r\n  \"puny\",\r\n  \"pure\",\r\n  \"puzzled\",\r\n  \"puzzling\",\r\n  \"quirky\",\r\n  \"stupendous\",\r\n  \"sturdy\",\r\n  \"stylish\",\r\n  \"subdued\",\r\n  \"subtle\",\r\n  \"sunny\",\r\n  \"super\",\r\n  \"superb\",\r\n  \"supportive\",\r\n  \"surprised\",\r\n  \"sweet\",\r\n  \"swift\",\r\n  \"sympathetic\",\r\n  \"trivial\",\r\n  \"trusting\",\r\n  \"trustworthy\",\r\n  \"trusty\",\r\n  \"truthful\",\r\n  \"twin\",\r\n  \"usable\",\r\n  \"used\",\r\n  \"useful\",\r\n  \"utilized\",\r\n  \"vital\",\r\n  \"vivid\",\r\n  \"worried\",\r\n  \"worthwhile\",\r\n  \"worthy\",\r\n  \"writhing\",\r\n  \"wry\",\r\n  \"yummy\",\r\n  \"chocolate\",\r\n  \"crimson\",\r\n  \"cyan\",\r\n  \"fuchsia\",\r\n  \"gold\",\r\n  \"honeydew\",\r\n  \"lime\",\r\n  \"linen\",\r\n  \"magenta\",\r\n  \"olive\",\r\n  \"peru\",\r\n  \"salmon\",\r\n  \"seashell\",\r\n  \"sienna\",\r\n  \"snow\",\r\n  \"thistle\",\r\n  \"tomato\",\r\n  \"transparent\",\r\n  \"turquoise\",\r\n  \"violet\"\r\n];\r\n\r\nconst nouns = [\r\n  \"space\",\r\n  \"land\",\r\n  \"world\",\r\n  \"universe\",\r\n  \"plane\",\r\n  \"room\",\r\n  \"nation\",\r\n  \"plaza\",\r\n  \"gathering\",\r\n  \"meetup\",\r\n  \"get together\",\r\n  \"conclave\",\r\n  \"party\",\r\n  \"domain\",\r\n  \"dominion\",\r\n  \"realm\",\r\n  \"square\",\r\n  \"commons\",\r\n  \"park\",\r\n  \"cosmos\",\r\n  \"sphere\",\r\n  \"terrain\",\r\n  \"spot\",\r\n  \"zone\",\r\n  \"area\",\r\n  \"tract\",\r\n  \"turf\",\r\n  \"place\",\r\n  \"territory\",\r\n  \"volume\",\r\n  \"camp\",\r\n  \"picnic\",\r\n  \"outing\",\r\n  \"vacation\",\r\n  \"adventure\",\r\n  \"exploration\",\r\n  \"outing\",\r\n  \"walkabout\",\r\n  \"safari\",\r\n  \"venture\",\r\n  \"roundtable\",\r\n  \"barbecue\",\r\n  \"celebration\",\r\n  \"festivity\",\r\n  \"gala\",\r\n  \"shindig\",\r\n  \"social\",\r\n  \"convention\",\r\n  \"assembly\",\r\n  \"congregation\",\r\n  \"rendezvous\",\r\n  \"huddle\",\r\n  \"meet\",\r\n  \"soiree\"\r\n];\r\n\r\nexport function generateHubName() {\r\n  const randItem = set => {\r\n    const s = set[Math.floor(Math.random() * set.length)];\r\n    return s.charAt(0).toUpperCase() + s.slice(1);\r\n  };\r\n\r\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\r\n}\r\n","import { Socket } from \"phoenix\";\r\nimport { generateHubName } from \"../utils/name-generation\";\r\nimport configs from \"../utils/configs\";\r\n\r\nimport Store from \"../storage/store\";\r\n\r\nexport function hasReticulumServer() {\r\n  return !!configs.RETICULUM_SERVER;\r\n}\r\n\r\nexport function isLocalClient() {\r\n  return hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER;\r\n}\r\n\r\nconst resolverLink = document.createElement(\"a\");\r\nlet reticulumMeta = null;\r\nlet invalidatedReticulumMetaThisSession = false;\r\n\r\nexport function getReticulumFetchUrl(path, absolute = false, host = null, port = null) {\r\n  if (host || hasReticulumServer()) {\r\n    return `https://${host || configs.RETICULUM_SERVER}${port ? `:${port}` : \"\"}${path}`;\r\n  } else if (absolute) {\r\n    resolverLink.href = path;\r\n    return resolverLink.href;\r\n  } else {\r\n    return path;\r\n  }\r\n}\r\n\r\nexport async function getReticulumMeta() {\r\n  if (!reticulumMeta) {\r\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\r\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\r\n      reticulumMeta = {\r\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\r\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\r\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\r\n      };\r\n    } else {\r\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\r\n        reticulumMeta = await res.json();\r\n      });\r\n    }\r\n  }\r\n\r\n  const qs = new URLSearchParams(location.search);\r\n  const phxHostOverride = qs.get(\"phx_host\");\r\n\r\n  if (phxHostOverride) {\r\n    reticulumMeta.phx_host = phxHostOverride;\r\n  }\r\n\r\n  return reticulumMeta;\r\n}\r\n\r\nlet directReticulumHostAndPort;\r\n\r\nasync function refreshDirectReticulumHostAndPort() {\r\n  const qs = new URLSearchParams(location.search);\r\n  let host = qs.get(\"phx_host\");\r\n  const reticulumMeta = await getReticulumMeta();\r\n  host = host || configs.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\r\n  const port =\r\n    qs.get(\"phx_port\") ||\r\n    (hasReticulumServer() ? new URL(`${document.location.protocol}//${configs.RETICULUM_SERVER}`).port : \"443\");\r\n  directReticulumHostAndPort = { host, port };\r\n}\r\n\r\nexport function getDirectReticulumFetchUrl(path, absolute = false) {\r\n  if (!directReticulumHostAndPort) {\r\n    console.warn(\"Cannot call getDirectReticulumFetchUrl before connectToReticulum. Returning non-direct url.\");\r\n    return getReticulumFetchUrl(path, absolute);\r\n  }\r\n\r\n  const { host, port } = directReticulumHostAndPort;\r\n  return getReticulumFetchUrl(path, absolute, host, port);\r\n}\r\n\r\nexport async function invalidateReticulumMeta() {\r\n  invalidatedReticulumMetaThisSession = true;\r\n  reticulumMeta = null;\r\n}\r\n\r\nexport async function connectToReticulum(debug = false, params = null, socketClass = Socket) {\r\n  const qs = new URLSearchParams(location.search);\r\n\r\n  const getNewSocketUrl = async () => {\r\n    await refreshDirectReticulumHostAndPort();\r\n    const { host, port } = directReticulumHostAndPort;\r\n    const protocol =\r\n      qs.get(\"phx_protocol\") ||\r\n      configs.RETICULUM_SOCKET_PROTOCOL ||\r\n      (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\r\n\r\n    return `${protocol}//${host}${port ? `:${port}` : \"\"}`;\r\n  };\r\n\r\n  const socketUrl = await getNewSocketUrl();\r\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\r\n\r\n  const socketSettings = {};\r\n\r\n  if (debug) {\r\n    socketSettings.logger = (kind, msg, data) => {\r\n      console.log(`${kind}: ${msg}`, data);\r\n    };\r\n  }\r\n\r\n  if (params) {\r\n    socketSettings.params = params;\r\n  }\r\n\r\n  const socket = new socketClass(`${socketUrl}/socket`, socketSettings);\r\n  socket.connect();\r\n  socket.onError(async () => {\r\n    // On error, underlying reticulum node may have died, so rebalance by\r\n    // fetching a new healthy node to connect to.\r\n    invalidateReticulumMeta();\r\n\r\n    const endPointPath = new URL(socket.endPoint).pathname;\r\n    const newSocketUrl = await getNewSocketUrl();\r\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\r\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\r\n    socket.endPoint = newEndPoint;\r\n  });\r\n\r\n  return socket;\r\n}\r\n\r\nexport function getLandingPageForPhoto(photoUrl) {\r\n  const parsedUrl = new URL(photoUrl);\r\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\r\n}\r\n\r\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\r\n  const { token } = window.APP.store.state.credentials;\r\n  const retUrl = getReticulumFetchUrl(url);\r\n  const params = {\r\n    headers: { \"content-type\": \"application/json\" },\r\n    method\r\n  };\r\n  if (token) {\r\n    params.headers.authorization = `bearer ${token}`;\r\n  }\r\n  if (payload) {\r\n    params.body = JSON.stringify(payload);\r\n  }\r\n  return fetch(retUrl, params).then(async r => {\r\n    const result = await r.text();\r\n    try {\r\n      return JSON.parse(result);\r\n    } catch (e) {\r\n      // Some reticulum responses, particularly DELETE requests, don't return json.\r\n      return result;\r\n    }\r\n  });\r\n}\r\n\r\nexport async function createAndRedirectToNewHub(name, sceneId, replace) {\r\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\r\n  const payload = { hub: { name: name || generateHubName() } };\r\n\r\n  if (sceneId) {\r\n    payload.hub.scene_id = sceneId;\r\n  }\r\n\r\n  const headers = { \"content-type\": \"application/json\" };\r\n  const store = new Store();\r\n  if (store.state && store.state.credentials.token) {\r\n    headers.authorization = `bearer ${store.state.credentials.token}`;\r\n  }\r\n\r\n  let res = await fetch(createUrl, {\r\n    body: JSON.stringify(payload),\r\n    headers,\r\n    method: \"POST\"\r\n  }).then(r => r.json());\r\n\r\n  if (res.error === \"invalid_token\") {\r\n    // Clear the invalid token from store.\r\n    store.update({ credentials: { token: null, email: null } });\r\n\r\n    // Create hub anonymously\r\n    delete headers.authorization;\r\n    res = await fetch(createUrl, {\r\n      body: JSON.stringify(payload),\r\n      headers,\r\n      method: \"POST\"\r\n    }).then(r => r.json());\r\n  }\r\n\r\n  const hub = res;\r\n  let url = hub.url;\r\n\r\n  const creatorAssignmentToken = hub.creator_assignment_token;\r\n  if (creatorAssignmentToken) {\r\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\r\n\r\n    // Don't need to store the embed token if there's no creator assignment token, since that means\r\n    // we are the owner and will get the embed token on page load.\r\n    const embedToken = hub.embed_token;\r\n\r\n    if (embedToken) {\r\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\r\n    }\r\n  }\r\n\r\n  if (isLocalClient()) {\r\n    url = `/hub.html?hub_id=${hub.hub_id}`;\r\n  }\r\n\r\n  if (replace) {\r\n    document.location.replace(url);\r\n  } else {\r\n    document.location = url;\r\n  }\r\n}\r\n\r\nexport function getPresenceEntryForSession(presences, sessionId) {\r\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\r\n  const presence = entry[1];\r\n  return (presence && presence.metas && presence.metas[0]) || {};\r\n}\r\n\r\nexport function getPresenceContextForSession(presences, sessionId) {\r\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\r\n}\r\n\r\nexport function getPresenceProfileForSession(presences, sessionId) {\r\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\r\n}\r\n\r\n// Takes the given channel, and creates a new channel with the same bindings\r\n// with the given socket, joins it, and leaves the old channel after joining.\r\n//\r\n// NOTE: This function relies upon phoenix channel object internals, so this\r\n// function will need to be reviewed if/when we ever update phoenix.js\r\nexport function migrateChannelToSocket(oldChannel, socket, params) {\r\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\r\n\r\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\r\n    const item = oldChannel.bindings[i];\r\n    channel.on(item.event, item.callback);\r\n  }\r\n\r\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\r\n    const item = oldChannel.pushBuffer[i];\r\n    channel.push(item.event, item.payload, item.timeout);\r\n  }\r\n\r\n  const oldJoinPush = oldChannel.joinPush;\r\n  const joinPush = channel.join();\r\n\r\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\r\n    const item = oldJoinPush.recHooks[i];\r\n    joinPush.receive(item.status, item.callback);\r\n  }\r\n\r\n  return new Promise(resolve => {\r\n    joinPush.receive(\"ok\", () => {\r\n      // Clear all event handlers first so no duplicate messages come in.\r\n      oldChannel.bindings = [];\r\n      resolve(channel);\r\n    });\r\n  });\r\n}\r\n\r\nexport function discordBridgesForPresences(presences) {\r\n  const channels = [];\r\n  for (const p of Object.values(presences)) {\r\n    for (const m of p.metas) {\r\n      if (m.profile && m.profile.discordBridges) {\r\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\r\n      }\r\n    }\r\n  }\r\n  return channels;\r\n}\r\n","const tempVector3 = new THREE.Vector3();\r\nconst tempQuaternion = new THREE.Quaternion();\r\n\r\nexport function getLastWorldPosition(src, target) {\r\n  src.updateMatrices();\r\n  target.setFromMatrixPosition(src.matrixWorld);\r\n  return target;\r\n}\r\n\r\nexport function getLastWorldQuaternion(src, target) {\r\n  src.updateMatrices();\r\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\r\n  return target;\r\n}\r\n\r\nexport function getLastWorldScale(src, target) {\r\n  src.updateMatrices();\r\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\r\n  return target;\r\n}\r\n\r\nexport function disposeMaterial(mtrl) {\r\n  if (mtrl.map) mtrl.map.dispose();\r\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\r\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\r\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\r\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\r\n  if (mtrl.envMap) mtrl.envMap.dispose();\r\n  mtrl.dispose();\r\n}\r\n\r\nexport function disposeNode(node) {\r\n  if (!(node instanceof THREE.Mesh)) return;\r\n\r\n  if (node.geometry) {\r\n    node.geometry.dispose();\r\n  }\r\n\r\n  if (node.material) {\r\n    let materialArray;\r\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\r\n      materialArray = node.material.materials;\r\n    } else if (node.material instanceof Array) {\r\n      materialArray = node.material;\r\n    }\r\n    if (materialArray) {\r\n      materialArray.forEach(disposeMaterial);\r\n    } else {\r\n      disposeMaterial(node.material);\r\n    }\r\n  }\r\n}\r\n\r\nconst IDENTITY = new THREE.Matrix4().identity();\r\nexport function setMatrixWorld(object3D, m) {\r\n  if (!object3D.matrixIsModified) {\r\n    object3D.applyMatrix(IDENTITY); // hack around our matrix optimizations\r\n  }\r\n  object3D.matrixWorld.copy(m);\r\n  if (object3D.parent) {\r\n    object3D.matrix = object3D.matrix.getInverse(object3D.parent.matrixWorld).multiply(object3D.matrixWorld);\r\n  } else {\r\n    object3D.matrix.copy(object3D.matrixWorld);\r\n  }\r\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\r\n  object3D.childrenNeedMatrixWorldUpdate = true;\r\n}\r\n\r\n// Modified version of Don McCurdy's AnimationUtils.clone\r\n// https://github.com/mrdoob/three.js/pull/14494\r\n\r\nfunction parallelTraverse(a, b, callback) {\r\n  callback(a, b);\r\n\r\n  for (let i = 0; i < a.children.length; i++) {\r\n    parallelTraverse(a.children[i], b.children[i], callback);\r\n  }\r\n}\r\n\r\n// Supports the following PropertyBinding path formats:\r\n// uuid.propertyName\r\n// uuid.propertyName[propertyIndex]\r\n// uuid.objectName[objectIndex].propertyName[propertyIndex]\r\n// Does not support property bindings that use object3D names or parent nodes\r\nfunction cloneKeyframeTrack(sourceKeyframeTrack, cloneUUIDLookup) {\r\n  const { nodeName: uuid, objectName, objectIndex, propertyName, propertyIndex } = THREE.PropertyBinding.parseTrackName(\r\n    sourceKeyframeTrack.name\r\n  );\r\n\r\n  let path = \"\";\r\n\r\n  if (uuid !== undefined) {\r\n    const clonedUUID = cloneUUIDLookup.get(uuid);\r\n\r\n    if (clonedUUID === undefined) {\r\n      console.warn(`Could not find KeyframeTrack target with uuid: \"${uuid}\"`);\r\n    }\r\n\r\n    path += clonedUUID;\r\n  }\r\n\r\n  if (objectName !== undefined) {\r\n    path += \".\" + objectName;\r\n  }\r\n\r\n  if (objectIndex !== undefined) {\r\n    path += \"[\" + objectIndex + \"]\";\r\n  }\r\n\r\n  if (propertyName !== undefined) {\r\n    path += \".\" + propertyName;\r\n  }\r\n\r\n  if (propertyIndex !== undefined) {\r\n    path += \"[\" + propertyIndex + \"]\";\r\n  }\r\n\r\n  const clonedKeyframeTrack = sourceKeyframeTrack.clone();\r\n  clonedKeyframeTrack.name = path;\r\n\r\n  return clonedKeyframeTrack;\r\n}\r\n\r\nfunction cloneAnimationClip(sourceAnimationClip, cloneUUIDLookup) {\r\n  const clonedTracks = sourceAnimationClip.tracks.map(keyframeTrack =>\r\n    cloneKeyframeTrack(keyframeTrack, cloneUUIDLookup)\r\n  );\r\n  return new THREE.AnimationClip(sourceAnimationClip.name, sourceAnimationClip.duration, clonedTracks);\r\n}\r\n\r\nexport function cloneObject3D(source, preserveUUIDs) {\r\n  const cloneLookup = new Map();\r\n  const cloneUUIDLookup = new Map();\r\n\r\n  const clone = source.clone();\r\n\r\n  parallelTraverse(source, clone, (sourceNode, clonedNode) => {\r\n    cloneLookup.set(sourceNode, clonedNode);\r\n  });\r\n\r\n  source.traverse(sourceNode => {\r\n    const clonedNode = cloneLookup.get(sourceNode);\r\n\r\n    if (preserveUUIDs) {\r\n      clonedNode.uuid = sourceNode.uuid;\r\n    }\r\n\r\n    cloneUUIDLookup.set(sourceNode.uuid, clonedNode.uuid);\r\n  });\r\n\r\n  source.traverse(sourceNode => {\r\n    const clonedNode = cloneLookup.get(sourceNode);\r\n\r\n    if (!clonedNode) {\r\n      return;\r\n    }\r\n\r\n    if (sourceNode.animations) {\r\n      clonedNode.animations = sourceNode.animations.map(animationClip =>\r\n        cloneAnimationClip(animationClip, cloneUUIDLookup)\r\n      );\r\n    }\r\n\r\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\r\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\r\n    }\r\n\r\n    if (!sourceNode.isSkinnedMesh) return;\r\n\r\n    const sourceBones = sourceNode.skeleton.bones;\r\n\r\n    clonedNode.skeleton = sourceNode.skeleton.clone();\r\n\r\n    clonedNode.skeleton.bones = sourceBones.map(sourceBone => {\r\n      if (!cloneLookup.has(sourceBone)) {\r\n        throw new Error(\"Required bones are not descendants of the given object.\");\r\n      }\r\n\r\n      return cloneLookup.get(sourceBone);\r\n    });\r\n\r\n    clonedNode.bind(clonedNode.skeleton, sourceNode.bindMatrix);\r\n  });\r\n\r\n  return clone;\r\n}\r\n\r\nexport function findNode(root, pred) {\r\n  let nodes = [root];\r\n  while (nodes.length) {\r\n    const node = nodes.shift();\r\n    if (pred(node)) return node;\r\n    if (node.children) nodes = nodes.concat(node.children);\r\n  }\r\n  return null;\r\n}\r\n\r\nexport const interpolateAffine = (function() {\r\n  const mat4 = new THREE.Matrix4();\r\n  const end = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  const start = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  const interpolated = {\r\n    position: new THREE.Vector3(),\r\n    quaternion: new THREE.Quaternion(),\r\n    scale: new THREE.Vector3()\r\n  };\r\n  return function(startMat4, endMat4, progress, outMat4) {\r\n    start.quaternion.setFromRotationMatrix(mat4.extractRotation(startMat4));\r\n    end.quaternion.setFromRotationMatrix(mat4.extractRotation(endMat4));\r\n    THREE.Quaternion.slerp(start.quaternion, end.quaternion, interpolated.quaternion, progress);\r\n    interpolated.position.lerpVectors(\r\n      start.position.setFromMatrixColumn(startMat4, 3),\r\n      end.position.setFromMatrixColumn(endMat4, 3),\r\n      progress\r\n    );\r\n    interpolated.scale.lerpVectors(\r\n      start.scale.setFromMatrixScale(startMat4),\r\n      end.scale.setFromMatrixScale(endMat4),\r\n      progress\r\n    );\r\n    return outMat4.compose(\r\n      interpolated.position,\r\n      interpolated.quaternion,\r\n      interpolated.scale\r\n    );\r\n  };\r\n})();\r\n\r\nexport const squareDistanceBetween = (function() {\r\n  const posA = new THREE.Vector3();\r\n  const posB = new THREE.Vector3();\r\n  return function(objA, objB) {\r\n    objA.updateMatrices();\r\n    objB.updateMatrices();\r\n    posA.setFromMatrixColumn(objA.matrixWorld, 3);\r\n    posB.setFromMatrixColumn(objB.matrixWorld, 3);\r\n    return posA.distanceToSquared(posB);\r\n  };\r\n})();\r\n\r\nexport function isAlmostUniformVector3(v, epsilonHalf = 0.005) {\r\n  return Math.abs(v.x - v.y) < epsilonHalf && Math.abs(v.x - v.z) < epsilonHalf;\r\n}\r\nexport function almostEqual(a, b, epsilon = 0.01) {\r\n  return Math.abs(a - b) < epsilon;\r\n}\r\n\r\nexport const affixToWorldUp = (function() {\r\n  const inRotationMat4 = new THREE.Matrix4();\r\n  const inForward = new THREE.Vector3();\r\n  const outForward = new THREE.Vector3();\r\n  const outSide = new THREE.Vector3();\r\n  const worldUp = new THREE.Vector3(); // Could be called \"outUp\"\r\n  const v = new THREE.Vector3();\r\n  const inMat4Copy = new THREE.Matrix4();\r\n  return function affixToWorldUp(inMat4, outMat4) {\r\n    inRotationMat4.identity().extractRotation(inMat4Copy.copy(inMat4));\r\n    inForward.setFromMatrixColumn(inRotationMat4, 2).multiplyScalar(-1);\r\n    outForward\r\n      .copy(inForward)\r\n      .sub(v.copy(inForward).projectOnVector(worldUp.set(0, 1, 0)))\r\n      .normalize();\r\n    outSide.crossVectors(outForward, worldUp);\r\n    outMat4.makeBasis(outSide, worldUp, outForward.multiplyScalar(-1));\r\n    outMat4.scale(v.setFromMatrixScale(inMat4Copy));\r\n    outMat4.setPosition(v.setFromMatrixColumn(inMat4Copy, 3));\r\n    return outMat4;\r\n  };\r\n})();\r\n\r\nexport const calculateCameraTransformForWaypoint = (function() {\r\n  const upAffixedCameraTransform = new THREE.Matrix4();\r\n  const upAffixedWaypointTransform = new THREE.Matrix4();\r\n  const detachFromWorldUp = new THREE.Matrix4();\r\n  return function calculateCameraTransformForWaypoint(cameraTransform, waypointTransform, outMat4) {\r\n    affixToWorldUp(cameraTransform, upAffixedCameraTransform);\r\n    detachFromWorldUp.getInverse(upAffixedCameraTransform).multiply(cameraTransform);\r\n    affixToWorldUp(waypointTransform, upAffixedWaypointTransform);\r\n    outMat4.copy(upAffixedWaypointTransform).multiply(detachFromWorldUp);\r\n  };\r\n})();\r\n\r\nexport const calculateViewingDistance = (function() {\r\n  return function calculateViewingDistance(fov, aspect, object, box, center, vrMode) {\r\n    const halfYExtents = Math.max(Math.abs(box.max.y - center.y), Math.abs(center.y - box.min.y));\r\n    const halfXExtents = Math.max(Math.abs(box.max.x - center.x), Math.abs(center.x - box.min.x));\r\n    const halfVertFOV = THREE.Math.degToRad(fov / 2);\r\n    const halfHorFOV = Math.atan(Math.tan(halfVertFOV) * aspect) * (vrMode ? 0.5 : 1);\r\n    const margin = 1.05;\r\n    const length1 = Math.abs((halfYExtents * margin) / Math.tan(halfVertFOV));\r\n    const length2 = Math.abs((halfXExtents * margin) / Math.tan(halfHorFOV));\r\n    const length3 = Math.abs(box.max.z - center.z) + Math.max(length1, length2);\r\n    const length = vrMode ? Math.max(0.25, length3) : length3;\r\n    return length || 1.25;\r\n  };\r\n})();\r\n\r\nexport const rotateInPlaceAroundWorldUp = (function() {\r\n  const inMat4Copy = new THREE.Matrix4();\r\n  const startRotation = new THREE.Matrix4();\r\n  const endRotation = new THREE.Matrix4();\r\n  const v = new THREE.Vector3();\r\n  return function rotateInPlaceAroundWorldUp(inMat4, theta, outMat4) {\r\n    inMat4Copy.copy(inMat4);\r\n    return outMat4\r\n      .copy(endRotation.makeRotationY(theta).multiply(startRotation.extractRotation(inMat4Copy)))\r\n      .scale(v.setFromMatrixScale(inMat4Copy))\r\n      .setPosition(v.setFromMatrixPosition(inMat4Copy));\r\n  };\r\n})();\r\n\r\nexport const childMatch = (function() {\r\n  const childInverse = new THREE.Matrix4();\r\n  const newParentMatrix = new THREE.Matrix4();\r\n  // transform the parent such that its child matches the target\r\n  return function childMatch(parent, child, target) {\r\n    child.updateMatrices();\r\n    childInverse.getInverse(child.matrix);\r\n    newParentMatrix.multiplyMatrices(target, childInverse);\r\n    setMatrixWorld(parent, newParentMatrix);\r\n  };\r\n})();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"media-browser\":\"media-browser__media-browser__2vGrK\",\"mediaBrowser\":\"media-browser__media-browser__2vGrK\",\"facets\":\"media-browser__facets__1F5su\",\"facet\":\"media-browser__facet__2tPR2\",\"body\":\"media-browser__body__FLeTs\",\"pager\":\"media-browser__pager__1uCLF\",\"header-center\":\"media-browser__header-center__362oJ\",\"headerCenter\":\"media-browser__header-center__362oJ\",\"search\":\"media-browser__search__w9byu\",\"header-left\":\"media-browser__header-left__YiCBN\",\"headerLeft\":\"media-browser__header-left__YiCBN\",\"engine-attribution\":\"media-browser__engine-attribution__3BZw3\",\"engineAttribution\":\"media-browser__engine-attribution__3BZw3\",\"engine-attribution-contents\":\"media-browser__engine-attribution-contents__1V8lP\",\"engineAttributionContents\":\"media-browser__engine-attribution-contents__1V8lP\",\"favorites-header\":\"media-browser__favorites-header__eh800\",\"favoritesHeader\":\"media-browser__favorites-header__eh800\",\"search-clear\":\"media-browser__search-clear__3Q83g\",\"searchClear\":\"media-browser__search-clear__3Q83g\",\"search-icon\":\"media-browser__search-icon__1Wmzt\",\"searchIcon\":\"media-browser__search-icon__1Wmzt\",\"box\":\"media-browser__box__xnums\",\"header\":\"media-browser__header__2ld2A\",\"no-search\":\"media-browser__no-search__2jrN5\",\"noSearch\":\"media-browser__no-search__2jrN5\",\"nav\":\"media-browser__nav__3ojr-\",\"nav-right-pad\":\"media-browser__nav-right-pad__QhiMO\",\"navRightPad\":\"media-browser__nav-right-pad__QhiMO\",\"nav-source\":\"media-browser__nav-source__3XCDH\",\"navSource\":\"media-browser__nav-source__3XCDH\",\"nav-source-selected\":\"media-browser__nav-source-selected__2roPW\",\"navSourceSelected\":\"media-browser__nav-source-selected__2roPW\",\"nav-scroll-arrow\":\"media-browser__nav-scroll-arrow__K6rUz\",\"navScrollArrow\":\"media-browser__nav-scroll-arrow__K6rUz\",\"tiles\":\"media-browser__tiles__15go5\",\"tile\":\"media-browser__tile___t1yM\",\"info\":\"media-browser__info__2zbp_\",\"name\":\"media-browser__name__3rONd\",\"attribution\":\"media-browser__attribution__1VCu7\",\"creator\":\"media-browser__creator__1zPvK\",\"publisher\":\"media-browser__publisher__2VhDz\",\"last-joined\":\"media-browser__last-joined__kZYnR\",\"lastJoined\":\"media-browser__last-joined__kZYnR\",\"tile-link\":\"media-browser__tile-link__3J-E7\",\"tileLink\":\"media-browser__tile-link__3J-E7\",\"tile-content\":\"media-browser__tile-content__3ZFtH\",\"tileContent\":\"media-browser__tile-content__3ZFtH\",\"avatar-tile\":\"media-browser__avatar-tile__2Q8Hp\",\"avatarTile\":\"media-browser__avatar-tile__2Q8Hp\",\"favorite\":\"media-browser__favorite__10lax\",\"tile-actions\":\"media-browser__tile-actions__gdUZK\",\"tileActions\":\"media-browser__tile-actions__gdUZK\",\"presence\":\"media-browser__presence__2hz2_\",\"create-tile\":\"media-browser__create-tile__3PgH0\",\"createTile\":\"media-browser__create-tile__3PgH0\",\"create-avatar-tile\":\"media-browser__create-avatar-tile__xgxgC\",\"createAvatarTile\":\"media-browser__create-avatar-tile__xgxgC\",\"tiles-variable\":\"media-browser__tiles-variable__1C77s\",\"tilesVariable\":\"media-browser__tiles-variable__1C77s\",\"page-number\":\"media-browser__page-number__36gMl\",\"pageNumber\":\"media-browser__page-number__36gMl\",\"pager-button-disabled\":\"media-browser__pager-button-disabled__2hPHk\",\"pagerButtonDisabled\":\"media-browser__pager-button-disabled__2hPHk\",\"header-right\":\"media-browser__header-right__2mLFS\",\"headerRight\":\"media-browser__header-right__2mLFS\",\"create-button\":\"media-browser__create-button__2l0du\",\"createButton\":\"media-browser__create-button__2l0du\",\"create-link\":\"media-browser__create-link__1jbNm\",\"createLink\":\"media-browser__create-link__1jbNm\",\"empty-string\":\"media-browser__empty-string__ZDY2_\",\"emptyString\":\"media-browser__empty-string__ZDY2_\",\"media-browser-inline\":\"media-browser__media-browser-inline__3WnC7\",\"mediaBrowserInline\":\"media-browser__media-browser-inline__3WnC7\"};","import { hasReticulumServer } from \"./phoenix-utils\";\r\nimport configs from \"./configs\";\r\n\r\nconst nonCorsProxyDomains = (configs.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\r\nif (configs.CORS_PROXY_SERVER) {\r\n  nonCorsProxyDomains.push(configs.CORS_PROXY_SERVER);\r\n}\r\n\r\nconst commonKnownContentTypes = {\r\n  gltf: \"model/gltf\",\r\n  glb: \"model/gltf-binary\",\r\n  png: \"image/png\",\r\n  jpg: \"image/jpeg\",\r\n  jpeg: \"image/jpeg\",\r\n  pdf: \"application/pdf\",\r\n  mp4: \"video/mp4\",\r\n  mp3: \"audio/mpeg\",\r\n  basis: \"image/basis\"\r\n};\r\n\r\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\r\nfunction b64EncodeUnicode(str) {\r\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\r\n  // into raw bytes which can be fed into btoa.\r\n  const CHAR_RE = /%([0-9A-F]{2})/g;\r\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\r\n}\r\n\r\nconst farsparkEncodeUrl = url => {\r\n  // farspark doesn't know how to read '=' base64 padding characters\r\n  // translate base64 + to - and / to _ for URL safety\r\n  return b64EncodeUnicode(url)\r\n    .replace(/=+$/g, \"\")\r\n    .replace(/\\+/g, \"-\")\r\n    .replace(/\\//g, \"_\");\r\n};\r\n\r\nexport const scaledThumbnailUrlFor = (url, width, height) => {\r\n  let extension = \"\";\r\n  try {\r\n    const pathParts = new URL(url).pathname.split(\".\");\r\n\r\n    if (pathParts.length > 1) {\r\n      const extensionCandidate = pathParts.pop();\r\n      if (commonKnownContentTypes[extensionCandidate]) {\r\n        extension = `.${extensionCandidate}`;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    extension = \".png\";\r\n  }\r\n\r\n  // HACK: the extension is needed to ensure CDN caching on Cloudflare\r\n  const thumbnailUrl = `https://${configs.THUMBNAIL_SERVER}/thumbnail/${farsparkEncodeUrl(\r\n    url\r\n  )}${extension}?w=${width}&h=${height}`;\r\n\r\n  try {\r\n    const urlHostname = new URL(url).hostname;\r\n\r\n    if (hasReticulumServer()) {\r\n      const retHostname = new URL(`https://${configs.RETICULUM_SERVER}`).hostname;\r\n      if (retHostname === urlHostname) return url;\r\n    }\r\n  } catch (e) {\r\n    return thumbnailUrl;\r\n  }\r\n\r\n  return thumbnailUrl;\r\n};\r\n\r\nexport const isNonCorsProxyDomain = hostname => {\r\n  return nonCorsProxyDomains.find(domain => hostname.endsWith(domain));\r\n};\r\n\r\nexport const proxiedUrlFor = url => {\r\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\r\n\r\n  // Skip known domains that do not require CORS proxying.\r\n  try {\r\n    const parsedUrl = new URL(url);\r\n    if (isNonCorsProxyDomain(parsedUrl.hostname)) return url;\r\n  } catch (e) {\r\n    // Ignore\r\n  }\r\n\r\n  return `https://${configs.CORS_PROXY_SERVER}/${url}`;\r\n};\r\n\r\nexport function getAbsoluteUrl(baseUrl, relativeUrl) {\r\n  return new URL(relativeUrl, baseUrl);\r\n}\r\n\r\nexport function getAbsoluteHref(baseUrl, relativeUrl) {\r\n  return getAbsoluteUrl(baseUrl, relativeUrl).href;\r\n}\r\n\r\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\r\n  if (typeof url !== \"string\" || url === \"\") return \"\";\r\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\r\n  if (/^data:.*,.*$/i.test(url)) return url;\r\n  if (/^blob:.*$/i.test(url)) return url;\r\n\r\n  if (configs.CORS_PROXY_SERVER) {\r\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\r\n    const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\r\n\r\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\r\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\r\n      const originalUrlParts = originalUrl.split(\"/\");\r\n\r\n      // Drop the .gltf filename\r\n      const path = new URL(url).pathname;\r\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\r\n      return corsProxyPrefix + assetUrl;\r\n    }\r\n  }\r\n\r\n  return url;\r\n};\r\n\r\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\r\n\r\nexport const guessContentType = url => {\r\n  if (!url) return;\r\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\r\n  if (url.startsWith(\"data:\")) {\r\n    const matches = dataUrlRegex.exec(url);\r\n    if (matches.length > 0) {\r\n      matches[1];\r\n    }\r\n  }\r\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\r\n  return commonKnownContentTypes[extension];\r\n};\r\n\r\nconst originIsHubsServer = new Map();\r\nasync function isHubsServer(url) {\r\n  if (!url) return false;\r\n  if (!url.startsWith(\"http\")) {\r\n    url = \"https://\" + url;\r\n  }\r\n  const { origin } = new URL(url);\r\n\r\n  if (originIsHubsServer.has(origin)) {\r\n    return originIsHubsServer.get(origin);\r\n  }\r\n\r\n  let isHubsServer;\r\n  try {\r\n    isHubsServer = (await fetch(proxiedUrlFor(origin), { method: \"HEAD\" })).headers.has(\"hub-name\");\r\n  } catch (e) {\r\n    isHubsServer = false;\r\n  }\r\n  originIsHubsServer.set(origin, isHubsServer);\r\n  return isHubsServer;\r\n}\r\n\r\nconst hubsSceneRegex = /https?:\\/\\/[^/]+\\/scenes\\/(\\w+)\\/?\\S*/;\r\nconst hubsAvatarRegex = /https?:\\/\\/[^/]+\\/avatars\\/(?<id>\\w+)\\/?\\S*/;\r\nconst hubsRoomRegex = /(https?:\\/\\/)?[^/]+\\/([a-zA-Z0-9]{7})\\/?\\S*/;\r\n\r\nexport const isLocalHubsUrl = async url =>\r\n  (await isHubsServer(url)) && new URL(url).origin === document.location.origin;\r\n\r\nexport const isHubsSceneUrl = async url => (await isHubsServer(url)) && hubsSceneRegex.test(url);\r\nexport const isLocalHubsSceneUrl = async url => (await isHubsSceneUrl(url)) && (await isLocalHubsUrl(url));\r\n\r\nexport const isHubsAvatarUrl = async url => (await isHubsServer(url)) && hubsAvatarRegex.test(url);\r\nexport const isLocalHubsAvatarUrl = async url => (await isHubsAvatarUrl(url)) && (await isLocalHubsUrl(url));\r\n\r\nexport const isHubsRoomUrl = async url =>\r\n  (await isHubsServer(url)) && !(await isHubsAvatarUrl(url)) && !(await isHubsSceneUrl(url)) && hubsRoomRegex.test(url);\r\n\r\nexport const isHubsDestinationUrl = async url =>\r\n  (await isHubsServer(url)) && ((await isHubsSceneUrl(url)) || (await isHubsRoomUrl(url)));\r\n\r\nexport const idForAvatarUrl = url => {\r\n  const match = url.match(hubsAvatarRegex);\r\n  if (match) {\r\n    return match.groups.id;\r\n  }\r\n  return null;\r\n};\r\n","export const waitForEvent = function(eventName, eventObj) {\r\n  return new Promise(resolve => {\r\n    eventObj.addEventListener(eventName, resolve, { once: true });\r\n  });\r\n};\r\n\r\nexport const waitForDOMContentLoaded = function() {\r\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\r\n    return Promise.resolve(null);\r\n  } else {\r\n    return waitForEvent(\"DOMContentLoaded\", window);\r\n  }\r\n};\r\n","import configs from \"./configs\";\r\nimport localeData from \"../assets/translations.data.json\";\r\n\r\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\r\n  .toLowerCase()\r\n  .split(/[_-]+/)[0];\r\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\r\n\r\nconst _messages = localeData[lang] || localeData.en;\r\n\r\nif (configs.APP_CONFIG && configs.APP_CONFIG.translations && configs.APP_CONFIG.translations[lang]) {\r\n  const configTranslations = configs.APP_CONFIG.translations[lang];\r\n  for (const messageKey in configTranslations) {\r\n    if (!configTranslations.hasOwnProperty(messageKey)) continue;\r\n    if (!configTranslations[messageKey]) continue;\r\n    _messages[messageKey] = configTranslations[messageKey];\r\n  }\r\n}\r\n\r\nexport const messages = Object.entries(_messages)\r\n  .map(([key, message]) => [\r\n    key,\r\n    // Replace nested message keys (e.g. %app-name%) with their messages.\r\n    message.replace(/%([\\w-.]+)%/i, (_match, subkey) => _messages[subkey])\r\n  ])\r\n  .reduce((acc, entry) => {\r\n    acc[entry[0]] = entry[1];\r\n    return acc;\r\n  }, {});\r\n","function loadAsync(loader, url, onProgress) {\r\n  return new Promise((resolve, reject) => loader.load(url, resolve, onProgress, reject));\r\n}\r\n\r\nexport default class HubsTextureLoader {\r\n  static crossOrigin = \"anonymous\";\r\n\r\n  constructor(manager = THREE.DefaultLoadingManager) {\r\n    this.manager = manager;\r\n  }\r\n\r\n  load(url, onLoad, onProgress, onError) {\r\n    const texture = new THREE.Texture();\r\n\r\n    this.loadTextureAsync(texture, url, onProgress)\r\n      .then(onLoad)\r\n      .catch(onError);\r\n\r\n    return texture;\r\n  }\r\n\r\n  async loadTextureAsync(texture, src, onProgress) {\r\n    let imageLoader;\r\n\r\n    if (window.createImageBitmap !== undefined) {\r\n      imageLoader = new THREE.ImageBitmapLoader(this.manager);\r\n      texture.flipY = false;\r\n    } else {\r\n      imageLoader = new THREE.ImageLoader(this.manager);\r\n    }\r\n\r\n    imageLoader.setCrossOrigin(this.crossOrigin);\r\n    imageLoader.setPath(this.path);\r\n\r\n    const cacheKey = this.manager.resolveURL(src);\r\n\r\n    texture.image = await loadAsync(imageLoader, src, onProgress);\r\n\r\n    // Image was just added to cache before this function gets called, disable caching by immediatly removing it\r\n    THREE.Cache.remove(cacheKey);\r\n\r\n    texture.needsUpdate = true;\r\n\r\n    texture.onUpdate = function() {\r\n      // Delete texture data once it has been uploaded to the GPU\r\n      texture.image.close && texture.image.close();\r\n      delete texture.image;\r\n    };\r\n\r\n    return texture;\r\n  }\r\n\r\n  setCrossOrigin(value) {\r\n    this.crossOrigin = value;\r\n    return this;\r\n  }\r\n\r\n  setPath(value) {\r\n    this.path = value;\r\n    return this;\r\n  }\r\n}\r\n","/* eslint-disable */\r\n\r\nimport transcoderWasmFile from \"./basis_transcoder.wasm\";\r\nimport BasisWorker from \"./basis_transcoder.worker.js\";\r\n\r\n/**\r\n * @author Don McCurdy / https://www.donmccurdy.com\r\n * @author Austin Eng / https://github.com/austinEng\r\n * @author Shrek Shao / https://github.com/shrekshao\r\n */\r\n\r\n/**\r\n * Loader for Basis Universal GPU Texture Codec.\r\n *\r\n * Basis Universal is a \"supercompressed\" GPU texture and texture video\r\n * compression system that outputs a highly compressed intermediate file format\r\n * (.basis) that can be quickly transcoded to a wide variety of GPU texture\r\n * compression formats.\r\n *\r\n * This loader parallelizes the transcoding process across a configurable number\r\n * of web workers, before transferring the transcoded compressed texture back\r\n * to the main thread.\r\n */\r\n\r\nTHREE.BasisTextureLoader = function(manager) {\r\n  THREE.Loader.call(this, manager);\r\n\r\n  this.transcoderPath = \"\";\r\n  this.transcoderBinary = null;\r\n  this.transcoderPending = null;\r\n\r\n  this.workerLimit = 4;\r\n  this.workerPool = [];\r\n  this.workerNextTaskID = 1;\r\n  this.workerConfig = {\r\n    format: null,\r\n    astcSupported: false,\r\n    etcSupported: false,\r\n    dxtSupported: false,\r\n    pvrtcSupported: false,\r\n    returnBuffer: false\r\n  };\r\n};\r\n\r\nTHREE.BasisTextureLoader.prototype = Object.assign(Object.create(THREE.Loader.prototype), {\r\n  constructor: THREE.BasisTextureLoader,\r\n\r\n  setTranscoderPath: function(path) {\r\n    this.transcoderPath = path;\r\n\r\n    return this;\r\n  },\r\n\r\n  setWorkerLimit: function(workerLimit) {\r\n    this.workerLimit = workerLimit;\r\n\r\n    return this;\r\n  },\r\n\r\n  detectSupport: function(renderer) {\r\n    var config = this.workerConfig;\r\n\r\n    config.astcSupported = !!renderer.extensions.get(\"WEBGL_compressed_texture_astc\");\r\n    config.etcSupported = !!renderer.extensions.get(\"WEBGL_compressed_texture_etc1\");\r\n    config.dxtSupported = !!renderer.extensions.get(\"WEBGL_compressed_texture_s3tc\");\r\n    config.pvrtcSupported =\r\n      !!renderer.extensions.get(\"WEBGL_compressed_texture_pvrtc\") ||\r\n      !!renderer.extensions.get(\"WEBKIT_WEBGL_compressed_texture_pvrtc\");\r\n\r\n    if (config.astcSupported) {\r\n      config.format = THREE.BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4;\r\n    } else if (config.dxtSupported) {\r\n      config.format = THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC3;\r\n    } else if (config.pvrtcSupported) {\r\n      config.format = THREE.BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA;\r\n    } else if (config.etcSupported) {\r\n      config.format = THREE.BasisTextureLoader.BASIS_FORMAT.cTFETC1;\r\n    } else {\r\n      throw new Error(\"THREE.BasisTextureLoader: No suitable compressed texture format found.\");\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  load: function(url, onLoad, onProgress, onError) {\r\n    var loader = new THREE.FileLoader(this.manager);\r\n\r\n    if (!this.ranDetect) {\r\n      this.detectSupport(AFRAME.scenes[0].renderer);\r\n      this.ranDetect = true;\r\n    }\r\n\r\n    loader.setResponseType(\"arraybuffer\");\r\n\r\n    loader.load(\r\n      url,\r\n      buffer => {\r\n        this._createTexture(buffer)\r\n          .then(onLoad)\r\n          .catch(onError);\r\n      },\r\n      onProgress,\r\n      onError\r\n    );\r\n  },\r\n\r\n  /**\r\n   * @param  {ArrayBuffer} buffer\r\n   * @return {Promise<THREE.CompressedTexture>}\r\n   */\r\n  _createTexture: function(buffer) {\r\n    var worker;\r\n    var taskID;\r\n\r\n    var texturePending = this._getWorker()\r\n      .then(_worker => {\r\n        worker = _worker;\r\n        taskID = this.workerNextTaskID++;\r\n\r\n        return new Promise((resolve, reject) => {\r\n          worker._callbacks[taskID] = { resolve, reject };\r\n          worker._taskCosts[taskID] = buffer.byteLength;\r\n          worker._taskLoad += worker._taskCosts[taskID];\r\n\r\n          worker.postMessage({ type: \"transcode\", id: taskID, buffer }, [buffer]);\r\n        });\r\n      })\r\n      .then(message => {\r\n        var config = this.workerConfig;\r\n\r\n        var { width, height, mipmaps, format, hasAlpha, buffer } = message;\r\n\r\n        var texture;\r\n\r\n        switch (format) {\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4:\r\n            texture = new THREE.CompressedTexture(mipmaps, width, height, THREE.RGBA_ASTC_4x4_Format);\r\n            break;\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC1:\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC3:\r\n            texture = new THREE.CompressedTexture(\r\n              mipmaps,\r\n              width,\r\n              height,\r\n              THREE.BasisTextureLoader.DXT_FORMAT_MAP[config.format],\r\n              THREE.UnsignedByteType\r\n            );\r\n            break;\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFETC1:\r\n            texture = new THREE.CompressedTexture(mipmaps, width, height, THREE.RGB_ETC1_Format);\r\n            break;\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGB:\r\n            texture = new THREE.CompressedTexture(mipmaps, width, height, THREE.RGB_PVRTC_4BPPV1_Format);\r\n            break;\r\n          case THREE.BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA:\r\n            texture = new THREE.CompressedTexture(mipmaps, width, height, THREE.RGBA_PVRTC_4BPPV1_Format);\r\n            break;\r\n          default:\r\n            throw new Error(\"THREE.BasisTextureLoader: No supported format available.\");\r\n        }\r\n\r\n        texture.minFilter = mipmaps.length === 1 ? THREE.LinearFilter : THREE.LinearMipmapLinearFilter;\r\n        texture.magFilter = THREE.LinearFilter;\r\n        texture.generateMipmaps = false;\r\n        texture.needsUpdate = true;\r\n\r\n        texture.image.hasAlpha = hasAlpha;\r\n        if (this.workerConfig.returnBuffer) {\r\n          texture.image.data = buffer;\r\n        }\r\n\r\n        return texture;\r\n      });\r\n\r\n    texturePending.finally(() => {\r\n      if (worker && taskID) {\r\n        worker._taskLoad -= worker._taskCosts[taskID];\r\n        delete worker._callbacks[taskID];\r\n        delete worker._taskCosts[taskID];\r\n      }\r\n    });\r\n\r\n    return texturePending;\r\n  },\r\n\r\n  _initTranscoder: function() {\r\n    if (!this.transcoderBinary) {\r\n      // Load transcoder WASM binary.\r\n      var binaryLoader = new THREE.FileLoader(this.manager);\r\n      binaryLoader.setPath(this.transcoderPath);\r\n      binaryLoader.setResponseType(\"arraybuffer\");\r\n      var binaryContent = new Promise((resolve, reject) => {\r\n        binaryLoader.load(transcoderWasmFile, resolve, undefined, reject);\r\n      });\r\n\r\n      this.transcoderPending = binaryContent.then(binaryContent => {\r\n        this.transcoderBinary = binaryContent;\r\n      });\r\n    }\r\n\r\n    return this.transcoderPending;\r\n  },\r\n\r\n  _getWorker: function() {\r\n    return this._initTranscoder().then(() => {\r\n      if (this.workerPool.length < this.workerLimit) {\r\n        var worker = new BasisWorker();\r\n\r\n        worker._callbacks = {};\r\n        worker._taskCosts = {};\r\n        worker._taskLoad = 0;\r\n\r\n        worker.postMessage({\r\n          type: \"init\",\r\n          config: this.workerConfig,\r\n          transcoderBinary: this.transcoderBinary\r\n        });\r\n\r\n        worker.onmessage = function(e) {\r\n          var message = e.data;\r\n\r\n          switch (message.type) {\r\n            case \"transcode\":\r\n              worker._callbacks[message.id].resolve(message);\r\n              break;\r\n\r\n            case \"error\":\r\n              worker._callbacks[message.id].reject(message);\r\n              break;\r\n\r\n            default:\r\n              console.error('THREE.BasisTextureLoader: Unexpected message, \"' + message.type + '\"');\r\n          }\r\n        };\r\n\r\n        this.workerPool.push(worker);\r\n      } else {\r\n        this.workerPool.sort(function(a, b) {\r\n          return a._taskLoad > b._taskLoad ? -1 : 1;\r\n        });\r\n      }\r\n\r\n      return this.workerPool[this.workerPool.length - 1];\r\n    });\r\n  },\r\n\r\n  dispose: function() {\r\n    for (var i = 0; i < this.workerPool.length; i++) {\r\n      this.workerPool[i].terminate();\r\n    }\r\n\r\n    this.workerPool.length = 0;\r\n\r\n    return this;\r\n  }\r\n});\r\n\r\n/* CONSTANTS */\r\n\r\nTHREE.BasisTextureLoader.BASIS_FORMAT = {\r\n  cTFETC1: 0,\r\n  cTFETC2: 1,\r\n  cTFBC1: 2,\r\n  cTFBC3: 3,\r\n  cTFBC4: 4,\r\n  cTFBC5: 5,\r\n  cTFBC7_M6_OPAQUE_ONLY: 6,\r\n  cTFBC7_M5: 7,\r\n  cTFPVRTC1_4_RGB: 8,\r\n  cTFPVRTC1_4_RGBA: 9,\r\n  cTFASTC_4x4: 10,\r\n  cTFATC_RGB: 11,\r\n  cTFATC_RGBA_INTERPOLATED_ALPHA: 12,\r\n  cTFRGBA32: 13,\r\n  cTFRGB565: 14,\r\n  cTFBGR565: 15,\r\n  cTFRGBA4444: 16\r\n};\r\n\r\n// DXT formats, from:\r\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_s3tc/\r\nTHREE.BasisTextureLoader.DXT_FORMAT = {\r\n  COMPRESSED_RGB_S3TC_DXT1_EXT: 0x83f0,\r\n  COMPRESSED_RGBA_S3TC_DXT1_EXT: 0x83f1,\r\n  COMPRESSED_RGBA_S3TC_DXT3_EXT: 0x83f2,\r\n  COMPRESSED_RGBA_S3TC_DXT5_EXT: 0x83f3\r\n};\r\nTHREE.BasisTextureLoader.DXT_FORMAT_MAP = {};\r\nTHREE.BasisTextureLoader.DXT_FORMAT_MAP[THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC1] =\r\n  THREE.BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT;\r\nTHREE.BasisTextureLoader.DXT_FORMAT_MAP[THREE.BasisTextureLoader.BASIS_FORMAT.cTFBC3] =\r\n  THREE.BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT;\r\n\r\nexport default THREE.BasisTextureLoader;\r\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\r\nimport { getReticulumFetchUrl, getDirectReticulumFetchUrl } from \"./phoenix-utils\";\r\nimport { ObjectContentOrigins } from \"../object-types\";\r\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\r\nimport { mapMaterials } from \"./material-utils\";\r\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\r\nimport { validMaterials } from \"../components/hoverable-visuals\";\r\nimport { proxiedUrlFor, guessContentType } from \"../utils/media-url-utils\";\r\nimport Linkify from \"linkify-it\";\r\nimport tlds from \"tlds\";\r\n\r\nimport anime from \"animejs\";\r\n\r\nconst linkify = Linkify();\r\nlinkify.tlds(tlds);\r\n\r\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\r\nconst getDirectMediaAPIEndpoint = () => getDirectReticulumFetchUrl(\"/api/v1/media\");\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobile();\r\n\r\n// Map<String, Promise<Object>\r\nconst resolveUrlCache = new Map();\r\nexport const getDefaultResolveQuality = (is360 = false) => {\r\n  const useLowerQuality = isMobile || isMobileVR;\r\n  return !is360 ? (useLowerQuality ? \"low\" : \"high\") : useLowerQuality ? \"low_360\" : \"high_360\";\r\n};\r\n\r\nexport const resolveUrl = async (url, quality = null, version = 1, bustCache) => {\r\n  const key = `${url}_${version}`;\r\n  if (!bustCache && resolveUrlCache.has(key)) return resolveUrlCache.get(key);\r\n\r\n  const resultPromise = fetch(mediaAPIEndpoint, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ media: { url, quality: quality || getDefaultResolveQuality() }, version })\r\n  }).then(async response => {\r\n    if (!response.ok) {\r\n      const message = `Error resolving url \"${url}\":`;\r\n      try {\r\n        const body = await response.text();\r\n        throw new Error(message + \" \" + body);\r\n      } catch (e) {\r\n        throw new Error(message + \" \" + response.statusText);\r\n      }\r\n    }\r\n    return response.json();\r\n  });\r\n\r\n  resolveUrlCache.set(key, resultPromise);\r\n  return resultPromise;\r\n};\r\n\r\nexport const upload = (file, desiredContentType) => {\r\n  const formData = new FormData();\r\n  formData.append(\"media\", file);\r\n  formData.append(\"promotion_mode\", \"with_token\");\r\n\r\n  if (desiredContentType) {\r\n    formData.append(\"desired_content_type\", desiredContentType);\r\n  }\r\n\r\n  // To eliminate the extra hop and avoid proxy timeouts, upload files directly\r\n  // to a reticulum host.\r\n  return fetch(getDirectMediaAPIEndpoint(), {\r\n    method: \"POST\",\r\n    body: formData\r\n  }).then(r => r.json());\r\n};\r\n\r\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\r\nfunction getOrientation(file, callback) {\r\n  const reader = new FileReader();\r\n  reader.onload = function(e) {\r\n    const view = new DataView(e.target.result);\r\n    if (view.getUint16(0, false) != 0xffd8) {\r\n      return callback(-2);\r\n    }\r\n    const length = view.byteLength;\r\n    let offset = 2;\r\n    while (offset < length) {\r\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\r\n      const marker = view.getUint16(offset, false);\r\n      offset += 2;\r\n      if (marker == 0xffe1) {\r\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\r\n          return callback(-1);\r\n        }\r\n\r\n        const little = view.getUint16((offset += 6), false) == 0x4949;\r\n        offset += view.getUint32(offset + 4, little);\r\n        const tags = view.getUint16(offset, little);\r\n        offset += 2;\r\n        for (let i = 0; i < tags; i++) {\r\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\r\n            return callback(view.getUint16(offset + i * 12 + 8, little));\r\n          }\r\n        }\r\n      } else if ((marker & 0xff00) != 0xff00) {\r\n        break;\r\n      } else {\r\n        offset += view.getUint16(offset, false);\r\n      }\r\n    }\r\n    return callback(-1);\r\n  };\r\n  reader.readAsArrayBuffer(file);\r\n}\r\n\r\nfunction getLatestMediaVersionOfSrc(src) {\r\n  const els = document.querySelectorAll(\"[media-loader]\");\r\n  let version = 1;\r\n\r\n  for (const el of els) {\r\n    const loader = el.components[\"media-loader\"];\r\n\r\n    if (loader.data && loader.data.src === src) {\r\n      version = Math.max(version, loader.data.version);\r\n    }\r\n  }\r\n\r\n  return version;\r\n}\r\n\r\nexport function coerceToUrl(urlOrText) {\r\n  if (!linkify.test(urlOrText)) return urlOrText;\r\n\r\n  // See: https://github.com/Soapbox/linkifyjs/blob/master/src/linkify.js#L52\r\n  return urlOrText.indexOf(\"://\") >= 0 ? urlOrText : `https://${urlOrText}`;\r\n}\r\n\r\nexport const addMedia = (\r\n  src,\r\n  template,\r\n  contentOrigin,\r\n  contentSubtype = null,\r\n  resolve = false,\r\n  fitToBox = false,\r\n  animate = true,\r\n  mediaOptions = {},\r\n  networked = true,\r\n  parentEl = null,\r\n  linkedEl = null\r\n) => {\r\n  const scene = AFRAME.scenes[0];\r\n\r\n  const entity = document.createElement(\"a-entity\");\r\n\r\n  if (networked) {\r\n    entity.setAttribute(\"networked\", { template: template });\r\n  } else {\r\n    const templateBody = document\r\n      .importNode(document.body.querySelector(template).content, true)\r\n      .firstElementChild.cloneNode(true);\r\n    const elAttrs = templateBody.attributes;\r\n\r\n    // Merge root element attributes with this entity\r\n    for (let attrIdx = 0; attrIdx < elAttrs.length; attrIdx++) {\r\n      entity.setAttribute(elAttrs[attrIdx].name, elAttrs[attrIdx].value);\r\n    }\r\n\r\n    // Append all child elements\r\n    while (templateBody.firstElementChild) {\r\n      entity.appendChild(templateBody.firstElementChild);\r\n    }\r\n  }\r\n\r\n  const needsToBeUploaded = src instanceof File;\r\n\r\n  // If we're re-pasting an existing src in the scene, we should use the latest version\r\n  // seen across any other entities. Otherwise, start with version 1.\r\n  const version = getLatestMediaVersionOfSrc(src);\r\n\r\n  entity.setAttribute(\"media-loader\", {\r\n    fitToBox,\r\n    resolve,\r\n    animate,\r\n    src: typeof src === \"string\" ? coerceToUrl(src) || src : \"\",\r\n    version,\r\n    contentSubtype,\r\n    fileIsOwned: !needsToBeUploaded,\r\n    linkedEl,\r\n    mediaOptions\r\n  });\r\n\r\n  entity.object3D.matrixNeedsUpdate = true;\r\n\r\n  (parentEl || scene).appendChild(entity);\r\n\r\n  const orientation = new Promise(function(resolve) {\r\n    if (needsToBeUploaded) {\r\n      getOrientation(src, x => {\r\n        resolve(x);\r\n      });\r\n    } else {\r\n      resolve(1);\r\n    }\r\n  });\r\n  if (needsToBeUploaded) {\r\n    // Video camera videos are converted to mp4 for compatibility\r\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : src.type || guessContentType(src.name);\r\n\r\n    upload(src, desiredContentType)\r\n      .then(response => {\r\n        const srcUrl = new URL(proxiedUrlFor(response.origin));\r\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\r\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\r\n        window.APP.store.update({\r\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\r\n        });\r\n      })\r\n      .catch(e => {\r\n        console.error(\"Media upload failed\", e);\r\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\r\n      });\r\n  } else if (src instanceof MediaStream) {\r\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\r\n  }\r\n\r\n  if (contentOrigin) {\r\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\r\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\r\n      scene.emit(\"object_spawned\", { objectType });\r\n    });\r\n  }\r\n\r\n  return { entity, orientation };\r\n};\r\n\r\nexport const cloneMedia = (sourceEl, template, src = null, networked = true, link = false, parentEl = null) => {\r\n  if (!src) {\r\n    ({ src } = sourceEl.components[\"media-loader\"].data);\r\n  }\r\n\r\n  const { contentSubtype, fitToBox, mediaOptions } = sourceEl.components[\"media-loader\"].data;\r\n\r\n  return addMedia(\r\n    src,\r\n    template,\r\n    ObjectContentOrigins.URL,\r\n    contentSubtype,\r\n    true,\r\n    fitToBox,\r\n    false,\r\n    mediaOptions,\r\n    networked,\r\n    parentEl,\r\n    link ? sourceEl : null\r\n  );\r\n};\r\n\r\nexport function injectCustomShaderChunks(obj) {\r\n  const vertexRegex = /\\bskinning_vertex\\b/;\r\n  const fragRegex = /\\bgl_FragColor\\b/;\r\n\r\n  const shaderUniforms = [];\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n\r\n  obj.traverse(object => {\r\n    if (!object.material) return;\r\n\r\n    object.material = mapMaterials(object, material => {\r\n      if (material.hubs_InjectedCustomShaderChunks) return material;\r\n      if (!validMaterials.includes(material.type)) {\r\n        return material;\r\n      }\r\n\r\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\r\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\r\n      // hover/toggle state, so for now just skip these while we figure out a more correct\r\n      // solution.\r\n      if (\r\n        object.el.classList.contains(\"ui\") ||\r\n        object.el.classList.contains(\"hud\") ||\r\n        object.el.getAttribute(\"text-button\")\r\n      )\r\n        return material;\r\n\r\n      // Used when the object is batched\r\n      if (batchManagerSystem.batchingEnabled) {\r\n        batchManagerSystem.meshToEl.set(object, obj.el);\r\n      }\r\n\r\n      const newMaterial = material.clone();\r\n      // This will not run if the object is never rendered unbatched, since its unbatched shader will never be compiled\r\n      newMaterial.onBeforeCompile = shader => {\r\n        if (!vertexRegex.test(shader.vertexShader)) return;\r\n\r\n        shader.uniforms.hubs_IsFrozen = { value: false };\r\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\r\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\r\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\r\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\r\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\r\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\r\n        shader.uniforms.hubs_Time = { value: 0 };\r\n\r\n        const vchunk = `\r\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\r\n          vec4 wt = modelMatrix * vec4(transformed, 1);\r\n\r\n          // Used in the fragment shader below.\r\n          hubs_WorldPosition = wt.xyz;\r\n        }\r\n        `;\r\n\r\n        const vlines = shader.vertexShader.split(\"\\n\");\r\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\r\n        vlines.splice(vindex + 1, 0, vchunk);\r\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\r\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\r\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\r\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\r\n        shader.vertexShader = vlines.join(\"\\n\");\r\n\r\n        const flines = shader.fragmentShader.split(\"\\n\");\r\n        const findex = flines.findIndex(line => fragRegex.test(line));\r\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\r\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\r\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\r\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\r\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\r\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\r\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\r\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\r\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\r\n        flines.unshift(\"uniform float hubs_Time;\");\r\n        shader.fragmentShader = flines.join(\"\\n\");\r\n\r\n        shaderUniforms.push(shader.uniforms);\r\n      };\r\n      newMaterial.needsUpdate = true;\r\n      newMaterial.hubs_InjectedCustomShaderChunks = true;\r\n      return newMaterial;\r\n    });\r\n  });\r\n\r\n  return shaderUniforms;\r\n}\r\n\r\nexport function getPromotionTokenForFile(fileId) {\r\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\r\n}\r\n\r\nconst mediaPos = new THREE.Vector3();\r\n\r\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false, distance = 0.75) {\r\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\r\n\r\n  const pos = el.object3D.position;\r\n\r\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\r\n  entity.object3D.rotation.copy(el.object3D.rotation);\r\n\r\n  if (mirrorOrientation) {\r\n    entity.object3D.rotateY(Math.PI);\r\n  }\r\n\r\n  // Generate photos in a circle around camera, starting from the bottom.\r\n  // Prevent z-fighting but place behind viewfinder\r\n  const idx = (snapCount % 6) + 3;\r\n\r\n  mediaPos.set(\r\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * distance,\r\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * distance,\r\n    -0.05 + idx * 0.001\r\n  );\r\n\r\n  el.object3D.localToWorld(mediaPos);\r\n  entity.object3D.visible = false;\r\n\r\n  const handler = () => {\r\n    entity.object3D.visible = true;\r\n    entity.setAttribute(\"animation__photo_pos\", {\r\n      property: \"position\",\r\n      dur: 800,\r\n      from: { x: pos.x, y: pos.y, z: pos.z },\r\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\r\n      easing: \"easeOutElastic\"\r\n    });\r\n  };\r\n\r\n  let eventType = null;\r\n\r\n  if (contentSubtype.startsWith(\"photo\")) {\r\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\r\n    eventType = \"photo\";\r\n  } else if (contentSubtype.startsWith(\"video\")) {\r\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\r\n    eventType = \"video\";\r\n  } else {\r\n    console.error(\"invalid type \" + contentSubtype);\r\n    return;\r\n  }\r\n\r\n  entity.object3D.matrixNeedsUpdate = true;\r\n\r\n  entity.addEventListener(\r\n    \"media_resolved\",\r\n    () => {\r\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\r\n    },\r\n    { once: true }\r\n  );\r\n\r\n  return { entity, orientation };\r\n}\r\n\r\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\r\n\r\nexport async function createImageTexture(url, filter) {\r\n  let texture;\r\n\r\n  if (filter) {\r\n    const image = new Image();\r\n    image.crossOrigin = \"anonymous\";\r\n    const load = new Promise(res => image.addEventListener(\"load\", res, { once: true }));\r\n    image.src = url;\r\n    await load;\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = image.width;\r\n    canvas.height = image.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(image, 0, 0);\r\n    await filter(ctx, image.width, image.height);\r\n\r\n    texture = new THREE.CanvasTexture(canvas);\r\n  } else {\r\n    texture = new THREE.Texture();\r\n\r\n    try {\r\n      await textureLoader.loadTextureAsync(texture, url);\r\n    } catch (e) {\r\n      throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\r\n    }\r\n  }\r\n\r\n  texture.encoding = THREE.sRGBEncoding;\r\n  texture.anisotropy = 4;\r\n\r\n  return texture;\r\n}\r\n\r\nimport HubsBasisTextureLoader from \"../loaders/HubsBasisTextureLoader\";\r\nexport const basisTextureLoader = new HubsBasisTextureLoader();\r\n\r\nexport function createBasisTexture(url) {\r\n  return new Promise((resolve, reject) => {\r\n    basisTextureLoader.load(\r\n      url,\r\n      function(texture) {\r\n        texture.encoding = THREE.sRGBEncoding;\r\n        texture.onUpdate = function() {\r\n          // Delete texture data once it has been uploaded to the GPU\r\n          texture.mipmaps.length = 0;\r\n        };\r\n        // texture.anisotropy = 4;\r\n        resolve(texture);\r\n      },\r\n      undefined,\r\n      function(error) {\r\n        console.error(error);\r\n        reject(new Error(`'${url}' could not be fetched (Error: ${error}`));\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nexport function addMeshScaleAnimation(mesh, initialScale, onComplete) {\r\n  const step = (function() {\r\n    const lastValue = {};\r\n    return function(anim) {\r\n      const value = anim.animatables[0].target;\r\n\r\n      value.x = Math.max(Number.MIN_VALUE, value.x);\r\n      value.y = Math.max(Number.MIN_VALUE, value.y);\r\n      value.z = Math.max(Number.MIN_VALUE, value.z);\r\n\r\n      // For animation timeline.\r\n      if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n        return;\r\n      }\r\n\r\n      lastValue.x = value.x;\r\n      lastValue.y = value.y;\r\n      lastValue.z = value.z;\r\n\r\n      mesh.scale.set(value.x, value.y, value.z);\r\n      mesh.matrixNeedsUpdate = true;\r\n    };\r\n  })();\r\n\r\n  const config = {\r\n    duration: 400,\r\n    easing: \"easeOutElastic\",\r\n    elasticity: 400,\r\n    loop: 0,\r\n    round: false,\r\n    x: mesh.scale.x,\r\n    y: mesh.scale.y,\r\n    z: mesh.scale.z,\r\n    targets: [initialScale],\r\n    update: anim => step(anim),\r\n    complete: anim => {\r\n      step(anim);\r\n      if (onComplete) onComplete();\r\n    }\r\n  };\r\n\r\n  mesh.scale.copy(initialScale);\r\n  mesh.matrixNeedsUpdate = true;\r\n\r\n  return anime(config);\r\n}\r\n\r\nexport function closeExistingMediaMirror() {\r\n  const mirrorTarget = document.querySelector(\"#media-mirror-target\");\r\n\r\n  // Remove old mirror target media element\r\n  if (mirrorTarget.firstChild) {\r\n    mirrorTarget.firstChild.setAttribute(\"animation__remove\", {\r\n      property: \"scale\",\r\n      dur: 200,\r\n      to: { x: 0.01, y: 0.01, z: 0.01 },\r\n      easing: \"easeInQuad\"\r\n    });\r\n\r\n    return new Promise(res => {\r\n      mirrorTarget.firstChild.addEventListener(\"animationcomplete\", () => {\r\n        mirrorTarget.removeChild(mirrorTarget.firstChild);\r\n        mirrorTarget.parentEl.object3D.visible = false;\r\n        res();\r\n      });\r\n    });\r\n  }\r\n}\r\n","// Utilities for manipulating state history. This provides a number of functions which\r\n// need to be used to manipulate history state so we can deal with edge cases around\r\n// entry back button and refreshes once entered.\r\n//\r\n// These functions also transparently deal with the room slug, so incoming calls can ignore\r\n// dealing with it, and provides APIs for getting the non-slug part of the path.\r\n//\r\n// The slug cannot be part of the basename for history, because the slug changes intra-session\r\n// if the room is renamed.\r\n\r\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\r\n// keys, or clears state if k if null.\r\n//\r\n// Also maintains a length key that can be used to find the length of the history chain\r\n// (across refreshes) for the current room.\r\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\r\n  let state = {};\r\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\r\n\r\n  if (k || newPathname || newSearch) {\r\n    state = history.location.state ? { ...history.location.state } : {};\r\n    delete state.__duplicate;\r\n\r\n    if (k) {\r\n      state[k] = v;\r\n      state.key = k;\r\n      state.value = v;\r\n      state.detail = detail;\r\n    }\r\n  }\r\n\r\n  const pathname =\r\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\r\n\r\n  const search = newSearch !== undefined ? newSearch : history.location.search;\r\n\r\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\r\n  // at the top of the history stack (which was needed to wipe out forward history)\r\n  // so we use this opportunity to replace it.\r\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\r\n  const method = replace || isDuplicate ? history.replace : history.push;\r\n  state.__historyLength = newLength;\r\n\r\n  method({ pathname, search, state });\r\n}\r\n\r\nexport function pushHistoryState(history, k, v, detail) {\r\n  pushOrUpdateHistory(history, false, k, v, detail);\r\n}\r\n\r\nexport function replaceHistoryState(history, k, v, detail) {\r\n  pushOrUpdateHistory(history, true, k, v, detail);\r\n}\r\n\r\nexport function pushHistoryPath(history, path, search) {\r\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\r\n}\r\n\r\nexport function clearHistoryState(history) {\r\n  pushOrUpdateHistory(history, false);\r\n}\r\n\r\n// This will pop the browser history to the first entry that was for this hubs room,\r\n// and then push a duplicate entry onto the history stack in order to wipe out forward\r\n// history.\r\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\r\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\r\n\r\n  const len = history.location.state.__historyLength;\r\n  if (len === 0) return;\r\n\r\n  return new Promise(resolve => {\r\n    // After the go() completes, we push a duplicate history entry onto the stack\r\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\r\n    // to go back to the prior page.\r\n    const unsubscribe = history.listen(() => {\r\n      unsubscribe();\r\n      history.push({\r\n        pathname: history.location.pathname,\r\n        search: history.location.search,\r\n        state: { __historyLength: 0, __duplicate: true }\r\n      });\r\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\r\n      resolve();\r\n    });\r\n\r\n    history.go(-len);\r\n  });\r\n}\r\n\r\n// This will pop the browser history to the entry before the first entry for this hubs room.\r\nexport function navigateToPriorPage(history) {\r\n  popToBeginningOfHubHistory(history, true);\r\n}\r\n\r\n// Returns the part of the pathname that does not include the slug\r\nexport function sluglessPath(location) {\r\n  const parts = location.pathname.split(\"/\");\r\n  return `/${parts.slice(2).join(\"/\")}`;\r\n}\r\n\r\n// Returns a new path that includes the current slug as a prefix to the\r\n// provided path.\r\nexport function withSlug(location, path) {\r\n  const parts = location.pathname.split(\"/\");\r\n  return `/${parts[1]}${path}`;\r\n}\r\n","/* global fetch THREE */\r\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\r\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\r\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\r\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\r\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\r\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\r\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\r\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\r\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\r\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\r\nimport URL_POP from \"../assets/sfx/pop.mp3\";\r\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\r\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\r\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\r\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\r\nimport URL_SPAWN_EMOJI from \"../assets/sfx/emoji.mp3\";\r\nimport { setMatrixWorld } from \"../utils/three-utils\";\r\n\r\nlet soundEnum = 0;\r\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\r\nexport const SOUND_THAW = soundEnum++;\r\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\r\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\r\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\r\nexport const SOUND_TOGGLE_MIC = soundEnum++;\r\nexport const SOUND_TELEPORT_START = soundEnum++;\r\nexport const SOUND_TELEPORT_END = soundEnum++;\r\nexport const SOUND_WAYPOINT_START = soundEnum++;\r\nexport const SOUND_WAYPOINT_END = soundEnum++;\r\nexport const SOUND_SNAP_ROTATE = soundEnum++;\r\nexport const SOUND_SPAWN_PEN = soundEnum++;\r\nexport const SOUND_PEN_START_DRAW = soundEnum++;\r\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\r\nexport const SOUND_ENTER_SCENE = soundEnum++;\r\nexport const SOUND_QUACK = soundEnum++;\r\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\r\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\r\nexport const SOUND_FREEZE = soundEnum++;\r\nexport const SOUND_PIN = soundEnum++;\r\nexport const SOUND_MEDIA_LOADING = soundEnum++;\r\nexport const SOUND_MEDIA_LOADED = soundEnum++;\r\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\r\nexport const SOUND_PREFERENCE_MENU_HOVER = soundEnum++;\r\nexport const SOUND_PREFERENCE_MENU_SELECT = soundEnum++;\r\nexport const SOUND_SPAWN_EMOJI = soundEnum++;\r\n\r\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\r\nfunction decodeAudioData(audioContext, arrayBuffer) {\r\n  return new Promise((resolve, reject) => {\r\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\r\n  });\r\n}\r\n\r\nexport class SoundEffectsSystem {\r\n  constructor(scene) {\r\n    this.pendingAudioSourceNodes = [];\r\n    this.pendingPositionalAudios = [];\r\n    this.positionalAudiosStationary = [];\r\n    this.positionalAudiosFollowingObject3Ds = [];\r\n\r\n    this.audioContext = THREE.AudioContext.getContext();\r\n    this.scene = scene;\r\n    this.scene.audioListener = this.scene.audioListener || new THREE.AudioListener();\r\n    if (this.scene.camera) {\r\n      this.scene.camera.add(this.scene.audioListener);\r\n    }\r\n    this.scene.addEventListener(\"camera-set-active\", evt => {\r\n      evt.detail.cameraEl.getObject3D(\"camera\").add(this.scene.audioListener);\r\n    });\r\n    const soundsAndUrls = [\r\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\r\n      [SOUND_THAW, URL_TICK],\r\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\r\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\r\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\r\n      [SOUND_TOGGLE_MIC, URL_TICK],\r\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\r\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\r\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\r\n      [SOUND_WAYPOINT_START, URL_QUICK_TURN],\r\n      [SOUND_WAYPOINT_END, URL_TICK],\r\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\r\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\r\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\r\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\r\n      [SOUND_ENTER_SCENE, URL_WELCOME],\r\n      [SOUND_QUACK, URL_QUACK],\r\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\r\n      [SOUND_CHAT_MESSAGE, URL_POP],\r\n      [SOUND_FREEZE, URL_FREEZE],\r\n      [SOUND_PIN, URL_TACK],\r\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\r\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED],\r\n      [SOUND_PREFERENCE_MENU_HOVER, URL_FREEZE],\r\n      [SOUND_PREFERENCE_MENU_SELECT, URL_TICK],\r\n      [SOUND_SPAWN_EMOJI, URL_SPAWN_EMOJI]\r\n    ];\r\n    const loading = new Map();\r\n    const load = url => {\r\n      let audioBufferPromise = loading.get(url);\r\n      if (!audioBufferPromise) {\r\n        audioBufferPromise = fetch(url)\r\n          .then(r => r.arrayBuffer())\r\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\r\n        loading.set(url, audioBufferPromise);\r\n      }\r\n      return audioBufferPromise;\r\n    };\r\n    this.sounds = new Map();\r\n    soundsAndUrls.map(([sound, url]) => {\r\n      load(url).then(audioBuffer => {\r\n        this.sounds.set(sound, audioBuffer);\r\n      });\r\n    });\r\n  }\r\n\r\n  enqueueSound(sound, loop) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n    // The nodes are very inexpensive to create, according to\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\r\n    const source = this.audioContext.createBufferSource();\r\n    source.buffer = audioBuffer;\r\n    source.connect(this.audioContext.destination);\r\n    source.loop = loop;\r\n    this.pendingAudioSourceNodes.push(source);\r\n    return source;\r\n  }\r\n\r\n  enqueuePositionalSound(sound, loop) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n\r\n    const positionalAudio = new THREE.PositionalAudio(this.scene.audioListener).setBuffer(audioBuffer);\r\n    positionalAudio.loop = loop;\r\n    this.pendingPositionalAudios.push(positionalAudio);\r\n    return positionalAudio;\r\n  }\r\n\r\n  playPositionalSoundAt(sound, position, loop) {\r\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\r\n    if (!positionalAudio) return null;\r\n    positionalAudio.position.copy(position);\r\n    positionalAudio.matrixWorldNeedsUpdate = true;\r\n    this.positionalAudiosStationary.push(positionalAudio);\r\n  }\r\n\r\n  playPositionalSoundFollowing(sound, object3D, loop) {\r\n    const positionalAudio = this.enqueuePositionalSound(sound, loop);\r\n    if (!positionalAudio) return null;\r\n    this.positionalAudiosFollowingObject3Ds.push({ positionalAudio, object3D });\r\n    return positionalAudio;\r\n  }\r\n\r\n  playSoundOneShot(sound) {\r\n    return this.enqueueSound(sound, false);\r\n  }\r\n\r\n  playSoundLooped(sound) {\r\n    return this.enqueueSound(sound, true);\r\n  }\r\n\r\n  playSoundLoopedWithGain(sound) {\r\n    const audioBuffer = this.sounds.get(sound);\r\n    if (!audioBuffer) return null;\r\n\r\n    const source = this.audioContext.createBufferSource();\r\n    const gain = this.audioContext.createGain();\r\n    source.buffer = audioBuffer;\r\n    source.connect(gain);\r\n    gain.connect(this.audioContext.destination);\r\n    source.loop = true;\r\n    this.pendingAudioSourceNodes.push(source);\r\n    return { gain, source };\r\n  }\r\n\r\n  stopSoundNode(node) {\r\n    const index = this.pendingAudioSourceNodes.indexOf(node);\r\n    if (index !== -1) {\r\n      this.pendingAudioSourceNodes.splice(index, 1);\r\n    } else {\r\n      node.stop();\r\n    }\r\n  }\r\n\r\n  stopPositionalAudio(inPositionalAudio) {\r\n    const pendingIndex = this.pendingPositionalAudios.indexOf(inPositionalAudio);\r\n    if (pendingIndex !== -1) {\r\n      this.pendingPositionalAudios.splice(pendingIndex, 1);\r\n    } else {\r\n      if (inPositionalAudio.isPlaying) {\r\n        inPositionalAudio.stop();\r\n      }\r\n      if (inPositionalAudio.parent) {\r\n        inPositionalAudio.parent.remove(inPositionalAudio);\r\n      }\r\n    }\r\n    this.positionalAudiosStationary = this.positionalAudiosStationary.filter(\r\n      positionalAudio => positionalAudio !== inPositionalAudio\r\n    );\r\n    this.positionalAudiosFollowingObject3Ds = this.positionalAudiosFollowingObject3Ds.filter(\r\n      ({ positionalAudio }) => positionalAudio !== inPositionalAudio\r\n    );\r\n  }\r\n\r\n  tick() {\r\n    for (let i = 0; i < this.pendingAudioSourceNodes.length; i++) {\r\n      this.pendingAudioSourceNodes[i].start();\r\n    }\r\n    this.pendingAudioSourceNodes.length = 0;\r\n\r\n    for (let i = 0; i < this.pendingPositionalAudios.length; i++) {\r\n      const pendingPositionalAudio = this.pendingPositionalAudios[i];\r\n      this.scene.object3D.add(pendingPositionalAudio);\r\n      pendingPositionalAudio.play();\r\n    }\r\n    this.pendingPositionalAudios.length = 0;\r\n\r\n    for (let i = this.positionalAudiosStationary.length - 1; i >= 0; i--) {\r\n      const positionalAudio = this.positionalAudiosStationary[i];\r\n      if (!positionalAudio.isPlaying) {\r\n        this.stopPositionalAudio(positionalAudio);\r\n      }\r\n    }\r\n\r\n    for (let i = this.positionalAudiosFollowingObject3Ds.length - 1; i >= 0; i--) {\r\n      const positionalAudioAndObject3D = this.positionalAudiosFollowingObject3Ds[i];\r\n      const positionalAudio = positionalAudioAndObject3D.positionalAudio;\r\n      const object3D = positionalAudioAndObject3D.object3D;\r\n      if (!positionalAudio.isPlaying || !object3D.parent) {\r\n        this.stopPositionalAudio(positionalAudio);\r\n      } else {\r\n        object3D.updateMatrices();\r\n        setMatrixWorld(positionalAudio, object3D.matrixWorld);\r\n      }\r\n    }\r\n  }\r\n}\r\n","const qs = new URLSearchParams(location.search);\r\n\r\nexport default function qsTruthy(param) {\r\n  const val = qs.get(param);\r\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\r\n  return val === \"\" || /1|on|true|yes/i.test(val);\r\n}\r\n\r\nexport function qsGet(param) {\r\n  return qs.get(param);\r\n}\r\n","import configs from \"../utils/configs\";\r\n\r\nexport default function IfFeature(props) {\r\n  return (configs.feature(props.name) && props.children) || null;\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nexport default class DialogContainer extends Component {\r\n  static propTypes = {\r\n    title: PropTypes.node,\r\n    children: PropTypes.node.isRequired,\r\n    onClose: PropTypes.func,\r\n    closable: PropTypes.bool,\r\n    wide: PropTypes.bool,\r\n    noOverlay: PropTypes.bool,\r\n    className: PropTypes.string,\r\n    allowOverflow: PropTypes.bool,\r\n    additionalClass: PropTypes.string\r\n  };\r\n\r\n  static defaultProps = {\r\n    closable: true\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n    this.onContainerClicked = this.onContainerClicked.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    window.addEventListener(\"keydown\", this.onKeyDown);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"keydown\", this.onKeyDown);\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    if (this.props.closable && e.key === \"Escape\") {\r\n      this.props.onClose();\r\n    }\r\n  }\r\n\r\n  onContainerClicked = e => {\r\n    if (this.props.closable && e.currentTarget === e.target) {\r\n      this.props.onClose();\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className={classNames(\r\n          \"dialog-overlay\",\r\n          this.props.noOverlay ? \"dialog-overlay__no-pointer-events\" : \"\",\r\n          this.props.className\r\n        )}\r\n      >\r\n        <div\r\n          className={classNames(\r\n            \"dialog\",\r\n            this.props.noOverlay ? \"dialog__no-pointer-events\" : \"dialog__dark-background\",\r\n            this.props.noOverlay ? \"dialog__align-end\" : \"\"\r\n          )}\r\n          onClick={this.onContainerClicked}\r\n        >\r\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\r\n            <div\r\n              className={classNames(\r\n                \"dialog__box__contents\",\r\n                this.props.allowOverflow ? \"dialog__box__contents-overflow\" : null,\r\n                this.props.additionalClass\r\n              )}\r\n            >\r\n              {this.props.closable &&\r\n                this.props.onClose &&\r\n                !this.props.noOverlay && (\r\n                  <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\r\n                    <i>\r\n                      <FontAwesomeIcon icon={faTimes} />\r\n                    </i>\r\n                  </button>\r\n                )}\r\n              {this.props.title && <div className=\"dialog__box__contents__title\">{this.props.title}</div>}\r\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\r\n              <div className=\"dialog__box__contents__button-container\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nexport const ReactAudioContext = React.createContext({});\r\n\r\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\r\n\r\nexport const WithHoverSound = ({ sound, children }) => {\r\n  return (\r\n    <ReactAudioContext.Consumer>\r\n      {context => {\r\n        return React.cloneElement(children, {\r\n          onMouseEnter: e => {\r\n            if (context && context.playSound) {\r\n              context.playSound(sound || hudHoverSound);\r\n            }\r\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\r\n          }\r\n        });\r\n      }}\r\n    </ReactAudioContext.Consumer>\r\n  );\r\n};\r\n\r\nWithHoverSound.propTypes = {\r\n  children: PropTypes.object,\r\n  sound: PropTypes.string\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"entry-button-secondary\":\"entry__entry-button-secondary__2Gv8L\",\"entryButtonSecondary\":\"entry__entry-button-secondary__2Gv8L\",\"entry-panel\":\"entry__entry-panel__1QyDv\",\"entryPanel\":\"entry__entry-panel__1QyDv\",\"button-container\":\"entry__button-container__2yj-v\",\"buttonContainer\":\"entry__button-container__2yj-v\",\"secondary-action-button\":\"entry__secondary-action-button__3R8zv\",\"secondaryActionButton\":\"entry__secondary-action-button__3R8zv\",\"entry-button\":\"entry__entry-button__2RPjC\",\"entryButton\":\"entry__entry-button__2RPjC\",\"action-button\":\"entry__action-button__zJFiY\",\"actionButton\":\"entry__action-button__zJFiY\",\"collapse-button\":\"entry__collapse-button__2QZqx\",\"collapseButton\":\"entry__collapse-button__2QZqx\",\"favorite-button\":\"entry__favorite-button__1FYya\",\"favoriteButton\":\"entry__favorite-button__1FYya\",\"back\":\"entry__back__1ju07\",\"lobby-label\":\"entry__lobby-label__eJhNf\",\"lobbyLabel\":\"entry__lobby-label__eJhNf\",\"label\":\"entry__label__1xFFp\",\"title\":\"entry__title__2uzZ9\",\"name\":\"entry__name__3UgEA\",\"rename-button\":\"entry__rename-button__1vjFo\",\"renameButton\":\"entry__rename-button__1vjFo\",\"center\":\"entry__center__20-Iy\",\"wide-button\":\"entry__wide-button__AEhcL\",\"wideButton\":\"entry__wide-button__AEhcL\",\"screen-sharing\":\"entry__screen-sharing__39qDI\",\"screenSharing\":\"entry__screen-sharing__39qDI\",\"checkbox\":\"entry__checkbox__2Rwrl\",\"entry-dialog\":\"entry__entry-dialog__2hYda\",\"entryDialog\":\"entry__entry-dialog__2hYda\",\"favorited\":\"entry__favorited__3nDE4\",\"icon\":\"entry__icon__3ES9L\",\"bolded\":\"entry__bolded__29CDZ\",\"subtitle\":\"entry__subtitle__2qdPo\",\"room-subtitle\":\"entry__room-subtitle__17Bvw\",\"roomSubtitle\":\"entry__room-subtitle__17Bvw\",\"lobby\":\"entry__lobby__3s129\",\"profile-icon\":\"entry__profile-icon__2YMAl\",\"profileIcon\":\"entry__profile-icon__2YMAl\",\"button-subtitle\":\"entry__button-subtitle__VRK7r\",\"buttonSubtitle\":\"entry__button-subtitle__VRK7r\",\"audio-loader\":\"entry__audio-loader__1Z0me\",\"audioLoader\":\"entry__audio-loader__1Z0me\",\"webvr-link-container\":\"entry__webvr-link-container__1UI8I\",\"webvrLinkContainer\":\"entry__webvr-link-container__1UI8I\",\"webvr-link\":\"entry__webvr-link__-UkE1\",\"webvrLink\":\"entry__webvr-link__-UkE1\",\"secondary\":\"entry__secondary__2Qs02\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"secondary-button\":\"settings-menu__secondary-button__2CBK3\",\"secondaryButton\":\"settings-menu__secondary-button__2CBK3\",\"bottom-links-main\":\"settings-menu__bottom-links-main__1aPW5\",\"bottomLinksMain\":\"settings-menu__bottom-links-main__1aPW5\",\"bottom-links\":\"settings-menu__bottom-links__19PM2\",\"bottomLinks\":\"settings-menu__bottom-links__19PM2\",\"close-button\":\"settings-menu__close-button__2RKS-\",\"closeButton\":\"settings-menu__close-button__2RKS-\",\"settings-menu-drop\":\"settings-menu__settings-menu-drop__-4bIi\",\"settingsMenuDrop\":\"settings-menu__settings-menu-drop__-4bIi\",\"attach-point\":\"settings-menu__attach-point__If1GZ\",\"attachPoint\":\"settings-menu__attach-point__If1GZ\",\"contents\":\"settings-menu__contents__1gjjE\",\"rows\":\"settings-menu__rows__2sPIS\",\"row\":\"settings-menu__row__Yn9x0\",\"row-no-margin\":\"settings-menu__row-no-margin__2m0Ha\",\"rowNoMargin\":\"settings-menu__row-no-margin__2m0Ha\",\"row-header\":\"settings-menu__row-header__2V0ZJ\",\"rowHeader\":\"settings-menu__row-header__2V0ZJ\",\"list-item\":\"settings-menu__list-item__2ejL1\",\"listItem\":\"settings-menu__list-item__2ejL1\",\"list-item-link\":\"settings-menu__list-item-link__2isNZ\",\"listItemLink\":\"settings-menu__list-item-link__2isNZ\",\"settings-menu-overlay-wrap\":\"settings-menu__settings-menu-overlay-wrap__2n1IJ\",\"settingsMenuOverlayWrap\":\"settings-menu__settings-menu-overlay-wrap__2n1IJ\",\"settings-menu-overlay\":\"settings-menu__settings-menu-overlay__HYQTq\",\"settingsMenuOverlay\":\"settings-menu__settings-menu-overlay__HYQTq\",\"settings-row\":\"settings-menu__settings-row__21Hop\",\"settingsRow\":\"settings-menu__settings-row__21Hop\",\"icon\":\"settings-menu__icon__5EzMW\",\"secondary-link-item\":\"settings-menu__secondary-link-item__2z_8N\",\"secondaryLinkItem\":\"settings-menu__secondary-link-item__2z_8N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ui\":\"ui-root__ui__3D1Np\",\"ui-dialog\":\"ui-root__ui-dialog__3E0sU\",\"uiDialog\":\"ui-root__ui-dialog__3E0sU\",\"ui-interactive\":\"ui-root__ui-interactive__3x9ZM\",\"uiInteractive\":\"ui-root__ui-interactive__3x9ZM\",\"object-list\":\"ui-root__object-list__34oNe\",\"objectList\":\"ui-root__object-list__34oNe\",\"presence-info\":\"ui-root__presence-info__2EEuj\",\"presenceInfo\":\"ui-root__presence-info__2EEuj\",\"corner-button\":\"ui-root__corner-button__2DZWu\",\"cornerButton\":\"ui-root__corner-button__2DZWu\",\"nag-corner-button\":\"ui-root__nag-corner-button__3JzqS\",\"nagCornerButton\":\"ui-root__nag-corner-button__3JzqS\",\"choose-scene-button\":\"ui-root__choose-scene-button__2YksT\",\"chooseSceneButton\":\"ui-root__choose-scene-button__2YksT\",\"leave-button\":\"ui-root__leave-button__yjDSy\",\"leaveButton\":\"ui-root__leave-button__yjDSy\",\"interstitial\":\"ui-root__interstitial__1hAXJ\",\"invite-tip\":\"ui-root__invite-tip__p4WVu\",\"inviteTip\":\"ui-root__invite-tip__p4WVu\",\"streaming-tip\":\"ui-root__streaming-tip__3ol4I\",\"streamingTip\":\"ui-root__streaming-tip__3ol4I\",\"streaming-tip-attach-point\":\"ui-root__streaming-tip-attach-point__3e-kO\",\"streamingTipAttachPoint\":\"ui-root__streaming-tip-attach-point__3e-kO\",\"streaming-tip-close\":\"ui-root__streaming-tip-close__HFVD7\",\"streamingTipClose\":\"ui-root__streaming-tip-close__HFVD7\",\"streaming-tip-message\":\"ui-root__streaming-tip-message__2uY2i\",\"streamingTipMessage\":\"ui-root__streaming-tip-message__2uY2i\",\"ui-dialog-box-contents\":\"ui-root__ui-dialog-box-contents__2Lyac\",\"uiDialogBoxContents\":\"ui-root__ui-dialog-box-contents__2Lyac\",\"backgrounded\":\"ui-root__backgrounded__ZylE6\",\"in-room-favorite-button\":\"ui-root__in-room-favorite-button__7ZQG5\",\"inRoomFavoriteButton\":\"ui-root__in-room-favorite-button__7ZQG5\",\"help-button\":\"ui-root__help-button__DqvtK\",\"helpButton\":\"ui-root__help-button__DqvtK\",\"occupant-count\":\"ui-root__occupant-count__2W1X_\",\"occupantCount\":\"ui-root__occupant-count__2W1X_\",\"presence-info-selected\":\"ui-root__presence-info-selected__2-Hga\",\"presenceInfoSelected\":\"ui-root__presence-info-selected__2-Hga\",\"camera-mode-exit-button\":\"ui-root__camera-mode-exit-button__2GpRN\",\"cameraModeExitButton\":\"ui-root__camera-mode-exit-button__2GpRN\",\"corner-button-selected\":\"ui-root__corner-button-selected__nFTJm\",\"cornerButtonSelected\":\"ui-root__corner-button-selected__nFTJm\",\"invite-tip-attach-point\":\"ui-root__invite-tip-attach-point__2o5IV\",\"inviteTipAttachPoint\":\"ui-root__invite-tip-attach-point__2o5IV\",\"avatar-editor\":\"ui-root__avatar-editor__2GpWm\",\"avatarEditor\":\"ui-root__avatar-editor__2GpWm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"room-info-dialog__title__Q-4Cv\",\"room-info\":\"room-info-dialog__room-info__11DPZ\",\"roomInfo\":\"room-info-dialog__room-info__11DPZ\",\"scene-screenshot\":\"room-info-dialog__scene-screenshot__qBYcV\",\"sceneScreenshot\":\"room-info-dialog__scene-screenshot__qBYcV\",\"scene-details\":\"room-info-dialog__scene-details__1iqpD\",\"sceneDetails\":\"room-info-dialog__scene-details__1iqpD\",\"scene-main\":\"room-info-dialog__scene-main__Ut61u\",\"sceneMain\":\"room-info-dialog__scene-main__Ut61u\",\"scene-name\":\"room-info-dialog__scene-name__2_zua\",\"sceneName\":\"room-info-dialog__scene-name__2_zua\",\"scene-creator\":\"room-info-dialog__scene-creator__3FlPc\",\"sceneCreator\":\"room-info-dialog__scene-creator__3FlPc\",\"scene-attributions\":\"room-info-dialog__scene-attributions__wCin2\",\"sceneAttributions\":\"room-info-dialog__scene-attributions__wCin2\",\"attribution\":\"room-info-dialog__attribution__B4omT\",\"attribution-name\":\"room-info-dialog__attribution-name__259N9\",\"attributionName\":\"room-info-dialog__attribution-name__259N9\",\"attribution-author\":\"room-info-dialog__attribution-author__3zmlb\",\"attributionAuthor\":\"room-info-dialog__attribution-author__3zmlb\",\"description\":\"room-info-dialog__description__1tl3L\",\"subtitle\":\"room-info-dialog__subtitle__17wES\",\"hub-title\":\"room-info-dialog__hub-title__1EIq-\",\"hubTitle\":\"room-info-dialog__hub-title__1EIq-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"presence-log\":\"presence-log__presence-log__17lUR\",\"presenceLog\":\"presence-log__presence-log__17lUR\",\"presence-log-entry\":\"presence-log__presence-log-entry__spVNj\",\"presenceLogEntry\":\"presence-log__presence-log-entry__spVNj\",\"message-body\":\"presence-log__message-body__3egxe\",\"messageBody\":\"presence-log__message-body__3egxe\",\"message-body-multi\":\"presence-log__message-body-multi__MnnIP\",\"messageBodyMulti\":\"presence-log__message-body-multi__MnnIP\",\"message-body-mono\":\"presence-log__message-body-mono__2BY1M\",\"messageBodyMono\":\"presence-log__message-body-mono__2BY1M\",\"message-wrap\":\"presence-log__message-wrap__6SA1O\",\"messageWrap\":\"presence-log__message-wrap__6SA1O\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__3kNxM\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__3kNxM\",\"message-source\":\"presence-log__message-source__2_U0y\",\"messageSource\":\"presence-log__message-source__2_U0y\",\"message-source-link\":\"presence-log__message-source-link__19svP\",\"messageSourceLink\":\"presence-log__message-source-link__19svP\",\"icon-button\":\"presence-log__icon-button__15bSk\",\"iconButton\":\"presence-log__icon-button__15bSk\",\"spawn-message\":\"presence-log__spawn-message__Q5HR5\",\"spawnMessage\":\"presence-log__spawn-message__Q5HR5\",\"share\":\"presence-log__share__1DUKJ\",\"media\":\"presence-log__media__1H9Sw\",\"mediaBody\":\"presence-log__mediaBody__2Jr3l\",\"expired\":\"presence-log__expired__2pqi5\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__1HsV0\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__1HsV0\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__2VyQB\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__2VyQB\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__1_xBV\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__1_xBV\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__GYAO3\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__GYAO3\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__1cbZt\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__1cbZt\",\"emoji\":\"presence-log__emoji__34NW3\"};","import screenfull from \"screenfull\";\r\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\r\nconst { detect } = require(\"detect-browser\");\r\n\r\nconst browser = detect();\r\nlet isExitingFullscreenDueToFocus = false;\r\n\r\n// Utility function that handles a bunch of incidental stuff related to text fields:\r\n//\r\n// - On non-mobile platforms, selects the value on focus\r\n// - If full screen, exits/enters full screen because of firefox full screen issues\r\nexport function handleTextFieldFocus(target) {\r\n  if (!window.AFRAME) return;\r\n  const isMobile = AFRAME.utils.device.isMobile();\r\n\r\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\r\n    // This will prevent focus, but its the only way to avoid getting into a\r\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\r\n    // twice to ultimately get the focus.\r\n    //\r\n    // We need to keep track of a bit here so that we don't re-full screen when\r\n    // the text box is blurred by the browser.\r\n\r\n    isExitingFullscreenDueToFocus = true;\r\n    screenfull.exit().then(() => {\r\n      target.focus();\r\n    });\r\n  }\r\n\r\n  if (!isMobile) target.select();\r\n}\r\n\r\nexport function handleTextFieldBlur() {\r\n  // This is the incidental blur event when exiting fullscreen mode on mobile\r\n  if (isExitingFullscreenDueToFocus) {\r\n    isExitingFullscreenDueToFocus = false;\r\n    return;\r\n  }\r\n\r\n  showFullScreenIfWasFullScreen();\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"max-resolution-preference-item\":\"preferences-screen__max-resolution-preference-item__3Mr-g\",\"maxResolutionPreferenceItem\":\"preferences-screen__max-resolution-preference-item__3Mr-g\",\"number-with-range\":\"preferences-screen__number-with-range__7OhNV\",\"numberWithRange\":\"preferences-screen__number-with-range__7OhNV\",\"number-in-number-with-range\":\"preferences-screen__number-in-number-with-range__275RY\",\"numberInNumberWithRange\":\"preferences-screen__number-in-number-with-range__275RY\",\"preference-list-item\":\"preferences-screen__preference-list-item__2Awel\",\"preferenceListItem\":\"preferences-screen__preference-list-item__2Awel\",\"dropdown\":\"preferences-screen__dropdown__3cnrO\",\"content-container\":\"preferences-screen__content-container__954bc\",\"contentContainer\":\"preferences-screen__content-container__954bc\",\"panel-margin\":\"preferences-screen__panel-margin__2K94m\",\"panelMargin\":\"preferences-screen__panel-margin__2K94m\",\"close-button\":\"preferences-screen__close-button__B6Hli\",\"closeButton\":\"preferences-screen__close-button__B6Hli\",\"dropdownArrow\":\"preferences-screen__dropdownArrow__3j3sV\",\"preference-list-non-checkbox\":\"preferences-screen__preference-list-non-checkbox__1ph5-\",\"preferenceListNonCheckbox\":\"preferences-screen__preference-list-non-checkbox__1ph5-\",\"part\":\"preferences-screen__part__35Auu\",\"checkbox-margin\":\"preferences-screen__checkbox-margin__1mUwC\",\"checkboxMargin\":\"preferences-screen__checkbox-margin__1mUwC\",\"left\":\"preferences-screen__left__B166l\",\"right\":\"preferences-screen__right__nl5N6\",\"preferences-panel\":\"preferences-screen__preferences-panel__M1Bum\",\"preferencesPanel\":\"preferences-screen__preferences-panel__M1Bum\",\"scrolling-content\":\"preferences-screen__scrolling-content__h22jZ\",\"scrollingContent\":\"preferences-screen__scrolling-content__h22jZ\",\"section-bar\":\"preferences-screen__section-bar__3sYZ4\",\"sectionBar\":\"preferences-screen__section-bar__3sYZ4\",\"section-title\":\"preferences-screen__section-title__1Gm6m\",\"sectionTitle\":\"preferences-screen__section-title__1Gm6m\",\"checkbox\":\"preferences-screen__checkbox__3rEjR\",\"row\":\"preferences-screen__row__2DqxG\",\"row-name\":\"preferences-screen__row-name__1tggv\",\"rowName\":\"preferences-screen__row-name__1tggv\",\"reset-to-default-button\":\"preferences-screen__reset-to-default-button__38WFX\",\"resetToDefaultButton\":\"preferences-screen__reset-to-default-button__38WFX\",\"prev-option-scale\":\"preferences-screen__prev-option-scale__CsRkR\",\"prevOptionScale\":\"preferences-screen__prev-option-scale__CsRkR\",\"next-option-scale\":\"preferences-screen__next-option-scale__1Onhz\",\"nextOptionScale\":\"preferences-screen__next-option-scale__1Onhz\",\"prev-option-hovered-scale\":\"preferences-screen__prev-option-hovered-scale__1hLMG\",\"prevOptionHoveredScale\":\"preferences-screen__prev-option-hovered-scale__1hLMG\",\"next-option-hovered-scale\":\"preferences-screen__next-option-hovered-scale__2w9CL\",\"nextOptionHoveredScale\":\"preferences-screen__next-option-hovered-scale__2w9CL\",\"range-slider\":\"preferences-screen__range-slider__1ll_Z\",\"rangeSlider\":\"preferences-screen__range-slider__1ll_Z\"};","// Enumeration of spawned object content origins. URL means the content is\r\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\r\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\r\n// it was copied over from a spawner.\r\nexport const ObjectContentOrigins = {\r\n  URL: 1,\r\n  FILE: 2,\r\n  CLIPBOARD: 3,\r\n  SPAWNER: 4\r\n};\r\n\r\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\r\n// both the origin of the content for the object and also the type of content\r\n// contained in the object.\r\nexport const ObjectTypes = {\r\n  URL_IMAGE: 0,\r\n  URL_VIDEO: 1,\r\n  URL_MODEL: 2,\r\n  URL_PDF: 3,\r\n  URL_AUDIO: 4,\r\n  //URL_TEXT: 5,\r\n  //URL_TELEPORTER: 6,\r\n  FILE_IMAGE: 8,\r\n  FILE_VIDEO: 9,\r\n  FILE_MODEL: 10,\r\n  FILE_PDF: 11,\r\n  FILE_AUDIO: 12,\r\n  //FILE_TEXT: 13,\r\n  CLIPBOARD_IMAGE: 16,\r\n  CLIPBOARD_VIDEO: 17,\r\n  CLIPBOARD_MODEL: 18,\r\n  CLIPBOARD_PDF: 19,\r\n  CLIPBOARD_AUDIO: 20,\r\n  //CLIPBOARD_TEXT: 21,\r\n  SPAWNER_IMAGE: 24,\r\n  SPAWNER_VIDEO: 25,\r\n  SPAWNER_MODEL: 26,\r\n  SPAWNER_PDF: 27,\r\n  SPAWNER_AUDIO: 28,\r\n  //SPAWNER_TEXT: 29,\r\n  CAMERA: 30,\r\n  UNKNOWN: 31\r\n};\r\n\r\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\r\n// origins respectively, return the appropriate one\r\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\r\n  if (contentOrigin === ObjectContentOrigins.URL) {\r\n    return urlType;\r\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\r\n    return fileType;\r\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\r\n    return clipboardType;\r\n  } else {\r\n    return spawnerType;\r\n  }\r\n}\r\n\r\n// Lookup table of mime-type prefixes to the set of object types that we should use\r\n// for objects spawned matching their underlying Content-Type.\r\nconst objectTypeMimePrefixLookupMap = {\r\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\r\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\r\n  \"application/x-zip-compressed\": [\r\n    ObjectTypes.URL_MODEL,\r\n    ObjectTypes.FILE_MODEL,\r\n    ObjectTypes.CLIPBOARD_MODEL,\r\n    ObjectTypes.SPAWNER_MODEL\r\n  ],\r\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\r\n  \"application/vnd.apple.mpegurl\": [\r\n    ObjectTypes.URL_VIDEO,\r\n    ObjectTypes.FILE_VIDEO,\r\n    ObjectTypes.CLIPBOARD_VIDEO,\r\n    ObjectTypes.SPAWNER_VIDEO\r\n  ],\r\n  \"application/x-mpegurl\": [\r\n    ObjectTypes.URL_VIDEO,\r\n    ObjectTypes.FILE_VIDEO,\r\n    ObjectTypes.CLIPBOARD_VIDEO,\r\n    ObjectTypes.SPAWNER_VIDEO\r\n  ],\r\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\r\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\r\n};\r\n\r\nconst srcSuffixLookupMap = {\r\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\r\n};\r\n\r\n// Given an content origin and the resolved mime type of a piece of content, return\r\n// the ObjectType, if any, for that content.\r\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\r\n  for (const prefix in objectTypeMimePrefixLookupMap) {\r\n    if (contentType.toLowerCase().startsWith(prefix)) {\r\n      const types = objectTypeMimePrefixLookupMap[prefix];\r\n      return objectTypeForOrigin(contentOrigin, ...types);\r\n    }\r\n  }\r\n\r\n  if (src) {\r\n    for (const suffix in srcSuffixLookupMap) {\r\n      if (src.toLowerCase().endsWith(suffix)) {\r\n        const types = srcSuffixLookupMap[suffix];\r\n        return objectTypeForOrigin(contentOrigin, ...types);\r\n      }\r\n    }\r\n  }\r\n\r\n  return ObjectTypes.UNKNOWN;\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"_2d-hud__panel__3tCpT\",\"tip-cancel-text\":\"_2d-hud__tip-cancel-text__1J3BH\",\"tipCancelText\":\"_2d-hud__tip-cancel-text__1J3BH\",\"top-tip\":\"_2d-hud__top-tip__2ilUL\",\"topTip\":\"_2d-hud__top-tip__2ilUL\",\"container\":\"_2d-hud__container__22Xyy\",\"top\":\"_2d-hud__top__3jv3E\",\"column\":\"_2d-hud__column__2NwM1\",\"bottom\":\"_2d-hud__bottom__3p9Rx\",\"hide\":\"_2d-hud__hide__2Q54K\",\"attach-point\":\"_2d-hud__attach-point__3tsDz\",\"attachPoint\":\"_2d-hud__attach-point__3tsDz\",\"attach_video_share_mode\":\"_2d-hud__attach_video_share_mode__3_A0u\",\"attachVideoShareMode\":\"_2d-hud__attach_video_share_mode__3_A0u\",\"attach_video_share_failed\":\"_2d-hud__attach_video_share_failed__2iYhT\",\"attachVideoShareFailed\":\"_2d-hud__attach_video_share_failed__2iYhT\",\"attach_pen_mode\":\"_2d-hud__attach_pen_mode__2hwmX\",\"attachPenMode\":\"_2d-hud__attach_pen_mode__2hwmX\",\"attach_mute_mode\":\"_2d-hud__attach_mute_mode__DzX4Y\",\"attachMuteMode\":\"_2d-hud__attach_mute_mode__DzX4Y\",\"attach_freeze_mode\":\"_2d-hud__attach_freeze_mode__pfuhi\",\"attachFreezeMode\":\"_2d-hud__attach_freeze_mode__pfuhi\",\"top-tip-no-hud\":\"_2d-hud__top-tip-no-hud__XXkM0\",\"topTipNoHud\":\"_2d-hud__top-tip-no-hud__XXkM0\",\"tip-cancel\":\"_2d-hud__tip-cancel__1W-wz\",\"tipCancel\":\"_2d-hud__tip-cancel__1W-wz\",\"video-share-extra-options\":\"_2d-hud__video-share-extra-options__2nAT0\",\"videoShareExtraOptions\":\"_2d-hud__video-share-extra-options__2nAT0\",\"iconButton\":\"_2d-hud__iconButton__35Z1N\",\"up\":\"_2d-hud__up__1aEN3\",\"iconButtonIcon\":\"_2d-hud__iconButtonIcon__3GFYG\",\"spawn\":\"_2d-hud__spawn__HB4aM\",\"small\":\"_2d-hud__small__puteG\",\"large\":\"_2d-hud__large__3VNmn\",\"disabled\":\"_2d-hud__disabled__10Jl8\",\"video-share\":\"_2d-hud__video-share__1_I2R\",\"videoShare\":\"_2d-hud__video-share__1_I2R\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"invite-container\":\"invite-dialog__invite-container__3pLQp\",\"inviteContainer\":\"invite-dialog__invite-container__3pLQp\",\"dialog\":\"invite-dialog__dialog__3SSCD\",\"link-button\":\"invite-dialog__link-button__3cBQw\",\"linkButton\":\"invite-dialog__link-button__3cBQw\",\"enter-vr-button\":\"invite-dialog__enter-vr-button__YdItl\",\"enterVrButton\":\"invite-dialog__enter-vr-button__YdItl\",\"invite-button\":\"invite-dialog__invite-button__OTxW3\",\"inviteButton\":\"invite-dialog__invite-button__OTxW3\",\"enter-button\":\"invite-dialog__enter-button__1b43x\",\"enterButton\":\"invite-dialog__enter-button__1b43x\",\"invite-mini-button\":\"invite-dialog__invite-mini-button__3pYTX\",\"inviteMiniButton\":\"invite-dialog__invite-mini-button__3pYTX\",\"domain\":\"invite-dialog__domain__2YWot\",\"embed-text\":\"invite-dialog__embed-text__17nwL\",\"embedText\":\"invite-dialog__embed-text__17nwL\",\"invite-container-inverted\":\"invite-dialog__invite-container-inverted__1uq3h\",\"inviteContainerInverted\":\"invite-dialog__invite-container-inverted__1uq3h\",\"subscribe\":\"invite-dialog__subscribe__34wl_\",\"embed-tip-wrap\":\"invite-dialog__embed-tip-wrap__2bLQp\",\"embedTipWrap\":\"invite-dialog__embed-tip-wrap__2bLQp\",\"embed-tip\":\"invite-dialog__embed-tip__2Yaud\",\"embedTip\":\"invite-dialog__embed-tip__2Yaud\",\"modal\":\"invite-dialog__modal__2BpuQ\",\"invite-button-lowered\":\"invite-dialog__invite-button-lowered__1dkmh\",\"inviteButtonLowered\":\"invite-dialog__invite-button-lowered__1dkmh\",\"hide-small-screens\":\"invite-dialog__hide-small-screens__1HuaB\",\"hideSmallScreens\":\"invite-dialog__hide-small-screens__1HuaB\",\"link-code\":\"invite-dialog__link-code__3qMog\",\"linkCode\":\"invite-dialog__link-code__3qMog\",\"code-duration\":\"invite-dialog__code-duration__ax_D2\",\"codeDuration\":\"invite-dialog__code-duration__ax_D2\",\"invite-container-below-hud\":\"invite-dialog__invite-container-below-hud__x0M-h\",\"inviteContainerBelowHud\":\"invite-dialog__invite-container-below-hud__x0M-h\",\"attach-point\":\"invite-dialog__attach-point__y96Ix\",\"attachPoint\":\"invite-dialog__attach-point__y96Ix\",\"code\":\"invite-dialog__code__1ce8y\",\"keep-open\":\"invite-dialog__keep-open__3gpKz\",\"keepOpen\":\"invite-dialog__keep-open__3gpKz\",\"digit\":\"invite-dialog__digit__O2r4n\",\"digit_2\":\"invite-dialog__digit_2__1VTBG\",\"digit2\":\"invite-dialog__digit_2__1VTBG\",\"digit_3\":\"invite-dialog__digit_3__MSjxY\",\"digit3\":\"invite-dialog__digit_3__MSjxY\",\"code-loading-panel\":\"invite-dialog__code-loading-panel__17_fO\",\"codeLoadingPanel\":\"invite-dialog__code-loading-panel__17_fO\",\"hub-link-link\":\"invite-dialog__hub-link-link__3u-lB\",\"hubLinkLink\":\"invite-dialog__hub-link-link__3u-lB\",\"buttons\":\"invite-dialog__buttons__3_UJZ\",\"embed\":\"invite-dialog__embed__pnqw3\",\"close\":\"invite-dialog__close__1mXtB\",\"embed-tip-attach-point\":\"invite-dialog__embed-tip-attach-point__b70Mg\",\"embedTipAttachPoint\":\"invite-dialog__embed-tip-attach-point__b70Mg\"};","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\r\nimport { proxiedUrlFor } from \"./media-url-utils\";\r\n\r\nconst AVATARS_API = \"/api/v1/avatars\";\r\n\r\nexport const AVATAR_TYPES = {\r\n  SKINNABLE: \"skinnable\",\r\n  URL: \"url\"\r\n};\r\n\r\nexport function getAvatarType(avatarId) {\r\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\r\n  return AVATAR_TYPES.SKINNABLE;\r\n}\r\n\r\nasync function fetchSkinnableAvatar(avatarId) {\r\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\r\n  return resp && resp.avatars && resp.avatars[0];\r\n}\r\n\r\nexport async function fetchAvatar(avatarId) {\r\n  switch (getAvatarType(avatarId)) {\r\n    case AVATAR_TYPES.SKINNABLE:\r\n      return fetchSkinnableAvatar(avatarId);\r\n    case AVATAR_TYPES.URL:\r\n      return {\r\n        avatar_id: avatarId,\r\n        gltf_url: proxiedUrlFor(avatarId)\r\n      };\r\n  }\r\n}\r\n\r\nasync function fetchAvatarGltfUrl(avatarId) {\r\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\r\n}\r\n\r\nexport function getAvatarSrc(avatarId) {\r\n  switch (getAvatarType(avatarId)) {\r\n    case AVATAR_TYPES.SKINNABLE:\r\n      return fetchAvatarGltfUrl(avatarId);\r\n    case AVATAR_TYPES.URL:\r\n      return proxiedUrlFor(avatarId);\r\n    default:\r\n      return avatarId;\r\n  }\r\n}\r\n\r\nexport async function getAvatarThumbnailUrl(avatarId) {\r\n  switch (getAvatarType(avatarId)) {\r\n    case AVATAR_TYPES.SKINNABLE:\r\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\r\n    default:\r\n      return \"https://asset-bundles-prod.reticulum.io/bots/avatar_unavailable.png\";\r\n  }\r\n}\r\n\r\n// Currently the way we do material overrides is with a special named material.\r\n// We want to migrate eventually to having a GLTF extension that specifies what\r\n// materials can be overridden, but in the meantime we want to be able to support\r\n// arbitrary models with some sort of functionality. This provides a fallback\r\nexport const MAT_NAME = \"Bot_PBS\";\r\nexport function ensureAvatarMaterial(gltf) {\r\n  if (gltf.materials.find(m => m.name === MAT_NAME)) return gltf;\r\n\r\n  function materialForMesh(mesh) {\r\n    if (!mesh.primitives) return;\r\n    const primitive = mesh.primitives.find(p => p.material !== undefined);\r\n    return primitive && gltf.materials[primitive.material];\r\n  }\r\n\r\n  let nodes = gltf.scenes[gltf.scene].nodes.slice(0);\r\n  while (nodes.length) {\r\n    const node = gltf.nodes[nodes.shift()];\r\n    const material = node.mesh !== undefined && materialForMesh(gltf.meshes[node.mesh]);\r\n    if (material) {\r\n      material.name = MAT_NAME;\r\n      break;\r\n    }\r\n    if (node.children) nodes = nodes.concat(node.children);\r\n  }\r\n\r\n  return gltf;\r\n}\r\n\r\nexport async function remixAvatar(parentId, name) {\r\n  const avatar = {\r\n    parent_avatar_listing_id: parentId,\r\n    name: name,\r\n    files: {}\r\n  };\r\n\r\n  return fetchReticulumAuthenticated(AVATARS_API, \"POST\", { avatar });\r\n}\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { childMatch, setMatrixWorld, calculateViewingDistance } from \"../utils/three-utils\";\r\nimport { paths } from \"./userinput/paths\";\r\nimport { getBox } from \"../utils/auto-box-collider\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\nimport { qsGet } from \"../utils/qs_truthy\";\r\nconst customFOV = qsGet(\"fov\");\r\nconst enableThirdPersonMode = qsTruthy(\"thirdPerson\");\r\n\r\nexport function getInspectable(child) {\r\n  let el = child;\r\n  while (el) {\r\n    if (el.components && el.components.tags && el.components.tags.data.inspectable) return el;\r\n    el = el.parentNode;\r\n  }\r\n  return null;\r\n}\r\n\r\nconst decompose = (function() {\r\n  const scale = new THREE.Vector3();\r\n  return function decompose(m, p, q) {\r\n    m.decompose(p, q, scale); //ignore scale, like we're dealing with a motor\r\n  };\r\n})();\r\n\r\nconst IDENTITY = new THREE.Matrix4().identity();\r\nconst orbit = (function() {\r\n  const owq = new THREE.Quaternion();\r\n  const owp = new THREE.Vector3();\r\n  const cwq = new THREE.Quaternion();\r\n  const cwp = new THREE.Vector3();\r\n  const rwq = new THREE.Quaternion();\r\n  const UP = new THREE.Vector3();\r\n  const RIGHT = new THREE.Vector3();\r\n  const target = new THREE.Object3D();\r\n  const dhQ = new THREE.Quaternion();\r\n  const dvQ = new THREE.Quaternion();\r\n  return function orbit(object, rig, camera, dh, dv, dz, dt, panY) {\r\n    if (!target.parent) {\r\n      // add dummy object to the scene, if this is the first time we call this function\r\n      AFRAME.scenes[0].object3D.add(target);\r\n      target.applyMatrix(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\r\n    }\r\n    object.updateMatrices();\r\n    decompose(object.matrixWorld, owp, owq);\r\n    decompose(camera.matrixWorld, cwp, cwq);\r\n    rig.getWorldQuaternion(rwq);\r\n\r\n    dhQ.setFromAxisAngle(UP.set(0, 1, 0).applyQuaternion(owq), 0.1 * dh * dt);\r\n    target.quaternion.copy(cwq).premultiply(dhQ);\r\n    const dPos = new THREE.Vector3().subVectors(cwp, owp);\r\n    const zoom = 1 - dz * dt;\r\n    const newLength = dPos.length() * zoom;\r\n    // TODO: These limits should be calculated based on the calculated view distance.\r\n    if (newLength > 0.1 && newLength < 100) {\r\n      dPos.multiplyScalar(zoom);\r\n    }\r\n\r\n    dvQ.setFromAxisAngle(RIGHT.set(1, 0, 0).applyQuaternion(target.quaternion), 0.1 * dv * dt);\r\n    target.quaternion.premultiply(dvQ);\r\n    target.position.addVectors(owp, dPos.applyQuaternion(dhQ).applyQuaternion(dvQ)).add(\r\n      UP.set(0, 1, 0)\r\n        .multiplyScalar(panY * newLength)\r\n        .applyQuaternion(target.quaternion)\r\n    );\r\n    target.matrixNeedsUpdate = true;\r\n    target.updateMatrices();\r\n    childMatch(rig, camera, target.matrixWorld);\r\n  };\r\n})();\r\n\r\nconst moveRigSoCameraLooksAtObject = (function() {\r\n  const owq = new THREE.Quaternion();\r\n  const owp = new THREE.Vector3();\r\n  const cwq = new THREE.Quaternion();\r\n  const cwp = new THREE.Vector3();\r\n  const oForw = new THREE.Vector3();\r\n  const center = new THREE.Vector3();\r\n  const target = new THREE.Object3D();\r\n  return function moveRigSoCameraLooksAtObject(rig, camera, object, distanceMod) {\r\n    if (!target.parent) {\r\n      // add dummy object to the scene, if this is the first time we call this function\r\n      AFRAME.scenes[0].object3D.add(target);\r\n      target.applyMatrix(IDENTITY); // make sure target gets updated at least once for our matrix optimizations\r\n    }\r\n\r\n    object.updateMatrices();\r\n    decompose(object.matrixWorld, owp, owq);\r\n    decompose(camera.matrixWorld, cwp, cwq);\r\n    rig.getWorldQuaternion(cwq);\r\n\r\n    const box = getBox(object.el, object.el.getObject3D(\"mesh\") || object, true);\r\n    box.getCenter(center);\r\n    const vrMode = object.el.sceneEl.is(\"vr-mode\");\r\n    const dist =\r\n      calculateViewingDistance(\r\n        object.el.sceneEl.camera.fov,\r\n        object.el.sceneEl.camera.aspect,\r\n        object,\r\n        box,\r\n        center,\r\n        vrMode\r\n      ) * distanceMod;\r\n    target.position.addVectors(\r\n      owp,\r\n      oForw\r\n        .set(0, 0, 1)\r\n        .multiplyScalar(dist)\r\n        .applyQuaternion(owq)\r\n    );\r\n    target.quaternion.copy(owq);\r\n    target.matrixNeedsUpdate = true;\r\n    target.updateMatrices();\r\n    childMatch(rig, camera, target.matrixWorld);\r\n  };\r\n})();\r\n\r\nexport const CAMERA_MODE_FIRST_PERSON = 0;\r\nexport const CAMERA_MODE_THIRD_PERSON_NEAR = 1;\r\nexport const CAMERA_MODE_THIRD_PERSON_FAR = 2;\r\nexport const CAMERA_MODE_INSPECT = 3;\r\nexport const CAMERA_MODE_SCENE_PREVIEW = 4;\r\n\r\nconst NEXT_MODES = {\r\n  [CAMERA_MODE_FIRST_PERSON]: CAMERA_MODE_THIRD_PERSON_NEAR,\r\n  [CAMERA_MODE_THIRD_PERSON_NEAR]: CAMERA_MODE_THIRD_PERSON_FAR,\r\n  [CAMERA_MODE_THIRD_PERSON_FAR]: CAMERA_MODE_FIRST_PERSON\r\n};\r\n\r\nconst CAMERA_LAYER_INSPECT = 4;\r\n// This layer is never actually rendered by a camera but lets the batching system know it should be rendered if inspecting\r\nexport const CAMERA_LAYER_BATCH_INSPECT = 5;\r\n\r\nconst ensureLightsAreSeenByCamera = function(o) {\r\n  if (o.isLight) {\r\n    o.layers.enable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\nconst enableInspectLayer = function(o) {\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n  const batch = batchManagerSystem.batchingEnabled && batchManagerSystem.batchManager.batchForMesh.get(o);\r\n  if (batch) {\r\n    batch.layers.enable(CAMERA_LAYER_INSPECT);\r\n    o.layers.enable(CAMERA_LAYER_BATCH_INSPECT);\r\n  } else {\r\n    o.layers.enable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\nconst disableInspectLayer = function(o) {\r\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\r\n  const batch = batchManagerSystem.batchingEnabled && batchManagerSystem.batchManager.batchForMesh.get(o);\r\n  if (batch) {\r\n    batch.layers.disable(CAMERA_LAYER_INSPECT);\r\n    o.layers.disable(CAMERA_LAYER_BATCH_INSPECT);\r\n  } else {\r\n    o.layers.disable(CAMERA_LAYER_INSPECT);\r\n  }\r\n};\r\n\r\nfunction getAudio(o) {\r\n  let audio;\r\n  o.traverse(c => {\r\n    if (!audio && c.type === \"Audio\") {\r\n      audio = c;\r\n    }\r\n  });\r\n  return audio;\r\n}\r\n\r\nconst FALLOFF = 0.9;\r\nexport class CameraSystem {\r\n  constructor(scene) {\r\n    this.enableLights = localStorage.getItem(\"show-background-while-inspecting\") === \"true\";\r\n    this.verticalDelta = 0;\r\n    this.horizontalDelta = 0;\r\n    this.inspectZoom = 0;\r\n    this.mode = CAMERA_MODE_SCENE_PREVIEW;\r\n    this.snapshot = { audioTransform: new THREE.Matrix4(), matrixWorld: new THREE.Matrix4() };\r\n    this.audioListenerTargetTransform = new THREE.Matrix4();\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\r\n      this.avatarRig = document.getElementById(\"avatar-rig\");\r\n      this.viewingCamera = document.getElementById(\"viewing-camera\");\r\n      this.viewingRig = document.getElementById(\"viewing-rig\");\r\n\r\n      const bg = new THREE.Mesh(\r\n        new THREE.BoxGeometry(100, 100, 100),\r\n        new THREE.MeshBasicMaterial({ color: 0x020202, side: THREE.BackSide })\r\n      );\r\n      bg.layers.set(CAMERA_LAYER_INSPECT);\r\n      this.viewingRig.object3D.add(bg);\r\n      if (customFOV) {\r\n        if (this.viewingCamera.components.camera) {\r\n          this.viewingCamera.setAttribute(\"camera\", { fov: customFOV });\r\n        } else {\r\n          scene.addEventListener(\"camera-set-active\", () => {\r\n            this.viewingCamera.setAttribute(\"camera\", { fov: customFOV });\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  nextMode() {\r\n    if (this.mode === CAMERA_MODE_INSPECT) {\r\n      this.uninspect();\r\n      return;\r\n    }\r\n\r\n    if (!enableThirdPersonMode) return;\r\n    if (this.mode === CAMERA_MODE_SCENE_PREVIEW) return;\r\n\r\n    this.mode = NEXT_MODES[this.mode] || 0;\r\n    if (this.mode === CAMERA_MODE_FIRST_PERSON) {\r\n      AFRAME.scenes[0].renderer.vr.setPoseTarget(this.avatarPOV.object3D);\r\n    } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\r\n      AFRAME.scenes[0].renderer.vr.setPoseTarget(this.viewingCamera.object3D);\r\n    }\r\n  }\r\n\r\n  inspect(o, distanceMod, temporarilyDisableRegularExit) {\r\n    this.verticalDelta = 0;\r\n    this.horizontalDelta = 0;\r\n    this.inspectZoom = 0;\r\n    this.temporarilyDisableRegularExit = temporarilyDisableRegularExit; // TODO: Do this at the action set layer\r\n    if (this.mode === CAMERA_MODE_INSPECT) {\r\n      return;\r\n    }\r\n    const scene = AFRAME.scenes[0];\r\n    scene.object3D.traverse(ensureLightsAreSeenByCamera);\r\n    scene.classList.add(\"hand-cursor\");\r\n    scene.classList.remove(\"no-cursor\");\r\n    this.snapshot.mode = this.mode;\r\n    this.mode = CAMERA_MODE_INSPECT;\r\n    this.inspected = o;\r\n\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    this.snapshot.mask = camera.layers.mask;\r\n    if (vrMode) {\r\n      this.snapshot.mask0 = camera.cameras[0].layers.mask;\r\n      this.snapshot.mask1 = camera.cameras[1].layers.mask;\r\n    }\r\n    if (!this.enableLights) {\r\n      this.hideEverythingButThisObject(o);\r\n    }\r\n\r\n    this.viewingCamera.object3D.updateMatrices();\r\n    this.snapshot.matrixWorld.copy(this.viewingRig.object3D.matrixWorld);\r\n\r\n    moveRigSoCameraLooksAtObject(\r\n      this.viewingRig.object3D,\r\n      this.viewingCamera.object3D,\r\n      this.inspected,\r\n      distanceMod || 1\r\n    );\r\n\r\n    this.snapshot.audio = getAudio(o);\r\n    if (this.snapshot.audio) {\r\n      this.snapshot.audio.updateMatrices();\r\n      this.snapshot.audioTransform.copy(this.snapshot.audio.matrixWorld);\r\n      scene.audioListener.updateMatrices();\r\n      this.audioListenerTargetTransform.makeTranslation(0, 0, 1).premultiply(scene.audioListener.matrixWorld);\r\n      setMatrixWorld(this.snapshot.audio, this.audioListenerTargetTransform);\r\n    }\r\n  }\r\n\r\n  uninspect() {\r\n    this.temporarilyDisableRegularExit = false;\r\n    if (this.mode !== CAMERA_MODE_INSPECT) return;\r\n    const scene = AFRAME.scenes[0];\r\n    if (scene.is(\"entered\")) {\r\n      scene.classList.remove(\"hand-cursor\");\r\n      scene.classList.add(\"no-cursor\");\r\n    }\r\n    this.showEverythingAsNormal();\r\n    this.inspected = null;\r\n    if (this.snapshot.audio) {\r\n      setMatrixWorld(this.snapshot.audio, this.snapshot.audioTransform);\r\n      this.snapshot.audio = null;\r\n    }\r\n\r\n    this.mode = this.snapshot.mode;\r\n    if (this.snapshot.mode === CAMERA_MODE_SCENE_PREVIEW) {\r\n      setMatrixWorld(this.viewingRig.object3D, this.snapshot.matrixWorld);\r\n    }\r\n    this.snapshot.mode = null;\r\n    this.tick(AFRAME.scenes[0]);\r\n  }\r\n\r\n  hideEverythingButThisObject(o) {\r\n    o.traverse(enableInspectLayer);\r\n\r\n    const scene = AFRAME.scenes[0];\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    camera.layers.set(CAMERA_LAYER_INSPECT);\r\n    if (vrMode) {\r\n      camera.cameras[0].layers.set(CAMERA_LAYER_INSPECT);\r\n      camera.cameras[1].layers.set(CAMERA_LAYER_INSPECT);\r\n    }\r\n  }\r\n\r\n  showEverythingAsNormal() {\r\n    if (this.inspected) {\r\n      this.inspected.traverse(disableInspectLayer);\r\n    }\r\n    const scene = AFRAME.scenes[0];\r\n    const vrMode = scene.is(\"vr-mode\");\r\n    const camera = vrMode ? scene.renderer.vr.getCamera(scene.camera) : scene.camera;\r\n    camera.layers.mask = this.snapshot.mask;\r\n    if (vrMode) {\r\n      camera.cameras[0].layers.mask = this.snapshot.mask0;\r\n      camera.cameras[1].layers.mask = this.snapshot.mask1;\r\n    }\r\n  }\r\n\r\n  tick = (function() {\r\n    const translation = new THREE.Matrix4();\r\n    let uiRoot;\r\n    return function tick(scene, dt) {\r\n      const entered = scene.is(\"entered\");\r\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n      if (isGhost && this.mode !== CAMERA_MODE_FIRST_PERSON && this.mode !== CAMERA_MODE_INSPECT) {\r\n        this.mode = CAMERA_MODE_FIRST_PERSON;\r\n        const position = new THREE.Vector3();\r\n        const quat = new THREE.Quaternion();\r\n        const scale = new THREE.Vector3();\r\n        this.viewingCamera.object3D.updateMatrices();\r\n        this.viewingRig.object3D.updateMatrices();\r\n        this.viewingRig.object3D.matrixWorld.decompose(position, quat, scale);\r\n        position.setFromMatrixPosition(this.viewingCamera.object3D.matrixWorld);\r\n        position.y = position.y - 1.6;\r\n        setMatrixWorld(\r\n          this.avatarRig.object3D,\r\n          new THREE.Matrix4().compose(\r\n            position,\r\n            quat,\r\n            scale\r\n          )\r\n        );\r\n        scene.systems[\"hubs-systems\"].characterController.fly = true;\r\n        this.avatarPOV.object3D.updateMatrices();\r\n        setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.object3D.matrixWorld);\r\n      }\r\n      if (!this.enteredScene && entered) {\r\n        this.enteredScene = true;\r\n        this.mode = CAMERA_MODE_FIRST_PERSON;\r\n      }\r\n      this.avatarPOVRotator = this.avatarPOVRotator || this.avatarPOV.components[\"pitch-yaw-rotator\"];\r\n      this.viewingCameraRotator = this.viewingCameraRotator || this.viewingCamera.components[\"pitch-yaw-rotator\"];\r\n      this.avatarPOVRotator.on = true;\r\n      this.viewingCameraRotator.on = true;\r\n\r\n      this.userinput = this.userinput || scene.systems.userinput;\r\n      this.interaction = this.interaction || scene.systems.interaction;\r\n\r\n      if (this.userinput.get(paths.actions.startInspecting) && this.mode !== CAMERA_MODE_INSPECT) {\r\n        const hoverEl = this.interaction.state.rightRemote.hovered || this.interaction.state.leftRemote.hovered;\r\n\r\n        if (hoverEl) {\r\n          const inspectable = getInspectable(hoverEl);\r\n\r\n          if (inspectable) {\r\n            this.inspect(inspectable.object3D);\r\n          }\r\n        }\r\n      } else if (\r\n        !this.temporarilyDisableRegularExit &&\r\n        this.mode === CAMERA_MODE_INSPECT &&\r\n        this.userinput.get(paths.actions.stopInspecting)\r\n      ) {\r\n        scene.emit(\"uninspect\");\r\n        this.uninspect();\r\n      }\r\n\r\n      if (this.userinput.get(paths.actions.nextCameraMode)) {\r\n        this.nextMode();\r\n      }\r\n\r\n      const headShouldBeVisible = this.mode !== CAMERA_MODE_FIRST_PERSON;\r\n      this.playerHead = this.playerHead || document.getElementById(\"avatar-head\");\r\n      if (this.playerHead && headShouldBeVisible !== this.playerHead.object3D.visible) {\r\n        this.playerHead.object3D.visible = headShouldBeVisible;\r\n\r\n        // Skip a frame so we don't see our own avatar, etc.\r\n        return;\r\n      }\r\n\r\n      if (this.mode === CAMERA_MODE_FIRST_PERSON) {\r\n        this.viewingCameraRotator.on = false;\r\n        this.avatarRig.object3D.updateMatrices();\r\n        setMatrixWorld(this.viewingRig.object3D, this.avatarRig.object3D.matrixWorld);\r\n        if (scene.is(\"vr-mode\")) {\r\n          this.viewingCamera.object3D.updateMatrices();\r\n          setMatrixWorld(this.avatarPOV.object3D, this.viewingCamera.object3D.matrixWorld);\r\n        } else {\r\n          this.avatarPOV.object3D.updateMatrices();\r\n          setMatrixWorld(this.viewingCamera.object3D, this.avatarPOV.object3D.matrixWorld);\r\n        }\r\n      } else if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR || this.mode === CAMERA_MODE_THIRD_PERSON_FAR) {\r\n        if (this.mode === CAMERA_MODE_THIRD_PERSON_NEAR) {\r\n          translation.makeTranslation(0, 1, 3);\r\n        } else {\r\n          translation.makeTranslation(0, 2, 8);\r\n        }\r\n        this.avatarRig.object3D.updateMatrices();\r\n        this.viewingRig.object3D.matrixWorld.copy(this.avatarRig.object3D.matrixWorld).multiply(translation);\r\n        setMatrixWorld(this.viewingRig.object3D, this.viewingRig.object3D.matrixWorld);\r\n        this.avatarPOV.object3D.quaternion.copy(this.viewingCamera.object3D.quaternion);\r\n        this.avatarPOV.object3D.matrixNeedsUpdate = true;\r\n      } else if (this.mode === CAMERA_MODE_INSPECT) {\r\n        this.avatarPOVRotator.on = false;\r\n        this.viewingCameraRotator.on = false;\r\n        const cameraDelta = this.userinput.get(\r\n          scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta\r\n        );\r\n\r\n        if (cameraDelta) {\r\n          // TODO: Move device specific tinkering to action sets\r\n          const horizontalDelta = (AFRAME.utils.device.isMobile() ? -0.6 : 1) * cameraDelta[0] || 0;\r\n          const verticalDelta = (AFRAME.utils.device.isMobile() ? -1.2 : 1) * cameraDelta[1] || 0;\r\n          this.horizontalDelta = (this.horizontalDelta + horizontalDelta) / 2;\r\n          this.verticalDelta = (this.verticalDelta + verticalDelta) / 2;\r\n        } else if (Math.abs(this.verticalDelta) > 0.0001 || Math.abs(this.horizontalDelta) > 0.0001) {\r\n          this.verticalDelta = FALLOFF * this.verticalDelta;\r\n          this.horizontalDelta = FALLOFF * this.horizontalDelta;\r\n        }\r\n\r\n        const inspectZoom = this.userinput.get(paths.actions.inspectZoom) * 0.001;\r\n        if (inspectZoom) {\r\n          this.inspectZoom = inspectZoom + (5 * this.inspectZoom) / 6;\r\n        } else if (Math.abs(this.inspectZoom) > 0.0001) {\r\n          this.inspectZoom = FALLOFF * this.inspectZoom;\r\n        }\r\n        const panY = this.userinput.get(paths.actions.inspectPanY) || 0;\r\n        if (this.userinput.get(paths.actions.resetInspectView)) {\r\n          moveRigSoCameraLooksAtObject(this.viewingRig.object3D, this.viewingCamera.object3D, this.inspected, 1);\r\n        }\r\n\r\n        if (\r\n          Math.abs(this.verticalDelta) > 0.001 ||\r\n          Math.abs(this.horizontalDelta) > 0.001 ||\r\n          Math.abs(this.inspectZoom) > 0.001 ||\r\n          Math.abs(panY) > 0.0001\r\n        ) {\r\n          orbit(\r\n            this.inspected,\r\n            this.viewingRig.object3D,\r\n            this.viewingCamera.object3D,\r\n            this.horizontalDelta,\r\n            this.verticalDelta,\r\n            this.inspectZoom,\r\n            dt,\r\n            panY\r\n          );\r\n        }\r\n      }\r\n\r\n      if (scene.audioListener && this.avatarPOV) {\r\n        if (this.mode === CAMERA_MODE_INSPECT && scene.audioListener.parent !== this.avatarPOV.object3D) {\r\n          this.avatarPOV.object3D.add(scene.audioListener);\r\n        } else if (\r\n          (this.mode === CAMERA_MODE_FIRST_PERSON ||\r\n            this.mode === CAMERA_MODE_THIRD_PERSON_NEAR ||\r\n            this.mode === CAMERA_MODE_THIRD_PERSON_FAR) &&\r\n          scene.audioListener.parent !== this.viewingCamera.object3D\r\n        ) {\r\n          this.viewingCamera.object3D.add(scene.audioListener);\r\n        }\r\n      }\r\n    };\r\n  })();\r\n}\r\n","export function forEachMaterial(object3D, fn) {\r\n  if (!object3D.material) return;\r\n\r\n  if (Array.isArray(object3D.material)) {\r\n    object3D.material.forEach(fn);\r\n  } else {\r\n    fn(object3D.material);\r\n  }\r\n}\r\n\r\nexport function mapMaterials(object3D, fn) {\r\n  if (!object3D.material) return;\r\n\r\n  if (Array.isArray(object3D.material)) {\r\n    return object3D.material.map(fn);\r\n  } else {\r\n    return fn(object3D.material);\r\n  }\r\n}\r\n","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\r\nimport ducky from \"../assets/models/DuckyMesh.glb\";\r\n\r\nconst names = [\r\n  \"Baers-Pochard\",\r\n  \"Baikal-Teal\",\r\n  \"Barrows-Goldeneye\",\r\n  \"Blue-Billed\",\r\n  \"Blue-Duck\",\r\n  \"Blue-Winged\",\r\n  \"Brown-Teal\",\r\n  \"Bufflehead\",\r\n  \"Canvasback\",\r\n  \"Cape-Shoveler\",\r\n  \"Chestnut-Teal\",\r\n  \"Chiloe-Wigeon\",\r\n  \"Cinnamon-Teal\",\r\n  \"Comb-Duck\",\r\n  \"Common-Eider\",\r\n  \"Common-Goldeneye\",\r\n  \"Common-Merganser\",\r\n  \"Common-Pochard\",\r\n  \"Common-Scoter\",\r\n  \"Common-Shelduck\",\r\n  \"Cotton-Pygmy\",\r\n  \"Crested-Duck\",\r\n  \"Crested-Shelduck\",\r\n  \"Eatons-Pintail\",\r\n  \"Falcated\",\r\n  \"Ferruginous\",\r\n  \"Freckled-Duck\",\r\n  \"Gadwall\",\r\n  \"Garganey\",\r\n  \"Greater-Scaup\",\r\n  \"Green-Pygmy\",\r\n  \"Grey-Teal\",\r\n  \"Hardhead\",\r\n  \"Harlequin\",\r\n  \"Hartlaubs\",\r\n  \"Hooded-Merganser\",\r\n  \"Hottentot-Teal\",\r\n  \"Kelp-Goose\",\r\n  \"King-Eider\",\r\n  \"Lake-Duck\",\r\n  \"Laysan-Duck\",\r\n  \"Lesser-Scaup\",\r\n  \"Long-Tailed\",\r\n  \"Maccoa-Duck\",\r\n  \"Mallard\",\r\n  \"Mandarin\",\r\n  \"Marbled-Teal\",\r\n  \"Mellers-Duck\",\r\n  \"Merganser\",\r\n  \"Northern-Pintail\",\r\n  \"Orinoco-Goose\",\r\n  \"Paradise-Shelduck\",\r\n  \"Plumed-Whistler\",\r\n  \"Puna-Teal\",\r\n  \"Pygmy-Goose\",\r\n  \"Radjah-Shelduck\",\r\n  \"Red-Billed\",\r\n  \"Red-Crested\",\r\n  \"Red-Shoveler\",\r\n  \"Ring-Necked\",\r\n  \"Ringed-Teal\",\r\n  \"Rosy-Billed\",\r\n  \"Ruddy-Shelduck\",\r\n  \"Salvadoris-Teal\",\r\n  \"Scaly-Sided\",\r\n  \"Shelduck\",\r\n  \"Shoveler\",\r\n  \"Silver-Teal\",\r\n  \"Smew\",\r\n  \"Spectacled-Eider\",\r\n  \"Spot-Billed\",\r\n  \"Spotted-Whistler\",\r\n  \"Steamerduck\",\r\n  \"Stellers-Eider\",\r\n  \"Sunda-Teal\",\r\n  \"Surf-Scoter\",\r\n  \"Tufted-Duck\",\r\n  \"Velvet-Scoter\",\r\n  \"Wandering-Whistler\",\r\n  \"Whistling-duck\",\r\n  \"White-Backed\",\r\n  \"White-Cheeked\",\r\n  \"White-Winged\",\r\n  \"Wigeon\",\r\n  \"Wood-Duck\",\r\n  \"Yellow-Billed\"\r\n];\r\n\r\nfunction chooseRandom(arr) {\r\n  return arr[Math.floor(Math.random() * arr.length)];\r\n}\r\n\r\nexport function generateRandomName() {\r\n  return `${chooseRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\r\n}\r\n\r\nexport async function fetchRandomDefaultAvatarId() {\r\n  const defaultAvatarEndpoint = \"/api/v1/media/search?filter=default&source=avatar_listings\";\r\n  const defaultAvatars = (await fetchReticulumAuthenticated(defaultAvatarEndpoint)).entries;\r\n  if (defaultAvatars.length === 0) {\r\n    // If reticulum doesn't return any default avatars, just default to the duck model. This should only happen\r\n    // when running against a fresh reticulum server, e.g. a local ret instance.\r\n    return new URL(ducky, location.href).href;\r\n  }\r\n  const avatarIds = defaultAvatars.map(avatar => avatar.id);\r\n  return chooseRandom(avatarIds);\r\n}\r\n","import { Validator } from \"jsonschema\";\r\nimport merge from \"deepmerge\";\r\nimport Cookies from \"js-cookie\";\r\nimport jwtDecode from \"jwt-decode\";\r\n\r\nconst LOCAL_STORE_KEY = \"___hubs_store\";\r\nconst STORE_STATE_CACHE_KEY = Symbol();\r\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\r\nconst validator = new Validator();\r\nimport { EventTarget } from \"event-target-shim\";\r\nimport { fetchRandomDefaultAvatarId, generateRandomName } from \"../utils/identity.js\";\r\n\r\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\r\n// (Think flux but with way less incidental complexity, at least for now :))\r\nexport const SCHEMA = {\r\n  id: \"/HubsStore\",\r\n\r\n  definitions: {\r\n    profile: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9 -]{3,32}$\" },\r\n        avatarId: { type: \"string\" },\r\n        // personalAvatarId is obsolete, but we need it here for backwards compatibility.\r\n        personalAvatarId: { type: \"string\" }\r\n      }\r\n    },\r\n\r\n    credentials: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        token: { type: [\"null\", \"string\"] },\r\n        email: { type: [\"null\", \"string\"] }\r\n      }\r\n    },\r\n\r\n    activity: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        hasFoundFreeze: { type: \"boolean\" },\r\n        hasChangedName: { type: \"boolean\" },\r\n        hasAcceptedProfile: { type: \"boolean\" },\r\n        lastEnteredAt: { type: \"string\" },\r\n        hasPinned: { type: \"boolean\" },\r\n        hasRotated: { type: \"boolean\" },\r\n        hasRecentered: { type: \"boolean\" },\r\n        hasScaled: { type: \"boolean\" },\r\n        hasHoveredInWorldHud: { type: \"boolean\" },\r\n        hasOpenedShare: { type: \"boolean\" },\r\n        entryCount: { type: \"number\" }\r\n      }\r\n    },\r\n\r\n    settings: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        lastUsedMicDeviceId: { type: \"string\" }\r\n      }\r\n    },\r\n\r\n    preferences: {\r\n      type: \"object\",\r\n      additionalProperties: false,\r\n      properties: {\r\n        muteMicOnEntry: { type: \"bool\" },\r\n        enableOnScreenJoystickLeft: { type: \"bool\" },\r\n        enableOnScreenJoystickRight: { type: \"bool\" },\r\n        onlyShowNametagsInFreeze: { type: \"bool\" },\r\n        allowMultipleHubsInstances: { type: \"bool\" },\r\n        maxResolutionWidth: { type: \"number\" },\r\n        maxResolutionHeight: { type: \"number\" },\r\n        globalVoiceVolume: { type: \"number\" },\r\n        globalMediaVolume: { type: \"number\" },\r\n        snapRotationDegrees: { type: \"number\" },\r\n        materialQualitySetting: { type: \"string\" },\r\n        disableMovement: { type: \"bool\" },\r\n        disableBackwardsMovement: { type: \"bool\" },\r\n        disableStrafing: { type: \"bool\" },\r\n        disableTeleporter: { type: \"bool\" },\r\n        disableAutoPixelRatio: { type: \"bool\" }\r\n      }\r\n    },\r\n\r\n    // Legacy\r\n    confirmedDiscordRooms: {\r\n      type: \"array\",\r\n      items: { type: \"string\" }\r\n    },\r\n\r\n    confirmedBroadcastedRooms: {\r\n      type: \"array\",\r\n      items: { type: \"string\" }\r\n    },\r\n\r\n    uploadPromotionTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          fileId: { type: \"string\" },\r\n          promotionToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    creatorAssignmentTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          hubId: { type: \"string\" },\r\n          creatorAssignmentToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    embedTokens: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          hubId: { type: \"string\" },\r\n          embedToken: { type: \"string\" }\r\n        }\r\n      }\r\n    },\r\n\r\n    onLoadActions: {\r\n      type: \"array\",\r\n      items: {\r\n        type: \"object\",\r\n        additionalProperties: false,\r\n        properties: {\r\n          action: { type: \"string\" },\r\n          args: { type: \"object\" }\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  type: \"object\",\r\n\r\n  properties: {\r\n    profile: { $ref: \"#/definitions/profile\" },\r\n    credentials: { $ref: \"#/definitions/credentials\" },\r\n    activity: { $ref: \"#/definitions/activity\" },\r\n    settings: { $ref: \"#/definitions/settings\" },\r\n    preferences: { $ref: \"#/definitions/preferences\" },\r\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\r\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\r\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\r\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\r\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\r\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\r\n  },\r\n\r\n  additionalProperties: false\r\n};\r\n\r\nexport default class Store extends EventTarget {\r\n  constructor() {\r\n    super();\r\n\r\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\r\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\r\n    }\r\n\r\n    // When storage is updated in another window\r\n    window.addEventListener(\"storage\", e => {\r\n      if (e.key !== LOCAL_STORE_KEY) return;\r\n      delete this[STORE_STATE_CACHE_KEY];\r\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n    });\r\n\r\n    this.update({\r\n      activity: {},\r\n      settings: {},\r\n      credentials: {},\r\n      profile: {},\r\n      confirmedDiscordRooms: [],\r\n      confirmedBroadcastedRooms: [],\r\n      uploadPromotionTokens: [],\r\n      creatorAssignmentTokens: [],\r\n      embedTokens: [],\r\n      onLoadActions: [],\r\n      preferences: {}\r\n    });\r\n\r\n    this._shouldResetAvatarOnInit = false;\r\n\r\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\r\n    if (oauthFlowCredentials) {\r\n      this.update({ credentials: oauthFlowCredentials });\r\n      this._shouldResetAvatarOnInit = true;\r\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\r\n    }\r\n\r\n    this._signOutOnExpiredAuthToken();\r\n  }\r\n\r\n  _signOutOnExpiredAuthToken = () => {\r\n    if (!this.state.credentials.token) return;\r\n\r\n    const expiry = jwtDecode(this.state.credentials.token).exp * 1000;\r\n    if (expiry <= Date.now()) {\r\n      this.update({ credentials: { token: null, email: null } });\r\n    }\r\n  };\r\n\r\n  initProfile = async () => {\r\n    if (this._shouldResetAvatarOnInit) {\r\n      await this.resetToRandomDefaultAvatar();\r\n    } else {\r\n      this.update({\r\n        profile: { avatarId: await fetchRandomDefaultAvatarId(), ...(this.state.profile || {}) }\r\n      });\r\n    }\r\n\r\n    // Regenerate name to encourage users to change it.\r\n    if (!this.state.activity.hasChangedName) {\r\n      this.update({ profile: { displayName: generateRandomName() } });\r\n    }\r\n  };\r\n\r\n  resetToRandomDefaultAvatar = async () => {\r\n    this.update({\r\n      profile: { ...(this.state.profile || {}), avatarId: await fetchRandomDefaultAvatarId() }\r\n    });\r\n  };\r\n\r\n  get state() {\r\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\r\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\r\n    }\r\n\r\n    return this[STORE_STATE_CACHE_KEY];\r\n  }\r\n\r\n  get credentialsAccountId() {\r\n    if (this.state.credentials.token) {\r\n      return jwtDecode(this.state.credentials.token).sub;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  resetConfirmedBroadcastedRooms() {\r\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\r\n  }\r\n\r\n  resetTipActivityFlags() {\r\n    this.update({\r\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\r\n    });\r\n  }\r\n\r\n  bumpEntryCount() {\r\n    const currentEntryCount = this.state.activity.entryCount || 0;\r\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\r\n  }\r\n\r\n  // Sets a one-time action to perform the next time the page loads\r\n  enqueueOnLoadAction(action, args) {\r\n    this.update({ onLoadActions: [{ action, args }] });\r\n  }\r\n\r\n  executeOnLoadActions(sceneEl) {\r\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\r\n      const { action, args } = this.state.onLoadActions[i];\r\n\r\n      if (action === \"emit_scene_event\") {\r\n        sceneEl.emit(args.event, args.detail);\r\n      }\r\n    }\r\n\r\n    this.clearOnLoadActions();\r\n  }\r\n\r\n  clearOnLoadActions() {\r\n    this.clearStoredArray(\"onLoadActions\");\r\n  }\r\n\r\n  clearStoredArray(key) {\r\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\r\n    const update = {};\r\n    update[key] = [];\r\n\r\n    this.update(update, { arrayMerge: overwriteMerge });\r\n  }\r\n\r\n  update(newState, mergeOpts) {\r\n    const finalState = merge(this.state, newState, mergeOpts);\r\n    const { valid } = validator.validate(finalState, SCHEMA);\r\n\r\n    if (!valid) {\r\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\r\n      // sensitive data in the error message.\r\n      throw new Error(`Write to store failed schema validation.`);\r\n    }\r\n\r\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\r\n    delete this[STORE_STATE_CACHE_KEY];\r\n\r\n    if (newState.profile !== undefined) {\r\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\r\n    }\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n\r\n    return finalState;\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/images/app-logo-157c06cff6c80227eb577f35c79e58b6.png\";","module.exports = __webpack_public_path__ + \"assets/images/company-logo-8f6f7c3b303004256295b45c2eee5117.png\";","module.exports = __webpack_public_path__ + \"assets/images/editor-logo-6f885a1543496ebc23a21b7fea82b255.png\";","// Brief overview of client authorization can be found in the wiki:\r\n// https://github.com/mozilla/hubs/wiki/Hubs-authorization\r\nexport function showHoverEffect(el) {\r\n  const isFrozen = el.sceneEl.is(\"frozen\");\r\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\r\n  const isSpawner = !!el.components[\"super-spawner\"];\r\n  const isEmojiSpawner = isSpawner && el.components[\"super-spawner\"].data.template === \"#interactable-emoji\";\r\n  const isEmoji = !!el.components.emoji;\r\n  const canMove =\r\n    (isEmoji || isEmojiSpawner\r\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\r\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\r\n    (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\r\n  return (isSpawner || !isPinned || isFrozen) && canMove;\r\n}\r\n\r\nexport function canMove(entity) {\r\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\r\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\r\n  const isCamera = networkedTemplate === \"#interactable-camera\";\r\n  const isPen = networkedTemplate === \"#interactable-pen\";\r\n  const spawnerTemplate =\r\n    entity && entity.components[\"super-spawner\"] && entity.components[\"super-spawner\"].data.template;\r\n  const isEmojiSpawner = spawnerTemplate === \"#interactable-emoji\";\r\n  const isEmoji = !!entity.components.emoji;\r\n  const isHoldableButton = entity.components.tags && entity.components.tags.data.holdableButton;\r\n  return (\r\n    isHoldableButton ||\r\n    ((isEmoji || isEmojiSpawner\r\n      ? window.APP.hubChannel.can(\"spawn_emoji\")\r\n      : window.APP.hubChannel.can(\"spawn_and_move_media\")) &&\r\n      (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\r\n      (!isCamera || window.APP.hubChannel.can(\"spawn_camera\")) &&\r\n      (!isPen || window.APP.hubChannel.can(\"spawn_drawing\")))\r\n  );\r\n}\r\n\r\nfunction indexForComponent(component, schema) {\r\n  const fullComponent = typeof component === \"string\";\r\n  const componentName = fullComponent ? component : component.component;\r\n\r\n  if (fullComponent) {\r\n    return schema.components.findIndex(schemaComponent => schemaComponent === componentName);\r\n  } else {\r\n    return schema.components.findIndex(\r\n      schemaComponent => schemaComponent.component === componentName && schemaComponent.property === component.property\r\n    );\r\n  }\r\n}\r\n\r\nlet nonAuthorizedSchemas = null;\r\nfunction initializeNonAuthorizedSchemas() {\r\n  /*\r\n  Takes the NAF schemas defined in network-schemas.js and produces a data structure of template name to non-authorized\r\n  component indices:\r\n  {\r\n    \"#interactable-media\": [\"4\", \"5\", \"6\"]\r\n  }\r\n  */\r\n  nonAuthorizedSchemas = {};\r\n  const { schemaDict } = NAF.schemas;\r\n  for (const template in schemaDict) {\r\n    if (!schemaDict.hasOwnProperty(template)) continue;\r\n    const schema = schemaDict[template];\r\n    nonAuthorizedSchemas[template] = (schema.nonAuthorizedComponents || [])\r\n      .map(nonAuthorizedComponent => indexForComponent(nonAuthorizedComponent, schema))\r\n      .map(index => index.toString());\r\n  }\r\n}\r\n\r\nfunction sanitizeMessageData(template, data) {\r\n  if (nonAuthorizedSchemas === null) {\r\n    initializeNonAuthorizedSchemas();\r\n  }\r\n  const nonAuthorizedIndices = nonAuthorizedSchemas[template];\r\n  for (const index in data.components) {\r\n    if (!data.components.hasOwnProperty(index)) continue;\r\n    if (!nonAuthorizedIndices.includes(index)) {\r\n      data.components[index] = null;\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nfunction authorizeEntityManipulation(entityMetadata, sender, senderPermissions) {\r\n  const { template, creator, isPinned } = entityMetadata;\r\n  const isCreator = sender === creator;\r\n\r\n  if (template.endsWith(\"-waypoint-avatar\")) {\r\n    return true;\r\n  } else if (template.endsWith(\"-avatar\")) {\r\n    return isCreator;\r\n  } else if (template.endsWith(\"-media\")) {\r\n    return (!isPinned || senderPermissions.pin_objects) && (isCreator || senderPermissions.spawn_and_move_media);\r\n  } else if (template.endsWith(\"-camera\")) {\r\n    return isCreator || senderPermissions.spawn_camera;\r\n  } else if (template.endsWith(\"-pen\") || template.endsWith(\"-drawing\")) {\r\n    return isCreator || senderPermissions.spawn_drawing;\r\n  } else if (template.endsWith(\"-emoji\")) {\r\n    return isCreator || senderPermissions.spawn_emoji;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction getPendingOrExistingEntityMetadata(networkId) {\r\n  const pendingData = NAF.connection.adapter.getPendingDataForNetworkId(networkId);\r\n\r\n  if (pendingData) {\r\n    const { template, creator } = pendingData;\r\n    const schema = NAF.schemas.schemaDict[template];\r\n    const pinnableComponent = pendingData.components[indexForComponent(\"pinnable\", schema)];\r\n    const isPinned = pinnableComponent && pinnableComponent.pinned;\r\n    return { template, creator, isPinned };\r\n  }\r\n\r\n  const entity = NAF.entities.getEntity(networkId);\r\n  if (!entity) return null;\r\n\r\n  const { template, creator } = entity.components.networked.data;\r\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\r\n  return { template, creator, isPinned };\r\n}\r\n\r\nfunction authorizeOrSanitizeMessageData(data, sender, senderPermissions) {\r\n  const entityMetadata = getPendingOrExistingEntityMetadata(data.networkId);\r\n  if (!entityMetadata) return false;\r\n\r\n  if (authorizeEntityManipulation(entityMetadata, sender, senderPermissions)) {\r\n    return true;\r\n  } else {\r\n    const { template } = entityMetadata;\r\n    sanitizeMessageData(template, data);\r\n    return true;\r\n  }\r\n}\r\n\r\n// If we receive a sync from a persistent object that we don't have an entity for yet, it must be a scene-owned object\r\n// (since we guarantee that pinned objects are loaded before connecting NAF).\r\n// Since we need to get metadata (the template id in particular) from the entity, we must stash these messages until\r\n// the scene has loaded.\r\n// Components which require this data must call applyPersistentSync after they are initialized\r\nconst persistentSyncs = {};\r\nfunction stashPersistentSync(message, entityData) {\r\n  if (!persistentSyncs[entityData.networkId]) {\r\n    persistentSyncs[entityData.networkId] = {\r\n      dataType: \"u\",\r\n      data: entityData,\r\n      clientId: message.clientId,\r\n      from_session_id: message.from_session_id\r\n    };\r\n  } else {\r\n    const currentData = persistentSyncs[entityData.networkId].data;\r\n    const currentComponents = currentData.components;\r\n    Object.assign(currentData, entityData);\r\n    currentData.components = Object.assign(currentComponents, entityData.components);\r\n  }\r\n}\r\n\r\nconst emptyObject = {};\r\nexport function authorizeOrSanitizeMessage(message) {\r\n  const { dataType, from_session_id } = message;\r\n\r\n  if (dataType === \"u\" && message.data.isFirstSync && !message.data.persistent) {\r\n    // The server has already authorized first sync messages that result in an instantiation.\r\n    return message;\r\n  }\r\n\r\n  const presenceState = window.APP.hubChannel.presence.state[from_session_id];\r\n\r\n  if (!presenceState) {\r\n    // We've received a manipulation message from a user that we don't have presence state for yet.\r\n    // Since we can't make a judgement about their permissions, we'll have to ignore the message.\r\n    return emptyObject;\r\n  }\r\n\r\n  const senderPermissions = presenceState.metas[0].permissions;\r\n\r\n  if (dataType === \"um\") {\r\n    let sanitizedAny = false;\r\n    let stashedAny = false;\r\n    for (const index in message.data.d) {\r\n      if (!message.data.d.hasOwnProperty(index)) continue;\r\n      const entityData = message.data.d[index];\r\n      if (entityData.persistent && !NAF.entities.getEntity(entityData.networkId)) {\r\n        stashPersistentSync(message, entityData);\r\n        message.data.d[index] = null;\r\n        stashedAny = true;\r\n      } else {\r\n        const authorizedOrSanitized = authorizeOrSanitizeMessageData(entityData, from_session_id, senderPermissions);\r\n        if (!authorizedOrSanitized) {\r\n          message.data.d[index] = null;\r\n          sanitizedAny = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (sanitizedAny || stashedAny) {\r\n      message.data.d = message.data.d.filter(x => x != null);\r\n    }\r\n\r\n    return message;\r\n  } else if (dataType === \"u\") {\r\n    if (message.data.persistent && !NAF.entities.getEntity(message.data.networkId)) {\r\n      persistentSyncs[message.data.networkId] = message;\r\n      return emptyObject;\r\n    } else {\r\n      const authorizedOrSanitized = authorizeOrSanitizeMessageData(message.data, from_session_id, senderPermissions);\r\n      if (authorizedOrSanitized) {\r\n        return message;\r\n      } else {\r\n        return emptyObject;\r\n      }\r\n    }\r\n  } else if (dataType === \"r\") {\r\n    const entityMetadata = getPendingOrExistingEntityMetadata(message.data.networkId);\r\n    if (!entityMetadata) return emptyObject;\r\n    if (authorizeEntityManipulation(entityMetadata, from_session_id, senderPermissions)) {\r\n      return message;\r\n    } else {\r\n      return emptyObject;\r\n    }\r\n  } else {\r\n    // Fall through for other data types. Namely, \"drawing-<networkId>\" messages at the moment.\r\n    return message;\r\n  }\r\n}\r\n\r\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\r\nexport function applyPersistentSync(networkId) {\r\n  if (!persistentSyncs[networkId]) return;\r\n  NAF.connection.adapter.onData(authorizeOrSanitizeMessage(persistentSyncs[networkId]), PHOENIX_RELIABLE_NAF);\r\n  delete persistentSyncs[networkId];\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navigation-button\":\"client-info-dialog__navigation-button__2UkZ2\",\"navigationButton\":\"client-info-dialog__navigation-button__2UkZ2\",\"primary-action-buttons\":\"client-info-dialog__primary-action-buttons__3fbLR\",\"primaryActionButtons\":\"client-info-dialog__primary-action-buttons__3fbLR\",\"cancel\":\"client-info-dialog__cancel__3-cNq\",\"collapse-button\":\"client-info-dialog__collapse-button__10CuY\",\"collapseButton\":\"client-info-dialog__collapse-button__10CuY\",\"title-and-close\":\"client-info-dialog__title-and-close__3-mNq\",\"titleAndClose\":\"client-info-dialog__title-and-close__3-mNq\",\"object-display-string\":\"client-info-dialog__object-display-string__27GUX\",\"objectDisplayString\":\"client-info-dialog__object-display-string__27GUX\",\"cancel-text\":\"client-info-dialog__cancel-text__1El_x\",\"cancelText\":\"client-info-dialog__cancel-text__1El_x\",\"client-info-dialog\":\"client-info-dialog__client-info-dialog__2W3x6\",\"clientInfoDialog\":\"client-info-dialog__client-info-dialog__2W3x6\",\"title\":\"client-info-dialog__title__BKVNd\",\"community-identifier\":\"client-info-dialog__community-identifier__d8AsL\",\"communityIdentifier\":\"client-info-dialog__community-identifier__d8AsL\",\"client-info\":\"client-info-dialog__client-info__3kkrL\",\"clientInfo\":\"client-info-dialog__client-info__3kkrL\",\"client-profile-image\":\"client-info-dialog__client-profile-image__2sA9h\",\"clientProfileImage\":\"client-info-dialog__client-profile-image__2sA9h\",\"client-details\":\"client-info-dialog__client-details__4ZVkU\",\"clientDetails\":\"client-info-dialog__client-details__4ZVkU\",\"client-main\":\"client-info-dialog__client-main__ch3Uu\",\"clientMain\":\"client-info-dialog__client-main__ch3Uu\",\"action-button-sections\":\"client-info-dialog__action-button-sections__2D51-\",\"actionButtonSections\":\"client-info-dialog__action-button-sections__2D51-\",\"action-button-placeholder\":\"client-info-dialog__action-button-placeholder__1JZCd\",\"actionButtonPlaceholder\":\"client-info-dialog__action-button-placeholder__1JZCd\",\"left-action-buttons\":\"client-info-dialog__left-action-buttons__1cQ_7\",\"leftActionButtons\":\"client-info-dialog__left-action-buttons__1cQ_7\",\"right-action-buttons\":\"client-info-dialog__right-action-buttons__3dS3d\",\"rightActionButtons\":\"client-info-dialog__right-action-buttons__3dS3d\",\"button-icon\":\"client-info-dialog__button-icon__3yTvh\",\"buttonIcon\":\"client-info-dialog__button-icon__3yTvh\",\"primary-action-button\":\"client-info-dialog__primary-action-button__DgsWX\",\"primaryActionButton\":\"client-info-dialog__primary-action-button__DgsWX\"};","import Raven from \"raven-js\";\r\nimport configs from \"./utils/configs\";\r\n\r\nconst ga = window.ga;\r\n\r\nexport default function registerTelemetry(trackedPage, trackedTitle) {\r\n  const sentryDsn = configs.SENTRY_DSN;\r\n  const gaTrackingId = configs.GA_TRACKING_ID;\r\n\r\n  if (sentryDsn) {\r\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\r\n    Raven.config(sentryDsn).install();\r\n  }\r\n\r\n  if (ga && gaTrackingId) {\r\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\r\n\r\n    ga(\"create\", gaTrackingId, \"auto\");\r\n\r\n    if (trackedPage) {\r\n      ga(\"set\", \"page\", trackedPage);\r\n    }\r\n\r\n    if (trackedTitle) {\r\n      ga(\"set\", \"title\", trackedTitle);\r\n    }\r\n\r\n    ga(\"send\", \"pageview\");\r\n  }\r\n}\r\n","// Computes an AABB that surrounds the object in question and all of its children.\r\n// Note that if the children have rotations, this probably won't return the tightest\r\n// possible AABB -- we could return a tighter one if we examined all of the vertices\r\n// of the geometry for ourselves, but we don't care enough for what we're using this\r\n// for to do so much work.\r\nexport const computeObjectAABB = (function() {\r\n  const bounds = new THREE.Box3();\r\n  return function(root, target) {\r\n    target.makeEmpty();\r\n    root.traverse(node => {\r\n      node.updateMatrices();\r\n      const geometry = node.geometry;\r\n      if (geometry != null) {\r\n        if (geometry.boundingBox == null) {\r\n          geometry.computeBoundingBox();\r\n        }\r\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\r\n      }\r\n    });\r\n    return target;\r\n  };\r\n})();\r\n\r\nconst rotation = new THREE.Euler();\r\nexport function getBox(entity, boxRoot, worldSpace) {\r\n  const box = new THREE.Box3();\r\n\r\n  rotation.copy(entity.object3D.rotation);\r\n  entity.object3D.rotation.set(0, 0, 0);\r\n\r\n  entity.object3D.updateMatrices(true, true);\r\n  boxRoot.updateMatrices(true, true);\r\n  boxRoot.updateMatrixWorld(true);\r\n\r\n  computeObjectAABB(boxRoot, box);\r\n\r\n  if (!box.isEmpty()) {\r\n    if (!worldSpace) {\r\n      entity.object3D.worldToLocal(box.min);\r\n      entity.object3D.worldToLocal(box.max);\r\n    }\r\n    entity.object3D.rotation.copy(rotation);\r\n    entity.object3D.matrixNeedsUpdate = true;\r\n  }\r\n\r\n  boxRoot.matrixWorldNeedsUpdate = true;\r\n  boxRoot.updateMatrices();\r\n\r\n  return box;\r\n}\r\n\r\nexport function getScaleCoefficient(length, box) {\r\n  if (box.isEmpty()) return 1.0;\r\n\r\n  const { max, min } = box;\r\n  const dX = Math.abs(max.x - min.x);\r\n  const dY = Math.abs(max.y - min.y);\r\n  const dZ = Math.abs(max.z - min.z);\r\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\r\n  return length / lengthOfLongestComponent;\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"client-link\":\"presence-list__client-link__3UYRG\",\"clientLink\":\"presence-list__client-link__3UYRG\",\"presence-list\":\"presence-list__presence-list__ceaB8\",\"presenceList\":\"presence-list__presence-list__ceaB8\",\"attach-point\":\"presence-list__attach-point__3_rJ_\",\"attachPoint\":\"presence-list__attach-point__3_rJ_\",\"contents\":\"presence-list__contents__3rvpS\",\"rows\":\"presence-list__rows__1w_Hy\",\"row\":\"presence-list__row__1_UOV\",\"row-no-margin\":\"presence-list__row-no-margin__3EuB8\",\"rowNoMargin\":\"presence-list__row-no-margin__3EuB8\",\"row-header\":\"presence-list__row-header__1aPqC\",\"rowHeader\":\"presence-list__row-header__1aPqC\",\"list-item\":\"presence-list__list-item__3uCtq\",\"listItem\":\"presence-list__list-item__3uCtq\",\"list-item-link\":\"presence-list__list-item-link__3DzsO\",\"listItemLink\":\"presence-list__list-item-link__3DzsO\",\"presence\":\"presence-list__presence__3bQc8\",\"sign-in\":\"presence-list__sign-in__arEZg\",\"signIn\":\"presence-list__sign-in__arEZg\",\"icon\":\"presence-list__icon__rYQks\",\"self\":\"presence-list__self__3hznv\",\"moderator-badge\":\"presence-list__moderator-badge__1owiD\",\"moderatorBadge\":\"presence-list__moderator-badge__1owiD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message-entry-input\":\"message-entry__message-entry-input__1dtnV\",\"messageEntryInput\":\"message-entry__message-entry-input__1dtnV\",\"message-entry\":\"message-entry__message-entry__uBeqC\",\"messageEntry\":\"message-entry__message-entry__uBeqC\",\"message-entry-disabled\":\"message-entry__message-entry-disabled__1NXno\",\"messageEntryDisabled\":\"message-entry__message-entry-disabled__1NXno\",\"message-entry-button\":\"message-entry__message-entry-button__35Qzp\",\"messageEntryButton\":\"message-entry__message-entry-button__35Qzp\",\"message-entry-spawn\":\"message-entry__message-entry-spawn__3psMn\",\"messageEntrySpawn\":\"message-entry__message-entry-spawn__3psMn\",\"message-entry-button-in-room\":\"message-entry__message-entry-button-in-room__Esx-2\",\"messageEntryButtonInRoom\":\"message-entry__message-entry-button-in-room__Esx-2\",\"message-entry-upload\":\"message-entry__message-entry-upload__g1tcV\",\"messageEntryUpload\":\"message-entry__message-entry-upload__g1tcV\",\"message-entry-in-room\":\"message-entry__message-entry-in-room__2-BQX\",\"messageEntryInRoom\":\"message-entry__message-entry-in-room__2-BQX\",\"message-entry-input-in-room\":\"message-entry__message-entry-input-in-room__3B8xh\",\"messageEntryInputInRoom\":\"message-entry__message-entry-input-in-room__3B8xh\",\"message-entry-input-no-spawn\":\"message-entry__message-entry-input-no-spawn__1qhry\",\"messageEntryInputNoSpawn\":\"message-entry__message-entry-input-no-spawn__1qhry\",\"message-entry-on-mobile\":\"message-entry__message-entry-on-mobile__1wKPF\",\"messageEntryOnMobile\":\"message-entry__message-entry-on-mobile__1wKPF\"};","module.exports = __webpack_public_path__ + \"assets/models/DuckyMesh-04f978955fb12d48f7ff8c59a05de439.glb\";","import screenfull from \"screenfull\";\r\n\r\nlet hasEnteredFullScreenThisSession = false;\r\n\r\nfunction shouldShowFullScreen() {\r\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\r\n  return (\r\n    (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) &&\r\n    !AFRAME.utils.device.isIOS() &&\r\n    screenfull.enabled\r\n  );\r\n}\r\n\r\nexport function willRequireUserGesture() {\r\n  return !screenfull.isFullscreen && shouldShowFullScreen();\r\n}\r\n\r\nexport async function showFullScreenIfAvailable() {\r\n  if (shouldShowFullScreen()) {\r\n    hasEnteredFullScreenThisSession = true;\r\n    await screenfull.request();\r\n  }\r\n}\r\n\r\nexport async function showFullScreenIfWasFullScreen() {\r\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\r\n    await screenfull.request();\r\n  }\r\n}\r\n","export default function nextTick() {\r\n  return new Promise(resolve => {\r\n    setTimeout(resolve, 0);\r\n  });\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"description-field\":\"room-settings-dialog__description-field__2Wr3f\",\"descriptionField\":\"room-settings-dialog__description-field__2Wr3f\",\"name-field\":\"room-settings-dialog__name-field__aBV1p\",\"nameField\":\"room-settings-dialog__name-field__aBV1p\",\"next-button\":\"room-settings-dialog__next-button__3GvW-\",\"nextButton\":\"room-settings-dialog__next-button__3GvW-\",\"continue-button\":\"room-settings-dialog__continue-button__2BZUc\",\"continueButton\":\"room-settings-dialog__continue-button__2BZUc\",\"room-settings-form\":\"room-settings-dialog__room-settings-form__2wmQ0\",\"roomSettingsForm\":\"room-settings-dialog__room-settings-form__2wmQ0\",\"select-container\":\"room-settings-dialog__select-container__1wkVS\",\"selectContainer\":\"room-settings-dialog__select-container__1wkVS\",\"permission\":\"room-settings-dialog__permission__2mZ7m\",\"subtitle\":\"room-settings-dialog__subtitle__2Rytq\",\"member-cap-container\":\"room-settings-dialog__member-cap-container__1kIku\",\"memberCapContainer\":\"room-settings-dialog__member-cap-container__1kIku\",\"permissions\":\"room-settings-dialog__permissions__26mTi\",\"permissions-group\":\"room-settings-dialog__permissions-group__3tCkV\",\"permissionsGroup\":\"room-settings-dialog__permissions-group__3tCkV\",\"permission-disabled\":\"room-settings-dialog__permission-disabled__11X2s\",\"permissionDisabled\":\"room-settings-dialog__permission-disabled__11X2s\"};","import nextTick from \"../utils/next-tick\";\r\nimport { mapMaterials } from \"../utils/material-utils\";\r\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\r\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\r\nimport { textureLoader, basisTextureLoader } from \"../utils/media-utils\";\r\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\r\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\r\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\r\nimport { disposeNode, cloneObject3D } from \"../utils/three-utils\";\r\n\r\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\r\n\r\nclass GLTFCache {\r\n  cache = new Map();\r\n\r\n  set(src, gltf) {\r\n    this.cache.set(src, {\r\n      gltf,\r\n      count: 0\r\n    });\r\n    return this.retain(src);\r\n  }\r\n\r\n  has(src) {\r\n    return this.cache.has(src);\r\n  }\r\n\r\n  get(src) {\r\n    return this.cache.get(src);\r\n  }\r\n\r\n  retain(src) {\r\n    const cacheItem = this.cache.get(src);\r\n    cacheItem.count++;\r\n    return cacheItem;\r\n  }\r\n\r\n  release(src) {\r\n    const cacheItem = this.cache.get(src);\r\n\r\n    if (!cacheItem) {\r\n      console.error(`Releasing uncached gltf ${src}`);\r\n      return;\r\n    }\r\n\r\n    cacheItem.count--;\r\n    if (cacheItem.count <= 0) {\r\n      cacheItem.gltf.scene.traverse(disposeNode);\r\n      this.cache.delete(src);\r\n    }\r\n  }\r\n}\r\nconst gltfCache = new GLTFCache();\r\nconst inflightGltfs = new Map();\r\n\r\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\r\n\r\nfunction defaultInflator(el, componentName, componentData) {\r\n  if (!AFRAME.components[componentName]) {\r\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\r\n  }\r\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\r\n    for (let i = 0; i < componentData.length; i++) {\r\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\r\n    }\r\n  } else {\r\n    el.setAttribute(componentName, componentData);\r\n  }\r\n}\r\n\r\nAFRAME.GLTFModelPlus = {\r\n  // eslint-disable-next-line no-unused-vars\r\n  components: {},\r\n  registerComponent(componentKey, componentName, inflator) {\r\n    inflator = inflator || defaultInflator;\r\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\r\n  }\r\n};\r\n\r\nfunction generateMeshBVH(object3D) {\r\n  object3D.traverse(obj => {\r\n    // note that we might already have a bounds tree if this was a clone of an object with one\r\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\r\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\r\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\r\n      const geo = obj.geometry;\r\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\r\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\r\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\r\n      // we put this in a web worker)\r\n      if (triCount > 1000 && triCount < 1000000) {\r\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\r\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction cloneGltf(gltf) {\r\n  return {\r\n    animations: gltf.scene.animations,\r\n    scene: cloneObject3D(gltf.scene)\r\n  };\r\n}\r\n\r\nfunction getHubsComponents(node) {\r\n  const hubsComponents =\r\n    node.userData.gltfExtensions &&\r\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\r\n\r\n  // We can remove support for legacy components when our environment, avatar and interactable models are\r\n  // updated to match Spoke output.\r\n  const legacyComponents = node.userData.components;\r\n\r\n  return hubsComponents || legacyComponents;\r\n}\r\n\r\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\r\n/// and template data to construct A-Frame entities and components when necessary.\r\n/// (It's unnecessary to construct entities for subtrees that have no component data\r\n/// or templates associated with any of their nodes.)\r\n///\r\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\r\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\r\n  // TODO: Remove this once we update the legacy avatars to the new node names\r\n  if (node.name === \"Chest\") {\r\n    node.name = \"Spine\";\r\n  } else if (node.name === \"Root Scene\") {\r\n    node.name = \"AvatarRoot\";\r\n  } else if (node.name === \"Bot_Skinned\") {\r\n    node.name = \"AvatarMesh\";\r\n  }\r\n\r\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\r\n  const childEntities = [];\r\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\r\n  for (const child of children) {\r\n    const el = inflateEntities(indexToEntityMap, child, templates);\r\n    if (el) {\r\n      childEntities.push(el);\r\n    }\r\n  }\r\n\r\n  const entityComponents = getHubsComponents(node);\r\n\r\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\r\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\r\n    return null; // we don't need an entity for this node\r\n  }\r\n\r\n  const el = document.createElement(\"a-entity\");\r\n  el.append.apply(el, childEntities);\r\n\r\n  // Remove invalid CSS class name characters.\r\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\r\n  el.classList.add(className);\r\n\r\n  // AFRAME rotation component expects rotations in YXZ, convert it\r\n  if (node.rotation.order !== \"YXZ\") {\r\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\r\n  }\r\n\r\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\r\n  // all updates to the object should be done through the THREE.Group wrapper\r\n  el.object3D.position.copy(node.position);\r\n  el.object3D.rotation.copy(node.rotation);\r\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\r\n  el.object3D.matrixNeedsUpdate = true;\r\n\r\n  node.matrixAutoUpdate = false;\r\n  node.matrix.identity();\r\n  node.matrix.decompose(node.position, node.rotation, node.scale);\r\n\r\n  el.setObject3D(node.type.toLowerCase(), node);\r\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\r\n    el.setObject3D(\"mesh\", node);\r\n  }\r\n\r\n  // Set the name of the `THREE.Group` to match the name of the node,\r\n  // so that templates can be attached to the correct AFrame entity.\r\n  el.object3D.name = node.name;\r\n\r\n  // Set the uuid of the `THREE.Group` to match the uuid of the node,\r\n  // so that `THREE.PropertyBinding` will find (and later animate)\r\n  // the group. See `PropertyBinding.findNode`:\r\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\r\n  el.object3D.uuid = node.uuid;\r\n  node.uuid = THREE.Math.generateUUID();\r\n\r\n  if (node.animations) {\r\n    // Pass animations up to the group object so that when we can pass the group as\r\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\r\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\r\n    // `null` in `THREE.AnimationClip.findByName`.\r\n    node.parent.animations = node.animations;\r\n  }\r\n\r\n  if (node.morphTargetInfluences) {\r\n    node.parent.morphTargetInfluences = node.morphTargetInfluences;\r\n  }\r\n\r\n  const gltfIndex = node.userData.gltfIndex;\r\n  if (gltfIndex !== undefined) {\r\n    indexToEntityMap[gltfIndex] = el;\r\n  }\r\n\r\n  return el;\r\n};\r\n\r\nasync function inflateComponents(inflatedEntity, indexToEntityMap) {\r\n  let isFirstInflation = true;\r\n  const objectInflations = [];\r\n\r\n  inflatedEntity.object3D.traverse(async object3D => {\r\n    const objectInflation = {};\r\n    objectInflation.promise = new Promise(resolve => (objectInflation.resolve = resolve));\r\n    objectInflations.push(objectInflation);\r\n\r\n    if (!isFirstInflation) {\r\n      await objectInflations.shift().promise;\r\n    }\r\n    isFirstInflation = false;\r\n\r\n    const entityComponents = getHubsComponents(object3D);\r\n    const el = object3D.el;\r\n\r\n    if (entityComponents && el) {\r\n      for (const prop in entityComponents) {\r\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\r\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\r\n          await inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\r\n        }\r\n      }\r\n    }\r\n\r\n    objectInflation.resolve();\r\n  });\r\n\r\n  await objectInflations.shift().promise;\r\n}\r\n\r\nfunction attachTemplate(root, name, templateRoot) {\r\n  const targetEls = root.querySelectorAll(\".\" + name);\r\n  for (const el of targetEls) {\r\n    const root = templateRoot.cloneNode(true);\r\n    // Merge root element attributes with the target element\r\n    for (const { name, value } of root.attributes) {\r\n      el.setAttribute(name, value);\r\n    }\r\n\r\n    // Append all child elements\r\n    while (root.children.length > 0) {\r\n      el.appendChild(root.children[0]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction getHubsComponentsExtension(node) {\r\n  if (node.extensions && node.extensions.MOZ_hubs_components) {\r\n    return node.extensions.MOZ_hubs_components;\r\n  } else if (node.extensions && node.extensions.HUBS_components) {\r\n    return node.extensions.HUBS_components;\r\n  } else if (node.extras && node.extras.gltfExtensions && node.extras.gltfExtensions.MOZ_hubs_components) {\r\n    return node.extras.gltfExtensions.MOZ_hubs_components;\r\n  }\r\n}\r\n\r\n// Versions are documented here: https://github.com/mozilla/hubs/wiki/MOZ_hubs_components-Changelog\r\n// Make sure to update the wiki and Spoke when bumping a version\r\nfunction runMigration(version, json) {\r\n  if (version < 2) {\r\n    //old heightfields will be on the same node as the nav-mesh, delete those\r\n    const oldHeightfieldNode = json.nodes.find(node => {\r\n      const components = getHubsComponentsExtension(node);\r\n      return components && components.heightfield && components[\"nav-mesh\"];\r\n    });\r\n    if (oldHeightfieldNode) {\r\n      if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.MOZ_hubs_components) {\r\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\r\n      } else if (oldHeightfieldNode.extensions && oldHeightfieldNode.extensions.HUBS_components) {\r\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\r\n      } else if (\r\n        oldHeightfieldNode.extras &&\r\n        oldHeightfieldNode.extras.gltfExtensions &&\r\n        oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components\r\n      ) {\r\n        delete oldHeightfieldNode.extras.gltfExtensions.MOZ_hubs_components;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (version < 4) {\r\n    // Lights prior to version 4 should treat range === 0 as if it has zero decay\r\n    if (json.nodes) {\r\n      for (const node of json.nodes) {\r\n        const components = getHubsComponentsExtension(node);\r\n\r\n        if (!components) {\r\n          continue;\r\n        }\r\n\r\n        const light = components[\"spot-light\"] || components[\"point-light\"];\r\n\r\n        if (light && light.range === 0) {\r\n          light.decay = 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress, jsonPreprocessor) {\r\n  let gltfUrl = src;\r\n  let fileMap;\r\n\r\n  if (contentType && (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\"))) {\r\n    fileMap = await extractZipFile(gltfUrl);\r\n    gltfUrl = fileMap[\"scene.gtlf\"];\r\n  }\r\n\r\n  const loadingManager = new THREE.LoadingManager();\r\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\r\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\r\n  gltfLoader.setBasisTextureLoader(basisTextureLoader);\r\n\r\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\r\n\r\n  parser.textureLoader = textureLoader;\r\n\r\n  if (jsonPreprocessor) {\r\n    parser.json = jsonPreprocessor(parser.json);\r\n  }\r\n\r\n  let version = 0;\r\n  if (\r\n    parser.json.extensions &&\r\n    parser.json.extensions.MOZ_hubs_components &&\r\n    parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\r\n  ) {\r\n    version = parser.json.extensions.MOZ_hubs_components.version;\r\n  }\r\n  runMigration(version, parser.json);\r\n\r\n  const materials = parser.json.materials;\r\n  if (materials) {\r\n    for (let i = 0; i < materials.length; i++) {\r\n      const material = materials[i];\r\n\r\n      if (\r\n        material.extensions &&\r\n        material.extensions.MOZ_alt_materials &&\r\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\r\n      ) {\r\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\r\n        materials[i] = materials[altMaterialIndex];\r\n      }\r\n    }\r\n  }\r\n\r\n  const nodes = parser.json.nodes;\r\n\r\n  if (nodes) {\r\n    for (let i = 0; i < nodes.length; i++) {\r\n      const node = nodes[i];\r\n\r\n      if (!node.extras) {\r\n        node.extras = {};\r\n      }\r\n\r\n      node.extras.gltfIndex = i;\r\n    }\r\n  }\r\n\r\n  const gltf = await new Promise(parser.parse.bind(parser));\r\n\r\n  gltf.scene.traverse(object => {\r\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\r\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\r\n\r\n    object.material = mapMaterials(object, material => {\r\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\r\n        return MobileStandardMaterial.fromStandardMaterial(material);\r\n      }\r\n\r\n      return material;\r\n    });\r\n  });\r\n\r\n  if (fileMap) {\r\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\r\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\r\n  }\r\n\r\n  gltf.scene.animations = gltf.animations;\r\n\r\n  return gltf;\r\n}\r\n\r\nexport async function loadModel(src, contentType = null, useCache = false, jsonPreprocessor = null) {\r\n  const preferredTechnique =\r\n    window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\r\n\r\n  if (useCache) {\r\n    if (gltfCache.has(src)) {\r\n      gltfCache.retain(src);\r\n      return cloneGltf(gltfCache.get(src).gltf);\r\n    } else {\r\n      if (inflightGltfs.has(src)) {\r\n        const gltf = await inflightGltfs.get(src);\r\n        gltfCache.retain(src);\r\n        return cloneGltf(gltf);\r\n      } else {\r\n        const promise = loadGLTF(src, contentType, preferredTechnique, null, jsonPreprocessor);\r\n        inflightGltfs.set(src, promise);\r\n        const gltf = await promise;\r\n        inflightGltfs.delete(src);\r\n        gltfCache.set(src, gltf);\r\n        return cloneGltf(gltf);\r\n      }\r\n    }\r\n  } else {\r\n    return loadGLTF(src, contentType, preferredTechnique, null, jsonPreprocessor);\r\n  }\r\n}\r\n\r\nfunction resolveAsset(src) {\r\n  // If the src attribute is a selector, get the url from the asset item.\r\n  if (src && src.charAt(0) === \"#\") {\r\n    const assetEl = document.getElementById(src.substring(1));\r\n    if (assetEl) {\r\n      return assetEl.getAttribute(\"src\");\r\n    }\r\n  }\r\n  return src;\r\n}\r\n\r\n/**\r\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\r\n * whitelisted components on them if defined in the node's extras.\r\n * @namespace gltf\r\n * @component gltf-model-plus\r\n */\r\nAFRAME.registerComponent(\"gltf-model-plus\", {\r\n  schema: {\r\n    src: { type: \"string\" },\r\n    contentType: { type: \"string\" },\r\n    useCache: { default: true },\r\n    inflate: { default: false },\r\n    batch: { default: false },\r\n    modelToWorldScale: { type: \"number\", default: 1 }\r\n  },\r\n\r\n  init() {\r\n    // This can be set externally if a consumer wants to do some node preprocssing.\r\n    this.jsonPreprocessor = null;\r\n\r\n    this.loadTemplates();\r\n  },\r\n\r\n  update() {\r\n    this.applySrc(resolveAsset(this.data.src), this.data.contentType);\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.batch && this.model) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);\r\n    }\r\n    const src = resolveAsset(this.data.src);\r\n    if (src) {\r\n      gltfCache.release(src);\r\n    }\r\n  },\r\n\r\n  loadTemplates() {\r\n    this.templates = {};\r\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\r\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\r\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\r\n    });\r\n  },\r\n\r\n  async applySrc(src, contentType) {\r\n    try {\r\n      if (src === this.lastSrc) return;\r\n\r\n      const lastSrc = this.lastSrc;\r\n      this.lastSrc = src;\r\n\r\n      if (!src) {\r\n        if (this.inflatedEl) {\r\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\r\n          this.disposeLastInflatedEl();\r\n        }\r\n        return;\r\n      }\r\n\r\n      this.el.emit(\"model-loading\");\r\n      const gltf = await loadModel(src, contentType, this.data.useCache, this.jsonPreprocessor);\r\n\r\n      // If we started loading something else already\r\n      // TODO: there should be a way to cancel loading instead\r\n      if (src != this.lastSrc) return;\r\n\r\n      // If we had inflated something already before, clean that up\r\n      this.disposeLastInflatedEl();\r\n\r\n      this.model = gltf.scene || gltf.scenes[0];\r\n\r\n      if (this.data.batch) {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.model);\r\n      }\r\n\r\n      if (gltf.animations.length > 0) {\r\n        this.el.setAttribute(\"animation-mixer\", {});\r\n        this.el.components[\"animation-mixer\"].initMixer(this.model.animations);\r\n      } else {\r\n        generateMeshBVH(this.model);\r\n      }\r\n\r\n      const indexToEntityMap = {};\r\n\r\n      let object3DToSet = this.model;\r\n      if (\r\n        this.data.inflate &&\r\n        (this.inflatedEl = inflateEntities(\r\n          indexToEntityMap,\r\n          this.model,\r\n          this.templates,\r\n          true,\r\n          this.data.modelToWorldScale\r\n        ))\r\n      ) {\r\n        this.el.appendChild(this.inflatedEl);\r\n\r\n        object3DToSet = this.inflatedEl.object3D;\r\n        object3DToSet.visible = false;\r\n\r\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\r\n        // Wait one tick for the appended custom elements to be connected before attaching templates\r\n        await nextTick();\r\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\r\n\r\n        await inflateComponents(this.inflatedEl, indexToEntityMap);\r\n\r\n        for (const name in this.templates) {\r\n          attachTemplate(this.el, name, this.templates[name]);\r\n        }\r\n      }\r\n\r\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\r\n      // in the entire inflated entity graph to point to `object3DToSet`.\r\n      //\r\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\r\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\r\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\r\n      // the model or the root GLTF inflated entity.\r\n      const rewires = [];\r\n\r\n      object3DToSet.traverse(o => {\r\n        const el = o.el;\r\n        if (el) rewires.push(() => (o.el = el));\r\n      });\r\n\r\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n\r\n      if (environmentMapComponent) {\r\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\r\n      }\r\n\r\n      if (lastSrc) {\r\n        gltfCache.release(lastSrc);\r\n      }\r\n      this.el.setObject3D(\"mesh\", object3DToSet);\r\n\r\n      rewires.forEach(f => f());\r\n\r\n      object3DToSet.visible = true;\r\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\r\n    } catch (e) {\r\n      gltfCache.release(src);\r\n      console.error(\"Failed to load glTF model\", e, this);\r\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\r\n    }\r\n  },\r\n\r\n  disposeLastInflatedEl() {\r\n    if (this.inflatedEl) {\r\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\r\n\r\n      this.inflatedEl.object3D.traverse(x => {\r\n        if (x.material && x.material.dispose) {\r\n          x.material.dispose();\r\n        }\r\n\r\n        if (x.geometry) {\r\n          if (x.geometry.dispose) {\r\n            x.geometry.dispose();\r\n          }\r\n\r\n          x.geometry.boundsTree = null;\r\n        }\r\n      });\r\n\r\n      delete this.inflatedEl;\r\n\r\n      this.el.removeAttribute(\"animation-mixer\");\r\n    }\r\n  }\r\n});\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profile-entry\":\"profile__profile-entry__HNb_M\",\"profileEntry\":\"profile__profile-entry__HNb_M\",\"form-submit\":\"profile__form-submit__2Vu7b\",\"formSubmit\":\"profile__form-submit__2Vu7b\",\"choose-avatar\":\"profile__choose-avatar__2fhtQ\",\"chooseAvatar\":\"profile__choose-avatar__2fhtQ\",\"form-field-text\":\"profile__form-field-text__2olXk\",\"formFieldText\":\"profile__form-field-text__2olXk\",\"title\":\"profile__title__1uX4Y\",\"close\":\"profile__close__1_hm5\",\"logo\":\"profile__logo__3Oy0U\",\"form\":\"profile__form__wEqER\",\"box\":\"profile__box__3NJ7K\",\"links\":\"profile__links__2_qd6\",\"display-name\":\"profile__display-name__2k9ZG\",\"displayName\":\"profile__display-name__2k9ZG\",\"preview\":\"profile__preview__2J-oe\",\"edit-avatar\":\"profile__edit-avatar__2bmDN\",\"editAvatar\":\"profile__edit-avatar__2bmDN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttons\":\"tweet-dialog__buttons__3NinY\",\"tweet-button\":\"tweet-dialog__tweet-button__9_w_b\",\"tweetButton\":\"tweet-dialog__tweet-button__9_w_b\",\"tweet\":\"tweet-dialog__tweet__xG3SX\",\"editor\":\"tweet-dialog__editor__2pR4G\",\"editor-inner\":\"tweet-dialog__editor-inner__3s0PA\",\"editorInner\":\"tweet-dialog__editor-inner__3s0PA\",\"emoji-button\":\"tweet-dialog__emoji-button__3lY4X\",\"emojiButton\":\"tweet-dialog__emoji-button__3lY4X\",\"counter\":\"tweet-dialog__counter__3FBJ4\",\"media\":\"tweet-dialog__media__2VrJM\",\"posted\":\"tweet-dialog__posted__2uenp\",\"tweet-loader\":\"tweet-dialog__tweet-loader__3ZfG_\",\"tweetLoader\":\"tweet-dialog__tweet-loader__3ZfG_\",\"dialog-background\":\"tweet-dialog__dialog-background__3LyCV\",\"dialogBackground\":\"tweet-dialog__dialog-background__3LyCV\"};","export function findAncestorWithComponent(entity, componentName) {\r\n  while (entity && !(entity.components && entity.components[componentName])) {\r\n    entity = entity.parentNode;\r\n  }\r\n  return entity;\r\n}\r\n","export const createImageBitmap =\r\n  window.createImageBitmap ||\r\n  async function(data) {\r\n    return new Promise(resolve => {\r\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\r\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\r\n\r\n      let srcUrl;\r\n      if (data instanceof Blob) {\r\n        srcUrl = URL.createObjectURL(data);\r\n      } else {\r\n        const canvas = document.createElement(\"canvas\");\r\n        const ctx = canvas.getContext(\"2d\");\r\n        canvas.width = data.width;\r\n        canvas.height = data.height;\r\n        ctx.putImageData(data, 0, 0);\r\n        srcUrl = canvas.toDataURL();\r\n      }\r\n      const img = document.createElement(\"img\");\r\n\r\n      img.addEventListener(\"load\", () => resolve(img));\r\n\r\n      img.src = srcUrl;\r\n    });\r\n  };\r\n\r\nexport function disposeImageBitmap(imageBitmap) {\r\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\r\n    URL.revokeObjectURL(imageBitmap.src);\r\n  } else {\r\n    imageBitmap.close && imageBitmap.close();\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"email-field\":\"sign-in-dialog__email-field__1nkHJ\",\"emailField\":\"sign-in-dialog__email-field__1nkHJ\",\"next-button\":\"sign-in-dialog__next-button__3yK4L\",\"nextButton\":\"sign-in-dialog__next-button__3yK4L\",\"continue-button\":\"sign-in-dialog__continue-button__3w7HU\",\"continueButton\":\"sign-in-dialog__continue-button__3w7HU\",\"sign-in-form\":\"sign-in-dialog__sign-in-form__1arl9\",\"signInForm\":\"sign-in-dialog__sign-in-form__1arl9\",\"sign-in-complete\":\"sign-in-dialog__sign-in-complete__25NJE\",\"signInComplete\":\"sign-in-dialog__sign-in-complete__25NJE\",\"terms\":\"sign-in-dialog__terms__3j0oq\"};","import { waitForDOMContentLoaded } from \"./async-utils\";\r\nimport \"./configs\";\r\n\r\n// Node these should be synchronized with the top of shared.scss\r\nconst DEFAULT_ACTION_COLOR = \"#FF3464\";\r\nconst DEFAULT_ACTION_COLOR_LIGHT = \"#FF74A4\";\r\n\r\nconst DEFAULT_COLORS = {\r\n  \"action-color\": DEFAULT_ACTION_COLOR,\r\n  \"action-label-color\": DEFAULT_ACTION_COLOR,\r\n  \"action-color-disabled\": DEFAULT_ACTION_COLOR_LIGHT,\r\n  \"action-color-highlight\": DEFAULT_ACTION_COLOR_LIGHT,\r\n  \"action-text-color\": \"#FFFFFF\",\r\n  \"action-subtitle-color\": \"#F0F0F0\",\r\n  \"notice-background-color\": \"#2F80ED\",\r\n  \"notice-text-color\": \"#FFFFFF\",\r\n  \"favorited-color\": \"#FFC000\"\r\n};\r\n\r\nfunction getThemeColor(name) {\r\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[name])\r\n    return window.APP_CONFIG.theme[name];\r\n\r\n  return DEFAULT_COLORS[name];\r\n}\r\n\r\nwaitForDOMContentLoaded().then(() => {\r\n  if (window.APP_CONFIG && window.APP_CONFIG.theme && window.APP_CONFIG.theme[\"dark-theme\"]) {\r\n    document.body.classList.add(\"dark-theme\");\r\n  } else {\r\n    document.body.classList.add(\"light-theme\");\r\n  }\r\n\r\n  const actionColor = getThemeColor(\"action-color\");\r\n  const actionHoverColor = getThemeColor(\"action-color-highlight\");\r\n\r\n  if (document.querySelector(\"#rounded-text-button\")) {\r\n    // NOTE, using the object-based {} setAttribute variant in a-frame\r\n    // seems to not work in Firefox here -- the entities with the mixins are not\r\n    // updated.\r\n    document\r\n      .querySelector(\"#rounded-text-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: ${actionHoverColor}; textColor: ${actionColor}; backgroundColor: #fff; backgroundHoverColor: #aaa;`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-text-action-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\r\n      );\r\n\r\n    document\r\n      .querySelector(\"#rounded-action-button\")\r\n      .setAttribute(\r\n        \"text-button\",\r\n        `textHoverColor: #fff; textColor: #fff; backgroundColor: ${actionColor}; backgroundHoverColor: ${actionHoverColor}`\r\n      );\r\n  }\r\n});\r\n\r\nfunction applyThemeToTextButton(el, highlighted) {\r\n  el.setAttribute(\r\n    \"text-button\",\r\n    \"backgroundColor\",\r\n    highlighted ? getThemeColor(\"action-color-highlight\") : getThemeColor(\"action-color\")\r\n  );\r\n  el.setAttribute(\r\n    \"text-button\",\r\n    \"backgroundHoverColor\",\r\n    highlighted ? \"#aaa\" : getThemeColor(\"action-color-highlight\")\r\n  );\r\n}\r\n\r\nexport { applyThemeToTextButton, getThemeColor };\r\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","const VERTEX_SHADER = `\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\nvoid main() {\r\n  #include <uv_vertex>\r\n  #include <uv2_vertex>\r\n  #include <color_vertex>\r\n  #include <skinbase_vertex>\r\n\r\n  #include <begin_vertex>\r\n  #include <morphtarget_vertex>\r\n  #include <skinning_vertex>\r\n  #include <project_vertex>\r\n  #include <logdepthbuf_vertex>\r\n\r\n  #include <worldpos_vertex>\r\n  #include <clipping_planes_vertex>\r\n  #include <fog_vertex>\r\n}\r\n`;\r\n\r\nconst FRAGMENT_SHADER = `\r\nuniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform float opacity;\r\n\r\n#include <common>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\nvoid main() {\r\n  #include <clipping_planes_fragment>\r\n\r\n  vec4 diffuseColor = vec4(diffuse, opacity);\r\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\r\n  vec3 totalEmissiveRadiance = emissive;\r\n\r\n  #include <logdepthbuf_fragment>\r\n  #include <map_fragment>\r\n  #include <color_fragment>\r\n  #include <alphatest_fragment>\r\n  #include <emissivemap_fragment>\r\n\r\n  reflectedLight.indirectDiffuse += vec3(1.0);\r\n\r\n  #include <aomap_fragment>\r\n\r\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\r\n\r\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\r\n\r\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\r\n\r\n  #include <premultiplied_alpha_fragment>\r\n  #include <tonemapping_fragment>\r\n  #include <encodings_fragment>\r\n  #include <fog_fragment>\r\n}\r\n`;\r\n\r\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\r\n  type = \"MobileStandardMaterial\";\r\n  isMobileStandardMaterial = true;\r\n  static fromStandardMaterial(material) {\r\n    const parameters = {\r\n      vertexShader: VERTEX_SHADER,\r\n      fragmentShader: FRAGMENT_SHADER,\r\n      uniforms: {\r\n        ...THREE.UniformsUtils.clone(THREE.UniformsLib.fog),\r\n        uvTransform: { value: new THREE.Matrix3() },\r\n        diffuse: { value: material.color },\r\n        opacity: { value: material.opacity },\r\n        map: { value: material.map },\r\n        aoMapIntensity: { value: material.aoMapIntensity },\r\n        aoMap: { value: material.aoMap },\r\n        emissive: { value: material.emissive },\r\n        emissiveMap: { value: material.emissiveMap }\r\n      },\r\n      fog: true,\r\n      lights: false,\r\n      opacity: material.opacity,\r\n      transparent: material.transparent,\r\n      alphaTest: material.alphaTest,\r\n      skinning: material.skinning,\r\n      morphTargets: material.morphTargets,\r\n      vertexColors: material.vertexColors,\r\n      name: material.name\r\n    };\r\n\r\n    const mobileMaterial = new MobileStandardMaterial(parameters);\r\n\r\n    mobileMaterial.color = material.color;\r\n    mobileMaterial.map = material.map;\r\n    mobileMaterial.aoMap = material.aoMap;\r\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\r\n    mobileMaterial.emissive = material.emissive;\r\n    mobileMaterial.emissiveIntensity = material.emissiveIntensity;\r\n    mobileMaterial.emissiveMap = material.emissiveMap;\r\n\r\n    // TODO this actually needs to get called whenever any of these material properties change\r\n    mobileMaterial.refreshUniforms();\r\n\r\n    return mobileMaterial;\r\n  }\r\n\r\n  refreshUniforms() {\r\n    this.uniforms.opacity.value = this.opacity;\r\n\r\n    if (this.color) {\r\n      this.uniforms.diffuse.value.copy(this.color);\r\n    }\r\n\r\n    if (this.emissive) {\r\n      this.uniforms.emissive.value.copy(this.emissive).multiplyScalar(this.emissiveIntensity);\r\n    }\r\n\r\n    if (this.map) {\r\n      this.uniforms.map.value = this.map;\r\n    }\r\n\r\n    if (this.aoMap) {\r\n      this.uniforms.aoMap.value = this.aoMap;\r\n      this.uniforms.aoMapIntensity.value = this.aoMapIntensity;\r\n    }\r\n\r\n    const uvScaleMap = this.map || this.emissiveMap;\r\n    if (uvScaleMap && uvScaleMap.matrixAutoUpdate === true) {\r\n      uvScaleMap.updateMatrix();\r\n      this.uniforms.uvTransform.value.copy(uvScaleMap.matrix);\r\n    }\r\n  }\r\n\r\n  clone() {\r\n    return MobileStandardMaterial.fromStandardMaterial(this);\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"touchZone\":\"virtual-gamepad-controls__touchZone__RxPRi\",\"left\":\"virtual-gamepad-controls__left__1qnuE\",\"right\":\"virtual-gamepad-controls__right__3u-wL\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__3BUln\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__1tHQ8\",\"inner\":\"virtual-gamepad-controls__inner__2III_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tip-root\":\"tip__tip-root__2Q3Sf\",\"tipRoot\":\"tip__tip-root__2Q3Sf\",\"tip-link\":\"tip__tip-link__3d4Kt\",\"tipLink\":\"tip__tip-link__3d4Kt\",\"tip-cancel\":\"tip__tip-cancel__3Pha0\",\"tipCancel\":\"tip__tip-cancel__3Pha0\",\"tip\":\"tip__tip__1LvQM\",\"split-tip\":\"tip__split-tip__2B0gs\",\"splitTip\":\"tip__split-tip__2B0gs\",\"split-tip-icon\":\"tip__split-tip-icon__1YuAQ\",\"splitTipIcon\":\"tip__split-tip-icon__1YuAQ\",\"spawn_menu-icon\":\"tip__spawn_menu-icon__1W3nW\",\"spawnMenuIcon\":\"tip__spawn_menu-icon__1W3nW\",\"object_rotate_button-icon\":\"tip__object_rotate_button-icon__142gg\",\"objectRotateButtonIcon\":\"tip__object_rotate_button-icon__142gg\",\"object_scale_button-icon\":\"tip__object_scale_button-icon__1kDXW\",\"objectScaleButtonIcon\":\"tip__object_scale_button-icon__1kDXW\",\"object_recenter_button-icon\":\"tip__object_recenter_button-icon__2YU3J\",\"objectRecenterButtonIcon\":\"tip__object_recenter_button-icon__2YU3J\",\"tour-tip-root\":\"tip__tour-tip-root__1Oo43\",\"tourTipRoot\":\"tip__tour-tip-root__1Oo43\"};","module.exports = {\r\n  COLLISION_LAYERS: {\r\n    ALL: -1,\r\n    NONE: 0,\r\n    INTERACTABLES: 1,\r\n    ENVIRONMENT: 2,\r\n    AVATAR: 4,\r\n    HANDS: 8,\r\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\r\n    UNOWNED_INTERACTABLE: 1 | 8,\r\n    DEFAULT_SPAWNER: 1 | 8\r\n  }\r\n};\r\n","// Wrapper for a worker which accepts work items and responds with results.\r\n//\r\n// The worker must receive messages with data of the shape { id, payload }, and then respond\r\n// with messages containing matching IDs of the shape { id, result, err }.\r\n//\r\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\r\n// will resolve with the result or reject with the error.\r\n//\r\nexport function promisifyWorker(worker) {\r\n  let nextItemId = 0;\r\n  const outstanding = {}; // item ID: { resolve, reject }\r\n\r\n  worker.onmessage = msg => {\r\n    const { id, result, err } = msg.data;\r\n    const handlers = outstanding[id];\r\n    if (handlers == null) {\r\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\r\n    } else {\r\n      delete outstanding[id];\r\n      if (err != null) {\r\n        handlers.reject(new Error(err));\r\n      } else {\r\n        handlers.resolve(result);\r\n      }\r\n    }\r\n  };\r\n\r\n  return function(data, transfer, args = {}) {\r\n    const id = nextItemId++;\r\n    const promise = new Promise((resolve, reject) => {\r\n      outstanding[id] = { resolve, reject };\r\n    });\r\n    worker.postMessage(Object.assign(args, { id, payload: data }), transfer);\r\n    return promise;\r\n  };\r\n}\r\n","import { EventTarget } from \"event-target-shim\";\r\nimport configs from \"../utils/configs\";\r\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated, hasReticulumServer } from \"../utils/phoenix-utils\";\r\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\r\n\r\nconst EMPTY_RESULT = { entries: [], meta: {} };\r\n\r\nconst URL_SOURCE_TO_TO_API_SOURCE = {\r\n  scenes: \"scene_listings\",\r\n  images: \"bing_images\",\r\n  videos: \"bing_videos\",\r\n  youtube: \"youtube_videos\",\r\n  gifs: \"tenor\",\r\n  sketchfab: \"sketchfab\",\r\n  poly: \"poly\",\r\n  twitch: \"twitch\",\r\n  favorites: \"favorites\"\r\n};\r\n\r\nconst desiredSources = [\"poly\", \"sketchfab\", \"videos\", \"scenes\", \"avatars\", \"gifs\", \"images\"];\r\nconst availableIntegrations = configs.AVAILABLE_INTEGRATIONS;\r\nconst availableSources = desiredSources.filter(source => {\r\n  const apiSource = URL_SOURCE_TO_TO_API_SOURCE[source];\r\n  return !availableIntegrations.hasOwnProperty(apiSource) || availableIntegrations[apiSource];\r\n});\r\nexport const SOURCES = availableSources;\r\n\r\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\r\n  gifs: \"trending\",\r\n  sketchfab: \"featured\",\r\n  scenes: \"featured\",\r\n  favorites: \"my-favorites\"\r\n};\r\n\r\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\", \"similar_to\"];\r\n\r\n// This class is responsible for fetching and storing media search results and provides a\r\n// convenience API for performing history updates relevant to search navigation.\r\nexport default class MediaSearchStore extends EventTarget {\r\n  constructor() {\r\n    super();\r\n\r\n    this.requestIndex = 0;\r\n  }\r\n\r\n  setHistory(history) {\r\n    this.history = history;\r\n\r\n    this._update(this.history.location);\r\n\r\n    this.history.listen(location => {\r\n      this._update(location);\r\n    });\r\n  }\r\n\r\n  _update = async location => {\r\n    this.result = null;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n\r\n    const urlSource = this.getUrlMediaSource(location);\r\n    if (!urlSource) return;\r\n\r\n    if (!this.previousSource || this.previousSource !== urlSource) {\r\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\r\n      this.previousSource = urlSource;\r\n    }\r\n\r\n    const urlParams = new URLSearchParams(location.search);\r\n\r\n    this.requestIndex++;\r\n    const currentRequestIndex = this.requestIndex;\r\n    const searchParams = new URLSearchParams();\r\n    const locationSearchParams = new URLSearchParams(location.search);\r\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\r\n\r\n    for (const param of SEARCH_CONTEXT_PARAMS) {\r\n      if (!urlParams.get(param)) continue;\r\n      searchParams.set(param, urlParams.get(param));\r\n    }\r\n\r\n    searchParams.get(\"locale\", navigator.languages[0]);\r\n\r\n    let source;\r\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\r\n      // Avatars + scenes are special since we request them from a different source based on the facet.\r\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\r\n      source = isMy ? `${singular}s` : `${singular}_listings`;\r\n    } else {\r\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\r\n    }\r\n    searchParams.set(\"source\", source);\r\n\r\n    let fetch = true;\r\n\r\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\r\n      if (isMy) {\r\n        if (window.APP.store.credentialsAccountId) {\r\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\r\n        } else {\r\n          fetch = false; // Don't fetch my-* if not signed in\r\n        }\r\n      }\r\n    }\r\n\r\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\r\n    const url = getReticulumFetchUrl(path);\r\n    if (this.lastSavedUrl === url) return;\r\n\r\n    this.isFetching = true;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\r\n\r\n    if (this.requestIndex != currentRequestIndex) return;\r\n\r\n    this.result = result;\r\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\r\n    this.lastFetchedUrl = url;\r\n    this.isFetching = false;\r\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\r\n  };\r\n\r\n  pageNavigate = delta => {\r\n    if (delta === -1) {\r\n      this.history.goBack();\r\n    } else {\r\n      const location = this.history.location;\r\n      const searchParams = new URLSearchParams(location.search);\r\n      searchParams.set(\"cursor\", this.nextCursor);\r\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\r\n    }\r\n  };\r\n\r\n  filterQueryNavigate = (filter, query) => {\r\n    const location = this.history.location;\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    searchParams.delete(\"similar_to\");\r\n    searchParams.delete(\"similar_name\");\r\n\r\n    if (query) {\r\n      searchParams.set(\"q\", query);\r\n    } else {\r\n      searchParams.delete(\"q\");\r\n    }\r\n\r\n    if (filter) {\r\n      searchParams.set(\"filter\", filter);\r\n    } else {\r\n      searchParams.delete(\"filter\");\r\n    }\r\n\r\n    if (filter) {\r\n      searchParams.set(\"cursor\", filter);\r\n    } else {\r\n      searchParams.delete(\"cursor\");\r\n    }\r\n\r\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\r\n  };\r\n\r\n  getSearchClearedSearchParams = (location, keepSource, keepNav, keepSelectAction) => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    // Strip browsing query params\r\n    searchParams.delete(\"q\");\r\n    searchParams.delete(\"filter\");\r\n    searchParams.delete(\"cursor\");\r\n    searchParams.delete(\"similar_to\");\r\n    searchParams.delete(\"similar_name\");\r\n\r\n    if (!keepNav) {\r\n      searchParams.delete(\"media_nav\");\r\n    }\r\n\r\n    if (!keepSource) {\r\n      searchParams.delete(\"media_source\");\r\n    }\r\n\r\n    if (!keepSelectAction) {\r\n      searchParams.delete(\"selectAction\");\r\n    }\r\n\r\n    return searchParams;\r\n  };\r\n\r\n  _stashLastSearchParams = location => {\r\n    const searchParams = new URLSearchParams(location.search);\r\n\r\n    this._stashedParams = {};\r\n    this._stashedSource = null;\r\n\r\n    const source = this.getUrlMediaSource(location);\r\n\r\n    // HACK for now do not stash favorite search, since that ends up being a source\r\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\r\n    // proper favorites browser. Then, we should have two separate stashes.\r\n    if (source === \"favorites\") return;\r\n    this._stashedSource = source;\r\n\r\n    for (const param of SEARCH_CONTEXT_PARAMS) {\r\n      const value = searchParams.get(param);\r\n\r\n      if (value) {\r\n        this._stashedParams[param] = value;\r\n      }\r\n    }\r\n  };\r\n\r\n  clearStashedQuery = () => {\r\n    if (!this._stashedParams) return;\r\n    delete this._stashedParams.q;\r\n  };\r\n\r\n  sourceNavigate = source => {\r\n    this._sourceNavigate(source, false, true);\r\n  };\r\n\r\n  sourceNavigateToDefaultSource = () => {\r\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\r\n  };\r\n\r\n  sourceNavigateWithNoNav = (source, selectAction) => {\r\n    this._sourceNavigate(source, true, false, selectAction);\r\n  };\r\n\r\n  _sourceNavigate = async (source, hideNav, useLastStashedParams, selectAction) => {\r\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\r\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\r\n\r\n    if (currentQuery) {\r\n      searchParams.set(\"q\", currentQuery);\r\n    } else {\r\n      if (useLastStashedParams && this._stashedParams) {\r\n        for (const param of SEARCH_CONTEXT_PARAMS) {\r\n          const value = this._stashedParams[param];\r\n\r\n          // Only q param is compatible across sources, so keep it if is stashed.\r\n          const useValue = param === \"q\" || this._stashedSource === source;\r\n\r\n          if (value && useValue) {\r\n            searchParams.set(param, value);\r\n          }\r\n        }\r\n      } else {\r\n        if (source === \"avatars\") {\r\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\r\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\r\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\r\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\r\n        }\r\n      }\r\n    }\r\n\r\n    this._stashedParams = null;\r\n    this._stashedSource = null;\r\n\r\n    if (hideNav) {\r\n      searchParams.set(\"media_nav\", \"false\");\r\n    }\r\n\r\n    if (selectAction) {\r\n      searchParams.set(\"selectAction\", selectAction);\r\n    }\r\n\r\n    if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\r\n      searchParams.set(\"media_source\", source);\r\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\r\n    } else {\r\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\r\n    }\r\n  };\r\n\r\n  _hasAccountWithAvatars = async () => {\r\n    const { credentialsAccountId } = window.APP.store;\r\n    if (!credentialsAccountId) return false;\r\n\r\n    const searchParams = new URLSearchParams();\r\n    const source = \"avatars\";\r\n    searchParams.set(\"source\", source);\r\n    searchParams.set(\"user\", credentialsAccountId);\r\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\r\n    return !!(result && result.entries) && result.entries.length > 0;\r\n  };\r\n\r\n  getUrlMediaSource = location => {\r\n    const { search } = location;\r\n    const urlParams = new URLSearchParams(search);\r\n    const pathname = sluglessPath(location);\r\n\r\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\r\n    return urlParams.get(\"media_source\") || pathname.substring(7);\r\n  };\r\n\r\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\r\n    if (!history) history = this.history;\r\n\r\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\r\n\r\n    const { pathname } = history.location;\r\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\r\n    pushHistoryPath(\r\n      history,\r\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\r\n      this.getSearchClearedSearchParams(history.location).toString()\r\n    );\r\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\r\n  };\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { pushHistoryState, replaceHistoryState } from \"../utils/history\";\r\n\r\nfunction isModifiedEvent(event) {\r\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\r\n}\r\n\r\n/**\r\n * A history-aware link that pushes/replaces the state, but not the path, in the browser history.\r\n */\r\nclass StateLink extends React.Component {\r\n  static propTypes = {\r\n    history: PropTypes.object,\r\n    innerRef: PropTypes.object,\r\n    replace: PropTypes.bool,\r\n    stateKey: PropTypes.string,\r\n    stateValue: PropTypes.string,\r\n    stateDetail: PropTypes.object,\r\n    target: PropTypes.string,\r\n    title: PropTypes.string,\r\n    onClick: PropTypes.func,\r\n    children: PropTypes.node,\r\n    className: PropTypes.string\r\n  };\r\n\r\n  async handleClick(event, history) {\r\n    if (this.props.onClick) this.props.onClick(event);\r\n\r\n    if (\r\n      !event.defaultPrevented && // onClick prevented default\r\n      event.button === 0 && // ignore everything but left clicks\r\n      (!this.props.target || this.props.target === \"_self\") && // let browser handle \"target=_blank\" etc.\r\n      !isModifiedEvent(event) // ignore clicks with modifier keys\r\n    ) {\r\n      event.preventDefault();\r\n      const method = this.props.replace ? replaceHistoryState : pushHistoryState;\r\n      method(history, this.props.stateKey, this.props.stateValue, this.props.stateDetail);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { innerRef, target, className, title, children } = this.props;\r\n    return (\r\n      <a\r\n        target={target}\r\n        className={className}\r\n        title={title}\r\n        onClick={event => this.handleClick(event, this.props.history)}\r\n        href=\"#\"\r\n        ref={innerRef}\r\n      >\r\n        {children}\r\n      </a>\r\n    );\r\n  }\r\n}\r\n\r\nexport default StateLink;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"action-button\":\"create-object-dialog__action-button__12bjO\",\"actionButton\":\"create-object-dialog__action-button__12bjO\",\"buttons\":\"create-object-dialog__buttons__k2WQt\",\"small-button\":\"create-object-dialog__small-button__299GG\",\"smallButton\":\"create-object-dialog__small-button__299GG\",\"input-border\":\"create-object-dialog__input-border__25szk\",\"inputBorder\":\"create-object-dialog__input-border__25szk\",\"left-side-of-input\":\"create-object-dialog__left-side-of-input__EJ8Dc\",\"leftSideOfInput\":\"create-object-dialog__left-side-of-input__EJ8Dc\",\"add-media-form\":\"create-object-dialog__add-media-form__2Oc7U\",\"addMediaForm\":\"create-object-dialog__add-media-form__2Oc7U\",\"cancel-icon\":\"create-object-dialog__cancel-icon__2HGE6\",\"cancelIcon\":\"create-object-dialog__cancel-icon__2HGE6\",\"upload-icon\":\"create-object-dialog__upload-icon__xZFJA\",\"uploadIcon\":\"create-object-dialog__upload-icon__xZFJA\",\"hide-file-input\":\"create-object-dialog__hide-file-input__Gewdg\",\"hideFileInput\":\"create-object-dialog__hide-file-input__Gewdg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"close-button\":\"link-dialog__close-button__lpD7Y\",\"closeButton\":\"link-dialog__close-button__lpD7Y\",\"domain\":\"link-dialog__domain__HkXoX\",\"dialog\":\"link-dialog__dialog__1aUxi\",\"header\":\"link-dialog__header__1iWUI\",\"contents\":\"link-dialog__contents__1AFA8\",\"code\":\"link-dialog__code__Ie48Q\",\"imageHeader\":\"link-dialog__imageHeader__12AA5\",\"keep-open\":\"link-dialog__keep-open__2F9C9\",\"keepOpen\":\"link-dialog__keep-open__2F9C9\",\"digit\":\"link-dialog__digit__2-7hK\",\"code-loading-panel\":\"link-dialog__code-loading-panel__2Ogg9\",\"codeLoadingPanel\":\"link-dialog__code-loading-panel__2Ogg9\",\"close\":\"link-dialog__close__1pAtF\"};","import { detectOS } from \"detect-browser\";\r\n\r\nexport function disableiOSZoom() {\r\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\r\n\r\n  let lastTouchAtMs = 0;\r\n\r\n  document.addEventListener(\"touchmove\", ev => {\r\n    if (ev.scale === 1) return;\r\n\r\n    ev.preventDefault();\r\n  });\r\n\r\n  document.addEventListener(\"touchend\", ev => {\r\n    const now = new Date().getTime();\r\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\r\n    lastTouchAtMs = now;\r\n\r\n    if (isDoubleTouch) {\r\n      ev.preventDefault();\r\n    }\r\n  });\r\n}\r\n","// Provides a global registry of running components\r\nexport function registerComponentInstance(component, name) {\r\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\r\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\r\n  window.APP.componentRegistry[name].push(component);\r\n}\r\n\r\nexport function deregisterComponentInstance(component, name) {\r\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\r\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\r\n}\r\n\r\nexport function getCurrentStreamer() {\r\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\r\n    return null;\r\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\r\n  const presences = window.APP.hubChannel.presence.state;\r\n\r\n  for (let i = 0; i < playerInfos.length; i++) {\r\n    const playerInfo = playerInfos[i];\r\n    const presence = presences[playerInfo.playerSessionId];\r\n\r\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\r\n      return playerInfo;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n","// from https://developer.mozilla.org/en-US/docs/Web/HTTP/Browser_detection_using_the_user_agent\r\nfunction detectTouchScreen() {\r\n  let hasTouchScreen = false;\r\n  if (\"maxTouchPoints\" in navigator) {\r\n    hasTouchScreen = navigator.maxTouchPoints > 0;\r\n  } else if (\"msMaxTouchPoints\" in navigator) {\r\n    hasTouchScreen = navigator.msMaxTouchPoints > 0;\r\n  } else {\r\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\");\r\n    if (mQ && mQ.media === \"(pointer:coarse)\") {\r\n      hasTouchScreen = !!mQ.matches;\r\n    } else if (\"orientation\" in window) {\r\n      hasTouchScreen = true; // deprecated, but good fallback\r\n    } else {\r\n      // Only as a last resort, fall back to user agent sniffing\r\n      const UA = navigator.userAgent;\r\n      hasTouchScreen =\r\n        /\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(UA) || /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(UA);\r\n    }\r\n  }\r\n  return hasTouchScreen;\r\n}\r\n\r\nlet hackyMobileSafariTestValue = null;\r\n\r\n// HACK for https://github.com/mozilla/hubs/issues/1813\r\n// Touchscreen controls depend on iPad and iPhone detection,\r\n// which recently regressed. For UA matching \"Macintosh\", enable\r\n// touchscreen controls if there exists a touchscreen.\r\n// We cannot always enable touchscreen controls when a touchscreen\r\n// is present until we fix conflicts between simultaneous mouse\r\n// and touchscreen interactions.\r\nexport function hackyMobileSafariTest() {\r\n  if (hackyMobileSafariTestValue === null) {\r\n    hackyMobileSafariTestValue = /\\b(Macintosh|iPad|iPhone)\\b/i.test(navigator.userAgent) && detectTouchScreen();\r\n  }\r\n\r\n  return hackyMobileSafariTestValue;\r\n  // e.g. Match\r\n  // Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.1 Safari/605.1.15\r\n  // but not\r\n  // \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\"\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport styles from \"../assets/stylesheets/sign-in-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\n\r\nexport default class SignInDialog extends Component {\r\n  static propTypes = {\r\n    authStarted: PropTypes.bool,\r\n    authComplete: PropTypes.bool,\r\n    onSignIn: PropTypes.func,\r\n    onContinue: PropTypes.func,\r\n    message: PropTypes.string,\r\n    continueText: PropTypes.string,\r\n    closable: PropTypes.bool\r\n  };\r\n\r\n  static defaultProps = {\r\n    closable: true\r\n  };\r\n\r\n  state = {\r\n    email: \"\"\r\n  };\r\n\r\n  onSubmit = e => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.props.onSignIn(this.state.email);\r\n  };\r\n\r\n  render() {\r\n    let contents;\r\n    if (this.props.authStarted) {\r\n      contents = (\r\n        <p>\r\n          <FormattedMessage className=\"preformatted\" id=\"sign-in.auth-started\" />\r\n        </p>\r\n      );\r\n    } else if (this.props.authComplete) {\r\n      contents = (\r\n        <div className={styles.signInComplete}>\r\n          <p>{this.props.message}</p>\r\n          <button onClick={this.props.onContinue} className={styles.continueButton}>\r\n            {this.props.continueText}\r\n          </button>\r\n        </div>\r\n      );\r\n    } else {\r\n      contents = (\r\n        <form onSubmit={this.onSubmit} className={styles.signInForm}>\r\n          <span>{this.props.message}</span>\r\n          <input\r\n            name=\"email\"\r\n            type=\"email\"\r\n            required\r\n            placeholder=\"Your email address\"\r\n            value={this.state.email}\r\n            onFocus={e => handleTextFieldFocus(e.target)}\r\n            onBlur={() => handleTextFieldBlur()}\r\n            onChange={e => this.setState({ email: e.target.value })}\r\n            className={styles.emailField}\r\n          />\r\n          {(configs.feature(\"show_terms\") || configs.feature(\"show_privacy\")) && (\r\n            <p className={styles.terms}>\r\n              By proceeding, you agree to the{\" \"}\r\n              <IfFeature name=\"show_terms\">\r\n                <a\r\n                  rel=\"noopener noreferrer\"\r\n                  target=\"_blank\"\r\n                  href={configs.link(\"terms_of_use\", \"https://github.com/mozilla/hubs/blob/master/TERMS.md\")}\r\n                >\r\n                  terms of use\r\n                </a>{\" \"}\r\n              </IfFeature>\r\n              {configs.feature(\"show_terms\") && configs.feature(\"show_privacy\") && \"and \"}\r\n              <IfFeature name=\"show_privacy\">\r\n                <a\r\n                  rel=\"noopener noreferrer\"\r\n                  target=\"_blank\"\r\n                  href={configs.link(\"privacy_notice\", \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\")}\r\n                >\r\n                  privacy notice\r\n                </a>\r\n              </IfFeature>.\r\n            </p>\r\n          )}\r\n          <button type=\"submit\" className={styles.nextButton}>\r\n            next\r\n          </button>\r\n        </form>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <DialogContainer title=\"Sign In\" {...this.props}>\r\n        {contents}\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import { forEachMaterial } from \"../utils/material-utils\";\r\nimport { showHoverEffect } from \"../utils/permissions-utils\";\r\n\r\nconst interactorOneTransform = [];\r\nconst interactorTwoTransform = [];\r\n\r\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\r\n/**\r\n * Applies effects to a hoverable based on hover state.\r\n * @namespace interactables\r\n * @component hoverable-visuals\r\n */\r\nAFRAME.registerComponent(\"hoverable-visuals\", {\r\n  schema: {\r\n    enableSweepingEffect: { type: \"boolean\", default: true }\r\n  },\r\n  init() {\r\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\r\n    this.uniforms = null;\r\n    this.geometryRadius = 0;\r\n\r\n    this.sweepParams = [0, 0];\r\n  },\r\n  remove() {\r\n    this.uniforms = null;\r\n    this.boundingBox = null;\r\n\r\n    // Used when the object is batched\r\n    const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\r\n    this.el.object3D.traverse(object => {\r\n      if (!object.material) return;\r\n      forEachMaterial(object, material => {\r\n        if (\r\n          !validMaterials.includes(material.type) ||\r\n          object.el.classList.contains(\"ui\") ||\r\n          object.el.classList.contains(\"hud\") ||\r\n          object.el.getAttribute(\"text-button\")\r\n        )\r\n          return;\r\n\r\n        if (batchManagerSystem.batchingEnabled) {\r\n          batchManagerSystem.meshToEl.delete(object);\r\n        }\r\n      });\r\n    });\r\n\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n    this.isTouchscreen = isMobile && !isMobileVR;\r\n  },\r\n  tick(time) {\r\n    if (!this.uniforms || !this.uniforms.length) return;\r\n\r\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\r\n    const showEffect = showHoverEffect(this.el);\r\n    const toggling = this.el.sceneEl.systems[\"hubs-systems\"].cursorTogglingSystem;\r\n\r\n    let interactorOne, interactorTwo;\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\r\n      interactorOne = interaction.options.leftHand.entity.object3D;\r\n    }\r\n    if (\r\n      interaction.state.leftRemote.hovered === this.el &&\r\n      !interaction.state.leftRemote.held &&\r\n      !toggling.leftToggledOff\r\n    ) {\r\n      interactorOne = interaction.options.leftRemote.entity.object3D;\r\n    }\r\n    if (\r\n      interaction.state.rightRemote.hovered === this.el &&\r\n      !interaction.state.rightRemote.held &&\r\n      !toggling.rightToggledOff\r\n    ) {\r\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\r\n    }\r\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\r\n      interactorTwo = interaction.options.rightHand.entity.object3D;\r\n    }\r\n\r\n    if (interactorOne) {\r\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\r\n    }\r\n    if (interactorTwo) {\r\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\r\n    }\r\n\r\n    if (interactorOne || interactorTwo || isFrozen) {\r\n      const worldY = this.el.object3D.matrixWorld.elements[13];\r\n      const ms1 = this.el.object3D.matrixWorld.elements[4];\r\n      const ms2 = this.el.object3D.matrixWorld.elements[5];\r\n      const ms3 = this.el.object3D.matrixWorld.elements[6];\r\n      const worldScale = Math.sqrt(ms1 * ms1 + ms2 * ms2 + ms3 * ms3);\r\n      const scaledRadius = worldScale * this.geometryRadius;\r\n      this.sweepParams[0] = worldY - scaledRadius;\r\n      this.sweepParams[1] = worldY + scaledRadius;\r\n    }\r\n\r\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\r\n      const uniform = this.uniforms[i];\r\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\r\n      uniform.hubs_IsFrozen.value = isFrozen;\r\n      uniform.hubs_SweepParams.value = this.sweepParams;\r\n\r\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect && !this.isTouchscreen;\r\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\r\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\r\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\r\n\r\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect && !this.isTouchscreen;\r\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\r\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\r\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\r\n\r\n      if (interactorOne || interactorTwo || isFrozen) {\r\n        uniform.hubs_Time.value = time;\r\n      }\r\n    }\r\n  }\r\n});\r\n","import { isLocalHubsSceneUrl, proxiedUrlFor } from \"../utils/media-url-utils\";\r\n\r\nexport async function isValidGLB(url) {\r\n  return fetch(url).then(async r => {\r\n    const reader = r.body.getReader();\r\n    let header = \"\";\r\n    function readChunk({ done, value }) {\r\n      header += String.fromCharCode.apply(null, value.slice(0, 4));\r\n      if (!done && header.length < 4) {\r\n        return reader.read().then(readChunk);\r\n      } else {\r\n        reader.cancel();\r\n      }\r\n    }\r\n    await reader.read().then(readChunk);\r\n    return header.startsWith(\"glTF\");\r\n  });\r\n}\r\n\r\nexport async function isValidSceneUrl(url) {\r\n  if (url.trim() === \"\") return false;\r\n  if (!url.startsWith(\"http\")) return false;\r\n  if (await isLocalHubsSceneUrl(url)) {\r\n    return true;\r\n  } else {\r\n    return isValidGLB(proxiedUrlFor(url));\r\n  }\r\n}\r\n\r\n// To assist with content control, we avoid displaying scene links to users who are not the scene\r\n// creator, unless the scene is remixable or promotable.\r\nexport function allowDisplayOfSceneLink(scene, store) {\r\n  return (\r\n    (store.credentialsAccountId && scene.account_id === store.credentialsAccountId) ||\r\n    scene.allow_promotion ||\r\n    scene.allow_remixing\r\n  );\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"load-button\":\"preload-overlay__load-button__MvzCI\",\"loadButton\":\"preload-overlay__load-button__MvzCI\",\"treatment\":\"preload-overlay__treatment__1FqiF\",\"screenshot\":\"preload-overlay__screenshot__3XsBj\",\"hub-name\":\"preload-overlay__hub-name__3ymIj\",\"hubName\":\"preload-overlay__hub-name__3ymIj\",\"main-panel\":\"preload-overlay__main-panel__1F6UD\",\"mainPanel\":\"preload-overlay__main-panel__1F6UD\",\"logo\":\"preload-overlay__logo__1wWPy\"};","import { forEachMaterial } from \"../utils/material-utils\";\r\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\r\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\r\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\r\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\r\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\r\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\r\n\r\nexport async function createDefaultEnvironmentMap() {\r\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\r\n  const texture = await new Promise((resolve, reject) =>\r\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\r\n  );\r\n  texture.format = THREE.RGBFormat;\r\n  return texture;\r\n}\r\n\r\nAFRAME.registerComponent(\"environment-map\", {\r\n  init() {\r\n    this.environmentMap = null;\r\n\r\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\r\n  },\r\n\r\n  updateEnvironmentMap(environmentMap) {\r\n    this.environmentMap = environmentMap;\r\n    this.applyEnvironmentMap(this.el.object3D);\r\n  },\r\n\r\n  applyEnvironmentMap(object3D) {\r\n    object3D.traverse(object => {\r\n      forEachMaterial(object, material => {\r\n        if (material.isMeshStandardMaterial) {\r\n          material.envMap = this.environmentMap;\r\n          material.needsUpdate = true;\r\n        }\r\n      });\r\n    });\r\n  }\r\n});\r\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\r\\n  float ratio = 0.0;\\r\\n  float size = hubs_SweepParams.t - hubs_SweepParams.s;\\r\\n\\r\\n  if (hubs_EnableSweepingEffect) {\\r\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\r\\n\\r\\n    if (hubs_WorldPosition.y < line) {\\r\\n      // Highlight with a sweeping gradient.\\r\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\r\\n    }\\r\\n  }\\r\\n\\r\\n  // Highlight with a gradient falling off with distance.\\r\\n  float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\r\\n\\r\\n  if (hubs_HighlightInteractorOne) {\\r\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\r\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\r\\n  } \\r\\n\\r\\n  if (hubs_HighlightInteractorTwo) {\\r\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\r\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\r\\n  }\\r\\n\\r\\n  ratio = min(1.0, ratio);\\r\\n\\r\\n  // Gamma corrected highlight color\\r\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\r\\n\\r\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\r\\n}\\r\\n\"","module.exports = __webpack_public_path__ + \"assets/wasm/basis_transcoder-47fe610404bbcccd872b6ced44635d10.wasm\";","module.exports = function() {\n  return require(\"!!C:\\\\Projects\\\\hubs\\\\node_modules\\\\worker-loader\\\\dist\\\\workers\\\\InlineWorker.js\")(\"!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\\\"undefined\\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(t,\\\"__esModule\\\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\\\"object\\\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\\\"default\\\",{enumerable:!0,value:t}),2&e&&\\\"string\\\"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\\\"a\\\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\\\"/hubs\\\",r(r.s=1)}([function(t,e){var r,n,o=t.exports={};function i(){throw new Error(\\\"setTimeout has not been defined\\\")}function a(){throw new Error(\\\"clearTimeout has not been defined\\\")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r=\\\"function\\\"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n=\\\"function\\\"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(p);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function y(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new h(t,e)),1!==c.length||l||u(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title=\\\"browser\\\",o.browser=!0,o.env={},o.argv=[],o.version=\\\"\\\",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(t){return[]},o.binding=function(t){throw new Error(\\\"process.binding is not supported\\\")},o.cwd=function(){return\\\"/\\\"},o.chdir=function(t){throw new Error(\\\"process.chdir is not supported\\\")},o.umask=function(){return 0}},function(t,e,r){(function(e,n){var o,i,a,u,s=(o=\\\"undefined\\\"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var i,a=void 0!==(t=t||{})?t:{},u={};for(i in a)a.hasOwnProperty(i)&&(u[i]=a[i]);var s,c,l=[],f=!1,p=!1;f=\\\"object\\\"==typeof window,p=\\\"function\\\"==typeof importScripts,s=\\\"object\\\"==typeof e&&\\\"object\\\"==typeof e.versions&&\\\"string\\\"==typeof e.versions.node&&!f&&!p,c=!f&&!s&&!p;var d,h,y,v,m=\\\"\\\";s?(m=n+\\\"/\\\",d=function(t,e){var n;return y||(y=r(2)),v||(v=r(3)),t=v.normalize(t),n=y.readFileSync(t),e?n:n.toString()},h=function(t){var e=d(t,!0);return e.buffer||(e=new Uint8Array(e)),P(e.buffer),e},e.argv.length>1&&e.argv[1].replace(/\\\\\\\\/g,\\\"/\\\"),l=e.argv.slice(2),e.on(\\\"uncaughtException\\\",function(t){if(!(t instanceof function(t){this.name=\\\"ExitStatus\\\",this.message=\\\"Program terminated with exit(\\\"+t+\\\")\\\",this.status=t}))throw t}),e.on(\\\"unhandledRejection\\\",xe),a.inspect=function(){return\\\"[Emscripten Module object]\\\"}):c?(\\\"undefined\\\"!=typeof read&&(d=function(t){return read(t)}),h=function(t){var e;return\\\"function\\\"==typeof readbuffer?new Uint8Array(readbuffer(t)):(P(\\\"object\\\"==typeof(e=read(t,\\\"binary\\\"))),e)},\\\"undefined\\\"!=typeof scriptArgs?l=scriptArgs:void 0!==arguments&&(l=arguments),\\\"undefined\\\"!=typeof print&&(\\\"undefined\\\"==typeof console&&(console={}),console.log=print,console.warn=console.error=\\\"undefined\\\"!=typeof printErr?printErr:print)):(f||p)&&(p?m=self.location.href:document.currentScript&&(m=document.currentScript.src),o&&(m=o),m=0!==m.indexOf(\\\"blob:\\\")?m.substr(0,m.lastIndexOf(\\\"/\\\")+1):\\\"\\\",d=function(t){var e=new XMLHttpRequest;return e.open(\\\"GET\\\",t,!1),e.send(null),e.responseText},p&&(h=function(t){var e=new XMLHttpRequest;return e.open(\\\"GET\\\",t,!1),e.responseType=\\\"arraybuffer\\\",e.send(null),new Uint8Array(e.response)}));var g=a.print||console.log.bind(console),b=a.printErr||console.warn.bind(console);for(i in u)u.hasOwnProperty(i)&&(a[i]=u[i]);u=null,a.arguments&&(l=a.arguments),a.thisProgram&&a.thisProgram,a.quit&&a.quit;var w,T,C={\\\"f64-rem\\\":function(t,e){return t%e},debugger:function(){}};new Array(0),a.wasmBinary&&(w=a.wasmBinary),a.noExitRuntime&&a.noExitRuntime,\\\"object\\\"!=typeof WebAssembly&&b(\\\"no native wasm support detected\\\");var $=!1;function P(t,e){t||xe(\\\"Assertion failed: \\\"+e)}var _,A,E,F,S,O,j,W,k,x=\\\"undefined\\\"!=typeof TextDecoder?new TextDecoder(\\\"utf8\\\"):void 0;function I(t,e,r){for(var n=e+r,o=e;t[o]&&!(o>=n);)++o;if(o-e>16&&t.subarray&&x)return x.decode(t.subarray(e,o));for(var i=\\\"\\\";e<o;){var a=t[e++];if(128&a){var u=63&t[e++];if(192!=(224&a)){var s=63&t[e++];if((a=224==(240&a)?(15&a)<<12|u<<6|s:(7&a)<<18|u<<12|s<<6|63&t[e++])<65536)i+=String.fromCharCode(a);else{var c=a-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&a)<<6|u)}else i+=String.fromCharCode(a)}return i}function R(t,e){return t?I(E,t,e):\\\"\\\"}function D(t,e){return t%e>0&&(t+=e-t%e),t}function U(t){_=t,a.HEAP8=A=new Int8Array(t),a.HEAP16=F=new Int16Array(t),a.HEAP32=O=new Int32Array(t),a.HEAPU8=E=new Uint8Array(t),a.HEAPU16=S=new Uint16Array(t),a.HEAPU32=j=new Uint32Array(t),a.HEAPF32=W=new Float32Array(t),a.HEAPF64=k=new Float64Array(t)}\\\"undefined\\\"!=typeof TextDecoder&&new TextDecoder(\\\"utf-16le\\\");var B=a.TOTAL_MEMORY||16777216;function M(t){for(;t.length>0;){var e=t.shift();if(\\\"function\\\"!=typeof e){var r=e.func;\\\"number\\\"==typeof r?void 0===e.arg?a.dynCall_v(r):a.dynCall_vi(r,e.arg):r(void 0===e.arg?null:e.arg)}else e()}}(T=a.wasmMemory?a.wasmMemory:new WebAssembly.Memory({initial:B/65536}))&&(_=T.buffer),B=_.byteLength,U(_),O[59864]=5482368;var L=[],N=[],H=[],z=[],V=0,q=null,G=null;a.preloadedImages={},a.preloadedAudios={};var Z=\\\"data:application/octet-stream;base64,\\\";function X(t){return String.prototype.startsWith?t.startsWith(Z):0===t.indexOf(Z)}var J,Y=\\\"basis_transcoder.wasm\\\";function K(){try{if(w)return new Uint8Array(w);if(h)return h(Y);throw\\\"both async and sync fetching of the wasm failed\\\"}catch(t){xe(t)}}function Q(t){var e={env:t,wasi_unstable:t,global:{NaN:NaN,Infinity:1/0},\\\"global.Math\\\":Math,asm2wasm:C};function r(t,e){var r=t.exports;a.asm=r,function(t){if(V--,a.monitorRunDependencies&&a.monitorRunDependencies(V),0==V&&(null!==q&&(clearInterval(q),q=null),G)){var e=G;G=null,e()}}()}function n(t){r(t.instance)}function o(t){return(w||!f&&!p||\\\"function\\\"!=typeof fetch?new Promise(function(t,e){t(K())}):fetch(Y,{credentials:\\\"same-origin\\\"}).then(function(t){if(!t.ok)throw\\\"failed to load wasm binary file at '\\\"+Y+\\\"'\\\";return t.arrayBuffer()}).catch(function(){return K()})).then(function(t){return WebAssembly.instantiate(t,e)}).then(t,function(t){b(\\\"failed to asynchronously prepare wasm: \\\"+t),xe(t)})}if(V++,a.monitorRunDependencies&&a.monitorRunDependencies(V),a.instantiateWasm)try{return a.instantiateWasm(e,r)}catch(t){return b(\\\"Module.instantiateWasm callback failed with error: \\\"+t),!1}return function(){if(w||\\\"function\\\"!=typeof WebAssembly.instantiateStreaming||X(Y)||\\\"function\\\"!=typeof fetch)return o(n);fetch(Y,{credentials:\\\"same-origin\\\"}).then(function(t){return WebAssembly.instantiateStreaming(t,e).then(n,function(t){b(\\\"wasm streaming compile failed: \\\"+t),b(\\\"falling back to ArrayBuffer instantiation\\\"),o(n)})})}(),{}}X(Y)||(J=Y,Y=a.locateFile?a.locateFile(J,m):m+J),a.asm=function(t,e,r){return e.memory=T,e.table=new WebAssembly.Table({initial:342,maximum:342,element:\\\"anyfunc\\\"}),e.__memory_base=1024,e.__table_base=0,Q(e)},N.push({func:function(){We()}});var tt={},et={buffers:[null,[],[]],printChar:function(t,e){var r=et.buffers[t];0===e||10===e?((1===t?g:b)(I(r,0)),r.length=0):r.push(e)},varargs:0,get:function(t){return et.varargs+=4,O[et.varargs-4>>2]},getStr:function(){return R(et.get())},get64:function(){var t=et.get();return et.get(),t},getZero:function(){et.get()}};function rt(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(\\\"Unknown type size: \\\"+t)}}var nt=void 0;function ot(t){for(var e=\\\"\\\",r=t;E[r];)e+=nt[E[r++]];return e}var it={},at={},ut={},st=48,ct=57;function lt(t){if(void 0===t)return\\\"_unknown\\\";var e=(t=t.replace(/[^a-zA-Z0-9_]/g,\\\"$\\\")).charCodeAt(0);return e>=st&&e<=ct?\\\"_\\\"+t:t}function ft(t,e){return t=lt(t),new Function(\\\"body\\\",\\\"return function \\\"+t+'() {\\\\n    \\\"use strict\\\";    return body.apply(this, arguments);\\\\n};\\\\n')(e)}function pt(t,e){var r=ft(e,function(t){this.name=e,this.message=t;var r=new Error(t).stack;void 0!==r&&(this.stack=this.toString()+\\\"\\\\n\\\"+r.replace(/^Error(:[^\\\\n]*)?\\\\n/,\\\"\\\"))});return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+\\\": \\\"+this.message},r}var dt=void 0;function ht(t){throw new dt(t)}var yt=void 0;function vt(t){throw new yt(t)}function mt(t,e,r){function n(e){var n=r(e);n.length!==t.length&&vt(\\\"Mismatched type converter count\\\");for(var o=0;o<t.length;++o)gt(t[o],n[o])}t.forEach(function(t){ut[t]=e});var o=new Array(e.length),i=[],a=0;e.forEach(function(t,e){at.hasOwnProperty(t)?o[e]=at[t]:(i.push(t),it.hasOwnProperty(t)||(it[t]=[]),it[t].push(function(){o[e]=at[t],++a===i.length&&n(o)}))}),0===i.length&&n(o)}function gt(t,e,r){if(r=r||{},!(\\\"argPackAdvance\\\"in e))throw new TypeError(\\\"registerType registeredInstance requires argPackAdvance\\\");var n=e.name;if(t||ht('type \\\"'+n+'\\\" must have a positive integer typeid pointer'),at.hasOwnProperty(t)){if(r.ignoreDuplicateRegistrations)return;ht(\\\"Cannot register type '\\\"+n+\\\"' twice\\\")}if(at[t]=e,delete ut[t],it.hasOwnProperty(t)){var o=it[t];delete it[t],o.forEach(function(t){t()})}}function bt(t){if(!(this instanceof Wt))return!1;if(!(t instanceof Wt))return!1;for(var e=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=t.$$.ptrType.registeredClass,o=t.$$.ptr;e.baseClass;)r=e.upcast(r),e=e.baseClass;for(;n.baseClass;)o=n.upcast(o),n=n.baseClass;return e===n&&r===o}function wt(t){ht(t.$$.ptrType.registeredClass.name+\\\" instance already deleted\\\")}var Tt=!1;function Ct(t){}function $t(t){t.count.value-=1,0===t.count.value&&function(t){t.smartPtr?t.smartPtrType.rawDestructor(t.smartPtr):t.ptrType.registeredClass.rawDestructor(t.ptr)}(t)}function Pt(t){return\\\"undefined\\\"==typeof FinalizationGroup?(Pt=function(t){return t},t):(Tt=new FinalizationGroup(function(t){for(var e=t.next();!e.done;e=t.next()){var r=e.value;r.ptr?$t(r):console.warn(\\\"object already deleted: \\\"+r.ptr)}}),Ct=function(t){Tt.unregister(t.$$)},(Pt=function(t){return Tt.register(t,t.$$,t.$$),t})(t))}function _t(){if(this.$$.ptr||wt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var t,e=Pt(Object.create(Object.getPrototypeOf(this),{$$:{value:(t=this.$$,{count:t.count,deleteScheduled:t.deleteScheduled,preservePointerOnDelete:t.preservePointerOnDelete,ptr:t.ptr,ptrType:t.ptrType,smartPtr:t.smartPtr,smartPtrType:t.smartPtrType})}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function At(){this.$$.ptr||wt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ht(\\\"Object already scheduled for deletion\\\"),Ct(this),$t(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Et(){return!this.$$.ptr}var Ft=void 0,St=[];function Ot(){for(;St.length;){var t=St.pop();t.$$.deleteScheduled=!1,t.delete()}}function jt(){return this.$$.ptr||wt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ht(\\\"Object already scheduled for deletion\\\"),St.push(this),1===St.length&&Ft&&Ft(Ot),this.$$.deleteScheduled=!0,this}function Wt(){}var kt={};function xt(t,e,r){if(void 0===t[e].overloadTable){var n=t[e];t[e]=function(){return t[e].overloadTable.hasOwnProperty(arguments.length)||ht(\\\"Function '\\\"+r+\\\"' called with an invalid number of arguments (\\\"+arguments.length+\\\") - expects one of (\\\"+t[e].overloadTable+\\\")!\\\"),t[e].overloadTable[arguments.length].apply(this,arguments)},t[e].overloadTable=[],t[e].overloadTable[n.argCount]=n}}function It(t,e,r){a.hasOwnProperty(t)?((void 0===r||void 0!==a[t].overloadTable&&void 0!==a[t].overloadTable[r])&&ht(\\\"Cannot register public name '\\\"+t+\\\"' twice\\\"),xt(a,t,t),a.hasOwnProperty(r)&&ht(\\\"Cannot register multiple overloads of a function with the same number of arguments (\\\"+r+\\\")!\\\"),a[t].overloadTable[r]=e):(a[t]=e,void 0!==r&&(a[t].numArguments=r))}function Rt(t,e,r,n,o,i,a,u){this.name=t,this.constructor=e,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=o,this.getActualType=i,this.upcast=a,this.downcast=u,this.pureVirtualFunctions=[]}function Dt(t,e,r){for(;e!==r;)e.upcast||ht(\\\"Expected null or instance of \\\"+r.name+\\\", got an instance of \\\"+e.name),t=e.upcast(t),e=e.baseClass;return t}function Ut(t,e){if(null===e)return this.isReference&&ht(\\\"null is not a valid \\\"+this.name),0;e.$$||ht('Cannot pass \\\"'+he(e)+'\\\" as a '+this.name),e.$$.ptr||ht(\\\"Cannot pass deleted object as a pointer of type \\\"+this.name);var r=e.$$.ptrType.registeredClass;return Dt(e.$$.ptr,r,this.registeredClass)}function Bt(t,e){var r;if(null===e)return this.isReference&&ht(\\\"null is not a valid \\\"+this.name),this.isSmartPointer?(r=this.rawConstructor(),null!==t&&t.push(this.rawDestructor,r),r):0;e.$$||ht('Cannot pass \\\"'+he(e)+'\\\" as a '+this.name),e.$$.ptr||ht(\\\"Cannot pass deleted object as a pointer of type \\\"+this.name),!this.isConst&&e.$$.ptrType.isConst&&ht(\\\"Cannot convert argument of type \\\"+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+\\\" to parameter type \\\"+this.name);var n=e.$$.ptrType.registeredClass;if(r=Dt(e.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(void 0===e.$$.smartPtr&&ht(\\\"Passing raw pointer to smart pointer is illegal\\\"),this.sharingPolicy){case 0:e.$$.smartPtrType===this?r=e.$$.smartPtr:ht(\\\"Cannot convert argument of type \\\"+(e.$$.smartPtrType?e.$$.smartPtrType.name:e.$$.ptrType.name)+\\\" to parameter type \\\"+this.name);break;case 1:r=e.$$.smartPtr;break;case 2:if(e.$$.smartPtrType===this)r=e.$$.smartPtr;else{var o=e.clone();r=this.rawShare(r,de(function(){o.delete()})),null!==t&&t.push(this.rawDestructor,r)}break;default:ht(\\\"Unsupporting sharing policy\\\")}return r}function Mt(t,e){if(null===e)return this.isReference&&ht(\\\"null is not a valid \\\"+this.name),0;e.$$||ht('Cannot pass \\\"'+he(e)+'\\\" as a '+this.name),e.$$.ptr||ht(\\\"Cannot pass deleted object as a pointer of type \\\"+this.name),e.$$.ptrType.isConst&&ht(\\\"Cannot convert argument of type \\\"+e.$$.ptrType.name+\\\" to parameter type \\\"+this.name);var r=e.$$.ptrType.registeredClass;return Dt(e.$$.ptr,r,this.registeredClass)}function Lt(t){return this.fromWireType(j[t>>2])}function Nt(t){return this.rawGetPointee&&(t=this.rawGetPointee(t)),t}function Ht(t){this.rawDestructor&&this.rawDestructor(t)}function zt(t){null!==t&&t.delete()}function Vt(){return Object.keys(Zt).length}function qt(){var t=[];for(var e in Zt)Zt.hasOwnProperty(e)&&t.push(Zt[e]);return t}function Gt(t){Ft=t,St.length&&Ft&&Ft(Ot)}var Zt={};function Xt(t,e){return e=function(t,e){for(void 0===e&&ht(\\\"ptr should not be undefined\\\");t.baseClass;)e=t.upcast(e),t=t.baseClass;return e}(t,e),Zt[e]}function Jt(t,e){return e.ptrType&&e.ptr||vt(\\\"makeClassHandle requires ptr and ptrType\\\"),!!e.smartPtrType!=!!e.smartPtr&&vt(\\\"Both smartPtrType and smartPtr must be specified\\\"),e.count={value:1},Pt(Object.create(t,{$$:{value:e}}))}function Yt(t){var e=this.getPointee(t);if(!e)return this.destructor(t),null;var r=Xt(this.registeredClass,e);if(void 0!==r){if(0===r.$$.count.value)return r.$$.ptr=e,r.$$.smartPtr=t,r.clone();var n=r.clone();return this.destructor(t),n}function o(){return this.isSmartPointer?Jt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:e,smartPtrType:this,smartPtr:t}):Jt(this.registeredClass.instancePrototype,{ptrType:this,ptr:t})}var i,a=this.registeredClass.getActualType(e),u=kt[a];if(!u)return o.call(this);i=this.isConst?u.constPointerType:u.pointerType;var s=function t(e,r,n){if(r===n)return e;if(void 0===n.baseClass)return null;var o=t(e,r,n.baseClass);return null===o?null:n.downcast(o)}(e,this.registeredClass,i.registeredClass);return null===s?o.call(this):this.isSmartPointer?Jt(i.registeredClass.instancePrototype,{ptrType:i,ptr:s,smartPtrType:this,smartPtr:t}):Jt(i.registeredClass.instancePrototype,{ptrType:i,ptr:s})}function Kt(t,e,r,n,o,i,a,u,s,c,l){this.name=t,this.registeredClass=e,this.isReference=r,this.isConst=n,this.isSmartPointer=o,this.pointeeType=i,this.sharingPolicy=a,this.rawGetPointee=u,this.rawConstructor=s,this.rawShare=c,this.rawDestructor=l,o||void 0!==e.baseClass?this.toWireType=Bt:n?(this.toWireType=Ut,this.destructorFunction=null):(this.toWireType=Mt,this.destructorFunction=null)}function Qt(t,e,r){a.hasOwnProperty(t)||vt(\\\"Replacing nonexistant public symbol\\\"),void 0!==a[t].overloadTable&&void 0!==r?a[t].overloadTable[r]=e:(a[t]=e,a[t].argCount=r)}function te(t,e){var r;if(t=ot(t),void 0!==a[\\\"FUNCTION_TABLE_\\\"+t])r=a[\\\"FUNCTION_TABLE_\\\"+t][e];else if(\\\"undefined\\\"!=typeof FUNCTION_TABLE)r=FUNCTION_TABLE[e];else{var n=a[\\\"dynCall_\\\"+t];void 0===n&&void 0===(n=a[\\\"dynCall_\\\"+t.replace(/f/g,\\\"d\\\")])&&ht(\\\"No dynCall invoker for signature: \\\"+t),r=function(r){for(var n=[],o=1;o<t.length;++o)n.push(\\\"a\\\"+o);var i=\\\"return function dynCall_\\\"+t+\\\"_\\\"+e+\\\"(\\\"+n.join(\\\", \\\")+\\\") {\\\\n\\\";return i+=\\\"    return dynCall(rawFunction\\\"+(n.length?\\\", \\\":\\\"\\\")+n.join(\\\", \\\")+\\\");\\\\n\\\",i+=\\\"};\\\\n\\\",new Function(\\\"dynCall\\\",\\\"rawFunction\\\",i)(r,e)}(n)}return\\\"function\\\"!=typeof r&&ht(\\\"unknown function pointer with signature \\\"+t+\\\": \\\"+e),r}var ee=void 0;function re(t){var e=Se(t),r=ot(e);return Oe(e),r}function ne(t,e){var r=[],n={};throw e.forEach(function t(e){n[e]||at[e]||(ut[e]?ut[e].forEach(t):(r.push(e),n[e]=!0))}),new ee(t+\\\": \\\"+r.map(re).join([\\\", \\\"]))}function oe(t,e){for(var r=[],n=0;n<t;n++)r.push(O[(e>>2)+n]);return r}function ie(t){for(;t.length;){var e=t.pop();t.pop()(e)}}function ae(t,e){if(!(t instanceof Function))throw new TypeError(\\\"new_ called with constructor type \\\"+typeof t+\\\" which is not a function\\\");var r=ft(t.name||\\\"unknownFunctionName\\\",function(){});r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return o instanceof Object?o:n}function ue(t,e,r,n,o){var i=e.length;i<2&&ht(\\\"argTypes array size mismatch! Must at least get return value and 'this' types!\\\");for(var a=null!==e[1]&&null!==r,u=!1,s=1;s<e.length;++s)if(null!==e[s]&&void 0===e[s].destructorFunction){u=!0;break}var c=\\\"void\\\"!==e[0].name,l=\\\"\\\",f=\\\"\\\";for(s=0;s<i-2;++s)l+=(0!==s?\\\", \\\":\\\"\\\")+\\\"arg\\\"+s,f+=(0!==s?\\\", \\\":\\\"\\\")+\\\"arg\\\"+s+\\\"Wired\\\";var p=\\\"return function \\\"+lt(t)+\\\"(\\\"+l+\\\") {\\\\nif (arguments.length !== \\\"+(i-2)+\\\") {\\\\nthrowBindingError('function \\\"+t+\\\" called with ' + arguments.length + ' arguments, expected \\\"+(i-2)+\\\" args!');\\\\n}\\\\n\\\";u&&(p+=\\\"var destructors = [];\\\\n\\\");var d=u?\\\"destructors\\\":\\\"null\\\",h=[\\\"throwBindingError\\\",\\\"invoker\\\",\\\"fn\\\",\\\"runDestructors\\\",\\\"retType\\\",\\\"classParam\\\"],y=[ht,n,o,ie,e[0],e[1]];for(a&&(p+=\\\"var thisWired = classParam.toWireType(\\\"+d+\\\", this);\\\\n\\\"),s=0;s<i-2;++s)p+=\\\"var arg\\\"+s+\\\"Wired = argType\\\"+s+\\\".toWireType(\\\"+d+\\\", arg\\\"+s+\\\"); // \\\"+e[s+2].name+\\\"\\\\n\\\",h.push(\\\"argType\\\"+s),y.push(e[s+2]);if(a&&(f=\\\"thisWired\\\"+(f.length>0?\\\", \\\":\\\"\\\")+f),p+=(c?\\\"var rv = \\\":\\\"\\\")+\\\"invoker(fn\\\"+(f.length>0?\\\", \\\":\\\"\\\")+f+\\\");\\\\n\\\",u)p+=\\\"runDestructors(destructors);\\\\n\\\";else for(s=a?1:2;s<e.length;++s){var v=1===s?\\\"thisWired\\\":\\\"arg\\\"+(s-2)+\\\"Wired\\\";null!==e[s].destructorFunction&&(p+=v+\\\"_dtor(\\\"+v+\\\"); // \\\"+e[s].name+\\\"\\\\n\\\",h.push(v+\\\"_dtor\\\"),y.push(e[s].destructorFunction))}return c&&(p+=\\\"var ret = retType.fromWireType(rv);\\\\nreturn ret;\\\\n\\\"),p+=\\\"}\\\\n\\\",h.push(p),ae(Function,h).apply(null,y)}var se=[],ce=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function le(t){t>4&&0==--ce[t].refcount&&(ce[t]=void 0,se.push(t))}function fe(){for(var t=0,e=5;e<ce.length;++e)void 0!==ce[e]&&++t;return t}function pe(){for(var t=5;t<ce.length;++t)if(void 0!==ce[t])return ce[t];return null}function de(t){switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=se.length?se.pop():ce.length;return ce[e]={refcount:1,value:t},e}}function he(t){if(null===t)return\\\"null\\\";var e=typeof t;return\\\"object\\\"===e||\\\"array\\\"===e||\\\"function\\\"===e?t.toString():\\\"\\\"+t}function ye(t,e){switch(e){case 2:return function(t){return this.fromWireType(W[t>>2])};case 3:return function(t){return this.fromWireType(k[t>>3])};default:throw new TypeError(\\\"Unknown float type: \\\"+t)}}function ve(t,e,r){switch(e){case 0:return r?function(t){return A[t]}:function(t){return E[t]};case 1:return r?function(t){return F[t>>1]}:function(t){return S[t>>1]};case 2:return r?function(t){return O[t>>2]}:function(t){return j[t>>2]};default:throw new TypeError(\\\"Unknown integer type: \\\"+t)}}function me(t){return t||ht(\\\"Cannot use deleted val. handle = \\\"+t),ce[t].value}function ge(t,e){var r=at[t];return void 0===r&&ht(e+\\\" has unknown type \\\"+re(t)),r}var be={};function we(t){var e=be[t];return void 0===e?ot(t):e}var Te=[];function Ce(){return\\\"object\\\"==typeof globalThis?globalThis:Function(\\\"return this\\\")()}var $e={};function Pe(){return A.length}!function(){for(var t=new Array(256),e=0;e<256;++e)t[e]=String.fromCharCode(e);nt=t}(),dt=a.BindingError=pt(Error,\\\"BindingError\\\"),yt=a.InternalError=pt(Error,\\\"InternalError\\\"),Wt.prototype.isAliasOf=bt,Wt.prototype.clone=_t,Wt.prototype.delete=At,Wt.prototype.isDeleted=Et,Wt.prototype.deleteLater=jt,Kt.prototype.getPointee=Nt,Kt.prototype.destructor=Ht,Kt.prototype.argPackAdvance=8,Kt.prototype.readValueFromPointer=Lt,Kt.prototype.deleteObject=zt,Kt.prototype.fromWireType=Yt,a.getInheritedInstanceCount=Vt,a.getLiveInheritedInstances=qt,a.flushPendingDeletes=Ot,a.setDelayFunction=Gt,ee=a.UnboundTypeError=pt(Error,\\\"UnboundTypeError\\\"),a.count_emval_handles=fe,a.get_first_emval=pe;var _e={c:xe,A:function(t){},i:function(t){return je(t)},I:function(){throw $=!0,\\\"Pure virtual function called!\\\"},h:function(t,e,r){throw tt[t]={ptr:t,adjusted:[t],type:e,destructor:r,refcount:0,caught:!1,rethrown:!1},\\\"uncaught_exception\\\"in Fe?Fe.uncaught_exceptions++:Fe.uncaught_exceptions=1,t},z:function(){return Fe.uncaught_exceptions},m:function(t){return a.___errno_location&&(O[a.___errno_location()>>2]=t),t},y:function(t,e){et.varargs=e;try{return et.getStreamFromFD(),et.get(),et.get(),et.get(),et.get(),0}catch(t){return\\\"undefined\\\"!=typeof FS&&t instanceof FS.ErrnoError||xe(t),-t.errno}},x:function(t,e){et.varargs=e;try{return et.getStreamFromFD(),0}catch(t){return\\\"undefined\\\"!=typeof FS&&t instanceof FS.ErrnoError||xe(t),-t.errno}},w:function(){return function(t,e,r,n){try{for(var o=0,i=0;i<r;i++){for(var a=O[e+8*i>>2],u=O[e+(8*i+4)>>2],s=0;s<u;s++)et.printChar(t,E[a+s]);o+=u}return O[n>>2]=o,0}catch(t){return\\\"undefined\\\"!=typeof FS&&t instanceof FS.ErrnoError||xe(t),-t.errno}}.apply(null,arguments)},v:function(t,e,r,n,o){var i=rt(r);gt(t,{name:e=ot(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?n:o},argPackAdvance:8,readValueFromPointer:function(t){var n;if(1===r)n=A;else if(2===r)n=F;else{if(4!==r)throw new TypeError(\\\"Unknown boolean type size: \\\"+e);n=O}return this.fromWireType(n[t>>i])},destructorFunction:null})},N:function(t,e,r,n,o,i,a,u,s,c,l,f,p){l=ot(l),i=te(o,i),u&&(u=te(a,u)),c&&(c=te(s,c)),p=te(f,p);var d=lt(l);It(d,function(){ne(\\\"Cannot construct \\\"+l+\\\" due to unbound types\\\",[n])}),mt([t,e,r],n?[n]:[],function(e){var r,o;e=e[0],o=n?(r=e.registeredClass).instancePrototype:Wt.prototype;var a=ft(d,function(){if(Object.getPrototypeOf(this)!==s)throw new dt(\\\"Use 'new' to construct \\\"+l);if(void 0===f.constructor_body)throw new dt(l+\\\" has no accessible constructor\\\");var t=f.constructor_body[arguments.length];if(void 0===t)throw new dt(\\\"Tried to invoke ctor of \\\"+l+\\\" with invalid number of parameters (\\\"+arguments.length+\\\") - expected (\\\"+Object.keys(f.constructor_body).toString()+\\\") parameters instead!\\\");return t.apply(this,arguments)}),s=Object.create(o,{constructor:{value:a}});a.prototype=s;var f=new Rt(l,a,s,p,r,i,u,c),h=new Kt(l,f,!0,!1,!1),y=new Kt(l+\\\"*\\\",f,!1,!1,!1),v=new Kt(l+\\\" const*\\\",f,!1,!0,!1);return kt[t]={pointerType:y,constPointerType:v},Qt(d,a),[h,y,v]})},M:function(t,e,r,n,o,i){var a=oe(e,r);o=te(n,o),mt([],[t],function(t){var r=\\\"constructor \\\"+(t=t[0]).name;if(void 0===t.registeredClass.constructor_body&&(t.registeredClass.constructor_body=[]),void 0!==t.registeredClass.constructor_body[e-1])throw new dt(\\\"Cannot register multiple constructors with identical number of parameters (\\\"+(e-1)+\\\") for class '\\\"+t.name+\\\"'! Overload resolution is currently only performed using the parameter count, not actual type info!\\\");return t.registeredClass.constructor_body[e-1]=function(){ne(\\\"Cannot construct \\\"+t.name+\\\" due to unbound types\\\",a)},mt([],a,function(n){return t.registeredClass.constructor_body[e-1]=function(){arguments.length!==e-1&&ht(r+\\\" called with \\\"+arguments.length+\\\" arguments, expected \\\"+(e-1));var t=[],a=new Array(e);a[0]=i;for(var u=1;u<e;++u)a[u]=n[u].toWireType(t,arguments[u-1]);var s=o.apply(null,a);return ie(t),n[0].fromWireType(s)},[]}),[]})},g:function(t,e,r,n,o,i,a,u){var s=oe(r,n);e=ot(e),i=te(o,i),mt([],[t],function(t){var n=(t=t[0]).name+\\\".\\\"+e;function o(){ne(\\\"Cannot call \\\"+n+\\\" due to unbound types\\\",s)}u&&t.registeredClass.pureVirtualFunctions.push(e);var c=t.registeredClass.instancePrototype,l=c[e];return void 0===l||void 0===l.overloadTable&&l.className!==t.name&&l.argCount===r-2?(o.argCount=r-2,o.className=t.name,c[e]=o):(xt(c,e,n),c[e].overloadTable[r-2]=o),mt([],s,function(o){var u=ue(n,o,t,i,a);return void 0===c[e].overloadTable?(u.argCount=r-2,c[e]=u):c[e].overloadTable[r-2]=u,[]}),[]})},L:function(t,e){gt(t,{name:e=ot(e),fromWireType:function(t){var e=ce[t].value;return le(t),e},toWireType:function(t,e){return de(e)},argPackAdvance:8,readValueFromPointer:Lt,destructorFunction:null})},u:function(t,e,r){var n=rt(r);gt(t,{name:e=ot(e),fromWireType:function(t){return t},toWireType:function(t,e){if(\\\"number\\\"!=typeof e&&\\\"boolean\\\"!=typeof e)throw new TypeError('Cannot convert \\\"'+he(e)+'\\\" to '+this.name);return e},argPackAdvance:8,readValueFromPointer:ye(e,n),destructorFunction:null})},K:function(t,e,r,n,o,i){var a=oe(e,r);t=ot(t),o=te(n,o),It(t,function(){ne(\\\"Cannot call \\\"+t+\\\" due to unbound types\\\",a)},e-1),mt([],a,function(r){var n=[r[0],null].concat(r.slice(1));return Qt(t,ue(t,n,null,o,i),e-1),[]})},f:function(t,e,r,n,o){e=ot(e),-1===o&&(o=4294967295);var i=rt(r),a=function(t){return t};if(0===n){var u=32-8*r;a=function(t){return t<<u>>>u}}var s=-1!=e.indexOf(\\\"unsigned\\\");gt(t,{name:e,fromWireType:a,toWireType:function(t,r){if(\\\"number\\\"!=typeof r&&\\\"boolean\\\"!=typeof r)throw new TypeError('Cannot convert \\\"'+he(r)+'\\\" to '+this.name);if(r<n||r>o)throw new TypeError('Passing a number \\\"'+he(r)+'\\\" from JS side to C/C++ side to an argument of type \\\"'+e+'\\\", which is outside the valid range ['+n+\\\", \\\"+o+\\\"]!\\\");return s?r>>>0:0|r},argPackAdvance:8,readValueFromPointer:ve(e,i,0!==n),destructorFunction:null})},e:function(t,e,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];function o(t){var e=j,r=e[t>>=2],o=e[t+1];return new n(e.buffer,o,r)}gt(t,{name:r=ot(r),fromWireType:o,argPackAdvance:8,readValueFromPointer:o},{ignoreDuplicateRegistrations:!0})},t:function(t,e){var r=\\\"std::string\\\"===(e=ot(e));gt(t,{name:e,fromWireType:function(t){var e,n=j[t>>2];if(r){var o=E[t+4+n],i=0;0!=o&&(i=o,E[t+4+n]=0);for(var a=t+4,u=0;u<=n;++u){var s=t+4+u;if(0==E[s]){var c=R(a);void 0===e?e=c:(e+=String.fromCharCode(0),e+=c),a=s+1}}0!=i&&(E[t+4+n]=i)}else{var l=new Array(n);for(u=0;u<n;++u)l[u]=String.fromCharCode(E[t+4+u]);e=l.join(\\\"\\\")}return Oe(t),e},toWireType:function(t,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var n=\\\"string\\\"==typeof e;n||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||ht(\\\"Cannot pass non-string to std::string\\\");var o=(r&&n?function(){return function(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&t.charCodeAt(++r)),n<=127?++e:e+=n<=2047?2:n<=65535?3:4}return e}(e)}:function(){return e.length})(),i=je(4+o+1);if(j[i>>2]=o,r&&n)!function(t,e,r,n){if(!(n>0))return 0;for(var o=r+n-1,i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++i)),a<=127){if(r>=o)break;e[r++]=a}else if(a<=2047){if(r+1>=o)break;e[r++]=192|a>>6,e[r++]=128|63&a}else if(a<=65535){if(r+2>=o)break;e[r++]=224|a>>12,e[r++]=128|a>>6&63,e[r++]=128|63&a}else{if(r+3>=o)break;e[r++]=240|a>>18,e[r++]=128|a>>12&63,e[r++]=128|a>>6&63,e[r++]=128|63&a}}e[r]=0}(e,E,i+4,o+1);else if(n)for(var a=0;a<o;++a){var u=e.charCodeAt(a);u>255&&(Oe(i),ht(\\\"String has UTF-16 code units that do not fit in 8 bits\\\")),E[i+4+a]=u}else for(a=0;a<o;++a)E[i+4+a]=e[a];return null!==t&&t.push(Oe,i),i},argPackAdvance:8,readValueFromPointer:Lt,destructorFunction:function(t){Oe(t)}})},J:function(t,e,r){var n,o;r=ot(r),2===e?(n=function(){return S},o=1):4===e&&(n=function(){return j},o=2),gt(t,{name:r,fromWireType:function(t){for(var e=n(),r=j[t>>2],i=new Array(r),a=t+4>>o,u=0;u<r;++u)i[u]=String.fromCharCode(e[a+u]);return Oe(t),i.join(\\\"\\\")},toWireType:function(t,r){var i=n(),a=r.length,u=je(4+a*e);j[u>>2]=a;for(var s=u+4>>o,c=0;c<a;++c)i[s+c]=r.charCodeAt(c);return null!==t&&t.push(Oe,u),u},argPackAdvance:8,readValueFromPointer:Lt,destructorFunction:function(t){Oe(t)}})},H:function(t,e){gt(t,{isVoid:!0,name:e=ot(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(t,e){}})},s:function(t,e,r){t=me(t),e=ge(e,\\\"emval::as\\\");var n=[],o=de(n);return O[r>>2]=o,e.toWireType(n,t)},r:function(t,e,r,n){(t=Te[t])(e=me(e),r=we(r),null,n)},b:le,G:function(t){return 0===t?de(Ce()):(t=we(t),de(Ce()[t]))},q:function(t,e){for(var r=function(t,e,r){for(var n=new Array(t),o=0;o<t;++o)n[o]=ge(O[(e>>2)+o],\\\"parameter \\\"+o);return n}(t,e),n=r[0],o=n.name+\\\"_$\\\"+r.slice(1).map(function(t){return t.name}).join(\\\"_\\\")+\\\"$\\\",i=[\\\"retType\\\"],a=[n],u=\\\"\\\",s=0;s<t-1;++s)u+=(0!==s?\\\", \\\":\\\"\\\")+\\\"arg\\\"+s,i.push(\\\"argType\\\"+s),a.push(r[1+s]);var c=\\\"return function \\\"+lt(\\\"methodCaller_\\\"+o)+\\\"(handle, name, destructors, args) {\\\\n\\\",l=0;for(s=0;s<t-1;++s)c+=\\\"    var arg\\\"+s+\\\" = argType\\\"+s+\\\".readValueFromPointer(args\\\"+(l?\\\"+\\\"+l:\\\"\\\")+\\\");\\\\n\\\",l+=r[s+1].argPackAdvance;for(c+=\\\"    var rv = handle[name](\\\"+u+\\\");\\\\n\\\",s=0;s<t-1;++s)r[s+1].deleteObject&&(c+=\\\"    argType\\\"+s+\\\".deleteObject(arg\\\"+s+\\\");\\\\n\\\");n.isVoid||(c+=\\\"    return retType.toWireType(destructors, rv);\\\\n\\\"),c+=\\\"};\\\\n\\\",i.push(c);var f,p,d=ae(Function,i).apply(null,a);return f=d,p=Te.length,Te.push(f),p},p:function(t){return t=we(t),de(a[t])},k:function(t,e){return de((t=me(t))[e=me(e)])},l:function(t){t>4&&(ce[t].refcount+=1)},o:function(t,e,r,n){t=me(t);var o=$e[e];return o||(o=function(t){for(var e=\\\"\\\",r=0;r<t;++r)e+=(0!==r?\\\", \\\":\\\"\\\")+\\\"arg\\\"+r;var n=\\\"return function emval_allocator_\\\"+t+\\\"(constructor, argTypes, args) {\\\\n\\\";for(r=0;r<t;++r)n+=\\\"var argType\\\"+r+\\\" = requireRegisteredType(Module['HEAP32'][(argTypes >> 2) + \\\"+r+'], \\\"parameter '+r+'\\\");\\\\nvar arg'+r+\\\" = argType\\\"+r+\\\".readValueFromPointer(args);\\\\nargs += argType\\\"+r+\\\"['argPackAdvance'];\\\\n\\\";return n+=\\\"var obj = new constructor(\\\"+e+\\\");\\\\nreturn __emval_register(obj);\\\\n}\\\\n\\\",new Function(\\\"requireRegisteredType\\\",\\\"Module\\\",\\\"__emval_register\\\",n)(ge,a,de)}(e),$e[e]=o),o(t,r,n)},j:function(t){return de(we(t))},n:function(t){ie(ce[t].value),le(t)},d:function(){a.abort()},F:Pe,E:function(t,e,r){E.set(E.subarray(e,e+r),t)},D:function(t){var e=Pe();if(t>2147418112)return!1;for(var r=Math.max(e,16777216);r<t;)r=r<=536870912?D(2*r,65536):Math.min(D((3*r+2147483648)/4,65536),2147418112);return!!function(t){try{return T.grow(t-_.byteLength+65535>>16),U(T.buffer),1}catch(t){}}(r)},C:function(){xe(\\\"trap!\\\")},B:function(t){xe(\\\"OOM\\\")},a:239456},Ae=a.asm({},_e,_);a.asm=Ae;var Ee,Fe=a.__ZSt18uncaught_exceptionv=function(){return a.asm.O.apply(null,arguments)},Se=(a.___embind_register_native_and_builtin_types=function(){return a.asm.P.apply(null,arguments)},a.___errno_location=function(){return a.asm.Q.apply(null,arguments)},a.___getTypeName=function(){return a.asm.R.apply(null,arguments)}),Oe=a._free=function(){return a.asm.S.apply(null,arguments)},je=a._malloc=function(){return a.asm.T.apply(null,arguments)},We=a.globalCtors=function(){return a.asm.ha.apply(null,arguments)};function ke(t){function e(){Ee||(Ee=!0,$||(M(N),M(H),a.onRuntimeInitialized&&a.onRuntimeInitialized(),function(){if(a.postRun)for(\\\"function\\\"==typeof a.postRun&&(a.postRun=[a.postRun]);a.postRun.length;)t=a.postRun.shift(),z.unshift(t);var t;M(z)}()))}t=t||l,V>0||(function(){if(a.preRun)for(\\\"function\\\"==typeof a.preRun&&(a.preRun=[a.preRun]);a.preRun.length;)t=a.preRun.shift(),L.unshift(t);var t;M(L)}(),V>0||(a.setStatus?(a.setStatus(\\\"Running...\\\"),setTimeout(function(){setTimeout(function(){a.setStatus(\\\"\\\")},1),e()},1)):e()))}function xe(t){throw a.onAbort&&a.onAbort(t),g(t+=\\\"\\\"),b(t),$=!0,\\\"abort(\\\"+t+\\\"). Build with -s ASSERTIONS=1 for more info.\\\"}if(a.dynCall_ii=function(){return a.asm.U.apply(null,arguments)},a.dynCall_iidiiii=function(){return a.asm.V.apply(null,arguments)},a.dynCall_iii=function(){return a.asm.W.apply(null,arguments)},a.dynCall_iiii=function(){return a.asm.X.apply(null,arguments)},a.dynCall_iiiii=function(){return a.asm.Y.apply(null,arguments)},a.dynCall_iiiiii=function(){return a.asm.Z.apply(null,arguments)},a.dynCall_iiiiiiii=function(){return a.asm._.apply(null,arguments)},a.dynCall_iiiiiiiii=function(){return a.asm.$.apply(null,arguments)},a.dynCall_jiji=function(){return a.asm.aa.apply(null,arguments)},a.dynCall_v=function(){return a.asm.ba.apply(null,arguments)},a.dynCall_vi=function(){return a.asm.ca.apply(null,arguments)},a.dynCall_vii=function(){return a.asm.da.apply(null,arguments)},a.dynCall_viiii=function(){return a.asm.ea.apply(null,arguments)},a.dynCall_viiiii=function(){return a.asm.fa.apply(null,arguments)},a.dynCall_viiiiii=function(){return a.asm.ga.apply(null,arguments)},a.asm=Ae,a.then=function(t){if(Ee)t(a);else{var e=a.onRuntimeInitialized;a.onRuntimeInitialized=function(){e&&e(),t(a)}}return a},G=function t(){Ee||ke(),Ee||(G=t)},a.run=ke,a.abort=xe,a.preInit)for(\\\"function\\\"==typeof a.preInit&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return ke(),t});t.exports=s,onmessage=function(t){var e,r,n=t.data;switch(n.type){case\\\"init\\\":i=n.config,e=n.transcoderBinary,a=new Promise(t=>{s(r={wasmBinary:e,onRuntimeInitialized:t})}).then(()=>{var{BasisFile:t,initializeBasis:e}=r;u=t,e()});break;case\\\"transcode\\\":a.then(()=>{try{for(var{width:t,height:e,hasAlpha:r,mipmaps:o,format:a}=function(t){var e=new u(new Uint8Array(t)),r=e.getImageWidth(0,0),n=e.getImageHeight(0,0),o=e.getNumLevels(0),a=e.getHasAlpha();function s(){e.close(),e.delete()}if(!a)switch(i.format){case 9:i.format=8}if(!r||!n||!o)throw s(),new Error(\\\"THREE.BasisTextureLoader:  Invalid .basis file\\\");if(!e.startTranscoding())throw s(),new Error(\\\"THREE.BasisTextureLoader: .startTranscoding failed\\\");for(var c=[],l=0;l<o;l++){var f=e.getImageWidth(0,l),p=e.getImageHeight(0,l),d=new Uint8Array(e.getImageTranscodedSizeInBytes(0,l,i.format)),h=e.transcodeImage(d,0,l,i.format,a,0);if(!h)throw s(),new Error(\\\"THREE.BasisTextureLoader: .transcodeImage failed.\\\");c.push({data:d,width:f,height:p})}return s(),{width:r,height:n,hasAlpha:a,mipmaps:c,format:i.format}}(n.buffer),s=[],c=0;c<o.length;++c)s.push(o[c].data.buffer);i.returnBuffer&&s.push(n.buffer),self.postMessage({type:\\\"transcode\\\",id:n.id,width:t,height:e,hasAlpha:r,mipmaps:o,format:a,buffer:i.returnBuffer?n.buffer:null},s)}catch(t){console.error(t),self.postMessage({type:\\\"error\\\",id:n.id,error:t.message})}})}}}).call(this,r(0),\\\"/\\\")},function(t,e){},function(t,e,r){(function(t){function r(t,e){for(var r=0,n=t.length-1;n>=0;n--){var o=t[n];\\\".\\\"===o?t.splice(n,1):\\\"..\\\"===o?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift(\\\"..\\\");return t}var n=/^(\\\\/?|)([\\\\s\\\\S]*?)((?:\\\\.{1,2}|[^\\\\/]+?|)(\\\\.[^.\\\\/]*|))(?:[\\\\/]*)$/,o=function(t){return n.exec(t).slice(1)};function i(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}e.resolve=function(){for(var e=\\\"\\\",n=!1,o=arguments.length-1;o>=-1&&!n;o--){var a=o>=0?arguments[o]:t.cwd();if(\\\"string\\\"!=typeof a)throw new TypeError(\\\"Arguments to path.resolve must be strings\\\");a&&(e=a+\\\"/\\\"+e,n=\\\"/\\\"===a.charAt(0))}return(n?\\\"/\\\":\\\"\\\")+(e=r(i(e.split(\\\"/\\\"),function(t){return!!t}),!n).join(\\\"/\\\"))||\\\".\\\"},e.normalize=function(t){var n=e.isAbsolute(t),o=\\\"/\\\"===a(t,-1);return(t=r(i(t.split(\\\"/\\\"),function(t){return!!t}),!n).join(\\\"/\\\"))||n||(t=\\\".\\\"),t&&o&&(t+=\\\"/\\\"),(n?\\\"/\\\":\\\"\\\")+t},e.isAbsolute=function(t){return\\\"/\\\"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,function(t,e){if(\\\"string\\\"!=typeof t)throw new TypeError(\\\"Arguments to path.join must be strings\\\");return t}).join(\\\"/\\\"))},e.relative=function(t,r){function n(t){for(var e=0;e<t.length&&\\\"\\\"===t[e];e++);for(var r=t.length-1;r>=0&&\\\"\\\"===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=e.resolve(t).substr(1),r=e.resolve(r).substr(1);for(var o=n(t.split(\\\"/\\\")),i=n(r.split(\\\"/\\\")),a=Math.min(o.length,i.length),u=a,s=0;s<a;s++)if(o[s]!==i[s]){u=s;break}var c=[];for(s=u;s<o.length;s++)c.push(\\\"..\\\");return(c=c.concat(i.slice(u))).join(\\\"/\\\")},e.sep=\\\"/\\\",e.delimiter=\\\":\\\",e.dirname=function(t){var e=o(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):\\\".\\\"},e.basename=function(t,e){var r=o(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},e.extname=function(t){return o(t)[3]};var a=\\\"b\\\"===\\\"ab\\\".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(this,r(0))}]);\\n//# sourceMappingURL=basis_transcoder.worker-95a71f078806021bd3c4.js.map\", \"/\" + \"assets/js/basis_transcoder.worker-95a71f078806021bd3c4.js\");\n};","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import Store from \"./storage/store\";\r\nimport MediaSearchStore from \"./storage/media-search-store\";\r\n\r\nexport class App {\r\n  constructor() {\r\n    this.scene = null;\r\n    this.quality = \"low\";\r\n    this.store = new Store();\r\n    this.mediaSearchStore = new MediaSearchStore();\r\n  }\r\n\r\n  setQuality(quality) {\r\n    if (this.quality === quality) {\r\n      return false;\r\n    }\r\n\r\n    this.quality = quality;\r\n\r\n    if (this.scene) {\r\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { injectIntl, FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport \"three/examples/js/controls/OrbitControls\";\r\n\r\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\r\nimport { loadGLTF } from \"../components/gltf-model-plus\";\r\nimport { disposeNode, findNode } from \"../utils/three-utils\";\r\nimport { ensureAvatarMaterial, MAT_NAME } from \"../utils/avatar-utils\";\r\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\r\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\r\n\r\nconst TEXTURE_PROPS = {\r\n  base_map: [\"map\"],\r\n  emissive_map: [\"emissiveMap\"],\r\n  normal_map: [\"normalMap\"],\r\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\r\n};\r\n\r\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\r\n\r\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\r\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\r\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\r\n  const context = canvas.getContext(\"webgl2\", {\r\n    alpha,\r\n    depth: true,\r\n    antialias: true,\r\n    premultipliedAlpha: true,\r\n    preserveDrawingBuffer: false,\r\n    powerPreference: \"default\"\r\n  });\r\n\r\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context, forceWebVR: true });\r\n  renderer.gammaOutput = true;\r\n  renderer.gammaFactor = 2.2;\r\n  renderer.physicallyCorrectLights = true;\r\n  if (useDevicePixelRatio) {\r\n    renderer.setPixelRatio(window.devicePixelRatio);\r\n  }\r\n  return renderer;\r\n}\r\n\r\nconst createImageBitmapFromURL = url =>\r\n  fetch(url)\r\n    .then(r => r.blob())\r\n    .then(createImageBitmap);\r\n\r\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.Math.DEG2RAD, 30 * THREE.Math.DEG2RAD, 0);\r\nconst DEFAULT_MARGIN = 1;\r\n\r\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\r\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\r\n  const halfVertFOV = THREE.Math.degToRad(camera.fov / 2);\r\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\r\n  camera.position.applyEuler(ORBIT_ANGLE);\r\n  camera.position.add(center);\r\n  camera.lookAt(center);\r\n}\r\n\r\nclass AvatarPreview extends Component {\r\n  static propTypes = {\r\n    avatarGltfUrl: PropTypes.string,\r\n    className: PropTypes.string,\r\n    onGltfLoaded: PropTypes.func\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { loading: true, error: null };\r\n    this.avatar = null;\r\n    this.imageBitmaps = {};\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this.scene = new THREE.Scene();\r\n\r\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\r\n    this.controls = new THREE.OrbitControls(this.camera, this.canvas);\r\n    this.controls.enablePan = false;\r\n\r\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\r\n    light.position.set(0, 10, 10);\r\n    this.scene.add(light);\r\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\r\n\r\n    this.loadId = 0;\r\n\r\n    this.camera.position.set(-0.2, 0.5, 0.5);\r\n    this.camera.matrixAutoUpdate = true;\r\n\r\n    this.controls.target.set(0, 0.45, 0);\r\n    this.controls.update();\r\n\r\n    if (this.props.avatarGltfUrl) {\r\n      this.loadCurrentAvatarGltfUrl();\r\n    }\r\n\r\n    const clock = new THREE.Clock();\r\n\r\n    this.snapshotCanvas = document.createElement(\"canvas\");\r\n    this.snapshotCanvas.width = 720;\r\n    this.snapshotCanvas.height = 1280;\r\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\r\n    this.snapshotCamera.matrixAutoUpdate = true;\r\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\r\n    this.snapshotRenderer.setClearAlpha(0);\r\n\r\n    this.previewRenderer = createRenderer(this.canvas);\r\n    this.previewRenderer.setClearColor(0xeaeaea);\r\n    this.previewRenderer.setAnimationLoop(() => {\r\n      const dt = clock.getDelta();\r\n      this.mixer && this.mixer.update(dt);\r\n      this.previewRenderer.render(this.scene, this.camera);\r\n    });\r\n    window.addEventListener(\"resize\", this.resize);\r\n    this.resize();\r\n  };\r\n\r\n  resize = () => {\r\n    const width = this.canvas.parentElement.offsetWidth;\r\n    const height = this.canvas.parentElement.offsetHeight;\r\n    this.previewRenderer.setSize(width, height);\r\n    this.camera.aspect = width / height;\r\n    this.camera.updateProjectionMatrix();\r\n  };\r\n\r\n  setAvatar = avatar => {\r\n    if (!avatar) return;\r\n    this.avatar = avatar;\r\n    this.scene.add(avatar);\r\n    this.resetCamera();\r\n    this.setState({ error: null, loading: false });\r\n  };\r\n\r\n  resetCamera = (() => {\r\n    const box = new THREE.Box3();\r\n    const center = new THREE.Vector3();\r\n    return () => {\r\n      box.setFromObject(this.avatar);\r\n      box.getCenter(center);\r\n\r\n      // Shift the center vertically in order to frame the avatar nicely.\r\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\r\n\r\n      fitBoxInFrustum(this.camera, box, center);\r\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\r\n\r\n      this.controls.target.copy(center);\r\n      this.controls.update();\r\n    };\r\n  })();\r\n\r\n  componentWillUnmount = () => {\r\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\r\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\r\n    // contexts by holding on to them directly or indirectly.\r\n\r\n    this.scene && this.scene.traverse(disposeNode);\r\n    if (this.previewRenderer) {\r\n      this.previewRenderer.dispose();\r\n      this.previewRenderer.context = null;\r\n    }\r\n    if (this.snapshotRenderer) {\r\n      this.snapshotRenderer.dispose();\r\n      this.snapshotRenderer.context = null;\r\n    }\r\n    if (this.controls) {\r\n      this.controls.dispose();\r\n      this.controls.domElement = null;\r\n    }\r\n\r\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\r\n    window.removeEventListener(\"resize\", this.resize);\r\n  };\r\n\r\n  componentDidUpdate = async oldProps => {\r\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\r\n      if (this.avatar) {\r\n        this.scene.remove(this.avatar);\r\n        this.avatar = null;\r\n      }\r\n      if (this.props.avatarGltfUrl) {\r\n        this.setState({ error: null, loading: true });\r\n        await this.loadCurrentAvatarGltfUrl();\r\n      }\r\n    }\r\n    this.applyMaps(oldProps, this.props);\r\n  };\r\n\r\n  async loadCurrentAvatarGltfUrl() {\r\n    const newLoadId = ++this.loadId;\r\n    const gltf = await this.loadPreviewAvatar(this.props.avatarGltfUrl);\r\n    // If we had started loading another avatar while we were loading this one, throw this one away\r\n    if (newLoadId !== this.loadId) return;\r\n    if (gltf && this.props.onGltfLoaded) this.props.onGltfLoaded(gltf);\r\n    this.setAvatar(gltf.scene);\r\n  }\r\n\r\n  applyMaps(oldProps, newProps) {\r\n    return Promise.all(\r\n      ALL_MAPS.map(mapName => {\r\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\r\n        if (oldProps[mapName] != newProps[mapName]) {\r\n          if (newProps[mapName] instanceof File) {\r\n            return createImageBitmap(newProps[mapName]).then(applyMap);\r\n          } else if (newProps[mapName]) {\r\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\r\n          } else {\r\n            return this.revertMap(mapName);\r\n          }\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  loadPreviewAvatar = async avatarGltfUrl => {\r\n    let gltf;\r\n    try {\r\n      const technique = window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\r\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\", technique, null, ensureAvatarMaterial);\r\n    } catch (e) {\r\n      console.error(\"Failed to load avatar preview\", e);\r\n      this.setState({ loading: false, error: true });\r\n      return;\r\n    }\r\n\r\n    // TODO Check for \"Bot_Skinned\" here is a hack for legacy avatars which only has a name one of the MOZ_alt_material nodes\r\n    this.previewMesh = findNode(\r\n      gltf.scene,\r\n      n => (n.isMesh && n.material && n.material.name === MAT_NAME) || n.name === \"Bot_Skinned\"\r\n    );\r\n\r\n    if (!this.previewMesh) {\r\n      console.error(\"Failed to find avatar preview mesh\");\r\n      this.setState({ loading: false, error: true });\r\n      return;\r\n    }\r\n\r\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\r\n    if (idleAnimation) {\r\n      this.mixer = new THREE.AnimationMixer(gltf.scene);\r\n      const action = this.mixer.clipAction(idleAnimation);\r\n      action.enabled = true;\r\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\r\n      this.idleAnimationAction = action;\r\n    }\r\n\r\n    const { material } = this.previewMesh;\r\n    if (material) {\r\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\r\n      const getImage = p => material[p] && delete material[p].onUpdate && material[p].image;\r\n      this.originalMaps = {\r\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\r\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\r\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\r\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\r\n      };\r\n\r\n      await Promise.all([\r\n        this.applyMaps({}, this.props), // Apply initial maps\r\n        createDefaultEnvironmentMap().then(t => {\r\n          this.previewMesh.material.envMap = t;\r\n          this.previewMesh.material.needsUpdate = true;\r\n        })\r\n      ]);\r\n    } else {\r\n      this.originalMaps = {};\r\n    }\r\n\r\n    return gltf;\r\n  };\r\n\r\n  applyMapToPreview = (name, image) => {\r\n    if (this.imageBitmaps[name]) {\r\n      disposeImageBitmap(this.imageBitmaps[name]);\r\n    }\r\n    this.imageBitmaps[name] = image;\r\n    TEXTURE_PROPS[name].forEach(prop => {\r\n      const texture = this.previewMesh.material[prop];\r\n      texture.image = image;\r\n      texture.needsUpdate = true;\r\n    });\r\n  };\r\n\r\n  revertMap = name => {\r\n    if (this.imageBitmaps[name]) {\r\n      disposeImageBitmap(this.imageBitmaps[name]);\r\n    }\r\n    delete this.imageBitmaps[name];\r\n    this.originalMaps[name].forEach((bm, i) => {\r\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\r\n      texture.image = bm;\r\n      texture.needsUpdate = true;\r\n    });\r\n  };\r\n\r\n  snapshot = () => {\r\n    return new Promise(resolve => {\r\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\r\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\r\n      this.snapshotCanvas.toBlob(blob => {\r\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\r\n        resolve(blob);\r\n      });\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={classNames(styles.preview, this.props.className)}>\r\n        {!this.props.avatarGltfUrl ||\r\n          (this.state.loading &&\r\n            !this.state.error && (\r\n              <div className=\"loader\">\r\n                <div className=\"loader-center\" />\r\n              </div>\r\n            ))}\r\n        {this.props.avatarGltfUrl &&\r\n          (this.state.error && !this.state.loading) && (\r\n            <div className=\"error\">\r\n              <img\r\n                src=\"../assets/images/warning_icon.png\"\r\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\r\n                className=\"error-icon\"\r\n              />\r\n              <FormattedMessage id=\"avatar-preview.loading-failed\" />\r\n            </div>\r\n          )}\r\n        <canvas ref={c => (this.canvas = c)} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default injectIntl(AvatarPreview, { withRef: true });\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"action-button\":\"change-scene-dialog__action-button__yPEnq\",\"actionButton\":\"change-scene-dialog__action-button__yPEnq\",\"buttons\":\"change-scene-dialog__buttons__1YBr9\",\"spoke-launch\":\"change-scene-dialog__spoke-launch__3-NLN\",\"spokeLaunch\":\"change-scene-dialog__spoke-launch__3-NLN\",\"input-border\":\"change-scene-dialog__input-border__3-PUj\",\"inputBorder\":\"change-scene-dialog__input-border__3-PUj\",\"left-side-of-input\":\"change-scene-dialog__left-side-of-input__AncE_\",\"leftSideOfInput\":\"change-scene-dialog__left-side-of-input__AncE_\",\"change-scene-button\":\"change-scene-dialog__change-scene-button__wY1bH\",\"changeSceneButton\":\"change-scene-dialog__change-scene-button__wY1bH\",\"spoke-create\":\"change-scene-dialog__spoke-create__QcNEA\",\"spokeCreate\":\"change-scene-dialog__spoke-create__QcNEA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"oauth-discord-button\":\"oauth-dialog__oauth-discord-button__1fck8\",\"oauthDiscordButton\":\"oauth-dialog__oauth-discord-button__1fck8\",\"oauth-twitter-button\":\"oauth-dialog__oauth-twitter-button__e36W9\",\"oauthTwitterButton\":\"oauth-dialog__oauth-twitter-button__e36W9\",\"oauth-button\":\"oauth-dialog__oauth-button__2Gz9U\",\"oauthButton\":\"oauth-dialog__oauth-button__2Gz9U\",\"oauth-type-name\":\"oauth-dialog__oauth-type-name__hlC5_\",\"oauthTypeName\":\"oauth-dialog__oauth-type-name__hlC5_\",\"oauth-icon\":\"oauth-dialog__oauth-icon__20PJ6\",\"oauthIcon\":\"oauth-dialog__oauth-icon__20PJ6\",\"privacy-notice\":\"oauth-dialog__privacy-notice__351Xi\",\"privacyNotice\":\"oauth-dialog__privacy-notice__351Xi\",\"oauth-buttons\":\"oauth-dialog__oauth-buttons__1Sipw\",\"oauthButtons\":\"oauth-dialog__oauth-buttons__1Sipw\",\"twitter-message\":\"oauth-dialog__twitter-message__mnG_y\",\"twitterMessage\":\"oauth-dialog__twitter-message__mnG_y\"};","/*\r\nHACK Fix a-frame's device detection in Chrome when WebXR or WebVR flags are enabled in\r\nchrome://flags. See https://github.com/mozilla/hubs/issues/892\r\n*/\r\nif (!/Oculus/.test(navigator.userAgent) && navigator.xr && !navigator.xr.requestDevice) {\r\n  navigator.xr.requestDevice = () => Promise.reject({ message: \"Hubs: requestDevice not supported.\" });\r\n}\r\n/*\r\nHACK Call getVRDisplays to force Oculus Browser to use WebVR, which in turn disables the WebXR API.\r\n*/\r\nif (/Oculus/.test(navigator.userAgent)) {\r\n  navigator.getVRDisplays();\r\n}\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { easeOutQuadratic } from \"../utils/easing\";\r\n\r\n// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\r\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\r\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\r\n// the avatar is quiet during that entire duration (eg they are muted)\r\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\r\nconst DISABLE_GRACE_PERIOD_MS = 10000;\r\nconst MIN_VOLUME_THRESHOLD = 0.08;\r\n\r\nconst calculateVolume = (analyser, levels) => {\r\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\r\n  analyser.getByteTimeDomainData(levels);\r\n  let sum = 0;\r\n  for (let i = 0; i < levels.length; i++) {\r\n    const amplitude = (levels[i] - 128) / 128;\r\n    sum += amplitude * amplitude;\r\n  }\r\n  const currVolume = Math.sqrt(sum / levels.length);\r\n  return currVolume;\r\n};\r\n\r\nconst tempScaleFromPosition = new THREE.Vector3();\r\nconst tempScaleToPosition = new THREE.Vector3();\r\n\r\nexport function getAudioFeedbackScale(fromObject, toObject, minScale, maxScale, volume) {\r\n  tempScaleToPosition.setFromMatrixPosition(toObject.matrixWorld);\r\n  tempScaleFromPosition.setFromMatrixPosition(fromObject.matrixWorld);\r\n  const distance = tempScaleFromPosition.distanceTo(tempScaleToPosition) / 10;\r\n  return Math.min(maxScale, minScale + (maxScale - minScale) * volume * 8 * distance);\r\n}\r\n\r\nfunction updateVolume(component) {\r\n  const newRawVolume = calculateVolume(component.analyser, component.levels);\r\n\r\n  const newPerceivedVolume = Math.log(THREE.Math.mapLinear(newRawVolume, 0, 1, 1, Math.E));\r\n\r\n  component.volume = newPerceivedVolume < MIN_VOLUME_THRESHOLD ? 0 : newPerceivedVolume;\r\n\r\n  const s = component.volume > component.prevVolume ? 0.35 : 0.3;\r\n  component.volume = s * component.volume + (1 - s) * component.prevVolume;\r\n  component.prevVolume = component.volume;\r\n}\r\n\r\n/**\r\n * Updates a `volume` property based on a networked audio source\r\n * @namespace avatar\r\n * @component networked-audio-analyser\r\n */\r\nAFRAME.registerComponent(\"networked-audio-analyser\", {\r\n  async init() {\r\n    this.volume = 0;\r\n    this.prevVolume = 0;\r\n    this.loudest = 0;\r\n\r\n    this._updateAnalysis = this._updateAnalysis.bind(this);\r\n    this._runScheduledWork = this._runScheduledWork.bind(this);\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateAnalysis, \"audio-analyser\");\r\n    this.el.addEventListener(\"sound-source-set\", event => {\r\n      const ctx = THREE.AudioContext.getContext();\r\n      this.analyser = ctx.createAnalyser();\r\n      this.analyser.fftSize = 32;\r\n      this.levels = new Uint8Array(this.analyser.fftSize);\r\n      event.detail.soundSource.connect(this.analyser);\r\n    });\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\r\n  },\r\n\r\n  tick: function(t) {\r\n    if (!this.avatarIsQuiet) {\r\n      this._updateAnalysis(t);\r\n    }\r\n  },\r\n\r\n  _runScheduledWork: function() {\r\n    if (this.avatarIsQuiet) {\r\n      this._updateAnalysis();\r\n    }\r\n  },\r\n\r\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\r\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\r\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\r\n  // tick updates until the volume exceeds the level again.\r\n  _updateAnalysis: function(t) {\r\n    if (!this.analyser) return;\r\n\r\n    updateVolume(this);\r\n\r\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\r\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\r\n        this.avatarIsQuiet = true;\r\n      }\r\n    } else {\r\n      if (t) {\r\n        this.lastSeenVolume = t;\r\n      }\r\n\r\n      this.avatarIsQuiet = false;\r\n    }\r\n  }\r\n});\r\n\r\nfunction connectAnalyser(mediaStream) {\r\n  const ctx = THREE.AudioContext.getContext();\r\n  const source = ctx.createMediaStreamSource(mediaStream);\r\n  const analyser = ctx.createAnalyser();\r\n  analyser.fftSize = 32;\r\n  const levels = new Uint8Array(analyser.fftSize);\r\n  source.connect(analyser);\r\n  return { analyser, levels };\r\n}\r\n\r\nfunction getAnalyser(el) {\r\n  // Is this the local player\r\n  const ikRootEl = findAncestorWithComponent(el, \"ik-root\");\r\n  if (ikRootEl && ikRootEl.id === \"avatar-rig\") {\r\n    return el.sceneEl.systems[\"local-audio-analyser\"];\r\n  } else {\r\n    const analyserEl = findAncestorWithComponent(el, \"networked-audio-analyser\");\r\n    if (!analyserEl) return null;\r\n    return analyserEl.components[\"networked-audio-analyser\"];\r\n  }\r\n}\r\n\r\n/**\r\n * Calculates volume of the local audio stream.\r\n */\r\nAFRAME.registerSystem(\"local-audio-analyser\", {\r\n  init() {\r\n    this.volume = 0;\r\n    this.loudest = 0;\r\n    this.prevVolume = 0;\r\n\r\n    this.el.addEventListener(\"local-media-stream-created\", e => {\r\n      const mediaStream = e.detail.mediaStream;\r\n      if (this.stream) {\r\n        console.warn(\"media stream changed\", this.stream, mediaStream);\r\n        // TODO: cleanup?\r\n      }\r\n      this.stream = mediaStream;\r\n      const { analyser, levels } = connectAnalyser(mediaStream);\r\n      this.analyser = analyser;\r\n      this.levels = levels;\r\n    });\r\n  },\r\n\r\n  tick: function() {\r\n    if (!this.analyser) return;\r\n    updateVolume(this);\r\n  }\r\n});\r\n\r\n/**\r\n * Sets an entity's scale base on the volume of an audio-analyser in a parent entity.\r\n * @namespace avatar\r\n * @component scale-audio-feedback\r\n */\r\nAFRAME.registerComponent(\"scale-audio-feedback\", {\r\n  schema: {\r\n    minScale: { default: 1 },\r\n    maxScale: { default: 1.5 }\r\n  },\r\n\r\n  async init() {\r\n    await waitForDOMContentLoaded();\r\n    this.camera = document.getElementById(\"viewing-camera\").object3D;\r\n  },\r\n\r\n  tick() {\r\n    // TODO: come up with a cleaner way to handle this.\r\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\r\n    if (!this.el.object3D.visible) return;\r\n    if (!this.camera) return;\r\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\r\n\r\n    const { minScale, maxScale } = this.data;\r\n\r\n    const { object3D } = this.el;\r\n\r\n    const scale = getAudioFeedbackScale(\r\n      this.el.object3D,\r\n      this.camera,\r\n      minScale,\r\n      maxScale,\r\n      this.analyser ? this.analyser.volume : 0\r\n    );\r\n\r\n    object3D.scale.setScalar(scale);\r\n    object3D.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n\r\n/**\r\n * Animates a morph target based on an audio-analyser in a parent entity\r\n * @namespace avatar\r\n * @component morph-audio-feedback\r\n */\r\nAFRAME.registerComponent(\"morph-audio-feedback\", {\r\n  schema: {\r\n    name: { default: \"\" },\r\n    minValue: { default: 0 },\r\n    maxValue: { default: 2 }\r\n  },\r\n\r\n  init() {\r\n    this.mesh = this.el.object3DMap.skinnedmesh;\r\n    this.morphNumber = this.mesh.morphTargetDictionary[this.data.name];\r\n  },\r\n\r\n  tick() {\r\n    if (!this.mesh) return;\r\n\r\n    if (!this.analyser) this.analyser = getAnalyser(this.el);\r\n\r\n    const { minValue, maxValue } = this.data;\r\n    this.mesh.morphTargetInfluences[this.morphNumber] = THREE.Math.mapLinear(\r\n      easeOutQuadratic(this.analyser ? this.analyser.volume : 0),\r\n      0,\r\n      1,\r\n      minValue,\r\n      maxValue\r\n    );\r\n  }\r\n});\r\n\r\nconst SPRITE_NAMES = {\r\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\r\n  MIC_HOVER: [\r\n    \"mic-0_hover.png\",\r\n    \"mic-1_hover.png\",\r\n    \"mic-2_hover.png\",\r\n    \"mic-3_hover.png\",\r\n    \"mic-4_hover.png\",\r\n    \"mic-5_hover.png\",\r\n    \"mic-6_hover.png\",\r\n    \"mic-7_hover.png\"\r\n  ],\r\n  MIC_OFF: [\r\n    \"mic-off-0.png\",\r\n    \"mic-off-1.png\",\r\n    \"mic-off-2.png\",\r\n    \"mic-off-3.png\",\r\n    \"mic-off-4.png\",\r\n    \"mic-off-5.png\",\r\n    \"mic-off-6.png\",\r\n    \"mic-off-7.png\"\r\n  ],\r\n  MIC_OFF_HOVER: [\r\n    \"mic-off-0_hover.png\",\r\n    \"mic-off-1_hover.png\",\r\n    \"mic-off-2_hover.png\",\r\n    \"mic-off-3_hover.png\",\r\n    \"mic-off-4_hover.png\",\r\n    \"mic-off-5_hover.png\",\r\n    \"mic-off-6_hover.png\",\r\n    \"mic-off-7_hover.png\"\r\n  ]\r\n};\r\n\r\nexport function micLevelForVolume(volume) {\r\n  return THREE.Math.clamp(Math.ceil(THREE.Math.mapLinear(volume - 0.05, 0, 1, 0, 7)), 0, 7);\r\n}\r\n\r\nAFRAME.registerComponent(\"mic-button\", {\r\n  schema: {\r\n    active: { type: \"boolean\" },\r\n    tooltip: { type: \"selector\" },\r\n    tooltipText: { type: \"string\" },\r\n    activeTooltipText: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this.prevSpriteName = \"\";\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n    this.hovering = false;\r\n    this.onHover = () => {\r\n      this.hovering = true;\r\n      this.data.tooltip.setAttribute(\"visible\", true);\r\n    };\r\n    this.onHoverOut = () => {\r\n      this.hovering = false;\r\n      this.data.tooltip.setAttribute(\"visible\", false);\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  update() {\r\n    if (this.data.tooltip) {\r\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\r\n    const active = this.data.active;\r\n    const hovering = this.hovering;\r\n    const spriteNames =\r\n      SPRITE_NAMES[!active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\r\n    const level = micLevelForVolume(audioAnalyser.volume);\r\n    const spriteName = spriteNames[level];\r\n    if (spriteName !== this.prevSpriteName) {\r\n      this.prevSpriteName = spriteName;\r\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\r\n    }\r\n\r\n    if (this.data.tooltip && hovering) {\r\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\r\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\r\n    }\r\n  }\r\n});\r\n","import configs from \"../utils/configs\";\r\n\r\nexport default function UnlessFeature(props) {\r\n  return (!configs.feature(props.name) && props.children) || null;\r\n}\r\n","import uuid from \"uuid/v4\";\r\n\r\nexport default class AuthChannel {\r\n  constructor(store) {\r\n    this.store = store;\r\n    this.socket = null;\r\n    this._signedIn = !!this.store.state.credentials.token;\r\n  }\r\n\r\n  setSocket = socket => {\r\n    this.socket = socket;\r\n  };\r\n\r\n  get email() {\r\n    return this.store.state.credentials.email;\r\n  }\r\n\r\n  get signedIn() {\r\n    return this._signedIn;\r\n  }\r\n\r\n  signOut = async hubChannel => {\r\n    if (hubChannel) {\r\n      await hubChannel.signOut();\r\n    }\r\n    this.store.update({ credentials: { token: null, email: null } });\r\n    await this.store.resetToRandomDefaultAvatar();\r\n    this._signedIn = false;\r\n  };\r\n\r\n  verifyAuthentication(authTopic, authToken, authPayload) {\r\n    const channel = this.socket.channel(authTopic);\r\n    return new Promise((resolve, reject) => {\r\n      channel.onError(() => {\r\n        channel.leave();\r\n        reject();\r\n      });\r\n\r\n      channel\r\n        .join()\r\n        .receive(\"ok\", () => {\r\n          channel.on(\"auth_credentials\", async ({ credentials: token, payload: payload }) => {\r\n            await this.handleAuthCredentials(payload.email, token);\r\n            resolve();\r\n          });\r\n\r\n          channel.push(\"auth_verified\", { token: authToken, payload: authPayload });\r\n        })\r\n        .receive(\"error\", reject);\r\n    });\r\n  }\r\n\r\n  async startAuthentication(email, hubChannel) {\r\n    const channel = this.socket.channel(`auth:${uuid()}`);\r\n    await new Promise((resolve, reject) =>\r\n      channel\r\n        .join()\r\n        .receive(\"ok\", resolve)\r\n        .receive(\"error\", reject)\r\n    );\r\n\r\n    const authComplete = new Promise(resolve =>\r\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\r\n        await this.handleAuthCredentials(email, token, hubChannel);\r\n        resolve();\r\n      })\r\n    );\r\n\r\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\r\n\r\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\r\n    // for authComplete.\r\n    return { authComplete };\r\n  }\r\n\r\n  async handleAuthCredentials(email, token, hubChannel) {\r\n    this.store.update({ credentials: { email, token } });\r\n\r\n    if (hubChannel) {\r\n      await hubChannel.signIn(token);\r\n    }\r\n\r\n    this._signedIn = true;\r\n  }\r\n}\r\n","export function addAnimationComponents(modelEl) {\r\n  if (!modelEl.components[\"animation-mixer\"]) {\r\n    return;\r\n  }\r\n\r\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\r\n    modelEl.setAttribute(\"loop-animation\", \"\");\r\n  }\r\n}\r\n","export function easeOutQuadratic(t) {\r\n  return t * (2 - t);\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png\";","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png\";","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\r\n// via the query string.\r\nimport debug from \"debug\";\r\nimport qsTruthy from \"./qs_truthy\";\r\n\r\nconst qs = new URLSearchParams(location.search);\r\nconst isDebug = qsTruthy(\"debug\");\r\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\r\n\r\nif (logFilter) {\r\n  debug.enable(logFilter);\r\n}\r\n","export default function maskEmail(email) {\r\n  if (!email) return \"\";\r\n  const emailParts = email.split(\"@\");\r\n  const emailIdentity = emailParts[0];\r\n  const emailDomain = emailParts[1];\r\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\r\n  return `${truncatedIdentity}...@${emailDomain}`;\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { injectIntl, FormattedMessage } from \"react-intl\";\r\n\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/room-info-dialog.scss\";\r\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\r\nimport { allowDisplayOfSceneLink } from \"../utils/scene-url-utils\";\r\n\r\nclass RoomInfoDialog extends Component {\r\n  static propTypes = {\r\n    hubName: PropTypes.string,\r\n    hubDescription: PropTypes.string,\r\n    scene: PropTypes.object,\r\n    store: PropTypes.object\r\n  };\r\n\r\n  render() {\r\n    const hasDescription = !!this.props.hubDescription;\r\n    const hasScene = !!this.props.scene;\r\n\r\n    const showSceneLink = hasScene && allowDisplayOfSceneLink(this.props.scene, this.props.store);\r\n\r\n    const toAttributionDiv = (a, i) => {\r\n      if (a.url) {\r\n        const source = a.url.includes(\"sketchfab.com\")\r\n          ? \"on Sketchfab\"\r\n          : a.url.includes(\"poly.google.com\")\r\n            ? \"on Google Poly\"\r\n            : \"\";\r\n\r\n        return (\r\n          <div className={styles.attribution} key={`${a.url} ${i}`}>\r\n            <div className={styles.attributionName}>\r\n              <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                {a.name}\r\n              </a>\r\n            </div>\r\n            <div className={styles.attributionAuthor}>\r\n              by {a.author} {source}\r\n            </div>\r\n          </div>\r\n        );\r\n      } else {\r\n        return (\r\n          <div className={styles.attribution} key={`${a.name} ${a.author} {i}`}>\r\n            <div className={styles.attributionName}>{a.name}</div>\r\n            <div className={styles.attributionAuthor}>by {a.author}</div>\r\n          </div>\r\n        );\r\n      }\r\n    };\r\n\r\n    let attributions = null;\r\n    let creator = null;\r\n\r\n    if (hasScene && this.props.scene.attributions) {\r\n      creator = this.props.scene.attributions.creator;\r\n      attributions = (\r\n        <div>\r\n          {this.props.scene.attributions.content && this.props.scene.attributions.content.map(toAttributionDiv)}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    const title = (\r\n      <div className={styles.title}>\r\n        {hasDescription && hasScene ? <FormattedMessage id=\"room-info.title\" /> : this.props.hubName}\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <DialogContainer title={title} wide={true} {...this.props}>\r\n        {hasDescription && (\r\n          <>\r\n            {hasScene && <div className={styles.hubTitle}>{this.props.hubName}</div>}\r\n            <div className={styles.description}>{this.props.hubDescription}</div>\r\n          </>\r\n        )}\r\n        {hasScene && (\r\n          <>\r\n            <div className={styles.subtitle}>\r\n              <FormattedMessage id=\"room-info.scene-info\" />\r\n            </div>\r\n            <div className={styles.roomInfo}>\r\n              <div className={styles.sceneScreenshot}>\r\n                {showSceneLink ? (\r\n                  <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                    <img src={scaledThumbnailUrlFor(this.props.scene.screenshot_url, 400, 480)} />\r\n                  </a>\r\n                ) : (\r\n                  <img src={scaledThumbnailUrlFor(this.props.scene.screenshot_url, 400, 480)} />\r\n                )}\r\n              </div>\r\n              <div className={styles.sceneDetails}>\r\n                <div className={styles.sceneMain}>\r\n                  <div className={styles.sceneName}>\r\n                    {showSceneLink ? (\r\n                      <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        {this.props.scene.name}\r\n                      </a>\r\n                    ) : (\r\n                      <span>{this.props.scene.name}</span>\r\n                    )}\r\n                  </div>\r\n                  <div className={styles.sceneCreator}>{creator}</div>\r\n                </div>\r\n                <div className={styles.sceneAttributions}>{attributions}</div>\r\n                <div className={styles.sceneButtons}> </div>\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\nexport default injectIntl(RoomInfoDialog);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport dayjs from \"dayjs-ext\";\r\nimport relativeTime from \"dayjs-ext/plugin/relativeTime\";\r\nimport { injectIntl, FormattedMessage } from \"react-intl\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\r\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\r\nimport { faExternalLinkAlt } from \"@fortawesome/free-solid-svg-icons/faExternalLinkAlt\";\r\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\r\nimport { faInfo } from \"@fortawesome/free-solid-svg-icons/faInfo\";\r\nimport { faClone } from \"@fortawesome/free-solid-svg-icons/faClone\";\r\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\r\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons/faSearch\";\r\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\r\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\r\n\r\nimport IfFeature from \"./if-feature\";\r\nimport styles from \"../assets/stylesheets/media-browser.scss\";\r\nimport { proxiedUrlFor, scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\r\nimport StateLink from \"./state-link\";\r\nimport { remixAvatar } from \"../utils/avatar-utils\";\r\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\r\nimport { getReticulumFetchUrl } from \"../utils/phoenix-utils\";\r\n\r\ndayjs.extend(relativeTime);\r\n\r\nconst PUBLISHER_FOR_ENTRY_TYPE = {\r\n  sketchfab_model: \"Sketchfab\",\r\n  poly_model: \"Google Poly\",\r\n  twitch_stream: \"Twitch\"\r\n};\r\n\r\nclass MediaTiles extends Component {\r\n  static propTypes = {\r\n    intl: PropTypes.object,\r\n    entries: PropTypes.array,\r\n    hasNext: PropTypes.bool,\r\n    hasPrevious: PropTypes.bool,\r\n    isVariableWidth: PropTypes.bool,\r\n    page: PropTypes.number,\r\n    history: PropTypes.object,\r\n    urlSource: PropTypes.string,\r\n    handleEntryClicked: PropTypes.func,\r\n    handleEntryInfoClicked: PropTypes.func,\r\n    handlePager: PropTypes.func,\r\n    onCopyAvatar: PropTypes.func,\r\n    onCopyScene: PropTypes.func,\r\n    onShowSimilar: PropTypes.func\r\n  };\r\n\r\n  handleCopyAvatar = async (e, entry) => {\r\n    e.preventDefault();\r\n    await remixAvatar(entry.id, entry.name);\r\n    this.props.onCopyAvatar();\r\n  };\r\n\r\n  handleCopyScene = async (e, entry) => {\r\n    e.preventDefault();\r\n    await fetchReticulumAuthenticated(\"/api/v1/scenes\", \"POST\", {\r\n      parent_scene_id: entry.id\r\n    });\r\n    this.props.onCopyScene();\r\n  };\r\n\r\n  render() {\r\n    const { urlSource, hasNext, hasPrevious, page, isVariableWidth } = this.props;\r\n    const entries = this.props.entries || [];\r\n    const [createTileWidth, createTileHeight] = this.getTileDimensions(false, urlSource === \"avatars\");\r\n\r\n    return (\r\n      <div className={styles.body}>\r\n        <div className={classNames({ [styles.tiles]: true, [styles.tilesVariable]: isVariableWidth })}>\r\n          {(urlSource === \"avatars\" || urlSource === \"scenes\") && (\r\n            <div\r\n              style={{ width: `${createTileWidth}px`, height: `${createTileHeight}px` }}\r\n              className={classNames({\r\n                [styles.tile]: true,\r\n                [styles.createTile]: true,\r\n                [styles.createAvatarTile]: urlSource === \"avatars\"\r\n              })}\r\n            >\r\n              {urlSource === \"scenes\" ? (\r\n                <IfFeature name=\"enable_spoke\">\r\n                  <a href=\"/spoke/new\" rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tileLink}>\r\n                    <div className={styles.tileContent}>\r\n                      <FontAwesomeIcon icon={faPlus} />\r\n                      <FormattedMessage id=\"media-browser.create-scene\" />\r\n                    </div>\r\n                  </a>\r\n                </IfFeature>\r\n              ) : (\r\n                <a\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\r\n                  }}\r\n                  className={styles.tileLink}\r\n                >\r\n                  <div className={styles.tileContent}>\r\n                    <FontAwesomeIcon icon={faPlus} />\r\n                    <FormattedMessage id=\"media-browser.create-avatar\" />\r\n                  </div>\r\n                </a>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {entries.map(this.entryToTile)}\r\n        </div>\r\n\r\n        {(hasNext || hasPrevious) &&\r\n          this.props.handlePager && (\r\n            <div className={styles.pager}>\r\n              <a\r\n                className={classNames({ [styles.previousPage]: true, [styles.pagerButtonDisabled]: !hasPrevious })}\r\n                onClick={() => this.props.handlePager(-1)}\r\n              >\r\n                <FontAwesomeIcon icon={faAngleLeft} />\r\n              </a>\r\n              <div className={styles.pageNumber}>{page}</div>\r\n              <a\r\n                className={classNames({ [styles.nextPage]: true, [styles.pagerButtonDisabled]: !hasNext })}\r\n                onClick={() => this.props.handlePager(1)}\r\n              >\r\n                <FontAwesomeIcon icon={faAngleRight} />\r\n              </a>\r\n            </div>\r\n          )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getTileDimensions = (isImage, isAvatar, imageAspect) => {\r\n    // Doing breakpointing here, so we can have proper image placeholder based upon dynamic aspect ratio\r\n    const clientWidth = window.innerWidth;\r\n    let imageHeight = clientWidth < 1079 ? (clientWidth < 768 ? (clientWidth < 400 ? 85 : 100) : 150) : 200;\r\n    if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\r\n\r\n    // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\r\n    let imageWidth;\r\n    if (isImage) {\r\n      imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\r\n    } else if (isAvatar) {\r\n      imageWidth = Math.floor((9 / 16) * imageHeight);\r\n    } else {\r\n      imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\r\n    }\r\n\r\n    return [imageWidth, imageHeight];\r\n  };\r\n\r\n  entryToTile = (entry, idx) => {\r\n    const imageSrc = entry.images.preview.url;\r\n    const creator = entry.attributions && entry.attributions.creator;\r\n    const isImage = entry.type.endsWith(\"_image\");\r\n    const isAvatar = [\"avatar\", \"avatar_listing\"].includes(entry.type);\r\n    const isHub = [\"room\"].includes(entry.type);\r\n    const imageAspect = entry.images.preview.width / entry.images.preview.height;\r\n\r\n    const [imageWidth, imageHeight] = this.getTileDimensions(isImage, isAvatar, imageAspect);\r\n\r\n    // Inline mp4s directly since far/nearspark cannot resize them.\r\n    const thumbnailElement =\r\n      entry.images.preview.type === \"mp4\" ? (\r\n        <video\r\n          className={classNames(styles.tileContent, styles.avatarTile)}\r\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\r\n          muted\r\n          autoPlay\r\n          playsInline\r\n          loop\r\n          src={proxiedUrlFor(imageSrc)}\r\n        />\r\n      ) : (\r\n        <img\r\n          className={classNames(styles.tileContent, styles.avatarTile)}\r\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\r\n          src={scaledThumbnailUrlFor(imageSrc, imageWidth, imageHeight)}\r\n        />\r\n      );\r\n\r\n    const publisherName =\r\n      (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\r\n      PUBLISHER_FOR_ENTRY_TYPE[entry.type];\r\n\r\n    const { formatMessage } = this.props.intl;\r\n\r\n    return (\r\n      <div style={{ width: `${imageWidth}px` }} className={styles.tile} key={`${entry.id}_${idx}`}>\r\n        <a\r\n          href={entry.url}\r\n          rel=\"noreferrer noopener\"\r\n          onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\r\n          className={styles.tileLink}\r\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\r\n        >\r\n          {thumbnailElement}\r\n        </a>\r\n        <div className={styles.tileActions}>\r\n          {entry.type === \"avatar\" && (\r\n            <StateLink\r\n              stateKey=\"overlay\"\r\n              stateValue=\"avatar-editor\"\r\n              stateDetail={{ avatarId: entry.id }}\r\n              history={this.props.history}\r\n              title=\"Edit\"\r\n            >\r\n              <FontAwesomeIcon icon={faPencilAlt} />\r\n            </StateLink>\r\n          )}\r\n          {entry.type === \"avatar_listing\" && (\r\n            <a\r\n              onClick={e => {\r\n                e.preventDefault();\r\n                this.props.onShowSimilar(entry.id, entry.name);\r\n              }}\r\n              title=\"Show Similar\"\r\n            >\r\n              <FontAwesomeIcon icon={faSearch} />\r\n            </a>\r\n          )}\r\n          {entry.type === \"avatar_listing\" &&\r\n            entry.allow_remixing && (\r\n              <a onClick={e => this.handleCopyAvatar(e, entry)} title=\"Copy to my avatars\">\r\n                <FontAwesomeIcon icon={faClone} />\r\n              </a>\r\n            )}\r\n          {entry.type === \"scene_listing\" &&\r\n            entry.allow_remixing && (\r\n              <a onClick={e => this.handleCopyScene(e, entry)} title=\"Copy to my scenes\">\r\n                <FontAwesomeIcon icon={faClone} />\r\n              </a>\r\n            )}\r\n          {entry.type === \"scene\" &&\r\n            entry.project_id && (\r\n              <a\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                href={getReticulumFetchUrl(`/spoke/projects/${entry.project_id}`)}\r\n                title={formatMessage({ id: \"scene.edit_button\" })}\r\n              >\r\n                <FontAwesomeIcon icon={faPencilAlt} />\r\n              </a>\r\n            )}\r\n          {entry.type === \"room\" &&\r\n            this.props.handleEntryInfoClicked &&\r\n            entry.description && (\r\n              <a\r\n                title=\"room info\"\r\n                onClick={e => {\r\n                  e.preventDefault();\r\n                  this.props.handleEntryInfoClicked(entry);\r\n                }}\r\n              >\r\n                <FontAwesomeIcon icon={faInfo} />\r\n              </a>\r\n            )}\r\n        </div>\r\n\r\n        {entry.favorited && (\r\n          <div className={styles.favorite}>\r\n            <FontAwesomeIcon icon={faStar} />\r\n          </div>\r\n        )}\r\n\r\n        {!entry.type.endsWith(\"_image\") && (\r\n          <div className={styles.info}>\r\n            <a\r\n              href={entry.url}\r\n              rel=\"noreferrer noopener\"\r\n              className={styles.name}\r\n              onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\r\n            >\r\n              {entry.name || \"\\u00A0\"}\r\n            </a>\r\n            {!isAvatar &&\r\n              !isHub && (\r\n                <div className={styles.attribution}>\r\n                  <div className={styles.creator}>\r\n                    {creator && creator.name === undefined && <span>{creator}</span>}\r\n                    {creator && creator.name && !creator.url && <span>{creator.name}</span>}\r\n                    {creator &&\r\n                      creator.name &&\r\n                      creator.url && (\r\n                        <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {creator.name}\r\n                        </a>\r\n                      )}\r\n                  </div>\r\n                  {publisherName && (\r\n                    <div className={styles.publisher}>\r\n                      <i>\r\n                        <FontAwesomeIcon icon={faExternalLinkAlt} />\r\n                      </i>\r\n                      &nbsp;<a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        {publisherName}\r\n                      </a>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            {isHub && (\r\n              <>\r\n                <div className={styles.attribution}>\r\n                  <div className={styles.lastJoined}>\r\n                    <FormattedMessage id=\"media-browser.hub.joined-prefix\" />\r\n                    {dayjs(entry.last_activated_at).fromNow()}\r\n                  </div>\r\n                </div>\r\n                <div className={styles.presence}>\r\n                  <FontAwesomeIcon icon={faUsers} />\r\n                  <span>{entry.member_count}</span>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n}\r\nexport default injectIntl(MediaTiles);\r\n","const THREE = AFRAME.THREE;\r\n\r\nfunction checkFloatTextureSupport() {\r\n  const renderer = new THREE.WebGLRenderer();\r\n\r\n  const scene = new THREE.Scene();\r\n  const size = 2;\r\n  const data = new Float32Array(size * size * 4);\r\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\r\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\r\n  box.material.map.needsUpdate = true;\r\n  scene.add(box);\r\n\r\n  renderer.render(scene, new THREE.Camera());\r\n  const result = renderer.context.getError() === 0;\r\n  renderer.dispose();\r\n  return result;\r\n}\r\n\r\nexport function patchWebGLRenderingContext() {\r\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\r\n    // It appears that Galaxy S6 devices falsely report that they support\r\n    // OES_texture_float in Firefox. This workaround disables float textures\r\n    // for those devices.\r\n    // See https://github.com/mozilla/hubs/issues/32 and\r\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\r\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\r\n    const supportsFloatTextures = checkFloatTextureSupport();\r\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\r\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\r\n        return null;\r\n      }\r\n      return originalGetExtension.call(this, name);\r\n    };\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"assets/models/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/emoji-27673179a22e6f42e8187ccba07e4dce.mp3\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preview\":\"avatar-preview__preview__3UraQ\"};","import { CAMERA_MODE_INSPECT } from \"./camera-system.js\";\r\nimport { setMatrixWorld } from \"../utils/three-utils\";\r\n\r\nlet viewingCamera;\r\nlet uiRoot;\r\nexport class ScenePreviewCameraSystem {\r\n  constructor() {\r\n    this.entities = [];\r\n  }\r\n\r\n  register(el) {\r\n    this.entities.push(el);\r\n  }\r\n\r\n  unregister(el) {\r\n    this.entities.splice(this.entities.indexOf(el, 1));\r\n  }\r\n\r\n  tick() {\r\n    viewingCamera = viewingCamera || document.getElementById(\"viewing-camera\");\r\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n    const entered = viewingCamera && viewingCamera.sceneEl.is(\"entered\");\r\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n    for (let i = 0; i < this.entities.length; i++) {\r\n      const el = this.entities[i];\r\n      const hubsSystems = AFRAME.scenes[0].systems[\"hubs-systems\"];\r\n      if (el && (!hubsSystems || (hubsSystems.cameraSystem.mode !== CAMERA_MODE_INSPECT && !isGhost && !entered))) {\r\n        el.components[\"scene-preview-camera\"].tick2();\r\n        if (hubsSystems && viewingCamera) {\r\n          el.object3D.updateMatrices();\r\n          setMatrixWorld(viewingCamera.object3D, el.object3D.matrixWorld);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\r\n\r\nasync function deriveKey(privateKey, publicKey) {\r\n  return crypto.subtle.deriveKey(\r\n    { name: \"ECDH\", public: publicKey },\r\n    privateKey,\r\n    { name: \"AES-CBC\", length: 256 },\r\n    true,\r\n    [\"encrypt\", \"decrypt\"]\r\n  );\r\n}\r\n\r\nasync function publicKeyToString(key) {\r\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\r\n}\r\n\r\nasync function stringToPublicKey(s) {\r\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\r\n}\r\n\r\nfunction stringToArrayBuffer(s) {\r\n  const buf = new Uint8Array(s.length);\r\n\r\n  for (let i = 0; i < s.length; i++) {\r\n    buf[i] = s.charCodeAt(i);\r\n  }\r\n\r\n  return buf;\r\n}\r\n\r\nfunction arrayBufferToString(b) {\r\n  const buf = new Uint8Array(b);\r\n  let s = \"\";\r\n\r\n  for (let i = 0; i < buf.byteLength; i++) {\r\n    s += String.fromCharCode(buf[i]);\r\n  }\r\n\r\n  return s;\r\n}\r\n\r\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\r\n\r\n// Requestor generates a public key and private key, and should send the public key to receiver.\r\nexport async function generateKeys() {\r\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\r\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\r\n  return { publicKeyString, privateKey: keyPair.privateKey };\r\n}\r\n\r\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\r\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\r\n  const iv = new Uint8Array(16);\r\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\r\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\r\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\r\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\r\n\r\n  const encryptedData = btoa(\r\n    arrayBufferToString(\r\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\r\n    )\r\n  );\r\n\r\n  return { publicKeyString, encryptedData };\r\n}\r\n\r\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\r\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\r\n  const iv = new Uint8Array(16);\r\n  const publicKey = await stringToPublicKey(publicKeyString);\r\n  const secret = await deriveKey(privateKey, publicKey);\r\n  const ciphertext = stringToArrayBuffer(atob(base64value));\r\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\r\n  return JSON.parse(arrayBufferToString(data));\r\n}\r\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\r\n\r\nconst LINK_ACTION_TIMEOUT = 10000;\r\n\r\nexport default class LinkChannel {\r\n  constructor(store) {\r\n    this.store = store;\r\n  }\r\n\r\n  setSocket = socket => {\r\n    this.socket = socket;\r\n  };\r\n\r\n  // Returns a promise that, when resolved, will forward an object with three keys:\r\n  //\r\n  // code: The code that was made available to use for link.\r\n  //\r\n  // cancel: A function that the caller can call to cancel the use of the code.\r\n  //\r\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\r\n  // because it was either successfully used by the remote device or it has expired\r\n  // (\"used\" or \"expired\" is passed to the callback).\r\n  generateCode = () => {\r\n    return new Promise(resolve => {\r\n      const onFinished = new Promise(finished => {\r\n        const step = () => {\r\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\r\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\r\n\r\n          // Only respond to one link_request in this channel.\r\n          let readyToSend = false;\r\n          let leftChannel = false;\r\n\r\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\r\n\r\n          const leave = () => {\r\n            if (!leftChannel) channel.leave();\r\n            leftChannel = true;\r\n          };\r\n\r\n          const cancel = () => leave();\r\n\r\n          channel.on(\"link_expired\", () => finished(\"expired\"));\r\n\r\n          channel.on(\"presence_state\", state => {\r\n            if (readyToSend) return;\r\n\r\n            if (Object.keys(state).length > 0) {\r\n              // Code is in use by someone else, try a new one\r\n              step();\r\n            } else {\r\n              readyToSend = true;\r\n              resolve({ code, cancel, onFinished });\r\n            }\r\n          });\r\n\r\n          channel.on(\"link_request\", incoming => {\r\n            if (readyToSend) {\r\n              const data = { path: location.pathname };\r\n\r\n              // Copy profile data to link'ed device if it's been set.\r\n              if (this.store.state.activity.hasChangedName) {\r\n                data.profile = { ...this.store.state.profile };\r\n              }\r\n              data.credentials = { ...this.store.state.credentials };\r\n\r\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\r\n                ({ publicKeyString, encryptedData }) => {\r\n                  const payload = {\r\n                    target_session_id: incoming.reply_to_session_id,\r\n                    public_key: publicKeyString,\r\n                    data: encryptedData\r\n                  };\r\n\r\n                  if (!leftChannel) {\r\n                    channel.push(\"link_response\", payload);\r\n                  }\r\n\r\n                  leave();\r\n\r\n                  finished(\"used\");\r\n                  readyToSend = false;\r\n                }\r\n              );\r\n            }\r\n          });\r\n\r\n          channel.join().receive(\"error\", r => console.error(r));\r\n        };\r\n\r\n        step();\r\n      });\r\n    });\r\n  };\r\n\r\n  // Attempts to receive a link payload from a remote device using the given code.\r\n  //\r\n  // Promise rejects if the code is invalid or there is a problem with the channel.\r\n  // Promise resolves and passes payload of link source on successful link.\r\n  attemptLink = code => {\r\n    return new Promise((resolve, reject) => {\r\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\r\n      let finished = false;\r\n\r\n      generateKeys().then(({ publicKeyString, privateKey }) => {\r\n        channel.on(\"presence_state\", state => {\r\n          const numOccupants = Object.keys(state).length;\r\n\r\n          if (numOccupants === 1) {\r\n            // Great, only sender is in topic, request link\r\n            channel.push(\"link_request\", {\r\n              reply_to_session_id: this.socket.params().session_id,\r\n              public_key: publicKeyString\r\n            });\r\n\r\n            setTimeout(() => {\r\n              if (finished) return;\r\n              channel.leave();\r\n              reject(new Error(\"no_response\"));\r\n            }, LINK_ACTION_TIMEOUT);\r\n          } else if (numOccupants === 0) {\r\n            // Nobody in this channel, probably a bad code.\r\n            channel.leave();\r\n            reject(new Error(\"failed\"));\r\n          } else {\r\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\r\n            channel.leave();\r\n            reject(new Error(\"in_use\"));\r\n          }\r\n        });\r\n\r\n        channel.on(\"link_response\", payload => {\r\n          finished = true;\r\n          channel.leave();\r\n\r\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\r\n        });\r\n\r\n        channel\r\n          .join()\r\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\r\n          .receive(\"error\", r => console.error(r));\r\n      });\r\n    });\r\n  };\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"command-help\":\"chat-command-help__command-help__12EAc\",\"commandHelp\":\"chat-command-help__command-help__12EAc\",\"entry\":\"chat-command-help__entry__3X_LH\",\"command\":\"chat-command-help__command__2N57v\"};","module.exports = __webpack_public_path__ + \"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png\";","module.exports = \"<svg viewBox=\\\"0 0 64 64\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"svg-icon\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M61.0316 33.4196C61.841 33.0737 61.841 31.9263 61.0316 31.5804L5.78581 7.97542C4.46632 7.41163 2.99999 8.37968 2.99999 9.81457L2.99999 30.4511L29.262 32.5L2.99999 34.549L2.99998 55.1854C2.99998 56.6203 4.46632 57.5884 5.7858 57.0246L61.0316 33.4196Z\\\" fill=\\\"currentColor\\\"></path></svg>\"","module.exports = __webpack_public_path__ + \"assets/models/LoadingEnvironment-570a9f69a9509eb8a039c9ff93ccfdca.glb\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cancel-button\":\"promote-client-dialog__cancel-button__z7B-p\",\"cancelButton\":\"promote-client-dialog__cancel-button__z7B-p\",\"confirm-button\":\"promote-client-dialog__confirm-button__3VES-\",\"confirmButton\":\"promote-client-dialog__confirm-button__3VES-\",\"message\":\"promote-client-dialog__message__2rcaA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cancel-button\":\"close-room-dialog__cancel-button__3HItM\",\"cancelButton\":\"close-room-dialog__cancel-button__3HItM\",\"confirm-button\":\"close-room-dialog__confirm-button__yOw4k\",\"confirmButton\":\"close-room-dialog__confirm-button__yOw4k\",\"message\":\"close-room-dialog__message__2fpFv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"help-dialog\":\"help-dialog__help-dialog__2kDpw\",\"helpDialog\":\"help-dialog__help-dialog__2kDpw\",\"docs-link\":\"help-dialog__docs-link__1Ixbs\",\"docsLink\":\"help-dialog__docs-link__1Ixbs\",\"tour-button\":\"help-dialog__tour-button__3fRUz\",\"tourButton\":\"help-dialog__tour-button__3fRUz\",\"link-button\":\"help-dialog__link-button__1luP3\",\"linkButton\":\"help-dialog__link-button__1luP3\"};","const zeroPos = new THREE.Vector3(0, 0, 0);\r\nconst zeroQuat = new THREE.Quaternion();\r\nconst oneScale = new THREE.Vector3(1, 1, 1);\r\nconst identity = new THREE.Matrix4();\r\nidentity.identity();\r\n\r\n// Patch animation system\r\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\r\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\r\n\r\n// For all binding types, monkey patch the setters that require world matrix\r\n// updates to also flip matrixNeedsUpdate\r\nfor (let i = 0; i < bindingSetters.length; i++) {\r\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\r\n  if (!setter) continue;\r\n\r\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\r\n    const v = setter.apply(this, arguments);\r\n    this.targetObject.matrixNeedsUpdate = true;\r\n    return v;\r\n  };\r\n}\r\n\r\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\r\n  if (target === undefined) {\r\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\r\n    target = new THREE.Vector3();\r\n  }\r\n\r\n  // New function, defined below (used instead of updateMatrixWorld)\r\n  this.updateMatrices();\r\n\r\n  return target.setFromMatrixPosition(this.matrixWorld);\r\n};\r\n\r\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\r\n  const position = new THREE.Vector3();\r\n  const scale = new THREE.Vector3();\r\n\r\n  return function getWorldQuaternion(target) {\r\n    if (target === undefined) {\r\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\r\n      target = new THREE.Quaternion();\r\n    }\r\n\r\n    // New function, defined below (used instead of updateMatrixWorld)\r\n    this.updateMatrices();\r\n    this.matrixWorld.decompose(position, target, scale);\r\n\r\n    return target;\r\n  };\r\n})();\r\n\r\nTHREE.Object3D.getWorldScale = (function() {\r\n  const position = new THREE.Vector3();\r\n  const quaternion = new THREE.Quaternion();\r\n\r\n  return function getWorldScale(target) {\r\n    if (target === undefined) {\r\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\r\n      target = new THREE.Vector3();\r\n    }\r\n\r\n    // New function, defined below (used instead of updateMatrixWorld)\r\n    this.updateMatrices();\r\n    this.matrixWorld.decompose(position, quaternion, target);\r\n\r\n    return target;\r\n  };\r\n})();\r\n\r\nconst handleMatrixModification = o => {\r\n  if (!o.matrixIsModified) {\r\n    o.matrixIsModified = true;\r\n\r\n    if (o.cachedMatrixWorld) {\r\n      o.cachedMatrixWorld.copy(o.matrixWorld);\r\n      o.matrixWorld = o.cachedMatrixWorld;\r\n    }\r\n  }\r\n};\r\n\r\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\r\nTHREE.Object3D.prototype.updateMatrix = function() {\r\n  updateMatrix.apply(this, arguments);\r\n  handleMatrixModification(this);\r\n};\r\n\r\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\r\nTHREE.Object3D.prototype.applyMatrix = function() {\r\n  applyMatrix.apply(this, arguments);\r\n  handleMatrixModification(this);\r\n};\r\n\r\n// By the end of this function this.matrix reflects the updated local matrix\r\n// and this.matrixWorld reflects the updated world matrix, taking into account\r\n// parent matrices.\r\n//\r\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\r\n// been marked dirty.\r\n//\r\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\r\n// has been updated since the last update.\r\n//\r\n// skipParents - unless true, all parent matricies are updated before updating this object's\r\n// local and world matrix.\r\n//\r\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\r\n  if (!this.hasHadFirstMatrixUpdate) {\r\n    if (\r\n      !this.position.equals(zeroPos) ||\r\n      !this.quaternion.equals(zeroQuat) ||\r\n      !this.scale.equals(oneScale) ||\r\n      !this.matrix.equals(identity)\r\n    ) {\r\n      // Only update the matrix the first time if its non-identity, this way\r\n      // this.matrixIsModified will remain false until the default\r\n      // identity matrix is updated.\r\n      this.updateMatrix();\r\n    }\r\n\r\n    this.hasHadFirstMatrixUpdate = true;\r\n    this.matrixWorldNeedsUpdate = true;\r\n    this.cachedMatrixWorld = this.matrixWorld;\r\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\r\n    this.updateMatrix();\r\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\r\n  }\r\n\r\n  if (!skipParents && this.parent) {\r\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\r\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\r\n  }\r\n\r\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\r\n    if (this.parent === null) {\r\n      this.matrixWorld.copy(this.matrix);\r\n    } else {\r\n      // If the matrix is unmodified, it is the identity matrix,\r\n      // and hence we can use the parent's world matrix directly.\r\n      //\r\n      // Note this assumes all callers will either not pass skipParents=true\r\n      // *or* will update the parent themselves beforehand as is done in\r\n      // updateMatrixWorld.\r\n      if (!this.matrixIsModified) {\r\n        this.matrixWorld = this.parent.matrixWorld;\r\n      } else {\r\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\r\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\r\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\r\n      }\r\n    }\r\n\r\n    this.childrenNeedMatrixWorldUpdate = true;\r\n    this.matrixWorldNeedsUpdate = false;\r\n  }\r\n};\r\n\r\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\r\n//\r\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\r\n// this node and all of its children.\r\n//\r\n// includeInvisible - If true, does not ignore non-visible objects.\r\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\r\n  if (!this.visible && !includeInvisible) return;\r\n\r\n  // Do not recurse upwards, since this is recursing downwards\r\n  this.updateMatrices(false, forceWorldUpdate, true);\r\n\r\n  const children = this.children;\r\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\r\n\r\n  for (let i = 0, l = children.length; i < l; i++) {\r\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\r\n  }\r\n\r\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\r\n};\r\n\r\n// Updates this function to use updateMatrices() to avoid extra matrix computations\r\nTHREE.Object3D.prototype.lookAt = (function() {\r\n  // This method does not support objects having non-uniformly-scaled parent(s)\r\n\r\n  const q1 = new THREE.Quaternion();\r\n  const m1 = new THREE.Matrix4();\r\n  const target = new THREE.Vector3();\r\n  const position = new THREE.Vector3();\r\n\r\n  return function lookAt(x, y, z) {\r\n    if (x.isVector3) {\r\n      target.copy(x);\r\n    } else {\r\n      target.set(x, y, z);\r\n    }\r\n\r\n    const parent = this.parent;\r\n\r\n    if (parent) {\r\n      parent.updateMatrices();\r\n    }\r\n    this.updateMatrices(); // hubs change\r\n\r\n    position.setFromMatrixPosition(this.matrixWorld);\r\n\r\n    if (this.isCamera || this.isLight) {\r\n      m1.lookAt(position, target, this.up);\r\n    } else {\r\n      m1.lookAt(target, position, this.up);\r\n    }\r\n\r\n    this.quaternion.setFromRotationMatrix(m1);\r\n\r\n    if (parent) {\r\n      m1.extractRotation(parent.matrixWorld);\r\n      q1.setFromRotationMatrix(m1);\r\n      this.quaternion.premultiply(q1.inverse());\r\n    }\r\n    this.matrixNeedsUpdate = true;\r\n  };\r\n})();\r\n","/* eslint-disable */\r\n\r\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\r\n// scenario where the transform changes on an object during an animation.\r\n//\r\n// Changes are identified w comment // hubs\r\n//\r\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\r\n// it erroneously restarts.\r\n\r\nvar anime = require(\"animejs\").default;\r\nvar components = AFRAME.components; // hubs\r\nvar registerComponent = AFRAME.registerComponent; // hubs\r\n//var THREE = require('../lib/three'); // hubs\r\nvar utils = AFRAME.utils; // hubs\r\n\r\ndelete AFRAME.components.animation; // hubs\r\n\r\nvar colorHelperFrom = new THREE.Color();\r\nvar colorHelperTo = new THREE.Color();\r\n\r\nvar getComponentProperty = utils.entity.getComponentProperty;\r\nvar setComponentProperty = utils.entity.setComponentProperty;\r\nvar splitCache = {};\r\n\r\nvar TYPE_COLOR = \"color\";\r\nvar PROP_POSITION = \"position\";\r\nvar PROP_ROTATION = \"rotation\";\r\nvar PROP_SCALE = \"scale\";\r\nvar STRING_COMPONENTS = \"components\";\r\nvar STRING_OBJECT3D = \"object3D\";\r\n\r\n/**\r\n * Animation component for A-Frame using anime.js.\r\n *\r\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\r\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\r\n * boolean * flag * `isAnimationPlaying`.\r\n *\r\n * anime.js animation config for tweenining Javascript objects and values works as:\r\n *\r\n *  config = {\r\n *    targets: {foo: 0.0, bar: '#000'},\r\n *    foo: 1.0,\r\n *    bar: '#FFF'\r\n *  }\r\n *\r\n * The above will tween each property in `targets`. The `to` values are set in the root of\r\n * the config.\r\n *\r\n * @member {object} animation - anime.js instance.\r\n * @member {boolean} animationIsPlaying - Control if animation is playing.\r\n */\r\nmodule.exports.Component = registerComponent(\"animation\", {\r\n  schema: {\r\n    autoplay: { default: true },\r\n    delay: { default: 0 },\r\n    dir: { default: \"\" },\r\n    dur: { default: 1000 },\r\n    easing: { default: \"easeInQuad\" },\r\n    elasticity: { default: 400 },\r\n    enabled: { default: true },\r\n    from: { default: \"\" },\r\n    loop: {\r\n      default: 0,\r\n      parse: function(value) {\r\n        // Boolean or integer.\r\n        if (value === true || value === \"true\") {\r\n          return true;\r\n        }\r\n        if (value === false || value === \"false\") {\r\n          return false;\r\n        }\r\n        return parseInt(value, 10);\r\n      }\r\n    },\r\n    property: { default: \"\" },\r\n    startEvents: { type: \"array\" },\r\n    pauseEvents: { type: \"array\" },\r\n    resumeEvents: { type: \"array\" },\r\n    round: { default: false },\r\n    to: { default: \"\" },\r\n    type: { default: \"\" },\r\n    isRawProperty: { default: false }\r\n  },\r\n\r\n  multiple: true,\r\n\r\n  init: function() {\r\n    var self = this;\r\n\r\n    this.eventDetail = { name: this.attrName };\r\n    this.time = 0;\r\n\r\n    this.animation = null;\r\n    this.animationIsPlaying = false;\r\n    this.onStartEvent = this.onStartEvent.bind(this);\r\n    this.beginAnimation = this.beginAnimation.bind(this);\r\n    this.pauseAnimation = this.pauseAnimation.bind(this);\r\n    this.resumeAnimation = this.resumeAnimation.bind(this);\r\n\r\n    this.fromColor = {};\r\n    this.toColor = {};\r\n    this.targets = {};\r\n    this.targetsArray = [];\r\n\r\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\r\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\r\n\r\n    this.config = {\r\n      complete: function() {\r\n        self.animationIsPlaying = false;\r\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\r\n        if (self.id) {\r\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\r\n        }\r\n      }\r\n    };\r\n  },\r\n\r\n  update: function(oldData) {\r\n    var config = this.config;\r\n    var data = this.data;\r\n\r\n    this.animationIsPlaying = false;\r\n\r\n    if (!this.data.enabled) {\r\n      return;\r\n    }\r\n\r\n    if (!data.property) {\r\n      return;\r\n    }\r\n\r\n    // Base config.\r\n    config.autoplay = false;\r\n    config.direction = data.dir;\r\n    config.duration = data.dur;\r\n    config.easing = data.easing;\r\n    config.elasticity = data.elasticity;\r\n    config.loop = data.loop;\r\n    config.round = data.round;\r\n\r\n    // Start new animation.\r\n    this.createAndStartAnimation();\r\n  },\r\n\r\n  tick: function(t, dt) {\r\n    if (!this.animationIsPlaying) {\r\n      return;\r\n    }\r\n    this.time += dt;\r\n    this.animation.tick(this.time);\r\n  },\r\n\r\n  remove: function() {\r\n    this.pauseAnimation();\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n  },\r\n\r\n  pause: function() {\r\n    this.paused = true;\r\n    this.pausedWasPlaying = this.animationIsPlaying;\r\n    this.pauseAnimation();\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n  },\r\n\r\n  /**\r\n   * `play` handler only for resuming scene.\r\n   */\r\n  play: function() {\r\n    if (!this.paused) {\r\n      return;\r\n    }\r\n    this.paused = false;\r\n    this.addEventListeners();\r\n    if (this.pausedWasPlaying) {\r\n      this.resumeAnimation();\r\n      this.pausedWasPlaying = false;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Start animation from scratch.\r\n   */\r\n  createAndStartAnimation: function() {\r\n    var data = this.data;\r\n\r\n    this.updateConfig();\r\n    this.animationIsPlaying = false;\r\n    this.animation = anime(this.config);\r\n\r\n    this.removeEventListeners();\r\n    this.cancelDelayedStart(); // hubs\r\n    this.addEventListeners();\r\n\r\n    // Wait for start events for animation.\r\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\r\n      return;\r\n    }\r\n\r\n    // Delay animation.\r\n    if (data.delay) {\r\n      // hubs\r\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\r\n      return;\r\n    }\r\n\r\n    // Play animation.\r\n    this.beginAnimation();\r\n  },\r\n\r\n  /**\r\n   * This is before animation start (including from startEvents).\r\n   * Set to initial state (config.from, time = 0, seekTime = 0).\r\n   */\r\n  beginAnimation: function() {\r\n    this.updateConfig();\r\n    this.time = 0;\r\n    this.animationIsPlaying = true;\r\n    this.stopRelatedAnimations();\r\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\r\n  },\r\n\r\n  pauseAnimation: function() {\r\n    this.animationIsPlaying = false;\r\n  },\r\n\r\n  resumeAnimation: function() {\r\n    this.animationIsPlaying = true;\r\n  },\r\n\r\n  /**\r\n   * startEvents callback.\r\n   */\r\n  onStartEvent: function() {\r\n    if (!this.data.enabled) {\r\n      return;\r\n    }\r\n\r\n    this.updateConfig();\r\n    if (this.animation) {\r\n      this.animation.pause();\r\n    }\r\n    this.animation = anime(this.config);\r\n\r\n    // Include the delay before each start event.\r\n    if (this.data.delay) {\r\n      setTimeout(this.beginAnimation, this.data.delay);\r\n      return;\r\n    }\r\n    this.beginAnimation();\r\n  },\r\n\r\n  /**\r\n   * rawProperty: true and type: color;\r\n   */\r\n  updateConfigForRawColor: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var from;\r\n    var key;\r\n    var to;\r\n\r\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\r\n      return;\r\n    }\r\n\r\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\r\n    to = data.to;\r\n\r\n    // Use r/g/b vector for color type.\r\n    this.setColorConfig(from, to);\r\n    from = this.fromColor;\r\n    to = this.toColor;\r\n\r\n    this.targetsArray.length = 0;\r\n    this.targetsArray.push(from);\r\n    config.targets = this.targetsArray;\r\n    for (key in to) {\r\n      config[key] = to[key];\r\n    }\r\n\r\n    config.update = (function() {\r\n      var lastValue = {};\r\n      return function(anim) {\r\n        var value;\r\n        value = anim.animatables[0].target;\r\n        // For animation timeline.\r\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\r\n          return;\r\n        }\r\n\r\n        setRawProperty(el, data.property, value, data.type);\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Stuff property into generic `property` key.\r\n   */\r\n  updateConfigForDefault: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var from;\r\n    var isBoolean;\r\n    var isNumber;\r\n    var to;\r\n\r\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\r\n      return;\r\n    }\r\n\r\n    if (data.from === \"\") {\r\n      // Infer from.\r\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\r\n    } else {\r\n      // Explicit from.\r\n      from = data.from;\r\n    }\r\n\r\n    to = data.to;\r\n\r\n    isNumber = !isNaN(from || to);\r\n    if (isNumber) {\r\n      from = parseFloat(from);\r\n      to = parseFloat(to);\r\n    } else {\r\n      from = from ? from.toString() : from;\r\n      to = to ? to.toString() : to;\r\n    }\r\n\r\n    // Convert booleans to integer to allow boolean flipping.\r\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\r\n    if (isBoolean) {\r\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\r\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\r\n    }\r\n\r\n    this.targets.aframeProperty = from;\r\n    config.targets = this.targets;\r\n    config.aframeProperty = to;\r\n    config.update = (function() {\r\n      var lastValue;\r\n\r\n      return function(anim) {\r\n        var value;\r\n        value = anim.animatables[0].target.aframeProperty;\r\n\r\n        // Need to do a last value check for animation timeline since all the tweening\r\n        // begins simultaenously even if the value has not changed. Also better for perf\r\n        // anyways.\r\n        if (value === lastValue) {\r\n          return;\r\n        }\r\n        lastValue = value;\r\n\r\n        if (isBoolean) {\r\n          value = value >= 1;\r\n        }\r\n\r\n        if (isRawProperty(data)) {\r\n          setRawProperty(el, data.property, value, data.type);\r\n        } else {\r\n          setComponentProperty(el, data.property, value);\r\n        }\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Extend x/y/z/w onto the config.\r\n   * Update vector by modifying object3D.\r\n   */\r\n  updateConfigForVector: function() {\r\n    var config = this.config;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var key;\r\n    var from;\r\n    var to;\r\n\r\n    // Parse coordinates.\r\n    from =\r\n      data.from !== \"\"\r\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\r\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\r\n    to = utils.coordinates.parse(data.to);\r\n\r\n    if (data.property === PROP_ROTATION) {\r\n      toRadians(from);\r\n      toRadians(to);\r\n    }\r\n\r\n    // Set to and from.\r\n    this.targetsArray.length = 0;\r\n    this.targetsArray.push(from);\r\n    config.targets = this.targetsArray;\r\n    for (key in to) {\r\n      config[key] = to[key];\r\n    }\r\n\r\n    // If animating object3D transformation, run more optimized updater.\r\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\r\n      config.update = (function() {\r\n        var lastValue = {};\r\n        return function(anim) {\r\n          var value = anim.animatables[0].target;\r\n\r\n          if (data.property === PROP_SCALE) {\r\n            value.x = Math.max(0.0001, value.x);\r\n            value.y = Math.max(0.0001, value.y);\r\n            value.z = Math.max(0.0001, value.z);\r\n          }\r\n\r\n          // For animation timeline.\r\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n            return;\r\n          }\r\n\r\n          lastValue.x = value.x;\r\n          lastValue.y = value.y;\r\n          lastValue.z = value.z;\r\n\r\n          el.object3D[data.property].set(value.x, value.y, value.z);\r\n          el.object3D.matrixNeedsUpdate = true; // hubs\r\n        };\r\n      })();\r\n      return;\r\n    }\r\n\r\n    // Animating some vector.\r\n    config.update = (function() {\r\n      var lastValue = {};\r\n      return function(anim) {\r\n        var value = anim.animations[0].target;\r\n\r\n        // Animate rotation through radians.\r\n        // For animation timeline.\r\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n          return;\r\n        }\r\n        lastValue.x = value.x;\r\n        lastValue.y = value.y;\r\n        lastValue.z = value.z;\r\n        setComponentProperty(el, data.property, value);\r\n      };\r\n    })();\r\n  },\r\n\r\n  /**\r\n   * Update the config before each run.\r\n   */\r\n  updateConfig: function() {\r\n    var propType;\r\n\r\n    // Route config type.\r\n    propType = getPropertyType(this.el, this.data.property);\r\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\r\n      this.updateConfigForRawColor();\r\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\r\n      this.updateConfigForVector();\r\n    } else {\r\n      this.updateConfigForDefault();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Wait for component to initialize.\r\n   */\r\n  waitComponentInitRawProperty: function(cb) {\r\n    var componentName;\r\n    var data = this.data;\r\n    var el = this.el;\r\n    var self = this;\r\n\r\n    if (data.from !== \"\") {\r\n      return false;\r\n    }\r\n\r\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\r\n      return false;\r\n    }\r\n\r\n    componentName = splitDot(data.property)[1];\r\n    if (el.components[componentName]) {\r\n      return false;\r\n    }\r\n\r\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\r\n      if (evt.detail.name !== componentName) {\r\n        return;\r\n      }\r\n      cb();\r\n      // Since the config was created async, create the animation now since we missed it\r\n      // earlier.\r\n      self.animation = anime(self.config);\r\n      el.removeEventListener(\"componentinitialized\", wait);\r\n    });\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   * Make sure two animations on the same property don't fight each other.\r\n   * e.g., animation__mouseenter=\"property: material.opacity\"\r\n   *       animation__mouseleave=\"property: material.opacity\"\r\n   */\r\n  stopRelatedAnimations: function() {\r\n    var component;\r\n    var componentName;\r\n    for (componentName in this.el.components) {\r\n      component = this.el.components[componentName];\r\n      if (componentName === this.attrName) {\r\n        continue;\r\n      }\r\n      if (component.name !== \"animation\") {\r\n        continue;\r\n      }\r\n      if (!component.animationIsPlaying) {\r\n        continue;\r\n      }\r\n      if (component.data.property !== this.data.property) {\r\n        continue;\r\n      }\r\n      component.animationIsPlaying = false;\r\n    }\r\n  },\r\n\r\n  addEventListeners: function() {\r\n    var data = this.data;\r\n    var el = this.el;\r\n    addEventListeners(el, data.startEvents, this.onStartEvent);\r\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\r\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\r\n  },\r\n\r\n  removeEventListeners: function() {\r\n    var data = this.data;\r\n    var el = this.el;\r\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\r\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\r\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\r\n  },\r\n\r\n  // hubs\r\n  cancelDelayedStart: function() {\r\n    if (this.delayTimeout) {\r\n      clearTimeout(this.delayTimeout);\r\n      this.delayTimeout = null;\r\n    }\r\n  },\r\n\r\n  setColorConfig: function(from, to) {\r\n    colorHelperFrom.set(from);\r\n    colorHelperTo.set(to);\r\n    from = this.fromColor;\r\n    to = this.toColor;\r\n    from.r = colorHelperFrom.r;\r\n    from.g = colorHelperFrom.g;\r\n    from.b = colorHelperFrom.b;\r\n    to.r = colorHelperTo.r;\r\n    to.g = colorHelperTo.g;\r\n    to.b = colorHelperTo.b;\r\n  }\r\n});\r\n\r\n/**\r\n * Given property name, check schema to see what type we are animating.\r\n * We just care whether the property is a vector.\r\n */\r\nfunction getPropertyType(el, property) {\r\n  var component;\r\n  var componentName;\r\n  var split;\r\n  var propertyName;\r\n\r\n  split = property.split(\".\");\r\n  componentName = split[0];\r\n  propertyName = split[1];\r\n  component = el.components[componentName] || components[componentName];\r\n\r\n  // Primitives.\r\n  if (!component) {\r\n    return null;\r\n  }\r\n\r\n  // Dynamic schema. We only care about vectors anyways.\r\n  if (propertyName && !component.schema[propertyName]) {\r\n    return null;\r\n  }\r\n\r\n  // Multi-prop.\r\n  if (propertyName) {\r\n    return component.schema[propertyName].type;\r\n  }\r\n\r\n  // Single-prop.\r\n  return component.schema.type;\r\n}\r\n\r\n/**\r\n * Convert object to radians.\r\n */\r\nfunction toRadians(obj) {\r\n  obj.x = THREE.Math.degToRad(obj.x);\r\n  obj.y = THREE.Math.degToRad(obj.y);\r\n  obj.z = THREE.Math.degToRad(obj.z);\r\n}\r\n\r\nfunction addEventListeners(el, eventNames, handler) {\r\n  var i;\r\n  for (i = 0; i < eventNames.length; i++) {\r\n    el.addEventListener(eventNames[i], handler);\r\n  }\r\n}\r\n\r\nfunction removeEventListeners(el, eventNames, handler) {\r\n  var i;\r\n  for (i = 0; i < eventNames.length; i++) {\r\n    el.removeEventListener(eventNames[i], handler);\r\n  }\r\n}\r\n\r\nfunction getRawProperty(el, path) {\r\n  var i;\r\n  var split;\r\n  var value;\r\n  split = splitDot(path);\r\n  value = el;\r\n  for (i = 0; i < split.length; i++) {\r\n    value = value[split[i]];\r\n  }\r\n  return value;\r\n}\r\n\r\nfunction setRawProperty(el, path, value, type) {\r\n  var i;\r\n  var split;\r\n  var propertyName;\r\n  var targetValue;\r\n\r\n  if (path.startsWith(\"object3D.rotation\")) {\r\n    value = THREE.Math.degToRad(value);\r\n  }\r\n\r\n  // Walk.\r\n  split = splitDot(path);\r\n  targetValue = el;\r\n  for (i = 0; i < split.length - 1; i++) {\r\n    targetValue = targetValue[split[i]];\r\n  }\r\n  propertyName = split[split.length - 1];\r\n\r\n  // Raw color.\r\n  if (type === TYPE_COLOR) {\r\n    if (\"r\" in targetValue[propertyName]) {\r\n      targetValue[propertyName].r = value.r;\r\n      targetValue[propertyName].g = value.g;\r\n      targetValue[propertyName].b = value.b;\r\n    } else {\r\n      targetValue[propertyName].x = value.r;\r\n      targetValue[propertyName].y = value.g;\r\n      targetValue[propertyName].z = value.b;\r\n    }\r\n    return;\r\n  }\r\n\r\n  targetValue[propertyName] = value;\r\n}\r\n\r\nfunction splitDot(path) {\r\n  if (path in splitCache) {\r\n    return splitCache[path];\r\n  }\r\n  splitCache[path] = path.split(\".\");\r\n  return splitCache[path];\r\n}\r\n\r\nfunction isRawProperty(data) {\r\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\r\n}\r\n","AFRAME.registerComponent(\"ambient-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.AmbientLight();\r\n    this.el.setObject3D(\"ambient-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    if (this.data.color !== prevData.color) {\r\n      this.light.color.set(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(this.light.color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      this.light.intensity = this.data.intensity;\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"ambient-light\");\r\n  }\r\n});\r\n","/**\r\n * Instantiates and updates a THREE.AnimationMixer on an entity.\r\n * @component animation-mixer\r\n */\r\nAFRAME.registerComponent(\"animation-mixer\", {\r\n  initMixer(animations) {\r\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\r\n    this.el.object3D.animations = animations;\r\n    this.animations = animations;\r\n  },\r\n\r\n  tick: function(t, dt) {\r\n    if (this.mixer) {\r\n      this.mixer.update(dt / 1000);\r\n    }\r\n  }\r\n});\r\n","/**\r\n * Sets the CSS class on an entity.\r\n * @component css-class\r\n */\r\nAFRAME.registerComponent(\"css-class\", {\r\n  schema: {\r\n    type: \"string\"\r\n  },\r\n  multiple: true,\r\n  init() {\r\n    this.el.classList.add(this.data);\r\n  },\r\n  update(oldData) {\r\n    if (this.data !== oldData) {\r\n      this.el.classList.remove(oldData);\r\n      this.el.classList.add(this.data);\r\n    }\r\n  },\r\n  remove() {\r\n    this.el.classList.remove(this.data);\r\n  }\r\n});\r\n","/* global CANNON */\r\n/**\r\n * Floats a duck based on its scale.\r\n * @component duck\r\n */\r\nAFRAME.registerComponent(\"duck\", {\r\n  schema: {\r\n    initialForce: { default: 0 },\r\n    maxForce: { default: 6.5 },\r\n    maxScale: { default: 5 }\r\n  },\r\n\r\n  init: function() {\r\n    this.physicsSystem = this.el.sceneEl.systems.physics;\r\n    this.hasBody = false;\r\n    this.position = new CANNON.Vec3();\r\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\r\n    this.initialScale = this.el.object3D.scale.x;\r\n    this.maxScale = this.data.maxScale * this.initialScale;\r\n  },\r\n\r\n  play: function() {\r\n    this.physicsSystem.addComponent(this);\r\n  },\r\n\r\n  pause: function() {\r\n    this.physicsSystem.removeComponent(this);\r\n  },\r\n\r\n  beforeStep: function() {\r\n    if (this.el.body && NAF.utils.isMine(this.el)) {\r\n      const currentScale = this.el.object3D.scale.x;\r\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\r\n      const force = ratio * this.data.maxForce;\r\n      if (force > 0) {\r\n        const angle = Math.random() * Math.PI * 2;\r\n        const x = Math.cos(angle);\r\n        const z = Math.sin(angle);\r\n        this.force.set(x, force, z);\r\n        this.position.set(x * 0.01, 0, z * 0.01);\r\n        this.el.object3D.matrixNeedsUpdate = true;\r\n        this.el.body.applyForce(this.force, this.position);\r\n      }\r\n    }\r\n  }\r\n});\r\n","/* global CANNON */\r\nAFRAME.registerComponent(\"heightfield\", {\r\n  init() {\r\n    this.el.addEventListener(\"componentinitialized\", e => {\r\n      if (e.detail.name === \"static-body\") {\r\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\r\n      }\r\n    });\r\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\r\n  },\r\n  generateAndAddHeightfield(body) {\r\n    const { offset, distance, data } = this.data;\r\n\r\n    const orientation = new CANNON.Quaternion();\r\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\r\n\r\n    const rotation = new CANNON.Quaternion();\r\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\r\n    rotation.mult(orientation, orientation);\r\n\r\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\r\n\r\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\r\n\r\n    body.addShape(shape, cannonOffset, orientation);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"hemisphere-light\", {\r\n  schema: {\r\n    skyColor: { type: \"color\" },\r\n    groundColor: { type: \"color\" },\r\n    intensity: { default: 1.0 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.HemisphereLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.matrixNeedsUpdate = true;\r\n    this.el.setObject3D(\"hemisphere-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n  },\r\n\r\n  update(prevData) {\r\n    if (this.data.skyColor !== prevData.skyColor) {\r\n      this.light.color.set(this.data.skyColor);\r\n    }\r\n\r\n    if (this.data.groundColor !== prevData.groundColor) {\r\n      this.light.groundColor.set(this.data.groundColor);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      this.light.intensity = this.data.intensity;\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"hemisphere-light\");\r\n  }\r\n});\r\n","/**\r\n * Hides entities based on the scene's quality mode\r\n * @namespace environment\r\n * @component hide-when-quality\r\n */\r\nAFRAME.registerComponent(\"hide-when-quality\", {\r\n  schema: { type: \"string\", default: \"low\" },\r\n\r\n  init() {\r\n    this.onQualityChanged = this.onQualityChanged.bind(this);\r\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\r\n  },\r\n\r\n  onQualityChanged(event) {\r\n    this.updateComponentState(event.detail);\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data !== oldData) {\r\n      this.updateComponentState(window.APP.quality);\r\n    }\r\n  },\r\n\r\n  updateComponentState(quality) {\r\n    this.el.setAttribute(\"visible\", quality !== this.data);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"point-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    range: { default: 0 },\r\n    decay: { default: 2 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.PointLight();\r\n    this.light.shadow.camera.matrixAutoUpdate = true;\r\n    this.el.setObject3D(\"point-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      const color = new THREE.Color(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(color);\r\n      light.color.copy(color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.range !== prevData.range) {\r\n      light.distance = this.data.range;\r\n    }\r\n\r\n    if (this.data.decay !== prevData.decay) {\r\n      light.decay = this.data.decay;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"point-light\");\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"spot-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    range: { default: 0 },\r\n    decay: { default: 2 },\r\n    innerConeAngle: { default: 0 },\r\n    outerConeAngle: { default: Math.PI / 4.0 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.SpotLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.target.position.set(0, 0, 1);\r\n    this.light.add(this.light.target);\r\n    this.light.matrixNeedsUpdate = true;\r\n    this.light.target.matrixNeedsUpdate = true;\r\n    this.el.setObject3D(\"spot-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      light.color.set(this.data.color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.range !== prevData.range) {\r\n      light.distance = this.data.range;\r\n    }\r\n\r\n    if (this.data.decay !== prevData.decay) {\r\n      light.decay = this.data.decay;\r\n    }\r\n\r\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\r\n      light.angle = this.data.outerConeAngle;\r\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"spot-light\");\r\n  }\r\n});\r\n","/* global AFRAME */\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nAFRAME.registerComponent(\"floaty-object\", {\r\n  schema: {\r\n    // Make the object locked/kinematic upon load\r\n    autoLockOnLoad: { default: false },\r\n\r\n    // Make the object kinematic immediately upon release\r\n    autoLockOnRelease: { default: false },\r\n\r\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\r\n    // otherwise apply releaseGravity.\r\n    modifyGravityOnRelease: { default: false },\r\n\r\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\r\n    releaseGravity: { default: -2 },\r\n\r\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\r\n    reduceAngularFloat: { default: false },\r\n\r\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\r\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\r\n  },\r\n\r\n  init() {\r\n    this.onGrab = this.onGrab.bind(this);\r\n    this.onRelease = this.onRelease.bind(this);\r\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n  },\r\n\r\n  tick() {\r\n    if (!this.bodyHelper) {\r\n      this.bodyHelper = this.el.components[\"body-helper\"];\r\n    }\r\n\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const isHeld = interaction && interaction.isHeld(this.el);\r\n    if (isHeld && !this.wasHeld) {\r\n      this.onGrab();\r\n    }\r\n    if (this.wasHeld && !isHeld) {\r\n      this.onRelease();\r\n    }\r\n\r\n    if (!isHeld && this._makeStaticWhenAtRest) {\r\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\r\n      const linearThreshold = this.bodyHelper.data.linearSleepingThreshold;\r\n      const angularThreshold = this.bodyHelper.data.angularSleepingThreshold;\r\n      const uuid = this.bodyHelper.uuid;\r\n      const isAtRest =\r\n        this.physicsSystem.bodyInitialized(uuid) &&\r\n        this.physicsSystem.getLinearVelocity(uuid) < linearThreshold &&\r\n        this.physicsSystem.getAngularVelocity(uuid) < angularThreshold;\r\n\r\n      if (isAtRest && isMine) {\r\n        this.el.setAttribute(\"body-helper\", { type: \"kinematic\" });\r\n      }\r\n\r\n      if (isAtRest || !isMine) {\r\n        this._makeStaticWhenAtRest = false;\r\n      }\r\n    }\r\n\r\n    this.wasHeld = isHeld;\r\n  },\r\n\r\n  play() {\r\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\r\n    if (this.hasBeenHereBefore) return;\r\n    this.hasBeenHereBefore = true;\r\n    if (this.data.autoLockOnLoad) {\r\n      this.el.setAttribute(\"body-helper\", {\r\n        gravity: { x: 0, y: 0, z: 0 }\r\n      });\r\n      this.setLocked(true);\r\n    }\r\n  },\r\n\r\n  setLocked(locked) {\r\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\r\n\r\n    this.locked = locked;\r\n    this.el.setAttribute(\"body-helper\", { type: locked ? \"kinematic\" : \"dynamic\" });\r\n  },\r\n\r\n  onRelease() {\r\n    if (this.data.modifyGravityOnRelease) {\r\n      const uuid = this.bodyHelper.uuid;\r\n      if (\r\n        this.data.gravitySpeedLimit === 0 ||\r\n        (this.physicsSystem.bodyInitialized(uuid) &&\r\n          this.physicsSystem.getLinearVelocity(uuid) < this.data.gravitySpeedLimit)\r\n      ) {\r\n        this.el.setAttribute(\"body-helper\", {\r\n          gravity: { x: 0, y: 0, z: 0 },\r\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\r\n          linearDamping: 0.95,\r\n          linearSleepingThreshold: 0.1,\r\n          angularSleepingThreshold: 0.1,\r\n          collisionFilterMask: COLLISION_LAYERS.HANDS\r\n        });\r\n\r\n        this._makeStaticWhenAtRest = true;\r\n      } else {\r\n        this.el.setAttribute(\"body-helper\", {\r\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\r\n          angularDamping: 0.01,\r\n          linearDamping: 0.01,\r\n          linearSleepingThreshold: 1.6,\r\n          angularSleepingThreshold: 2.5,\r\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\r\n        });\r\n      }\r\n    } else {\r\n      this.el.setAttribute(\"body-helper\", {\r\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE,\r\n        gravity: { x: 0, y: -9.8, z: 0 }\r\n      });\r\n    }\r\n\r\n    if (this.data.autoLockOnRelease) {\r\n      this.setLocked(true);\r\n    }\r\n  },\r\n\r\n  onGrab() {\r\n    this.el.setAttribute(\"body-helper\", {\r\n      gravity: { x: 0, y: 0, z: 0 },\r\n      collisionFilterMask: COLLISION_LAYERS.HANDS\r\n    });\r\n    this.setLocked(false);\r\n  },\r\n\r\n  remove() {\r\n    if (this.stuckTo) {\r\n      const stuckTo = this.stuckTo;\r\n      delete this.stuckTo;\r\n      stuckTo._unstickObject();\r\n    }\r\n  }\r\n});\r\n","const sizeVec = new THREE.Vector3();\r\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\r\nconst colliderWorldPositionVec = new THREE.Vector3();\r\n\r\nAFRAME.registerComponent(\"trigger-volume\", {\r\n  schema: {\r\n    colliders: { type: \"selectorAll\" },\r\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\r\n    target: { type: \"selector\" },\r\n    enterComponent: { type: \"string\" },\r\n    enterProperty: { type: \"string\" },\r\n    enterValue: {\r\n      default: \"\",\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    },\r\n    leaveComponent: { type: \"string\" },\r\n    leaveProperty: { type: \"string\" },\r\n    leaveValue: {\r\n      default: \"\",\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n  init() {\r\n    this.boundingBox = new THREE.Box3();\r\n    this.collidingLastFrame = {};\r\n  },\r\n  update() {\r\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\r\n    sizeVec.copy(this.data.size);\r\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\r\n  },\r\n  tick() {\r\n    if (!this.data.target) return;\r\n\r\n    const colliders = this.data.colliders;\r\n\r\n    for (let i = 0; i < colliders.length; i++) {\r\n      const collider = colliders[i];\r\n      const object3D = collider.object3D;\r\n\r\n      object3D.getWorldPosition(colliderWorldPositionVec);\r\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\r\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\r\n\r\n      if (isColliding && !collidingLastFrame) {\r\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\r\n      } else if (!isColliding && collidingLastFrame) {\r\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\r\n      }\r\n\r\n      this.collidingLastFrame[object3D.id] = isColliding;\r\n    }\r\n  }\r\n});\r\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\r\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\r\nAFRAME.registerComponent(\"video-pause-state\", {\r\n  schema: {\r\n    paused: { default: false }\r\n  },\r\n\r\n  init() {\r\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\r\n    this.videoComponent = this.el.components[\"media-video\"];\r\n\r\n    if (this.videoComponent) {\r\n      this.onVideoLoaded();\r\n    } else {\r\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\r\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\r\n    }\r\n  },\r\n\r\n  onVideoLoaded() {\r\n    this.videoComponent = this.el.components[\"media-video\"];\r\n    this.video = this.videoComponent.video;\r\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\r\n  },\r\n\r\n  onPauseStateChange() {\r\n    this.el.setAttribute(\"paused\", this.video.paused);\r\n  },\r\n\r\n  update() {\r\n    if (this.video && this.data.paused !== this.video.paused) {\r\n      this.videoComponent.togglePlaying();\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (this.video) {\r\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\r\n    }\r\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\r\n  }\r\n});\r\n","/**\r\n * Logs all events dispatched on an entity\r\n * @namespace debug\r\n * @component log-events\r\n */\r\nAFRAME.registerComponent(\"log-events\", {\r\n  init: function() {\r\n    const el = this.el;\r\n    const log = this.log.bind(this);\r\n    const origDispatch = this.el.dispatchEvent;\r\n    this.el.dispatchEvent = function() {\r\n      log(Array.from(arguments));\r\n      return origDispatch.apply(el, arguments);\r\n    };\r\n  },\r\n  log: function([e]) {\r\n    if ([\"componentchanged\"].includes(e.type)) return;\r\n    let firstObject = true;\r\n    const replacer = (k, x) => {\r\n      if (!x) return x;\r\n      if (typeof x === \"object\" && x.length === undefined) {\r\n        if (firstObject) {\r\n          firstObject = false;\r\n          return x;\r\n        }\r\n        return \"[object]\";\r\n      }\r\n      return x;\r\n    };\r\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\r\n  }\r\n});\r\n\r\n/**\r\n * Logs all life cycle phases on an entity.\r\n * @namespace debug\r\n * @component lifecycle-checker\r\n */\r\nAFRAME.registerComponent(\"lifecycle-checker\", {\r\n  schema: {\r\n    name: { type: \"string\" },\r\n    tick: { default: false }\r\n  },\r\n  init: function() {\r\n    this.log(\"init\");\r\n  },\r\n  update: function() {\r\n    this.log(\"update\");\r\n  },\r\n  tick: function() {\r\n    if (this.data.tick) {\r\n      this.log(\"tick\");\r\n    }\r\n  },\r\n  remove: function() {\r\n    this.log(\"remove\");\r\n  },\r\n  pause: function() {\r\n    this.log(\"pause\");\r\n  },\r\n  play: function() {\r\n    this.log(\"play\");\r\n  },\r\n\r\n  log: function(method) {\r\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\r\n  }\r\n});\r\n","const { Pathfinding } = require(\"three-pathfinding\");\r\n\r\nAFRAME.registerSystem(\"nav\", {\r\n  init: function() {\r\n    this.pathfinder = new Pathfinding();\r\n    this.mesh = null;\r\n    this.el.addEventListener(\"reset_scene\", this.removeNavMeshData.bind(this));\r\n    this.el.addEventListener(\"leaving_loading_environment\", this.removeNavMeshData.bind(this));\r\n  },\r\n\r\n  loadMesh: function(mesh, zone) {\r\n    if (this.mesh) {\r\n      console.error(\"tried to load multiple nav meshes\");\r\n      this.removeNavMeshData();\r\n    }\r\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\r\n    mesh.updateMatrices();\r\n    geometry.applyMatrix(mesh.matrixWorld);\r\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\r\n    this.mesh = mesh;\r\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\r\n  },\r\n\r\n  removeNavMeshData() {\r\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\r\n      this.mesh.geometry.dispose();\r\n    }\r\n    this.mesh = null;\r\n    this.pathfinder.zones = {};\r\n  }\r\n});\r\n","/**\r\n * Listens to events from an event source and re-emits them on this entity\r\n * @component event-repeater\r\n */\r\nAFRAME.registerComponent(\"event-repeater\", {\r\n  schema: {\r\n    eventSource: { type: \"selector\" },\r\n    events: { type: \"array\" }\r\n  },\r\n\r\n  play: function() {\r\n    this.data.eventListeners = [];\r\n    const events = this.data.events;\r\n    for (let i = 0; i < events.length; i++) {\r\n      const event = events[i];\r\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\r\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\r\n    }\r\n  },\r\n\r\n  pause: function() {\r\n    const events = this.data.events;\r\n    for (let i = 0; i < events.length; i++) {\r\n      const event = events[i];\r\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\r\n    }\r\n    this.data.eventListeners = [];\r\n  },\r\n\r\n  _handleEvent: function(event, e) {\r\n    this.el.emit(event, e.detail);\r\n  }\r\n});\r\n","const boundingBox = new THREE.Box3();\r\nconst frustumBox = new THREE.Box3();\r\nconst inverseLightMatrixWorld = new THREE.Matrix4();\r\nconst tempBox = new THREE.Box3();\r\nconst FRUSTUM_PADDING = 1;\r\nconst NEAR_CLIPPING_PLANE = -500;\r\nconst FAR_CLIPPING_PLANE = 500;\r\nconst verts = [\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3(),\r\n  new THREE.Vector3()\r\n];\r\n\r\nexport default function resizeShadowCameraFrustum(light, scene) {\r\n  // Reset bounding box\r\n  frustumBox.makeEmpty();\r\n  boundingBox.makeEmpty();\r\n\r\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\r\n  scene.traverse(node => {\r\n    const geometry = node.geometry;\r\n\r\n    if (geometry && node.castShadow) {\r\n      if (!geometry.boundingBox) {\r\n        geometry.computeBoundingBox();\r\n      }\r\n\r\n      tempBox.copy(geometry.boundingBox);\r\n\r\n      // Apply matrix transforming bounding box from model space to world space\r\n      tempBox.applyMatrix4(node.matrixWorld);\r\n\r\n      boundingBox.union(tempBox);\r\n    }\r\n  });\r\n\r\n  // Transform the resulting bounding box from world space to light space.\r\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\r\n  const min = boundingBox.min;\r\n  const max = boundingBox.max;\r\n\r\n  verts[0].set(min.x, min.y, min.z);\r\n  verts[1].set(min.x, min.y, max.z);\r\n  verts[2].set(min.x, max.y, min.z);\r\n  verts[3].set(min.x, max.y, max.z);\r\n  verts[4].set(max.x, min.y, min.z);\r\n  verts[5].set(max.x, min.y, max.z);\r\n  verts[6].set(max.x, max.y, min.z);\r\n  verts[7].set(max.x, max.y, max.z);\r\n\r\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\r\n\r\n  for (let i = 0; i < verts.length; i++) {\r\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\r\n    frustumBox.expandByPoint(verts[i]);\r\n  }\r\n\r\n  // Update the camera frustum to fit the resulting bounding box.\r\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\r\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\r\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\r\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\r\n  const camera = light.shadow.camera;\r\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\r\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\r\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\r\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\r\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\r\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\r\n  camera.updateProjectionMatrix();\r\n}\r\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\r\n\r\nAFRAME.registerComponent(\"directional-light\", {\r\n  schema: {\r\n    color: { type: \"color\" },\r\n    intensity: { default: 1.0 },\r\n    castShadow: { default: true },\r\n    shadowMapResolution: { default: [512, 512] },\r\n    shadowBias: { default: 0 },\r\n    shadowRadius: { default: 1 }\r\n  },\r\n\r\n  init() {\r\n    const el = this.el;\r\n    this.light = new THREE.DirectionalLight();\r\n    this.light.position.set(0, 0, 0);\r\n    this.light.target.position.set(0, 0, 1);\r\n    this.light.add(this.light.target);\r\n    this.el.setObject3D(\"directional-light\", this.light);\r\n    this.el.sceneEl.systems.light.registerLight(el);\r\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\r\n  },\r\n\r\n  update(prevData) {\r\n    const light = this.light;\r\n\r\n    if (this.data.color !== prevData.color) {\r\n      const color = new THREE.Color(this.data.color);\r\n      this.rendererSystem.applyColorCorrection(color);\r\n      light.color.copy(color);\r\n    }\r\n\r\n    if (this.data.intensity !== prevData.intensity) {\r\n      light.intensity = this.data.intensity;\r\n    }\r\n\r\n    if (this.data.castShadow !== prevData.castShadow) {\r\n      light.castShadow = this.data.castShadow;\r\n    }\r\n\r\n    if (this.data.shadowBias !== prevData.shadowBias) {\r\n      light.shadow.bias = this.data.shadowBias;\r\n    }\r\n\r\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\r\n      light.shadow.radius = this.data.shadowRadius;\r\n    }\r\n\r\n    const [width, height] = this.data.shadowMapResolution;\r\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\r\n\r\n    if (width !== prevWidth || height !== prevHeight) {\r\n      light.shadow.mapSize.set(width, height);\r\n\r\n      if (light.shadow.map) {\r\n        light.shadow.map.dispose();\r\n        light.shadow.map = null;\r\n      }\r\n    }\r\n\r\n    this.light.shadow.camera.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  tick() {\r\n    if (window.APP && window.APP.quality === \"low\") {\r\n      return;\r\n    }\r\n\r\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\r\n  },\r\n\r\n  remove: function() {\r\n    this.el.removeObject3D(\"directional-light\");\r\n  }\r\n});\r\n","export const Layers = {\r\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\r\n  reflection: 3\r\n};\r\n\r\n/**\r\n * Sets layer flags on the underlying Object3D\r\n * @namespace environment\r\n * @component layers\r\n */\r\nAFRAME.registerComponent(\"layers\", {\r\n  schema: {\r\n    reflection: { type: \"boolean\", default: false },\r\n    inWorldHud: { type: \"boolean\", default: false },\r\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\r\n  },\r\n  init() {\r\n    this.update = this.update.bind(this);\r\n    this.el.addEventListener(\"model-loaded\", this.update);\r\n  },\r\n  update(oldData) {\r\n    const obj = this.el.object3D;\r\n\r\n    if (this.data.exclusive) {\r\n      obj.traverse(o => (o.layers.mask = 0));\r\n    }\r\n\r\n    for (const [name, layer] of Object.entries(Layers)) {\r\n      const oldValue = oldData[name];\r\n      const newValue = this.data[name];\r\n\r\n      if (oldValue !== newValue) {\r\n        if (newValue) {\r\n          obj.traverse(o => o.layers.enable(layer));\r\n        } else {\r\n          obj.traverse(o => o.layers.disable(layer));\r\n        }\r\n      }\r\n    }\r\n  },\r\n  remove() {\r\n    this.el.removeEventListener(\"model-loaded\", this.update);\r\n  }\r\n});\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\n\r\n/**\r\n * Loops the given clip using this entity's animation mixer\r\n * @component loop-animation\r\n */\r\nAFRAME.registerComponent(\"loop-animation\", {\r\n  schema: {\r\n    paused: { type: \"boolean\", default: false },\r\n    /* DEPRECATED: Use activeClipIndex instead since animation names are not unique */\r\n    clip: { type: \"string\", default: \"\" },\r\n    activeClipIndex: { type: \"int\", default: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\r\n    this.currentActions = [];\r\n\r\n    if (!this.mixerEl) {\r\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\r\n      return;\r\n    }\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.mixerEl) {\r\n      if (oldData.clip !== this.data.clip || oldData.activeClipIndex !== this.data.activeClipIndex) {\r\n        this.updateClip();\r\n      }\r\n\r\n      if (oldData.paused !== this.data.paused) {\r\n        for (let i = 0; i < this.currentActions.length; i++) {\r\n          this.currentActions[i].paused = this.data.paused;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  updateClip() {\r\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\r\n    const { clip: clipName, activeClipIndex } = this.data;\r\n\r\n    if (animations.length === 0) {\r\n      return;\r\n    }\r\n\r\n    let clips;\r\n    if (clipName !== \"\") {\r\n      clips = clipName.split(\",\").map(n => animations.find(({ name }) => name === n));\r\n    } else {\r\n      clips = [animations[activeClipIndex]];\r\n    }\r\n\r\n    if (!(clips && clips.length)) return;\r\n\r\n    this.currentActions.length = 0;\r\n\r\n    for (let i = 0; i < clips.length; i++) {\r\n      const action = mixer.clipAction(clips[i], this.el.object3D);\r\n      action.enabled = true;\r\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\r\n      this.currentActions.push(action);\r\n    }\r\n  },\r\n\r\n  destroy() {\r\n    for (let i = 0; i < this.currentActions.length; i++) {\r\n      this.currentActions[i].enabled = false;\r\n      this.currentActions[i].stop();\r\n    }\r\n    this.currentActions.length = 0;\r\n  }\r\n});\r\n","import { computeObjectAABB, getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\r\nimport {\r\n  resolveUrl,\r\n  getDefaultResolveQuality,\r\n  injectCustomShaderChunks,\r\n  addMeshScaleAnimation,\r\n  closeExistingMediaMirror\r\n} from \"../utils/media-utils\";\r\nimport {\r\n  isNonCorsProxyDomain,\r\n  guessContentType,\r\n  proxiedUrlFor,\r\n  isHubsRoomUrl,\r\n  isLocalHubsSceneUrl,\r\n  isLocalHubsAvatarUrl\r\n} from \"../utils/media-url-utils\";\r\nimport { addAnimationComponents } from \"../utils/animation\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\nimport loadingObjectSrc from \"../assets/models/LoadingObject_Atom.glb\";\r\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\r\nimport { loadModel } from \"./gltf-model-plus\";\r\nimport { cloneObject3D, setMatrixWorld } from \"../utils/three-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nimport { SHAPE } from \"three-ammo/constants\";\r\n\r\nlet loadingObjectEnvMap;\r\nlet loadingObject;\r\n\r\nwaitForDOMContentLoaded().then(() => {\r\n  loadModel(loadingObjectSrc).then(gltf => {\r\n    loadingObject = gltf;\r\n  });\r\n});\r\n\r\nconst fetchContentType = url => {\r\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\r\n};\r\n\r\nconst forceMeshBatching = qsTruthy(\"batchMeshes\");\r\nconst forceImageBatching = qsTruthy(\"batchImages\");\r\nconst disableBatching = qsTruthy(\"disableBatching\");\r\n\r\nAFRAME.registerComponent(\"media-loader\", {\r\n  schema: {\r\n    playSoundEffect: { default: true },\r\n    fileId: { type: \"string\" },\r\n    fileIsOwned: { type: \"boolean\" },\r\n    src: { type: \"string\" },\r\n    version: { type: \"number\", default: 1 }, // Used to force a re-resolution\r\n    fitToBox: { default: false },\r\n    moveTheParentNotTheMesh: { default: false },\r\n    resolve: { default: false },\r\n    contentType: { default: null },\r\n    contentSubtype: { default: null },\r\n    animate: { default: true },\r\n    linkedEl: { default: null }, // This is the element of which this is a linked derivative. See linked-media.js\r\n    mediaOptions: {\r\n      default: {},\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.onError = this.onError.bind(this);\r\n    this.showLoader = this.showLoader.bind(this);\r\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\r\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\r\n    this.handleLinkedElRemoved = this.handleLinkedElRemoved.bind(this);\r\n    this.refresh = this.refresh.bind(this);\r\n    this.animating = false;\r\n\r\n    try {\r\n      NAF.utils\r\n        .getNetworkedEntity(this.el)\r\n        .then(networkedEl => {\r\n          this.networkedEl = networkedEl;\r\n        })\r\n        .catch(() => {}); //ignore exception, entity might not be networked\r\n    } catch (e) {\r\n      // NAF may not exist on scene landing page\r\n    }\r\n  },\r\n\r\n  updateScale: (function() {\r\n    const center = new THREE.Vector3();\r\n    const originalMeshMatrix = new THREE.Matrix4();\r\n    const desiredObjectMatrix = new THREE.Matrix4();\r\n    const position = new THREE.Vector3();\r\n    const quaternion = new THREE.Quaternion();\r\n    const scale = new THREE.Vector3();\r\n    const box = new THREE.Box3();\r\n    return function(fitToBox, moveTheParentNotTheMesh) {\r\n      this.el.object3D.updateMatrices();\r\n      const mesh = this.el.getObject3D(\"mesh\");\r\n      mesh.updateMatrices();\r\n      if (moveTheParentNotTheMesh) {\r\n        if (fitToBox) {\r\n          console.warn(\r\n            \"Unexpected combination of inputs. Can fit the mesh to a box OR move the parent to the mesh, but did not expect to do both.\",\r\n            this.el\r\n          );\r\n        }\r\n        // Keep the mesh exactly where it is, but move the parent transform such that it aligns with the center of the mesh's bounding box.\r\n        originalMeshMatrix.copy(mesh.matrixWorld);\r\n        computeObjectAABB(mesh, box);\r\n        center.addVectors(box.min, box.max).multiplyScalar(0.5);\r\n        this.el.object3D.matrixWorld.decompose(position, quaternion, scale);\r\n        desiredObjectMatrix.compose(\r\n          center,\r\n          quaternion,\r\n          scale\r\n        );\r\n        setMatrixWorld(this.el.object3D, desiredObjectMatrix);\r\n        mesh.updateMatrices();\r\n        setMatrixWorld(mesh, originalMeshMatrix);\r\n      } else {\r\n        // Move the mesh such that the center of its bounding box is in the same position as the parent matrix position\r\n        const box = getBox(this.el, mesh);\r\n        const scaleCoefficient = fitToBox ? getScaleCoefficient(0.5, box) : 1;\r\n        const { min, max } = box;\r\n        center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\r\n        mesh.scale.multiplyScalar(scaleCoefficient);\r\n        mesh.position.sub(center);\r\n        mesh.matrixNeedsUpdate = true;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  removeShape(id) {\r\n    if (this.el.getAttribute(\"shape-helper__\" + id)) {\r\n      this.el.removeAttribute(\"shape-helper__\" + id);\r\n    }\r\n  },\r\n\r\n  tick(t, dt) {\r\n    if (this.loaderMixer) {\r\n      this.loaderMixer.update(dt / 1000);\r\n    }\r\n  },\r\n\r\n  handleLinkedElRemoved(e) {\r\n    if (e.detail.name === \"media-loader\") {\r\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n\r\n      // this should be revisited if we ever use media linking for something other than media mirroring UX --\r\n      // right now it is assumed if there is a linkedEl, this is the currently active mirrored media\r\n      closeExistingMediaMirror();\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.linkedEl) {\r\n      this.data.linkedEl.removeEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n    }\r\n\r\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n    if (this.loadingSoundEffect) {\r\n      sfx.stopPositionalAudio(this.loadingSoundEffect);\r\n      this.loadingSoundEffect = null;\r\n    }\r\n    if (this.loadedSoundEffect) {\r\n      sfx.stopPositionalAudio(this.loadedSoundEffect);\r\n      this.loadedSoundEffect = null;\r\n    }\r\n  },\r\n\r\n  onError() {\r\n    this.el.removeAttribute(\"gltf-model-plus\");\r\n    this.el.removeAttribute(\"media-pager\");\r\n    this.el.removeAttribute(\"media-video\");\r\n    this.el.removeAttribute(\"media-pdf\");\r\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\r\n    this.clearLoadingTimeout();\r\n  },\r\n\r\n  showLoader() {\r\n    if (this.el.object3DMap.mesh) {\r\n      this.clearLoadingTimeout();\r\n      return;\r\n    }\r\n    const useFancyLoader = !!loadingObject;\r\n\r\n    const mesh = useFancyLoader\r\n      ? cloneObject3D(loadingObject.scene)\r\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\r\n    this.el.setObject3D(\"mesh\", mesh);\r\n\r\n    this.updateScale(true, false);\r\n\r\n    if (useFancyLoader) {\r\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n      if (environmentMapComponent) {\r\n        const currentEnivronmentMap = environmentMapComponent.environmentMap;\r\n        if (loadingObjectEnvMap !== currentEnivronmentMap) {\r\n          environmentMapComponent.applyEnvironmentMap(mesh);\r\n          loadingObjectEnvMap = currentEnivronmentMap;\r\n        }\r\n      }\r\n\r\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\r\n\r\n      this.loadingClip = this.loaderMixer.clipAction(mesh.animations[0]);\r\n      this.loadingScaleClip = this.loaderMixer.clipAction(\r\n        new THREE.AnimationClip(null, 1000, [\r\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\r\n        ])\r\n      );\r\n      setTimeout(() => {\r\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\r\n        this.el.setAttribute(\"shape-helper__loader\", { type: SHAPE.BOX });\r\n      }, 200);\r\n\r\n      this.loadingClip.play();\r\n      this.loadingScaleClip.play();\r\n    }\r\n\r\n    if (\r\n      this.el.sceneEl.is(\"entered\") &&\r\n      (!this.networkedEl || NAF.utils.isMine(this.networkedEl)) &&\r\n      this.data.playSoundEffect\r\n    ) {\r\n      this.loadingSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n        SOUND_MEDIA_LOADING,\r\n        this.el.object3D,\r\n        true\r\n      );\r\n    }\r\n\r\n    delete this.showLoaderTimeout;\r\n  },\r\n\r\n  clearLoadingTimeout() {\r\n    clearTimeout(this.showLoaderTimeout);\r\n    if (this.loadingSoundEffect) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopPositionalAudio(this.loadingSoundEffect);\r\n      this.loadingSoundEffect = null;\r\n    }\r\n    if (this.loaderMixer) {\r\n      this.loadingClip.stop();\r\n      this.loadingScaleClip.stop();\r\n      delete this.loaderMixer;\r\n      delete this.loadingScaleClip;\r\n      delete this.loadingClip;\r\n    }\r\n    delete this.showLoaderTimeout;\r\n    this.removeShape(\"loader\");\r\n  },\r\n\r\n  updateHoverableVisuals: (function() {\r\n    const boundingBox = new THREE.Box3();\r\n    const boundingSphere = new THREE.Sphere();\r\n    return function() {\r\n      const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\r\n\r\n      if (hoverableVisuals) {\r\n        if (!this.injectedCustomShaderChunks) {\r\n          this.injectedCustomShaderChunks = true;\r\n          hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\r\n        }\r\n\r\n        boundingBox.setFromObject(this.el.object3DMap.mesh);\r\n        boundingBox.getBoundingSphere(boundingSphere);\r\n        hoverableVisuals.geometryRadius = boundingSphere.radius / this.el.object3D.scale.y;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\r\n    const el = this.el;\r\n    this.clearLoadingTimeout();\r\n\r\n    if (this.el.sceneEl.is(\"entered\") && this.data.playSoundEffect) {\r\n      this.loadedSoundEffect = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n        SOUND_MEDIA_LOADED,\r\n        this.el.object3D,\r\n        false\r\n      );\r\n    }\r\n\r\n    const finish = () => {\r\n      this.animating = false;\r\n\r\n      if (physicsShape) {\r\n        el.setAttribute(\"shape-helper\", {\r\n          type: physicsShape,\r\n          minHalfExtent: 0.04\r\n        });\r\n      }\r\n\r\n      this.updateHoverableVisuals();\r\n\r\n      if (this.data.linkedEl) {\r\n        this.el.sceneEl.systems[\"linked-media\"].registerLinkage(this.data.linkedEl, this.el);\r\n        this.data.linkedEl.addEventListener(\"componentremoved\", this.handleLinkedElRemoved);\r\n      }\r\n\r\n      el.emit(\"media-loaded\");\r\n    };\r\n\r\n    if (this.data.animate) {\r\n      if (!this.animating) {\r\n        this.animating = true;\r\n        if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\r\n        const mesh = this.el.getObject3D(\"mesh\");\r\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\r\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\r\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\r\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\r\n        addMeshScaleAnimation(mesh, scale, finish);\r\n      }\r\n    } else {\r\n      if (shouldUpdateScale) this.updateScale(this.data.fitToBox, this.data.moveTheParentNotTheMesh);\r\n      finish();\r\n    }\r\n  },\r\n\r\n  refresh() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n\r\n    // When we refresh, we bump the version to the current timestamp.\r\n    //\r\n    // The only use-case for refresh right now is re-fetching screenshots.\r\n    this.el.setAttribute(\"media-loader\", { version: Math.floor(Date.now() / 1000) });\r\n  },\r\n\r\n  async update(oldData, forceLocalRefresh) {\r\n    const { src, version, contentSubtype } = this.data;\r\n    if (!src) return;\r\n\r\n    const srcChanged = oldData.src !== src;\r\n    const versionChanged = !!(oldData.version && oldData.version !== version);\r\n\r\n    if (versionChanged) {\r\n      this.el.emit(\"media_refreshing\");\r\n\r\n      // Don't animate if its a refresh.\r\n      this.data.animate = false;\r\n\r\n      // Play the sound effect on a refresh only if we are the owner\r\n      this.data.playSoundEffect = NAF.utils.isMine(this.networkedEl);\r\n    }\r\n\r\n    if (forceLocalRefresh) {\r\n      this.el.removeAttribute(\"gltf-model-plus\");\r\n      this.el.removeAttribute(\"media-pager\");\r\n      this.el.removeAttribute(\"media-video\");\r\n      this.el.removeAttribute(\"media-pdf\");\r\n      this.el.removeAttribute(\"media-image\");\r\n    }\r\n\r\n    try {\r\n      if ((forceLocalRefresh || srcChanged) && !this.showLoaderTimeout) {\r\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\r\n      }\r\n\r\n      let canonicalUrl = src;\r\n      let canonicalAudioUrl = src;\r\n      let accessibleUrl = src;\r\n      let contentType = this.data.contentType;\r\n      let thumbnail;\r\n\r\n      const parsedUrl = new URL(src);\r\n\r\n      // We want to resolve and proxy some hubs urls, like rooms and scene links,\r\n      // but want to avoid proxying assets in order for this to work in dev environments\r\n      const isLocalModelAsset =\r\n        isNonCorsProxyDomain(parsedUrl.hostname) && (guessContentType(src) || \"\").startsWith(\"model/gltf\");\r\n\r\n      if (this.data.resolve && !src.startsWith(\"data:\") && !src.startsWith(\"hubs:\") && !isLocalModelAsset) {\r\n        const is360 = !!(this.data.mediaOptions.projection && this.data.mediaOptions.projection.startsWith(\"360\"));\r\n        const quality = getDefaultResolveQuality(is360);\r\n        const result = await resolveUrl(src, quality, version, forceLocalRefresh);\r\n        canonicalUrl = result.origin;\r\n\r\n        // handle protocol relative urls\r\n        if (canonicalUrl.startsWith(\"//\")) {\r\n          canonicalUrl = location.protocol + canonicalUrl;\r\n        }\r\n\r\n        canonicalAudioUrl = result.origin_audio;\r\n        if (canonicalAudioUrl && canonicalAudioUrl.startsWith(\"//\")) {\r\n          canonicalAudioUrl = location.protocol + canonicalAudioUrl;\r\n        }\r\n\r\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\r\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\r\n      }\r\n\r\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\r\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\r\n\r\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\r\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\r\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\r\n\r\n      // We don't want to emit media_resolved for index updates.\r\n      if (forceLocalRefresh || srcChanged) {\r\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\r\n      } else {\r\n        this.el.emit(\"media_refreshed\", { src, raw: accessibleUrl, contentType });\r\n      }\r\n\r\n      if (\r\n        contentType.startsWith(\"video/\") ||\r\n        contentType.startsWith(\"audio/\") ||\r\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\r\n      ) {\r\n        let linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource;\r\n        if (this.data.linkedEl) {\r\n          const linkedMediaVideo = this.data.linkedEl.components[\"media-video\"];\r\n\r\n          linkedVideoTexture = linkedMediaVideo.videoTexture;\r\n          linkedAudioSource = linkedMediaVideo.audioSource;\r\n          linkedMediaElementAudioSource = linkedMediaVideo.mediaElementAudioSource;\r\n        }\r\n\r\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\r\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\r\n        const startTime = hashTime || qsTime || 0;\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        this.el.addEventListener(\r\n          \"video-loaded\",\r\n          e => {\r\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\r\n          \"media-video\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            audioSrc: canonicalAudioUrl ? proxiedUrlFor(canonicalAudioUrl) : null,\r\n            time: startTime,\r\n            contentType,\r\n            linkedVideoTexture,\r\n            linkedAudioSource,\r\n            linkedMediaElementAudioSource\r\n          })\r\n        );\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (contentType.startsWith(\"image/\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"image-loaded\",\r\n          e => {\r\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\r\n\r\n            if (contentSubtype === \"photo-camera\") {\r\n              this.el.setAttribute(\"hover-menu__photo\", {\r\n                template: \"#photo-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            }\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        let batch = !disableBatching && forceImageBatching;\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"media-image\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            version,\r\n            contentType,\r\n            batch\r\n          })\r\n        );\r\n\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (contentType.startsWith(\"application/pdf\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.setAttribute(\r\n          \"media-pdf\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            contentType,\r\n            batch: false // Batching disabled until atlas is updated properly\r\n          })\r\n        );\r\n        this.el.setAttribute(\"media-pager\", {});\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        this.el.addEventListener(\r\n          \"pdf-loaded\",\r\n          () => {\r\n            this.clearLoadingTimeout();\r\n            this.onMediaLoaded(SHAPE.BOX);\r\n          },\r\n          { once: true }\r\n        );\r\n\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else if (\r\n        contentType.includes(\"application/octet-stream\") ||\r\n        contentType.includes(\"x-zip-compressed\") ||\r\n        contentType.startsWith(\"model/gltf\")\r\n      ) {\r\n        this.el.removeAttribute(\"media-image\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"model-loaded\",\r\n          () => {\r\n            this.onMediaLoaded(SHAPE.HULL, true);\r\n            addAnimationComponents(this.el);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\r\n        let batch = !disableBatching && forceMeshBatching;\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"gltf-model-plus\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: accessibleUrl,\r\n            contentType: contentType,\r\n            inflate: true,\r\n            batch,\r\n            modelToWorldScale: this.data.fitToBox ? 0.0001 : 1.0\r\n          })\r\n        );\r\n      } else if (contentType.startsWith(\"text/html\")) {\r\n        this.el.removeAttribute(\"gltf-model-plus\");\r\n        this.el.removeAttribute(\"media-video\");\r\n        this.el.removeAttribute(\"media-pdf\");\r\n        this.el.removeAttribute(\"media-pager\");\r\n        this.el.addEventListener(\r\n          \"image-loaded\",\r\n          async () => {\r\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\r\n\r\n            if (await isLocalHubsAvatarUrl(src)) {\r\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\r\n                template: \"#avatar-link-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            } else if ((await isHubsRoomUrl(src)) || ((await isLocalHubsSceneUrl(src)) && mayChangeScene)) {\r\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\r\n                template: \"#hubs-destination-hover-menu\",\r\n                dirs: [\"forward\", \"back\"]\r\n              });\r\n            } else {\r\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\r\n            }\r\n            this.onMediaLoaded(SHAPE.BOX);\r\n          },\r\n          { once: true }\r\n        );\r\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\r\n        let batch = !disableBatching;\r\n        if (this.data.mediaOptions.hasOwnProperty(\"batch\") && !this.data.mediaOptions.batch) {\r\n          batch = false;\r\n        }\r\n        this.el.setAttribute(\r\n          \"media-image\",\r\n          Object.assign({}, this.data.mediaOptions, {\r\n            src: thumbnail,\r\n            version,\r\n            contentType: guessContentType(thumbnail) || \"image/png\",\r\n            batch\r\n          })\r\n        );\r\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\r\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\r\n        }\r\n      } else {\r\n        throw new Error(`Unsupported content type: ${contentType}`);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Error adding media\", e);\r\n      this.onError();\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"media-pager\", {\r\n  schema: {\r\n    index: { default: 0 },\r\n    maxIndex: { default: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.onNext = this.onNext.bind(this);\r\n    this.onPrev = this.onPrev.bind(this);\r\n    this.onSnap = this.onSnap.bind(this);\r\n    this.update = this.update.bind(this);\r\n\r\n    this.el.setAttribute(\"hover-menu__pager\", { template: \"#pager-hover-menu\", dirs: [\"forward\", \"back\"] });\r\n    this.el.components[\"hover-menu__pager\"].getHoverMenu().then(menu => {\r\n      // If we got removed while waiting, do nothing.\r\n      if (!this.el.parentNode) return;\r\n\r\n      this.hoverMenu = menu;\r\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\r\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\r\n      this.snapButton = this.el.querySelector(\".snap-button [text-button]\");\r\n      this.pageLabel = this.el.querySelector(\".page-label\");\r\n\r\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\r\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\r\n      this.snapButton.object3D.addEventListener(\"interact\", this.onSnap);\r\n\r\n      this.update();\r\n      this.el.emit(\"pager-loaded\");\r\n    });\r\n\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(networkedEl => {\r\n        this.networkedEl = networkedEl;\r\n        this.networkedEl.addEventListener(\"pinned\", this.update);\r\n        this.networkedEl.addEventListener(\"unpinned\", this.update);\r\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.update);\r\n      })\r\n      .catch(() => {}); //ignore exception, entity might not be networked\r\n\r\n    this.el.addEventListener(\"pdf-loaded\", async () => {\r\n      this.update();\r\n    });\r\n  },\r\n\r\n  async update(oldData) {\r\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n      if (oldData && typeof oldData.index === \"number\" && oldData.index !== this.data.index) {\r\n        this.el.emit(\"owned-pager-page-changed\");\r\n      }\r\n    }\r\n\r\n    if (this.pageLabel) {\r\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\r\n    }\r\n\r\n    if (this.prevButton && this.nextButton) {\r\n      const pinnableElement = this.el.components[\"media-loader\"].data.linkedEl || this.el;\r\n      const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\r\n      this.prevButton.object3D.visible = this.nextButton.object3D.visible =\r\n        !isPinned || window.APP.hubChannel.can(\"pin_objects\");\r\n    }\r\n  },\r\n\r\n  onNext() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n    const newIndex = Math.min(this.data.index + 1, this.data.maxIndex);\r\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\r\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\r\n  },\r\n\r\n  onPrev() {\r\n    if (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\r\n    const newIndex = Math.max(this.data.index - 1, 0);\r\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\r\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\r\n  },\r\n\r\n  onSnap() {\r\n    this.el.emit(\"pager-snap-clicked\");\r\n  },\r\n\r\n  remove() {\r\n    if (this.networkedEl) {\r\n      this.networkedEl.removeEventListener(\"pinned\", this.update);\r\n      this.networkedEl.removeEventListener(\"unpinned\", this.update);\r\n    }\r\n\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.update);\r\n  }\r\n});\r\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\r\n\r\nAFRAME.registerComponent(\"quack\", {\r\n  schema: {\r\n    quackPercentage: { default: 1 },\r\n    specialQuackPercentage: { default: 0.01 }\r\n  },\r\n\r\n  init: function() {\r\n    this._handleGrabStart = this._handleGrabStart.bind(this);\r\n  },\r\n\r\n  play: function() {\r\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\r\n  },\r\n\r\n  pause: function() {\r\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\r\n  },\r\n\r\n  _handleGrabStart: function() {\r\n    const rand = Math.random();\r\n    if (rand < this.data.specialQuackPercentage) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\r\n    } else if (rand < this.data.quackPercentage) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\r\n    }\r\n  }\r\n});\r\n","import { setMatrixWorld } from \"../utils/three-utils\";\r\nimport { getCurrentStreamer } from \"../utils/component-utils\";\r\nimport { CAMERA_MODE_SCENE_PREVIEW } from \"../systems/camera-system\";\r\n\r\nfunction getStreamerCamera() {\r\n  const streamer = getCurrentStreamer();\r\n  if (streamer) {\r\n    return streamer.el.querySelector(\".camera\").object3D;\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction lerp(start, end, t) {\r\n  return (1 - t) * start + t * end;\r\n}\r\n\r\nconst newRot = new THREE.Quaternion();\r\n\r\n/**\r\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\r\n * since it ends up panning in a direction dependent upon the start camera orientation,\r\n * but it's good enough for now.\r\n */\r\nAFRAME.registerComponent(\"scene-preview-camera\", {\r\n  schema: {\r\n    duration: { default: 90, type: \"number\" },\r\n    positionOnly: { default: false, type: \"boolean\" }\r\n  },\r\n\r\n  init: function() {\r\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\r\n\r\n    if (systems) {\r\n      systems.scenePreviewCameraSystem.register(this.el);\r\n    }\r\n\r\n    this.startPoint = this.el.object3D.position.clone();\r\n    this.startRotation = this.el.object3D.quaternion.clone();\r\n\r\n    this.targetPoint = this.el.object3D.position.clone();\r\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\r\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\r\n\r\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\r\n    this.targetRotation = new THREE.Quaternion();\r\n    this.targetRotation.setFromEuler(targetRotDelta);\r\n    this.targetRotation.premultiply(this.startRotation);\r\n\r\n    this.startTime = performance.now();\r\n    this.backwards = false;\r\n    this.ranOnePass = false;\r\n  },\r\n\r\n  tick2: function() {\r\n    const hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\r\n\r\n    let streamerCamera;\r\n    if (hubsSystems) {\r\n      hubsSystems.cameraSystem.mode = CAMERA_MODE_SCENE_PREVIEW;\r\n      streamerCamera = getStreamerCamera();\r\n    }\r\n\r\n    if (streamerCamera) {\r\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\r\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\r\n      this.el.object3D.translateZ(-0.1);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    } else {\r\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\r\n      t = Math.min(1.0, Math.max(0.0, t));\r\n\r\n      if (!this.ranOnePass) {\r\n        t = t * (2 - t);\r\n      } else {\r\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n      }\r\n\r\n      const from = this.backwards ? this.targetPoint : this.startPoint;\r\n      const to = this.backwards ? this.startPoint : this.targetPoint;\r\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\r\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\r\n\r\n      THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\r\n\r\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\r\n\r\n      if (!this.data.positionOnly) {\r\n        this.el.object3D.rotation.setFromQuaternion(newRot);\r\n      }\r\n\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n\r\n      if (t >= 0.9999) {\r\n        this.ranOnePass = true;\r\n        this.backwards = !this.backwards;\r\n        this.startTime = performance.now();\r\n      }\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    const systems = AFRAME.scenes[0].systems[\"hubs-systems\"] || AFRAME.scenes[0].systems[\"scene-systems\"];\r\n\r\n    if (systems) {\r\n      systems.scenePreviewCameraSystem.unregister(this.el);\r\n    }\r\n  }\r\n});\r\n","import \"three/examples/js/pmrem/PMREMGenerator\";\r\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\nconst isBotMode = qsTruthy(\"bot\");\r\n\r\nconst {\r\n  Scene,\r\n  CubeCamera,\r\n  Object3D,\r\n  Vector3,\r\n  BoxBufferGeometry,\r\n  ShaderMaterial,\r\n  UniformsUtils,\r\n  BackSide,\r\n  Mesh,\r\n  UniformsLib,\r\n  PMREMGenerator,\r\n  PMREMCubeUVPacker\r\n} = THREE;\r\n\r\n/**\r\n * @author zz85 / https://github.com/zz85\r\n *\r\n * Based on \"A Practical Analytic Model for Daylight\"\r\n * aka The Preetham Model, the de facto standard analytic skydome model\r\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\r\n *\r\n * First implemented by Simon Wallner\r\n * http://www.simonwallner.at/projects/atmospheric-scattering\r\n *\r\n * Improved by Martin Upitis\r\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\r\n *\r\n * Three.js integration by zz85 http://twitter.com/blurspline\r\n */\r\n\r\nconst vertexShader = `\r\n#include <common>\r\n#include <fog_pars_vertex>\r\n\r\nuniform vec3 sunPosition;\r\nuniform float rayleigh;\r\nuniform float turbidity;\r\nuniform float mieCoefficient;\r\n\r\nvarying vec3 vWorldPosition;\r\nvarying vec3 vSunDirection;\r\nvarying float vSunfade;\r\nvarying vec3 vBetaR;\r\nvarying vec3 vBetaM;\r\nvarying float vSunE;\r\n\r\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\r\n\r\n// constants for atmospheric scattering\r\nconst float e = 2.71828182845904523536028747135266249775724709369995957;\r\nconst float pi = 3.141592653589793238462643383279502884197169;\r\n\r\n// wavelength of used primaries, according to preetham\r\nconst vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\r\n// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\r\n// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\r\nconst vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\r\n\r\n// mie stuff\r\n// K coefficient for the primaries\r\nconst float v = 4.0;\r\nconst vec3 K = vec3( 0.686, 0.678, 0.666 );\r\n// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\r\nconst vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\r\n\r\n// earth shadow hack\r\n// cutoffAngle = pi / 1.95;\r\nconst float cutoffAngle = 1.6110731556870734;\r\nconst float steepness = 1.5;\r\nconst float EE = 1000.0;\r\n\r\nfloat sunIntensity( float zenithAngleCos ) {\r\n  zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\r\n  return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\r\n}\r\n\r\nvec3 totalMie( float T ) {\r\n  float c = ( 0.2 * T ) * 10E-18;\r\n  return 0.434 * c * MieConst;\r\n}\r\n\r\nvoid main() {\r\n  #include <begin_vertex>\r\n\r\n  vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\r\n  vWorldPosition = worldPosition.xyz;\r\n\r\n  #include <project_vertex>\r\n\r\n  vSunDirection = normalize( sunPosition );\r\n\r\n  vSunE = sunIntensity( dot( vSunDirection, up ) );\r\n\r\n  vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\r\n\r\n  float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\r\n\r\n  // extinction (absorbtion + out scattering)\r\n  // rayleigh coefficients\r\n  vBetaR = totalRayleigh * rayleighCoefficient;\r\n\r\n  // mie coefficients\r\n  vBetaM = totalMie( turbidity ) * mieCoefficient;\r\n\r\n  #include <fog_vertex>\r\n}\r\n`;\r\n\r\nconst fragmentShader = `\r\n#include <common>\r\n#include <fog_pars_fragment>\r\n\r\nvarying vec3 vWorldPosition;\r\nvarying vec3 vSunDirection;\r\nvarying float vSunfade;\r\nvarying vec3 vBetaR;\r\nvarying vec3 vBetaM;\r\nvarying float vSunE;\r\n\r\nuniform float luminance;\r\nuniform float mieDirectionalG;\r\n\r\nconst vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\r\n\r\n// constants for atmospheric scattering\r\nconst float pi = 3.141592653589793238462643383279502884197169;\r\n\r\nconst float n = 1.0003; // refractive index of air\r\nconst float N = 2.545E25; // number of molecules per unit volume for air at\r\n// 288.15K and 1013mb (sea level -45 celsius)\r\n\r\n// optical length at zenith for molecules\r\nconst float rayleighZenithLength = 8.4E3;\r\nconst float mieZenithLength = 1.25E3;\r\nconst vec3 up = vec3( 0.0, 1.0, 0.0 );\r\n// 66 arc seconds -> degrees, and the cosine of that\r\nconst float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\r\n\r\n// 3.0 / ( 16.0 * pi )\r\nconst float THREE_OVER_SIXTEENPI = 0.05968310365946075;\r\n// 1.0 / ( 4.0 * pi )\r\nconst float ONE_OVER_FOURPI = 0.07957747154594767;\r\n\r\nfloat rayleighPhase( float cosTheta ) {\r\n  return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\r\n}\r\n\r\nfloat hgPhase( float cosTheta, float g ) {\r\n  float g2 = pow( g, 2.0 );\r\n  float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\r\n  return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\r\n}\r\n\r\n// Filmic ToneMapping http://filmicgames.com/archives/75\r\nconst float A = 0.15;\r\nconst float B = 0.50;\r\nconst float C = 0.10;\r\nconst float D = 0.20;\r\nconst float E = 0.02;\r\nconst float F = 0.30;\r\n\r\nconst float whiteScale = 1.0748724675633854; // 1.0 / Uncharted2Tonemap(1000.0)\r\n\r\nvec3 Uncharted2Tonemap( vec3 x ) {\r\n  return ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\r\n}\r\n\r\nvoid main() {\r\n  // optical length\r\n  // cutoff angle at 90 to avoid singularity in next formula.\r\n  float zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\r\n  float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\r\n  float sR = rayleighZenithLength * inverse;\r\n  float sM = mieZenithLength * inverse;\r\n\r\n  // combined extinction factor\r\n  vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\r\n\r\n  // in scattering\r\n  float cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\r\n\r\n  float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\r\n  vec3 betaRTheta = vBetaR * rPhase;\r\n\r\n  float mPhase = hgPhase( cosTheta, mieDirectionalG );\r\n  vec3 betaMTheta = vBetaM * mPhase;\r\n\r\n  vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\r\n  Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\r\n\r\n  // nightsky\r\n  vec3 direction = normalize( vWorldPosition - cameraPos );\r\n  float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\r\n  float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\r\n  vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\r\n  vec3 L0 = vec3( 0.1 ) * Fex;\r\n\r\n  // composition + solar disc\r\n  float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\r\n  L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\r\n\r\n  vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\r\n\r\n  vec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\r\n  vec3 color = curr * whiteScale;\r\n\r\n  vec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\r\n\r\n  gl_FragColor = vec4( retColor, 1.0 );\r\n\r\n  #include <fog_fragment>\r\n}\r\n`;\r\n\r\nexport default class Sky extends Object3D {\r\n  static shader = {\r\n    uniforms: UniformsUtils.merge([\r\n      UniformsLib.fog,\r\n      {\r\n        luminance: { value: 1 },\r\n        turbidity: { value: 10 },\r\n        rayleigh: { value: 2 },\r\n        mieCoefficient: { value: 0.005 },\r\n        mieDirectionalG: { value: 0.8 },\r\n        sunPosition: { value: new Vector3() }\r\n      }\r\n    ]),\r\n    vertexShader,\r\n    fragmentShader\r\n  };\r\n\r\n  static _geometry = new BoxBufferGeometry(1, 1, 1);\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    const material = new ShaderMaterial({\r\n      fragmentShader: Sky.shader.fragmentShader,\r\n      vertexShader: Sky.shader.vertexShader,\r\n      uniforms: UniformsUtils.clone(Sky.shader.uniforms),\r\n      side: BackSide,\r\n      fog: true\r\n    });\r\n\r\n    this.skyScene = new Scene();\r\n    this.cubeCamera = new CubeCamera(1, 100000, 512);\r\n    this.skyScene.add(this.cubeCamera);\r\n\r\n    this.sky = new Mesh(Sky._geometry, material);\r\n    this.sky.name = \"Sky\";\r\n    this.add(this.sky);\r\n\r\n    this._inclination = 0;\r\n    this._azimuth = 0.15;\r\n    this._distance = 8000;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get turbidity() {\r\n    return this.sky.material.uniforms.turbidity.value;\r\n  }\r\n\r\n  set turbidity(value) {\r\n    this.sky.material.uniforms.turbidity.value = value;\r\n  }\r\n\r\n  get rayleigh() {\r\n    return this.sky.material.uniforms.rayleigh.value;\r\n  }\r\n\r\n  set rayleigh(value) {\r\n    this.sky.material.uniforms.rayleigh.value = value;\r\n  }\r\n\r\n  get luminance() {\r\n    return this.sky.material.uniforms.luminance.value;\r\n  }\r\n\r\n  set luminance(value) {\r\n    this.sky.material.uniforms.luminance.value = value;\r\n  }\r\n\r\n  get mieCoefficient() {\r\n    return this.sky.material.uniforms.mieCoefficient.value;\r\n  }\r\n\r\n  set mieCoefficient(value) {\r\n    this.sky.material.uniforms.mieCoefficient.value = value;\r\n  }\r\n\r\n  get mieDirectionalG() {\r\n    return this.sky.material.uniforms.mieDirectionalG.value;\r\n  }\r\n\r\n  set mieDirectionalG(value) {\r\n    this.sky.material.uniforms.mieDirectionalG.value = value;\r\n  }\r\n\r\n  get inclination() {\r\n    return this._inclination;\r\n  }\r\n\r\n  set inclination(value) {\r\n    this._inclination = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get azimuth() {\r\n    return this._azimuth;\r\n  }\r\n\r\n  set azimuth(value) {\r\n    this._azimuth = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  get distance() {\r\n    return this._distance;\r\n  }\r\n\r\n  set distance(value) {\r\n    this._distance = value;\r\n    this.updateSunPosition();\r\n  }\r\n\r\n  updateSunPosition() {\r\n    const theta = Math.PI * (this._inclination - 0.5);\r\n    const phi = 2 * Math.PI * (this._azimuth - 0.5);\r\n\r\n    const distance = this._distance;\r\n\r\n    const x = distance * Math.cos(phi);\r\n    const y = distance * Math.sin(phi) * Math.sin(theta);\r\n    const z = distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n    this.sky.material.uniforms.sunPosition.value.set(x, y, z).normalize();\r\n    this.sky.scale.set(distance, distance, distance);\r\n  }\r\n\r\n  generateEnvironmentMap(renderer) {\r\n    this.skyScene.add(this.sky);\r\n    this.cubeCamera.update(renderer, this.skyScene);\r\n    this.add(this.sky);\r\n    const vrEnabled = renderer.vr.enabled;\r\n    renderer.vr.enabled = false;\r\n    const pmremGenerator = new PMREMGenerator(this.cubeCamera.renderTarget.texture);\r\n    pmremGenerator.update(renderer);\r\n    const pmremCubeUVPacker = new PMREMCubeUVPacker(pmremGenerator.cubeLods);\r\n    pmremCubeUVPacker.update(renderer);\r\n    renderer.vr.enabled = vrEnabled;\r\n    pmremGenerator.dispose();\r\n    pmremCubeUVPacker.dispose();\r\n    return pmremCubeUVPacker.CubeUVRenderTarget.texture;\r\n  }\r\n\r\n  copy(source, recursive = true) {\r\n    if (recursive) {\r\n      this.remove(this.sky);\r\n    }\r\n\r\n    super.copy(source, recursive);\r\n\r\n    if (recursive) {\r\n      const skyIndex = source.children.indexOf(source.sky);\r\n\r\n      if (skyIndex !== -1) {\r\n        this.sky = this.children[skyIndex];\r\n      }\r\n    }\r\n\r\n    this.turbidity = source.turbidity;\r\n    this.rayleigh = source.rayleigh;\r\n    this.luminance = source.luminance;\r\n    this.mieCoefficient = source.mieCoefficient;\r\n    this.mieDirectionalG = source.mieDirectionalG;\r\n    this.inclination = source.inclination;\r\n    this.azimuth = source.azimuth;\r\n    this.distance = source.distance;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"skybox\", {\r\n  schema: {\r\n    turbidity: { type: \"number\", default: 10 },\r\n    rayleigh: { type: \"number\", default: 2 },\r\n    luminance: { type: \"number\", default: 1 },\r\n    mieCoefficient: { type: \"number\", default: 0.005 },\r\n    mieDirectionalG: { type: \"number\", default: 0.8 },\r\n    inclination: { type: \"number\", default: 0 },\r\n    azimuth: { type: \"number\", default: 0.15 },\r\n    distance: { type: \"number\", default: 8000 }\r\n  },\r\n\r\n  init() {\r\n    this.sky = new Sky();\r\n    this.sky.cubeCamera.children.forEach(o => (o.matrixNeedsUpdate = true));\r\n    this.el.setObject3D(\"mesh\", this.sky);\r\n\r\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\r\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\r\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\r\n    // Added timeout due to additional case where texture is black in Firefox.\r\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.turbidity !== oldData.turbidity) {\r\n      this.sky.turbidity = this.data.turbidity;\r\n    }\r\n\r\n    if (this.data.rayleigh !== oldData.rayleigh) {\r\n      this.sky.rayleigh = this.data.rayleigh;\r\n    }\r\n\r\n    if (this.data.luminance !== oldData.luminance) {\r\n      this.sky.luminance = this.data.luminance;\r\n    }\r\n\r\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\r\n      this.sky.mieCoefficient = this.data.mieCoefficient;\r\n    }\r\n\r\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\r\n      this.sky.mieDirectionalG = this.data.mieDirectionalG;\r\n    }\r\n\r\n    if (this.data.inclination !== oldData.inclination) {\r\n      this.sky.inclination = this.data.inclination;\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    if (this.data.azimuth !== oldData.azimuth) {\r\n      this.sky.azimuth = this.data.azimuth;\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    if (this.data.distance !== oldData.distance) {\r\n      const distance = this.data.distance;\r\n\r\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\r\n      // have their sky scales set to 1.\r\n      this.sky.distance = this.el.object3D.scale.x === 1 ? distance : 1;\r\n      this.sky.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    this.updateEnvironmentMap();\r\n  },\r\n\r\n  updateEnvironmentMap() {\r\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n\r\n    if (environmentMapComponent && !isBotMode) {\r\n      const renderer = this.el.sceneEl.renderer;\r\n      const envMap = this.sky.generateEnvironmentMap(renderer);\r\n      environmentMapComponent.updateEnvironmentMap(envMap);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"mesh\");\r\n  }\r\n});\r\n","import { getLastWorldPosition } from \"../utils/three-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\n/**\r\n * Used on a avatar-rig to move the avatar to a random spawn point on entry.\r\n * @namespace avatar\r\n * @component spawn-controller\r\n */\r\nAFRAME.registerComponent(\"spawn-controller\", {\r\n  schema: {\r\n    target: { type: \"selector\" },\r\n    camera: { type: \"selector\", default: \"#avatar-pov-node\" },\r\n    playerHeight: { default: 1.6 },\r\n    loadedEvent: { type: \"string\" }\r\n  },\r\n  init() {\r\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\r\n    });\r\n  },\r\n  moveToSpawnPoint() {\r\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\r\n\r\n    if (spawnPoints.length === 0) {\r\n      // Keep default position\r\n      return;\r\n    }\r\n\r\n    const camera = this.data.camera;\r\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\r\n    const spawnPoint = spawnPoints[spawnPointIndex];\r\n\r\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\r\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\r\n\r\n    if (this.el.sceneEl.is(\"vr-mode\")) {\r\n      // Rotate the avatar rig such that the vr-camera faces forward.\r\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\r\n    } else {\r\n      // Reset the camera transform in 2D mode.\r\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\r\n      camera.object3D.rotation.set(0, 0, 0);\r\n      camera.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\r\n    this.el.object3D.rotation.y += Math.PI;\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n\r\n/**\r\n * Marks an entity as a potential spawn point.\r\n * @namespace environment\r\n * @component spawn-point\r\n */\r\nAFRAME.registerComponent(\"spawn-point\", {\r\n  init() {\r\n    this.el.object3D.visible = false;\r\n  }\r\n});\r\n","/* global require AFRAME THREE setTimeout clearTimeout */\r\nimport { addMedia } from \"../utils/media-utils\";\r\nimport { waitForEvent } from \"../utils/async-utils\";\r\nimport { ObjectContentOrigins } from \"../object-types\";\r\nimport { paths } from \"../systems/userinput/paths\";\r\nimport { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\r\n\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nfunction setNonNullVec3Components(target, values) {\r\n  target.set(\r\n    values.x === null ? target.x : values.x,\r\n    values.y === null ? target.y : values.y,\r\n    values.z === null ? target.z : values.z\r\n  );\r\n}\r\n\r\n/**\r\n * Spawns networked objects when grabbed or when a specified event is fired.\r\n * @namespace network\r\n * @component super-spawner\r\n */\r\nAFRAME.registerComponent(\"super-spawner\", {\r\n  schema: {\r\n    /**\r\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\r\n     */\r\n    src: { default: \"\" },\r\n\r\n    /**\r\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\r\n     */\r\n    resolve: { default: false },\r\n\r\n    /**\r\n     * The template to use for this object\r\n     */\r\n    template: { default: \"\" },\r\n\r\n    /**\r\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\r\n     */\r\n    spawnScale: { type: \"vec3\", default: { x: NaN, y: NaN, z: NaN } },\r\n\r\n    /**\r\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\r\n     */\r\n    spawnCooldown: { default: 1 },\r\n\r\n    /**\r\n     * Optional event to listen for to spawn an object on the preferred superHand\r\n     */\r\n    spawnEvent: { type: \"string\" },\r\n\r\n    /**\r\n     * If true, will spawn the object at the cursor and animate it into the hand.\r\n     */\r\n    animateFromCursor: { type: \"boolean\" },\r\n\r\n    mediaOptions: {\r\n      default: {},\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.cooldownTimeout = null;\r\n    this.handPosition = new THREE.Vector3();\r\n\r\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\r\n\r\n    this.sceneEl = this.el.sceneEl;\r\n\r\n    this.tempSpawnHandPosition = new THREE.Vector3();\r\n\r\n    this.handleMediaLoaded = this.handleMediaLoaded.bind(this);\r\n\r\n    this.spawnedMediaScale = null;\r\n\r\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n  },\r\n\r\n  play() {\r\n    this.el.addEventListener(\"media-loaded\", this.handleMediaLoaded);\r\n    if (this.data.spawnEvent) {\r\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\r\n    }\r\n  },\r\n\r\n  pause() {\r\n    this.el.removeEventListener(\"media-loaded\", this.handleMediaLoaded);\r\n    if (this.data.spawnEvent) {\r\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\r\n    }\r\n    if (this.cooldownTimeout) {\r\n      clearTimeout(this.cooldownTimeout);\r\n      this.cooldownTimeout = null;\r\n      this.el.setAttribute(\"visible\", true);\r\n      this.el.classList.add(\"interactable\");\r\n    }\r\n  },\r\n\r\n  handleMediaLoaded(e) {\r\n    const spawnedEntity = e.target;\r\n    this.spawnedMediaScale = spawnedEntity.object3D.scale.clone();\r\n    setNonNullVec3Components(this.spawnedMediaScale, this.data.spawnScale);\r\n\r\n    const boxSize =\r\n      spawnedEntity.components[\"media-image\"] ||\r\n      spawnedEntity.components[\"media-video\"] ||\r\n      spawnedEntity.components[\"media-pdf\"]\r\n        ? 1\r\n        : 0.5;\r\n\r\n    const scaleCoefficient = getScaleCoefficient(boxSize, getBox(spawnedEntity, spawnedEntity.object3D));\r\n    this.spawnedMediaScale.divideScalar(scaleCoefficient);\r\n  },\r\n\r\n  async onSpawnEvent(e) {\r\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\r\n      return;\r\n    }\r\n\r\n    const spawnedEntity = addMedia(\r\n      this.data.src,\r\n      this.data.template,\r\n      ObjectContentOrigins.SPAWNER,\r\n      null,\r\n      this.data.resolve,\r\n      false,\r\n      {\r\n        x: this.data.spawnScale.x === null ? 1 : this.data.spawnScale.x,\r\n        y: this.data.spawnScale.y === null ? 1 : this.data.spawnScale.y,\r\n        z: this.data.spawnScale.z === null ? 1 : this.data.spawnScale.z\r\n      }\r\n    ).entity;\r\n\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    const cursor = (e.detail && e.detail.object3D) || interaction.options.rightRemote.entity.object3D;\r\n\r\n    const left = cursor.el.id.indexOf(\"right\") === -1;\r\n    const hand = left ? interaction.options.leftHand.entity.object3D : interaction.options.rightHand.entity.object3D;\r\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\r\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\r\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n    this.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\r\n\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const willAnimateFromCursor =\r\n      this.data.animateFromCursor &&\r\n      (userinput.get(paths.actions.rightHand.matrix) || userinput.get(paths.actions.leftHand.matrix));\r\n    if (!willAnimateFromCursor) {\r\n      if (left) {\r\n        interaction.state.leftRemote.held = spawnedEntity;\r\n        interaction.state.leftRemote.spawning = true;\r\n      } else {\r\n        interaction.state.rightRemote.held = spawnedEntity;\r\n        interaction.state.rightRemote.spawning = true;\r\n      }\r\n    }\r\n    this.activateCooldown();\r\n    await waitForEvent(\"model-loaded\", spawnedEntity);\r\n\r\n    cursor.getWorldPosition(spawnedEntity.object3D.position);\r\n    cursor.getWorldQuaternion(spawnedEntity.object3D.quaternion);\r\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n    if (willAnimateFromCursor) {\r\n      hand.getWorldPosition(this.handPosition);\r\n      spawnedEntity.setAttribute(\"animation__spawn-at-cursor\", {\r\n        property: \"position\",\r\n        delay: 500,\r\n        dur: 1500,\r\n        from: {\r\n          x: spawnedEntity.object3D.position.x,\r\n          y: spawnedEntity.object3D.position.y,\r\n          z: spawnedEntity.object3D.position.z\r\n        },\r\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\r\n        easing: \"easeInOutBack\"\r\n      });\r\n    } else {\r\n      if (left) {\r\n        interaction.state.leftRemote.spawning = false;\r\n      } else {\r\n        interaction.state.rightRemote.spawning = false;\r\n      }\r\n    }\r\n\r\n    this.physicsSystem.resetDynamicBody(spawnedEntity.components[\"body-helper\"].uuid);\r\n\r\n    spawnedEntity.addEventListener(\r\n      \"media-loaded\",\r\n      () => {\r\n        this.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\r\n      },\r\n      { once: true }\r\n    );\r\n  },\r\n\r\n  activateCooldown() {\r\n    if (this.data.spawnCooldown > 0) {\r\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\r\n\r\n      this.el.setAttribute(\"visible\", false);\r\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n      this.el.classList.remove(\"interactable\");\r\n      this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.NONE });\r\n      this.cooldownTimeout = setTimeout(() => {\r\n        this.el.setAttribute(\"visible\", true);\r\n        this.el.classList.add(\"interactable\");\r\n        this.el.setAttribute(\"body-helper\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\r\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\r\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\r\n          property: \"scale\",\r\n          delay: 50,\r\n          dur: 350,\r\n          from: { x: 0.001, y: 0.001, z: 0.001 },\r\n          to: { x: sx, y: sy, z: sz },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n\r\n        this.cooldownTimeout = null;\r\n      }, this.data.spawnCooldown * 1000);\r\n    }\r\n  }\r\n});\r\n","import { Layers } from \"./layers\";\r\nimport \"../vendor/Water\";\r\nimport waterNormalMap from \"../assets/waternormals.jpg\";\r\n\r\n/**\r\n * @author jbouny / https://github.com/jbouny\r\n *\r\n * Work based on :\r\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\r\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\r\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\r\n */\r\n\r\nfunction MobileWater(geometry, options) {\r\n  THREE.Mesh.call(this, geometry);\r\n\r\n  const scope = this;\r\n\r\n  options = options || {};\r\n\r\n  const time = options.time !== undefined ? options.time : 0.0;\r\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\r\n  const sunDirection =\r\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\r\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\r\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\r\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\r\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\r\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\r\n  const fog = options.fog !== undefined ? options.fog : false;\r\n\r\n  const mirrorShader = {\r\n    uniforms: THREE.UniformsUtils.merge([\r\n      THREE.UniformsLib[\"lights\"],\r\n      {\r\n        normalSampler: { value: null },\r\n        time: { value: 0.0 },\r\n        size: { value: 1.0 },\r\n        distortionScale: { value: 20.0 },\r\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\r\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\r\n        eye: { value: new THREE.Vector3() },\r\n        waterColor: { value: new THREE.Color(0x555555) }\r\n      }\r\n    ]),\r\n\r\n    vertexShader: `\r\n      uniform float time;\r\n      varying vec4 worldPosition;\r\n\r\n      void main() {\r\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\r\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\r\n      \tgl_Position = projectionMatrix * mvPosition;\r\n\r\n      }\r\n    `,\r\n\r\n    fragmentShader: `\r\n      uniform float time;\r\n      uniform float size;\r\n      uniform float distortionScale;\r\n      uniform sampler2D normalSampler;\r\n      uniform vec3 sunColor;\r\n      uniform vec3 sunDirection;\r\n      uniform vec3 eye;\r\n      uniform vec3 waterColor;\r\n\r\n      varying vec4 worldPosition;\r\n\r\n      vec4 getNoise( vec2 uv ) {\r\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\r\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\r\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\r\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\r\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\r\n      \t\ttexture2D( normalSampler, uv1 ) +\r\n      \t\ttexture2D( normalSampler, uv2 ) +\r\n      \t\ttexture2D( normalSampler, uv3 );\r\n      \treturn noise * 0.5 - 1.0;\r\n      }\r\n\r\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\r\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\r\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\r\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\r\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\r\n      }\r\n\r\n      ${THREE.ShaderChunk[\"common\"]}\r\n      ${THREE.ShaderChunk[\"packing\"]}\r\n      ${THREE.ShaderChunk[\"bsdfs\"]}\r\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\r\n\r\n      void main() {\r\n      \tvec4 noise = getNoise( worldPosition.xz * size );\r\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\r\n\r\n      \tvec3 diffuseLight = vec3(0.0);\r\n      \tvec3 specularLight = vec3(0.0);\r\n\r\n      \tvec3 worldToEye = eye-worldPosition.xyz;\r\n      \tvec3 eyeDirection = normalize( worldToEye );\r\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\r\n\r\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\r\n      \tfloat rf0 = 0.3;\r\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\r\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\r\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\r\n      \tvec3 outgoingLight = albedo;\r\n      \tgl_FragColor = vec4( outgoingLight, 1 );\r\n      }\r\n    `\r\n  };\r\n\r\n  const material = new THREE.ShaderMaterial({\r\n    fragmentShader: mirrorShader.fragmentShader,\r\n    vertexShader: mirrorShader.vertexShader,\r\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\r\n    transparent: false,\r\n    lights: true,\r\n    side: side,\r\n    fog: fog\r\n  });\r\n\r\n  material.uniforms.time.value = time;\r\n  material.uniforms.normalSampler.value = normalSampler;\r\n  material.uniforms.sunColor.value = sunColor;\r\n  material.uniforms.waterColor.value = waterColor;\r\n  material.uniforms.sunDirection.value = sunDirection;\r\n  material.uniforms.distortionScale.value = distortionScale;\r\n\r\n  material.uniforms.eye.value = eye;\r\n\r\n  scope.material = material;\r\n}\r\n\r\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\r\nMobileWater.prototype.constructor = THREE.Water;\r\n\r\nasync function loadWaterNormals(url) {\r\n  const texture = await new Promise((resolve, reject) =>\r\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\r\n  );\r\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\r\n  texture.needsUpdate = true;\r\n  return texture;\r\n}\r\n\r\nAFRAME.registerComponent(\"water\", {\r\n  schema: {\r\n    waterColor: { type: \"color\", default: \"#001e0f\" },\r\n    distortionScale: { type: \"number\", default: 3.7 },\r\n    sunColor: { type: \"color\", default: \"#ffffff\" },\r\n    inclination: { type: \"number\", default: 0 },\r\n    azimuth: { type: \"number\", default: 0 },\r\n    distance: { type: \"number\", default: 1 },\r\n    speed: { type: \"number\", default: 0.1 },\r\n    forceMobile: { type: \"boolean\", default: false }\r\n  },\r\n  init() {\r\n    const waterMesh = this.el.getObject3D(\"mesh\");\r\n    const waterGeometry = waterMesh.geometry;\r\n\r\n    // Render THREE.Water shader instead of THREE.Mesh\r\n    waterMesh.visible = false;\r\n\r\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\r\n      const waterConfig = {\r\n        textureWidth: 512,\r\n        textureHeight: 512,\r\n        waterNormals: waterNormals,\r\n        sunDirection: this.data.sunDirection,\r\n        sunColor: new THREE.Color(this.data.sunColor),\r\n        waterColor: new THREE.Color(this.data.waterColor),\r\n        distortionScale: this.data.distortionScale,\r\n        fog: false\r\n      };\r\n\r\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\r\n        this.water = new MobileWater(waterGeometry, waterConfig);\r\n      } else {\r\n        this.water = new THREE.Water(waterGeometry, waterConfig);\r\n        this.water.mirrorCamera.layers.set(Layers.reflection);\r\n      }\r\n\r\n      this.el.setObject3D(\"water\", this.water);\r\n    });\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.forceMobile !== oldData.forceMobile) {\r\n      this.el.removeObject3D(\"water\");\r\n      this.init();\r\n      return;\r\n    }\r\n\r\n    if (!this.water) {\r\n      return;\r\n    }\r\n\r\n    const uniforms = this.water.material.uniforms;\r\n\r\n    if (this.data.waterColor !== oldData.waterColor) {\r\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\r\n    }\r\n\r\n    if (this.data.distortionScale !== oldData.distortionScale) {\r\n      uniforms.distortionScale.value = this.data.distortionScale;\r\n    }\r\n\r\n    if (this.data.sunColor !== oldData.sunColor) {\r\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\r\n    }\r\n\r\n    if (\r\n      this.data.inclination !== oldData.inclination ||\r\n      this.data.azimuth !== oldData.azimuth ||\r\n      this.data.distance !== oldData.distance\r\n    ) {\r\n      const theta = Math.PI * (this.data.inclination - 0.5);\r\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\r\n\r\n      const distance = this.data.distance;\r\n\r\n      const x = distance * Math.cos(phi);\r\n      const y = distance * Math.sin(phi) * Math.sin(theta);\r\n      const z = distance * Math.sin(phi) * Math.cos(theta);\r\n\r\n      uniforms.sunDirection.value.set(x, y, z);\r\n    }\r\n  },\r\n\r\n  tick(time) {\r\n    if (this.water) {\r\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"water\");\r\n    const waterMesh = this.el.getObject3D(\"mesh\");\r\n    waterMesh.visible = true;\r\n  }\r\n});\r\n","import { SimplexNoise } from \"three/examples/jsm/math/SimplexNoise\";\r\nimport waterNormalsUrl from \"../assets/waternormals.jpg\";\r\n\r\nconst {\r\n  Mesh,\r\n  PlaneBufferGeometry,\r\n  MeshStandardMaterial,\r\n  MeshPhongMaterial,\r\n  Vector2,\r\n  TextureLoader,\r\n  RepeatWrapping\r\n} = THREE;\r\n\r\n/**\r\n * SimpleWater\r\n * Keep in sync with Spoke's SimpleWater class\r\n */\r\n\r\n/**\r\n * Adapted dynamic geometry code from: https://github.com/ditzel/UnityOceanWavesAndShip\r\n */\r\n\r\nclass Octave {\r\n  constructor(speed = new Vector2(1, 1), scale = new Vector2(1, 1), height = 0.0025, alternate = true) {\r\n    this.speed = speed;\r\n    this.scale = scale;\r\n    this.height = height;\r\n    this.alternate = alternate;\r\n  }\r\n}\r\nexport default class SimpleWater extends Mesh {\r\n  constructor(normalMap, resolution = 24, lowQuality = false) {\r\n    const geometry = new PlaneBufferGeometry(10, 10, resolution, resolution);\r\n    geometry.rotateX(-Math.PI / 2);\r\n\r\n    const waterUniforms = {\r\n      ripplesSpeed: { value: 0.25 },\r\n      ripplesScale: { value: 1 },\r\n      time: { value: 0 }\r\n    };\r\n\r\n    const materialClass = lowQuality ? MeshPhongMaterial : MeshStandardMaterial;\r\n\r\n    normalMap.wrapS = normalMap.wrapT = RepeatWrapping;\r\n\r\n    const material = new materialClass({ color: 0x0054df, normalMap });\r\n    material.name = \"SimpleWaterMaterial\";\r\n\r\n    material.onBeforeCompile = shader => {\r\n      Object.assign(shader.uniforms, waterUniforms);\r\n\r\n      shader.vertexShader = shader.vertexShader.replace(\r\n        \"#include <fog_pars_vertex>\",\r\n        `\r\n        #include <fog_pars_vertex>\r\n        varying vec3 vWPosition;\r\n      `\r\n      );\r\n\r\n      shader.vertexShader = shader.vertexShader.replace(\r\n        \"#include <fog_vertex>\",\r\n        `\r\n        #include <fog_vertex>\r\n        vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;\r\n      `\r\n      );\r\n\r\n      // getNoise function from https://github.com/mrdoob/three.js/blob/dev/examples/jsm/objects/Water.js\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        \"#include <normalmap_pars_fragment>\",\r\n        `\r\n        #include <normalmap_pars_fragment>\r\n\r\n        uniform float time;\r\n        uniform float ripplesSpeed;\r\n        uniform float ripplesScale;\r\n      \r\n        varying vec3 vWPosition;\r\n      \r\n        vec4 getNoise(vec2 uv){\r\n          float timeOffset = time * ripplesSpeed;\r\n          uv = (uv - 0.5) * (1.0 / ripplesScale);\r\n          vec2 uv0 = (uv/103.0)+vec2(timeOffset/17.0, timeOffset/29.0);\r\n          vec2 uv1 = uv/107.0-vec2(timeOffset/-19.0, timeOffset/31.0);\r\n          vec2 uv2 = uv/vec2(897.0, 983.0)+vec2(timeOffset/101.0, timeOffset/97.0);\r\n          vec2 uv3 = uv/vec2(991.0, 877.0)-vec2(timeOffset/109.0, timeOffset/-113.0);\r\n          vec4 noise = (texture2D(normalMap, uv0)) +\r\n                       (texture2D(normalMap, uv1)) +\r\n                       (texture2D(normalMap, uv2)) +\r\n                       (texture2D(normalMap, uv3));\r\n          return noise / 4.0;\r\n        }\r\n      `\r\n      );\r\n\r\n      // https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl.js#L20\r\n      shader.fragmentShader = shader.fragmentShader.replace(\r\n        \"#include <normal_fragment_maps>\",\r\n        `\r\n          // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\r\n\r\n          vec3 eye_pos = -vViewPosition;\r\n          vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\r\n          vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\r\n          vec2 st0 = dFdx( vUv.st );\r\n          vec2 st1 = dFdy( vUv.st );\r\n\r\n          float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\r\n\r\n          vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\r\n          vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\r\n          vec3 N = normalize( normal );\r\n          mat3 tsn = mat3( S, T, N );\r\n\r\n          vec3 mapN = getNoise(vWPosition.xz).xyz * 2.0 - 1.0;\r\n\r\n          mapN.xy *= normalScale;\r\n          mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\r\n          normal = normalize( tsn * mapN );\r\n        `\r\n      );\r\n    };\r\n\r\n    super(geometry, material);\r\n\r\n    this.lowQuality = lowQuality;\r\n    this.waterUniforms = waterUniforms;\r\n\r\n    if (lowQuality) {\r\n      this.material.specular.set(0xffffff);\r\n    } else {\r\n      this.receiveShadow = true;\r\n    }\r\n\r\n    this.geometry.attributes.position.dynamic = true;\r\n\r\n    this.resolution = resolution;\r\n    this.octaves = [\r\n      new Octave(new Vector2(0.5, 0.5), new Vector2(1, 1), 0.01, true),\r\n      new Octave(new Vector2(0.05, 6), new Vector2(1, 20), 0.1, false)\r\n    ];\r\n\r\n    this.simplex = new SimplexNoise();\r\n  }\r\n\r\n  get opacity() {\r\n    return this.material.opacity;\r\n  }\r\n\r\n  set opacity(value) {\r\n    this.material.opacity = value;\r\n\r\n    if (value !== 1) {\r\n      this.material.transparent = true;\r\n    }\r\n  }\r\n\r\n  get color() {\r\n    return this.material.color;\r\n  }\r\n\r\n  get tideHeight() {\r\n    return this.octaves[0].height;\r\n  }\r\n\r\n  get tideScale() {\r\n    return this.octaves[0].scale;\r\n  }\r\n\r\n  get tideSpeed() {\r\n    return this.octaves[0].speed;\r\n  }\r\n\r\n  set tideHeight(value) {\r\n    this.octaves[0].height = value;\r\n  }\r\n\r\n  get waveHeight() {\r\n    return this.octaves[1].height;\r\n  }\r\n\r\n  set waveHeight(value) {\r\n    this.octaves[1].height = value;\r\n  }\r\n\r\n  get waveScale() {\r\n    return this.octaves[1].scale;\r\n  }\r\n\r\n  get waveSpeed() {\r\n    return this.octaves[1].speed;\r\n  }\r\n\r\n  set ripplesSpeed(value) {\r\n    this.waterUniforms.ripplesSpeed.value = value;\r\n  }\r\n\r\n  get ripplesSpeed() {\r\n    return this.waterUniforms.ripplesSpeed.value;\r\n  }\r\n\r\n  set ripplesScale(value) {\r\n    this.waterUniforms.ripplesScale.value = value;\r\n  }\r\n\r\n  get ripplesScale() {\r\n    return this.waterUniforms.ripplesScale.value;\r\n  }\r\n\r\n  update(time) {\r\n    const positionAttribute = this.geometry.attributes.position;\r\n\r\n    for (let x = 0; x <= this.resolution; x++) {\r\n      for (let z = 0; z <= this.resolution; z++) {\r\n        let y = 0;\r\n\r\n        for (let o = 0; o < this.octaves.length; o++) {\r\n          const octave = this.octaves[o];\r\n\r\n          if (octave.alternate) {\r\n            const noise = this.simplex.noise(\r\n              (x * octave.scale.x) / this.resolution,\r\n              (z * octave.scale.y) / this.resolution\r\n            );\r\n            y += Math.cos(noise + octave.speed.length() * time) * octave.height;\r\n          } else {\r\n            const noise =\r\n              this.simplex.noise(\r\n                (x * octave.scale.x + time * octave.speed.x) / this.resolution,\r\n                (z * octave.scale.y + time * octave.speed.y) / this.resolution\r\n              ) - 0.5;\r\n            y += noise * octave.height;\r\n          }\r\n        }\r\n\r\n        positionAttribute.setY(x * (this.resolution + 1) + z, y);\r\n      }\r\n    }\r\n\r\n    this.geometry.computeVertexNormals();\r\n    positionAttribute.needsUpdate = true;\r\n    this.waterUniforms.time.value = time;\r\n  }\r\n\r\n  clone(recursive) {\r\n    return new SimpleWater(this.material.normalMap, this.resolution, this.lowQuality).copy(this, recursive);\r\n  }\r\n\r\n  copy(source, recursive = true) {\r\n    super.copy(source, recursive);\r\n\r\n    this.opacity = source.opacity;\r\n    this.color.copy(source.color);\r\n    this.tideHeight = source.tideHeight;\r\n    this.tideScale.copy(source.tideScale);\r\n    this.tideSpeed.copy(source.tideSpeed);\r\n    this.waveHeight = source.waveHeight;\r\n    this.waveScale.copy(source.waveScale);\r\n    this.waveSpeed.copy(source.waveSpeed);\r\n    this.ripplesSpeed = source.ripplesSpeed;\r\n    this.ripplesScale = source.ripplesScale;\r\n\r\n    return this;\r\n  }\r\n}\r\n\r\nfunction vec2Equals(a, b) {\r\n  return a && b && a.x === b.x && a.y === b.y;\r\n}\r\n\r\nlet waterNormalMap = null;\r\n\r\nAFRAME.registerComponent(\"simple-water\", {\r\n  schema: {\r\n    opacity: { type: \"number\", default: 1 },\r\n    color: { type: \"color\" },\r\n    tideHeight: { type: \"number\", default: 0.01 },\r\n    tideScale: { type: \"vec2\", default: { x: 1, y: 1 } },\r\n    tideSpeed: { type: \"vec2\", default: { x: 0.5, y: 0.5 } },\r\n    waveHeight: { type: \"number\", default: 0.1 },\r\n    waveScale: { type: \"vec2\", default: { x: 1, y: 20 } },\r\n    waveSpeed: { type: \"vec2\", default: { x: 0.05, y: 6 } },\r\n    ripplesScale: { type: \"number\", default: 1 },\r\n    ripplesSpeed: { type: \"number\", default: 0.25 }\r\n  },\r\n\r\n  init() {\r\n    if (!waterNormalMap) {\r\n      waterNormalMap = new TextureLoader().load(waterNormalsUrl);\r\n    }\r\n    this.water = new SimpleWater(waterNormalMap, undefined, window.APP && window.APP.quality === \"low\");\r\n    this.el.setObject3D(\"mesh\", this.water);\r\n  },\r\n\r\n  update(oldData) {\r\n    if (this.data.opacity !== oldData.opacity) {\r\n      this.water.opacity = this.data.opacity;\r\n    }\r\n\r\n    if (this.data.color !== oldData.color) {\r\n      this.water.color.set(this.data.color);\r\n    }\r\n\r\n    if (this.data.tideHeight !== oldData.tideHeight) {\r\n      this.water.tideHeight = this.data.tideHeight;\r\n    }\r\n\r\n    if (!vec2Equals(this.data.tideScale, oldData.tideScale)) {\r\n      this.water.tideScale.copy(this.data.tideScale);\r\n    }\r\n\r\n    if (!vec2Equals(this.data.tideSpeed, oldData.tideSpeed)) {\r\n      this.water.tideSpeed.copy(this.data.tideSpeed);\r\n    }\r\n\r\n    if (this.data.waveHeight !== oldData.waveHeight) {\r\n      this.water.waveHeight = this.data.waveHeight;\r\n    }\r\n\r\n    if (!vec2Equals(this.data.waveScale, oldData.waveScale)) {\r\n      this.water.waveScale.copy(this.data.waveScale);\r\n    }\r\n\r\n    if (!vec2Equals(this.data.waveSpeed, oldData.waveSpeed)) {\r\n      this.water.waveSpeed.copy(this.data.waveSpeed);\r\n    }\r\n\r\n    if (this.data.ripplesScale !== oldData.ripplesScale) {\r\n      this.water.ripplesScale = this.data.ripplesScale;\r\n    }\r\n\r\n    if (this.data.ripplesSpeed !== oldData.ripplesSpeed) {\r\n      this.water.ripplesSpeed = this.data.ripplesSpeed;\r\n    }\r\n  },\r\n\r\n  tick(time) {\r\n    this.water.update(time / 1000);\r\n  },\r\n\r\n  remove() {\r\n    this.el.removeObject3D(\"mesh\");\r\n  }\r\n});\r\n","import { ParticleEmitter } from \"@mozillareality/three-particle-emitter\";\r\nimport { textureLoader } from \"../utils/media-utils\";\r\nimport { resolveUrl } from \"../utils/media-utils\";\r\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\r\nimport defaultSrcImage from \"../assets/images/warning_icon.png\";\r\n\r\nconst defaultSrcUrl = new URL(defaultSrcImage, window.location.href).href;\r\n\r\nAFRAME.registerComponent(\"particle-emitter\", {\r\n  schema: {\r\n    resolve: { type: \"boolean\", default: true },\r\n    src: { type: \"string\", default: defaultSrcUrl },\r\n    startColor: { type: \"color\" },\r\n    middleColor: { type: \"color\" },\r\n    endColor: { type: \"color\" },\r\n    startOpacity: { type: \"number\", default: 1 },\r\n    middleOpacity: { type: \"number\", default: 1 },\r\n    endOpacity: { type: \"number\", default: 1 },\r\n    colorCurve: { type: \"string\", default: \"linear\" },\r\n    sizeCurve: { type: \"string\", default: \"linear\" },\r\n    startSize: { type: \"number\", default: 1 },\r\n    endSize: { type: \"number\", default: 1 },\r\n    sizeRandomness: { type: \"number\" },\r\n    ageRandomness: { type: \"number\" },\r\n    lifetime: { type: \"number\", default: 1 },\r\n    lifetimeRandomness: { type: \"number\" },\r\n    particleCount: { type: \"number\", default: 10 },\r\n    startVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\r\n    endVelocity: { type: \"vec3\", default: { x: 0, y: 0, z: 1 } },\r\n    velocityCurve: { type: \"string\", default: \"linear\" },\r\n    angularVelocity: { type: \"number\" }\r\n  },\r\n\r\n  init() {\r\n    this.particleEmitter = new ParticleEmitter(null);\r\n    this.particleEmitter.visible = false;\r\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\r\n    this.updateParticles = false;\r\n    if (this.data.src === defaultSrcUrl) {\r\n      this.data.resolve = false;\r\n    }\r\n  },\r\n\r\n  async setTexture(src, resolve) {\r\n    let accessibleUrl = src;\r\n\r\n    if (resolve) {\r\n      const result = await resolveUrl(src);\r\n      let canonicalUrl = result.origin;\r\n\r\n      // handle protocol relative urls\r\n      if (canonicalUrl.startsWith(\"//\")) {\r\n        canonicalUrl = location.protocol + canonicalUrl;\r\n      }\r\n\r\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\r\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\r\n    }\r\n\r\n    const texture = new THREE.Texture();\r\n\r\n    await textureLoader.loadTextureAsync(texture, accessibleUrl);\r\n\r\n    // Guard against src changing while request was in flight\r\n    if (this.data.src !== src) {\r\n      return;\r\n    }\r\n\r\n    this.particleEmitter.material.uniforms.map.value = texture;\r\n    this.particleEmitter.visible = true;\r\n    this.updateParticles = true;\r\n  },\r\n\r\n  update(prevData) {\r\n    const data = this.data;\r\n    const particleEmitter = this.particleEmitter;\r\n\r\n    if (prevData.src !== data.src) {\r\n      this.setTexture(data.src, data.resolve).catch(console.error);\r\n    }\r\n\r\n    if (\r\n      prevData.startColor !== data.startColor ||\r\n      prevData.startSize !== data.startSize ||\r\n      prevData.sizeRandomness !== data.sizeRandomness ||\r\n      prevData.ageRandomness !== data.ageRandomness ||\r\n      prevData.lifetime !== data.lifetime ||\r\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\r\n      prevData.particleCount !== data.particleCount\r\n    ) {\r\n      this.updateParticles = true;\r\n    }\r\n\r\n    particleEmitter.startColor.set(data.startColor);\r\n    particleEmitter.middleColor.set(data.middleColor);\r\n    particleEmitter.endColor.set(data.endColor);\r\n    particleEmitter.startOpacity = data.startOpacity;\r\n    particleEmitter.middleOpacity = data.middleOpacity;\r\n    particleEmitter.endOpacity = data.endOpacity;\r\n    particleEmitter.colorCurve = data.colorCurve;\r\n    particleEmitter.sizeCurve = data.sizeCurve;\r\n    particleEmitter.startSize = data.startSize;\r\n    particleEmitter.endSize = data.endSize;\r\n    particleEmitter.sizeRandomness = data.sizeRandomness;\r\n    particleEmitter.ageRandomness = data.ageRandomness;\r\n    particleEmitter.lifetime = data.lifetime;\r\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\r\n    particleEmitter.particleCount = data.particleCount;\r\n    particleEmitter.startVelocity.copy(data.startVelocity);\r\n    particleEmitter.endVelocity.copy(data.endVelocity);\r\n    particleEmitter.velocityCurve = data.velocityCurve;\r\n    particleEmitter.angularVelocity = data.angularVelocity;\r\n  },\r\n\r\n  tick(time, dt) {\r\n    if (this.updateParticles) {\r\n      this.particleEmitter.updateParticles();\r\n      this.updateParticles = false;\r\n    }\r\n\r\n    if (this.particleEmitter.visible) {\r\n      this.particleEmitter.update(dt / 1000);\r\n    }\r\n  }\r\n});\r\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\r\n  const publicComponent = publicComponents[inputComponent];\r\n\r\n  if (!publicComponent) {\r\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\r\n  }\r\n\r\n  const publicProperty = publicComponent.publicProperties[inputProperty];\r\n\r\n  if (!publicProperty) {\r\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\r\n  }\r\n\r\n  return {\r\n    mappedComponent: publicComponent.mappedComponent,\r\n    mappedProperty: publicProperty.mappedProperty,\r\n    getMappedValue: publicProperty.getMappedValue\r\n  };\r\n}\r\n","import \"./components/gltf-model-plus\";\r\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\r\nimport { TYPE, SHAPE, FIT } from \"three-ammo/constants\";\r\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\r\n\r\nfunction registerRootSceneComponent(componentName) {\r\n  AFRAME.GLTFModelPlus.registerComponent(componentName, componentName, (el, componentName, componentData) => {\r\n    const sceneEl = AFRAME.scenes[0];\r\n\r\n    sceneEl.setAttribute(componentName, componentData);\r\n\r\n    sceneEl.addEventListener(\r\n      \"reset_scene\",\r\n      () => {\r\n        sceneEl.removeAttribute(componentName);\r\n      },\r\n      { once: true }\r\n    );\r\n  });\r\n}\r\n\r\nregisterRootSceneComponent(\"fog\");\r\nregisterRootSceneComponent(\"background\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\r\n  el.setAttribute(componentName, \"interactable\");\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\r\n  //TODO: Do not automatically add these components\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n  el.setAttribute(\"hoverable-visuals\", \"\");\r\n  el.setAttribute(componentName, componentData);\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"body-helper\", el => {\r\n  //This is only required for migration of old environments with super-spawners\r\n  //will no longer be needed when spawners are added via Spoke instead.\r\n  el.setAttribute(\"body-helper\", {\r\n    mass: 0,\r\n    type: TYPE.STATIC,\r\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\r\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\r\n  });\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"shape-helper\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\r\n  if (componentData.distance === 0) {\r\n    componentData.decay = 0;\r\n  }\r\n  el.setAttribute(componentName, componentData);\r\n  if (componentData.castShadow) {\r\n    // HACK: component.light isn't set until one frame after setArrtibute\r\n    setTimeout(() => {\r\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\r\n    }, 0);\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"simple-water\", \"simple-water\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"morph-audio-feedback\", \"morph-audio-feedback\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\r\nAFRAME.GLTFModelPlus.registerComponent(\r\n  \"box-collider\",\r\n  \"shape-helper\",\r\n  (() => {\r\n    const euler = new THREE.Euler();\r\n    return (el, componentName, componentData) => {\r\n      const { scale, rotation } = componentData;\r\n      euler.set(rotation.x, rotation.y, rotation.z);\r\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\r\n      el.setAttribute(componentName, {\r\n        type: SHAPE.BOX,\r\n        fit: FIT.MANUAL,\r\n        offset: componentData.position,\r\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\r\n        orientation: { x: orientation.x, y: orientation.y, z: orientation.z, w: orientation.w }\r\n      });\r\n    };\r\n  })()\r\n);\r\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\r\n  if (typeof componentData === \"object\") {\r\n    el.setAttribute(componentName, componentData.visible);\r\n  } else {\r\n    el.setAttribute(componentName, componentData);\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\", el => {\r\n  el.setAttribute(\"waypoint\", {\r\n    canBeSpawnPoint: true,\r\n    canBeOccupied: false,\r\n    canBeClicked: false,\r\n    willDisableMotion: false,\r\n    willDisableTeleporting: false,\r\n    willMaintainWorldUp: true\r\n  });\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\r\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\r\n  const nav = AFRAME.scenes[0].systems.nav;\r\n  const zone = componentData.zone || \"character\";\r\n  let found = false;\r\n  el.object3D.traverse(node => {\r\n    if (node.isMesh && !found) {\r\n      found = true;\r\n      nav.loadMesh(node, zone);\r\n    }\r\n  });\r\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\r\n  // nav-mesh-helper will query for it later.\r\n  el.setAttribute(\"nav-mesh\");\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"waypoint\", \"waypoint\", (el, componentName, componentData, components) => {\r\n  if (componentData.canBeOccupied) {\r\n    el.setAttribute(\"networked\", {\r\n      template: \"#template-waypoint-avatar\",\r\n      attachTemplateToLocal: false,\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: components.networked.id\r\n    });\r\n  }\r\n  el.setAttribute(\"waypoint\", componentData);\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\r\n  if (componentData.id) {\r\n    el.setAttribute(\"networked\", {\r\n      template: \"#interactable-media\",\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: componentData.id\r\n    });\r\n  }\r\n\r\n  const mediaLoaderAttributes = {\r\n    src: componentData.src,\r\n    fitToBox: componentData.contentSubtype ? false : true,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false,\r\n    contentSubtype: componentData.contentSubtype\r\n  };\r\n\r\n  if (componentData.version) {\r\n    mediaLoaderAttributes.version = componentData.version;\r\n  }\r\n\r\n  el.setAttribute(\"media-loader\", mediaLoaderAttributes);\r\n\r\n  if (componentData.pageIndex) {\r\n    el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\r\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\r\n  }\r\n\r\n  if (componentData.paused !== undefined) {\r\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\r\n  }\r\n\r\n  if (componentData.time) {\r\n    el.setAttribute(\"media-video\", { time: componentData.time });\r\n  }\r\n});\r\n\r\nasync function mediaInflator(el, componentName, componentData, components) {\r\n  let isControlled = true;\r\n\r\n  if (components.networked) {\r\n    isControlled = componentData.controls || componentName === \"link\";\r\n\r\n    const hasVolume = componentName === \"video\" || componentName === \"audio\";\r\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\r\n\r\n    el.setAttribute(\"networked\", {\r\n      template: templateName,\r\n      owner: \"scene\",\r\n      persistent: true,\r\n      networkId: components.networked.id\r\n    });\r\n  }\r\n\r\n  const mediaOptions = {};\r\n\r\n  if (componentName === \"video\" || componentName === \"image\") {\r\n    mediaOptions.projection = componentData.projection;\r\n  }\r\n\r\n  if (componentName === \"video\" || componentName === \"audio\") {\r\n    mediaOptions.videoPaused = !componentData.autoPlay;\r\n    mediaOptions.volume = componentData.volume;\r\n    mediaOptions.loop = componentData.loop;\r\n    mediaOptions.audioType = componentData.audioType;\r\n    mediaOptions.hidePlaybackControls = !isControlled;\r\n\r\n    if (componentData.audioType === \"pannernode\") {\r\n      mediaOptions.distanceModel = componentData.distanceModel;\r\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\r\n      mediaOptions.refDistance = componentData.refDistance;\r\n      mediaOptions.maxDistance = componentData.maxDistance;\r\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\r\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\r\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\r\n    }\r\n\r\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\r\n  }\r\n\r\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\r\n\r\n  el.setAttribute(\"media-loader\", {\r\n    src,\r\n    fitToBox: true,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false,\r\n    mediaOptions\r\n  });\r\n}\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\r\nAFRAME.GLTFModelPlus.registerComponent(\"audio\", \"audio\", mediaInflator, (name, property, value) => {\r\n  if (property === \"paused\") {\r\n    return { name: \"video-pause-state\", property, value };\r\n  } else {\r\n    return null;\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\r\n  if (property === \"paused\") {\r\n    return { name: \"video-pause-state\", property, value };\r\n  } else {\r\n    return null;\r\n  }\r\n});\r\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\r\n  el.setAttribute(\"media-loader\", {\r\n    src: componentData.src,\r\n    resolve: true,\r\n    fileIsOwned: true,\r\n    animate: false,\r\n    moveTheParentNotTheMesh: true\r\n  });\r\n  el.setAttribute(\"css-class\", \"interactable\");\r\n  el.setAttribute(\"super-spawner\", {\r\n    src: componentData.src,\r\n    resolve: true,\r\n    template: \"#interactable-media\"\r\n  });\r\n  el.setAttribute(\"hoverable-visuals\", \"\");\r\n  el.setAttribute(\"body-helper\", {\r\n    mass: 0,\r\n    type: TYPE.STATIC,\r\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\r\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\r\n  });\r\n  el.setAttribute(\"is-remote-hover-target\", \"\");\r\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\r\n});\r\n\r\nconst publicComponents = {\r\n  video: {\r\n    mappedComponent: \"video-pause-state\",\r\n    publicProperties: {\r\n      paused: {\r\n        mappedProperty: \"paused\",\r\n        getMappedValue(value) {\r\n          return !!value;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"loop-animation\": {\r\n    mappedComponent: \"loop-animation\",\r\n    publicProperties: {\r\n      paused: {\r\n        mappedProperty: \"paused\",\r\n        getMappedValue(value) {\r\n          return !!value;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\r\n  \"trigger-volume\",\r\n  \"trigger-volume\",\r\n  (el, componentName, componentData, components, indexToEntityMap) => {\r\n    const {\r\n      size,\r\n      target,\r\n      enterComponent,\r\n      enterProperty,\r\n      enterValue,\r\n      leaveComponent,\r\n      leaveProperty,\r\n      leaveValue\r\n    } = componentData;\r\n\r\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\r\n\r\n    try {\r\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\r\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\r\n\r\n      targetEntity = indexToEntityMap[target];\r\n\r\n      if (!targetEntity) {\r\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\r\n      return;\r\n    }\r\n\r\n    // Filter out scope and colliders properties.\r\n    el.setAttribute(\"trigger-volume\", {\r\n      colliders: \"#avatar-pov-node\",\r\n      size,\r\n      target: targetEntity,\r\n      enterComponent: enterComponentMapping.mappedComponent,\r\n      enterProperty: enterComponentMapping.mappedProperty,\r\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\r\n      leaveComponent: leaveComponentMapping.mappedComponent,\r\n      leaveProperty: leaveComponentMapping.mappedProperty,\r\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\r\n    });\r\n  }\r\n);\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\r\n  el.setAttribute(\"shape-helper__heightfield\", {\r\n    type: SHAPE.HEIGHTFIELD,\r\n    margin: 0.01,\r\n    fit: FIT.MANUAL,\r\n    heightfieldDistance: componentData.distance,\r\n    offset: componentData.offset,\r\n    heightfieldData: componentData.data\r\n  });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\r\n  el.setAttribute(\"shape-helper__trimesh\", {\r\n    type: SHAPE.MESH,\r\n    margin: 0.01,\r\n    fit: FIT.ALL,\r\n    includeInvisible: true\r\n  });\r\n});\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"networked-drawing-buffer\", \"networked-drawing-buffer\");\r\n\r\nAFRAME.GLTFModelPlus.registerComponent(\"audio-settings\", \"audio-settings\", (el, _componentName, componentData) => {\r\n  el.sceneEl.systems[\"hubs-systems\"].audioSettingsSystem.updateAudioSettings(componentData);\r\n});\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-text\":\"loader__loading-text__3hkle\",\"loadingText\":\"loader__loading-text__3hkle\"};","module.exports = __webpack_public_path__ + \"assets/images/giphy_logo-e4fe68503ab5d004deb31e43636a0a7c.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_0-902121d77164d8da8f8dd09d7a9ed761.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_1-7d6e0cd0fcf8476aa9773da9bb53e399.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_2-810f2d13cb607c120556d95765b8b21d.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_3-5d247ddca0eccab1da6d29b030181195.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_4-b1e61ff7ce3ac7aa29e92ab3fd5987c5.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_5-1f8e9d84efb84989cd717fc147a80a9d.png\";","module.exports = __webpack_public_path__ + \"assets/images/emojis/emoji_6-bd090b380b4bde4f23a3b10040eb5623.png\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_0-f3f46448f25bc1d8599c39fc43fc3430.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_1-99633c94256b7520f7833921094bedfe.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_2-4531e5b1d197a14e76c8d47894b62db0.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_3-167102458af413f37fc62cd5b201a010.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_4-834ee3738e00e03227ff45809c6f2fe8.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_5-b2763de169ccdb200ec5e8503170079d.glb\";","module.exports = __webpack_public_path__ + \"assets/models/emojis/emoji_6-6df1120c791dabb88d6b1ada0d8f973d.glb\";","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw==\"","module.exports = __webpack_public_path__ + \"assets/images/audio-0205471a2825b8450c63e45f83436997.png\";","module.exports = __webpack_public_path__ + \"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png\";","module.exports = __webpack_public_path__ + \"assets/images/add-owner-c3f352da151b4a5be71defd565720235.png\";","module.exports = __webpack_public_path__ + \"assets/images/remove-owner-02b96ad3a84badda798fde00ac4c2243.png\";","module.exports = \"<svg viewBox=\\\"0 0 70 70\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><mask id=\\\"path-1-inside-1\\\" fill=\\\"currentColor\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M28 17C25.2386 17 23 19.2386 23 22V50C23 52.7614 25.2386 55 28 55H43C45.7614 55 48 52.7614 48 50V22C48 19.2386 45.7614 17 43 17H28ZM45 21H26V46H45V21Z\\\"></path></mask><path d=\\\"M26 21V18H23V21H26ZM45 21H48V18H45V21ZM26 46H23V49H26V46ZM45 46V49H48V46H45ZM26 22C26 20.8954 26.8954 20 28 20V14C23.5817 14 20 17.5817 20 22H26ZM26 50V22H20V50H26ZM28 52C26.8954 52 26 51.1046 26 50H20C20 54.4183 23.5817 58 28 58V52ZM43 52H28V58H43V52ZM45 50C45 51.1046 44.1046 52 43 52V58C47.4183 58 51 54.4183 51 50H45ZM45 22V50H51V22H45ZM43 20C44.1046 20 45 20.8954 45 22H51C51 17.5817 47.4183 14 43 14V20ZM28 20H43V14H28V20ZM26 24H45V18H26V24ZM29 46V21H23V46H29ZM45 43H26V49H45V43ZM42 21V46H48V21H42Z\\\" fill=\\\"currentColor\\\" mask=\\\"url(#path-1-inside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 70 70\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><rect x=\\\"25\\\" y=\\\"52\\\" width=\\\"20\\\" height=\\\"3\\\" fill=\\\"currentColor\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M17 18C15.3431 18 14 19.3431 14 21V49C14 50.6569 15.3431 52 17 52H52C53.6569 52 55 50.6569 55 49V21C55 19.3431 53.6569 18 52 18H17ZM50 24H19V46H50V24Z\\\" fill=\\\"currentColor\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 70 70\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M56.1704 22H16.7123C15.2406 22 14 23.226 14 24.7381V47.2622C14 48.7742 15.2406 50 16.7711 50H27.5496C28.7053 50 29.6958 49.3015 30.112 48.3081L33.2462 40.8289C33.7747 39.5677 35.0324 38.6805 36.5 38.6805C37.9676 38.6805 39.2253 39.5677 39.7538 40.8289L42.888 48.3081C43.3042 49.3015 44.2947 50 45.3916 50H56.1704C57.7594 50 59 48.7742 59 47.2622V24.7381C59 23.226 57.7594 22 56.1704 22ZM26.294 40.9274C23.5369 40.9274 21.3046 38.7226 21.3046 36C21.3046 33.2774 23.5369 31.0729 26.294 31.0729C29.0507 31.0729 31.2785 33.2774 31.2785 36C31.2785 38.7226 29.0459 40.9274 26.294 40.9274ZM46.7086 40.9251C43.9531 40.9251 41.7215 38.7214 41.7215 36C41.7215 33.2789 43.9531 31.0751 46.7086 31.0751C49.4641 31.0751 51.6957 33.2789 51.6957 36C51.6957 38.7214 49.4641 40.9251 46.7086 40.9251Z\\\" fill=\\\"currentColor\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 90 90\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M88.5 45C88.5 69.0244 69.0244 88.5 45 88.5C20.9756 88.5 1.5 69.0244 1.5 45C1.5 20.9756 20.9756 1.5 45 1.5C69.0244 1.5 88.5 20.9756 88.5 45Z\\\" fill=\\\"currentColor\\\" stroke=\\\"white\\\" stroke-width=\\\"3\\\"></path><path opacity=\\\"0.995697\\\" d=\\\"M14 4.5H31C36.2467 4.5 40.5 8.75329 40.5 14C40.5 19.2467 36.2467 23.5 31 23.5H14C8.75329 23.5 4.5 19.2467 4.5 14C4.5 8.75329 8.75329 4.5 14 4.5Z\\\" transform=\\\"translate(22 32)\\\" fill=\\\"currentColor\\\" fill-opacity=\\\"0.01\\\" stroke=\\\"white\\\" stroke-width=\\\"9\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 70 70\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M36.9396 28.0771L36.9407 28.0791L42.6084 23.8706L36.9396 28.0771ZM46.1453 21.2459L46.2056 21.2012C44.9645 13.4303 37.2392 10.5728 32.3743 12.3211C29.6618 13.2959 27.4228 15.8722 27.7725 19.6208C28.5866 19.9334 29.4993 20.3901 30.4405 20.988C29.7485 20.5556 29.02 20.1659 28.2565 19.8237C28.2326 19.8128 28.2068 19.8013 28.1798 19.7896L28.136 19.7706L28.0937 19.7526C27.9853 19.7068 27.8689 19.6597 27.7781 19.623L28.9614 31.0567L28.9592 31.0566L27.7733 19.6278C20.4643 16.8238 13.9753 21.995 13.0476 27.1085C12.5303 29.9594 13.7032 33.2419 17.1044 34.8115C17.1982 34.7357 17.2955 34.6596 17.3959 34.5834C17.2963 34.6596 17.1885 34.7455 17.1049 34.8122L27.5308 39.4958L17.1057 34.8158C11.0378 39.7828 12.272 48.063 16.2093 51.4281C18.4026 53.3028 21.7772 53.8141 24.8267 51.6413C24.8271 51.6437 24.8274 51.646 24.8278 51.6483C26.0717 59.4153 33.7589 62.5507 38.6227 60.8028C41.3351 59.828 43.5405 57.1432 43.1908 53.3947L43.1887 53.3938L42.0629 41.9876C42.8049 42.023 43.5494 42.0128 44.2918 41.9565C43.5693 42.013 42.8273 42.0263 42.0704 41.9884L43.1917 53.3903C50.5007 56.1943 57.0086 51.0182 57.9363 45.9048C58.4531 43.0563 57.261 39.8491 53.8666 38.2781L53.8726 38.2733L53.8813 38.2772C59.9492 33.3103 58.733 25.03 54.7957 21.6649C52.6011 19.7892 49.2551 19.0298 46.2043 21.2065L46.204 21.2049L46.1453 21.2459ZM24.7381 50.8659C24.6885 50.2898 24.6664 49.7171 24.6708 49.1492C24.6627 49.7549 24.6868 50.3301 24.7381 50.8659ZM26.4947 41.3573C26.7594 40.8103 27.0509 40.2765 27.3679 39.7576C27.0437 40.2833 26.7535 40.8179 26.4947 41.3573ZM35.899 47.811C35.2143 46.9425 34.5955 45.9912 34.0836 44.9638L34.0848 44.9629C34.6027 45.966 35.2091 46.9197 35.899 47.811ZM42.77 53.2217L42.8006 53.2352L42.838 53.2515C42.3392 53.0395 41.811 52.7758 41.2672 52.4623C41.7518 52.7362 42.2529 52.9898 42.77 53.2217ZM53.4572 38.5906C52.3548 39.3893 51.1917 40.0449 49.9897 40.5607C51.3569 39.983 52.5339 39.2898 53.4572 38.5906ZM46.1688 26.3694L46.1608 26.4207L46.1521 26.476C46.2432 25.8756 46.3047 25.2674 46.3351 24.6529C46.3103 25.2118 46.2582 25.786 46.1688 26.3694ZM46.2315 21.5027C46.252 21.7142 46.2709 21.9316 46.2875 22.1546C46.2786 22.0527 46.2688 21.9506 46.2582 21.8485C46.2556 21.8247 46.253 21.7961 46.2504 21.7643L46.2478 21.7306L46.243 21.6663L46.2363 21.5711L46.2315 21.5027ZM36.7446 27.7097C36.2049 26.7199 35.5771 25.7805 34.8671 24.9054C35.5604 25.7504 36.1988 26.6857 36.7446 27.7097ZM28.5085 31.0408C27.3591 31.0152 26.205 31.0989 25.0634 31.2945C26.1819 31.0909 27.3412 30.9931 28.5085 31.0408ZM18.1473 34.0527C18.0911 34.0902 18.0351 34.128 17.9792 34.1662C17.9387 34.1939 17.8983 34.2218 17.858 34.2498C17.7852 34.3004 17.7128 34.3516 17.6405 34.4034C17.5975 34.4343 17.5545 34.4654 17.5117 34.4967L17.5087 34.4989C17.7096 34.35 17.9229 34.2008 18.1473 34.0527Z\\\" fill=\\\"url(#paint0_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M28.9603 31.0463L27.7733 19.6074C20.4643 16.8034 13.9753 21.9747 13.0476 27.0881C12.5303 29.939 13.7032 33.2215 17.1044 34.7911C19.5285 32.8327 24.2134 30.6976 28.9603 31.0463Z\\\" fill=\\\"url(#paint1_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M27.532 39.4763L17.1056 34.7954C11.0378 39.7623 12.272 48.0426 16.2093 51.4077C18.4045 53.2839 21.7828 53.7945 24.8343 51.6155C24.3519 48.5236 24.8343 43.6784 27.532 39.4763Z\\\" fill=\\\"url(#paint2_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M34.0831 44.9423L24.8273 51.6222C26.0684 59.3932 33.7578 62.5307 38.6228 60.7824C41.3352 59.8076 43.5405 57.1228 43.1909 53.3743C40.3075 52.2601 36.2428 49.2778 34.0831 44.9423Z\\\" fill=\\\"url(#paint3_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M42.0704 41.968L43.1917 53.3699C50.5007 56.1739 57.0086 50.9978 57.9363 45.8844C58.4536 43.0334 57.259 39.8232 53.8578 38.2536C51.5074 40.1955 47.1197 42.221 42.0704 41.968Z\\\" fill=\\\"url(#paint4_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M43.4933 33.5267L53.8813 38.2568C59.9492 33.2899 58.733 25.0096 54.7957 21.6445C52.6005 19.7683 49.2533 19.0089 46.2018 21.1879C46.3564 22.6597 46.4588 24.4579 46.1687 26.349C45.8099 28.6889 44.997 31.1531 43.4933 33.5267Z\\\" fill=\\\"url(#paint5_radial)\\\"></path><path opacity=\\\"0.65\\\" fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M36.9358 28.0596L46.2056 21.1809C44.9645 13.4099 37.2392 10.5524 32.3742 12.3008C29.6618 13.2755 27.4228 15.8519 27.7725 19.6004C30.6226 20.6949 34.6806 23.5543 36.9358 28.0596Z\\\" fill=\\\"url(#paint6_radial)\\\"></path><defs><radialGradient id=\\\"paint0_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(17.6669 15.2447) rotate(53.2605) scale(49.8783 48.801)\\\"><stop stop-color=\\\"#F5F5F5\\\"></stop><stop offset=\\\"0.412807\\\" stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#DBDBDB\\\"></stop></radialGradient><radialGradient id=\\\"paint1_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(19.3019 36.2829) rotate(-103.017) scale(10.8394 10.8734)\\\"><stop stop-color=\\\"$ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient><radialGradient id=\\\"paint2_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(27.1801 50.5029) rotate(-163.042) scale(10.7545 10.9388)\\\"><stop stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient><radialGradient id=\\\"paint3_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(43.3906 50.7488) rotate(136.694) scale(10.7723 10.8964)\\\"><stop stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient><radialGradient id=\\\"paint4_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(51.6998 36.7682) rotate(76.9667) scale(10.7941 10.8401)\\\"><stop stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient><radialGradient id=\\\"paint5_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(43.7493 22.4711) rotate(17.0544) scale(10.8065 10.917)\\\"><stop stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient><radialGradient id=\\\"paint6_radial\\\" cx=\\\"0\\\" cy=\\\"0\\\" r=\\\"1\\\" gradientUnits=\\\"userSpaceOnUse\\\" gradientTransform=\\\"translate(27.6037 22.3039) rotate(-43.1622) scale(10.8536 10.8674)\\\"><stop stop-color=\\\"#ff3464\\\"></stop><stop offset=\\\"1\\\" stop-color=\\\"#ff3464\\\" stop-opacity=\\\"0.01\\\"></stop></radialGradient></defs></svg>\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar-url-dialog\":\"avatar-url-dialog__avatar-url-dialog__xc0pC\",\"avatarUrlDialog\":\"avatar-url-dialog__avatar-url-dialog__xc0pC\"};","module.exports = __webpack_public_path__ + \"assets/images/link_dialog_header-2a1a39d9110bd6a0faeb67efcd518cb2.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form-frame\":\"feedback-dialog__form-frame__1rMLT\",\"formFrame\":\"feedback-dialog__form-frame__1rMLT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"leave-room\":\"leave-room-dialog__leave-room__2Sd74\",\"leaveRoom\":\"leave-room-dialog__leave-room__2Sd74\"};","module.exports = \"<svg viewBox=\\\"0 0 64 64\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"svg-icon\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M37.681 23.5792C36.9 22.7981 35.6337 22.7981 34.8526 23.5792L28.061 30.3708L33.6796 35.9893L40.4712 29.1977C41.2522 28.4167 41.2522 27.1503 40.4712 26.3693L37.681 23.5792ZM32.1187 37.5501L26.5002 31.9316L6.46454 51.9672C5.68349 52.7483 5.68349 54.0146 6.46454 54.7957L9.25466 57.5858C10.0357 58.3668 11.302 58.3668 12.0831 57.5858L32.1187 37.5501Z\\\" fill=\\\"currentColor\\\"></path><path d=\\\"M27.2783 2.46352C27.4279 2.00287 28.0797 2.00287 28.2293 2.46353L29.9356 7.71476C30.0025 7.92078 30.1945 8.06026 30.4111 8.06026L35.9326 8.06026C36.4169 8.06026 36.6183 8.68006 36.2265 8.96476L31.7595 12.2102C31.5842 12.3375 31.5109 12.5632 31.5779 12.7692L33.2841 18.0205C33.4338 18.4811 32.9065 18.8642 32.5147 18.5795L28.0477 15.334C27.8724 15.2067 27.6352 15.2067 27.4599 15.334L22.9929 18.5795C22.6011 18.8642 22.0738 18.4811 22.2235 18.0205L23.9297 12.7692C23.9967 12.5632 23.9234 12.3375 23.7481 12.2102L19.2811 8.96476C18.8893 8.68006 19.0907 8.06026 19.575 8.06026L25.0965 8.06026C25.3131 8.06026 25.5051 7.92078 25.572 7.71476L27.2783 2.46352Z\\\" fill=\\\"currentColor\\\"></path><path d=\\\"M48.3949 10.6377C48.5445 10.177 49.1962 10.177 49.3459 10.6377L50.2875 13.5355C50.3544 13.7415 50.5464 13.881 50.763 13.881H53.81C54.2943 13.881 54.4957 14.5008 54.1039 14.7855L51.6388 16.5764C51.4636 16.7038 51.3902 16.9295 51.4572 17.1355L52.3987 20.0333C52.5484 20.4939 52.0212 20.877 51.6293 20.5923L49.1643 18.8013C48.989 18.674 48.7517 18.674 48.5765 18.8013L46.1115 20.5923C45.7196 20.877 45.1924 20.4939 45.342 20.0333L46.2836 17.1355C46.3505 16.9295 46.2772 16.7038 46.102 16.5764L43.6369 14.7855C43.2451 14.5008 43.4465 13.881 43.9308 13.881H46.9778C47.1944 13.881 47.3864 13.7415 47.4533 13.5355L48.3949 10.6377Z\\\" fill=\\\"currentColor\\\"></path><path d=\\\"M49.7572 31.0731C49.9069 30.6124 50.5586 30.6124 50.7083 31.0731L51.9557 34.9123C52.0226 35.1183 52.2146 35.2577 52.4312 35.2577H56.468C56.9524 35.2577 57.1537 35.8776 56.7619 36.1623L53.4961 38.535C53.3208 38.6623 53.2475 38.888 53.3144 39.094L54.5619 42.9332C54.7116 43.3939 54.1843 43.7769 53.7925 43.4922L50.5266 41.1195C50.3514 40.9922 50.1141 40.9922 49.9389 41.1195L46.6731 43.4922C46.2812 43.7769 45.754 43.3939 45.9036 42.9332L47.1511 39.094C47.218 38.888 47.1447 38.6623 46.9694 38.535L43.7036 36.1623C43.3118 35.8776 43.5131 35.2577 43.9975 35.2577H48.0343C48.2509 35.2577 48.4429 35.1183 48.5098 34.9123L49.7572 31.0731Z\\\" fill=\\\"currentColor\\\"></path></svg>\"","module.exports = \"<svg id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 245 240\\\"><style>.st0{fill:currentColor;}</style><path class=\\\"st0\\\" d=\\\"M104.4 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1zM140.9 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1s-4.5-11.1-10.2-11.1z\\\"></path><path class=\\\"st0\\\" d=\\\"M189.5 20h-134C44.2 20 35 29.2 35 40.6v135.2c0 11.4 9.2 20.6 20.5 20.6h113.4l-5.3-18.5 12.8 11.9 12.1 11.2 21.5 19V40.6c0-11.4-9.2-20.6-20.5-20.6zm-38.6 130.6s-3.6-4.3-6.6-8.1c13.1-3.7 18.1-11.9 18.1-11.9-4.1 2.7-8 4.6-11.5 5.9-5 2.1-9.8 3.5-14.5 4.3-9.6 1.8-18.4 1.3-25.9-.1-5.7-1.1-10.6-2.7-14.7-4.3-2.3-.9-4.8-2-7.3-3.4-.3-.2-.6-.3-.9-.5-.2-.1-.3-.2-.4-.3-1.8-1-2.8-1.7-2.8-1.7s4.8 8 17.5 11.8c-3 3.8-6.7 8.3-6.7 8.3-22.1-.7-30.5-15.2-30.5-15.2 0-32.2 14.4-58.3 14.4-58.3 14.4-10.8 28.1-10.5 28.1-10.5l1 1.2c-18 5.2-26.3 13.1-26.3 13.1s2.2-1.2 5.9-2.9c10.7-4.7 19.2-6 22.7-6.3.6-.1 1.1-.2 1.7-.2 6.1-.8 13-1 20.2-.2 9.5 1.1 19.7 3.9 30.1 9.6 0 0-7.9-7.5-24.9-12.7l1.4-1.6s13.7-.3 28.1 10.5c0 0 14.4 26.1 14.4 58.3 0 0-8.5 14.5-30.6 15.2z\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 32 32\\\" fill=\\\"currentColor\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"svg-icon\\\"><g id=\\\"device icon\\\"><path id=\\\"Vector 2\\\" d=\\\"M37.5 12C39.2921 12.2907 42.9409 13.0468 43.9308 13.5486C43.5236 1.76734 37.0468 -0.180441 33.5 2C37.7222 3.12137 37.6018 9.45614 37.5 12Z\\\" fill=\\\"#C4C4C4\\\"></path><path id=\\\"Vector 2.1\\\" d=\\\"M37.5 12C39.2921 12.2907 42.9409 13.0468 43.9308 13.5486C43.5236 1.76734 37.0468 -0.180441 33.5 2C37.7222 3.12137 37.6018 9.45614 37.5 12Z\\\" fill=\\\"#EFEFEF\\\"></path><g id=\\\"Subtract\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M27.5209 16.7286C28.8705 16.9007 30.167 16.1431 30.6795 14.8828C31.2166 13.5623 31.744 12.3973 32.2569 11.3735C33.4626 11.4107 34.5557 11.45 35.5 11.5C40.6072 11.7706 43.9609 13.2812 46.0424 15.3205C44.6124 15.9529 42.8928 16.8012 41.241 17.6476C39.5412 18.5184 37.8927 19.3977 36.6705 20.0585C36.059 20.3892 35.5532 20.6656 35.2001 20.8596C35.0234 20.9566 34.8849 21.033 34.7903 21.0853L34.644 21.1663C34.1086 21.4638 33.8079 22.057 33.8844 22.6648L33.8935 31.1305C33.9531 31.6039 34.2344 32.0208 34.6512 32.2532C35.0731 32.4938 35.5692 32.4314 36.0506 32.2866L36.1806 32.2269C36.294 32.1746 36.4598 32.098 36.6704 32C36.9037 31.8914 37.1922 31.7565 37.5258 31.5992C37.7946 31.4724 38.0927 31.3311 38.4147 31.1773L38.6575 31.0614C40.1664 30.3413 42.8905 29.0412 44.7287 28.0867C45.9328 27.4615 47.1537 26.8042 48.2714 26.1612C47.8862 27.1642 47.3632 28.0057 46.77 28.5856L29.5 38C28.0825 36.957 28.5674 36.3965 29.432 35.3968C30.97 33.6185 33.7096 30.4509 29.0818 20.7075C23.4626 16.2822 10.8481 16.1996 5.46832 16.1644C3.72919 16.153 2.74615 16.1466 3 16C4.71545 15.0093 15.9421 11.8416 19.6582 10.9238C19.5714 11.1113 19.4879 11.2913 19.4076 11.463C19.3668 11.5502 19.3269 11.6352 19.2878 11.7179C18.8773 12.5863 18.9074 13.5989 19.369 14.4414C19.8304 15.2838 20.6675 15.8543 21.6204 15.9759L27.5209 16.7286Z\\\" fill=\\\"currentColor\\\"></path><path d=\\\"M30.6795 14.8828L30.2163 14.6945L30.2163 14.6945L30.6795 14.8828ZM27.5209 16.7286L27.5842 16.2326L27.5842 16.2326L27.5209 16.7286ZM32.2569 11.3735L32.2723 10.8738L31.953 10.8639L31.8099 11.1496L32.2569 11.3735ZM35.5 11.5L35.5265 11.0007L35.5265 11.0007L35.5 11.5ZM46.0424 15.3205L46.2447 15.7778L46.9192 15.4795L46.3923 14.9633L46.0424 15.3205ZM41.241 17.6476L41.469 18.0925L41.469 18.0925L41.241 17.6476ZM36.6705 20.0585L36.4327 19.6187L36.4327 19.6187L36.6705 20.0585ZM35.2001 20.8596L35.4407 21.2979L35.4408 21.2978L35.2001 20.8596ZM34.7903 21.0853L34.5485 20.6477L34.548 20.6479L34.7903 21.0853ZM34.644 21.1663L34.4018 20.7289L34.4012 20.7292L34.644 21.1663ZM33.8844 22.6648L34.3844 22.6643L34.3844 22.6332L34.3805 22.6023L33.8844 22.6648ZM33.8935 31.1305L33.3935 31.131L33.3935 31.1621L33.3974 31.193L33.8935 31.1305ZM34.6512 32.2532L34.8989 31.8188L34.8947 31.8165L34.6512 32.2532ZM36.0506 32.2866L36.1945 32.7655L36.2278 32.7555L36.2594 32.7409L36.0506 32.2866ZM36.1806 32.2269L36.3894 32.6812L36.3898 32.681L36.1806 32.2269ZM36.6704 32L36.8814 32.4533L36.8814 32.4533L36.6704 32ZM37.5258 31.5992L37.7391 32.0514L37.7391 32.0514L37.5258 31.5992ZM38.4147 31.1773L38.1994 30.7261L38.1993 30.7261L38.4147 31.1773ZM38.6575 31.0614L38.4422 30.6102L38.4422 30.6102L38.6575 31.0614ZM44.7287 28.0867L44.4983 27.643L44.4983 27.643L44.7287 28.0867ZM48.2714 26.1612L48.7381 26.3405L49.2432 25.0252L48.022 25.7278L48.2714 26.1612ZM46.77 28.5856L47.0093 29.0246L47.0701 28.9915L47.1196 28.9431L46.77 28.5856ZM29.5 38L29.2037 38.4027L29.46 38.5913L29.7393 38.439L29.5 38ZM29.432 35.3968L29.8102 35.7238V35.7238L29.432 35.3968ZM29.0818 20.7075L29.5335 20.493L29.4832 20.3872L29.3912 20.3147L29.0818 20.7075ZM5.46832 16.1644L5.46505 16.6644H5.46505L5.46832 16.1644ZM3 16L2.74994 15.567L2.74994 15.567L3 16ZM19.6582 10.9238L20.1119 11.1338L20.5495 10.1886L19.5383 10.4383L19.6582 10.9238ZM19.4076 11.463L19.8605 11.6748L19.8605 11.6748L19.4076 11.463ZM19.2878 11.7179L18.8358 11.5041L18.8357 11.5042L19.2878 11.7179ZM19.369 14.4414L19.8075 14.2011L19.8075 14.2011L19.369 14.4414ZM21.6204 15.9759L21.6837 15.4799L21.6204 15.9759ZM30.2163 14.6945C29.7892 15.7447 28.7088 16.3761 27.5842 16.2326L27.4577 17.2246C29.0321 17.4254 30.5447 16.5416 31.1427 15.0712L30.2163 14.6945ZM31.8099 11.1496C31.2905 12.1863 30.7577 13.3633 30.2163 14.6945L31.1427 15.0712C31.6754 13.7614 32.1975 12.6083 32.7039 11.5975L31.8099 11.1496ZM35.5265 11.0007C34.5764 10.9504 33.4789 10.911 32.2723 10.8738L32.2415 11.8733C33.4464 11.9104 34.5349 11.9496 35.4735 11.9993L35.5265 11.0007ZM46.3923 14.9633C44.2011 12.8166 40.7191 11.2759 35.5265 11.0007L35.4735 11.9993C40.4953 12.2654 43.7206 13.7459 45.6925 15.6777L46.3923 14.9633ZM41.469 18.0925C43.1179 17.2477 44.8276 16.4045 46.2447 15.7778L45.8402 14.8632C44.3972 15.5014 42.6677 16.3548 41.013 17.2026L41.469 18.0925ZM36.9083 20.4984C38.1286 19.8386 39.7736 18.9611 41.469 18.0925L41.013 17.2026C39.3088 18.0757 37.6568 18.9569 36.4327 19.6187L36.9083 20.4984ZM35.4408 21.2978C35.7931 21.1043 36.2979 20.8284 36.9083 20.4984L36.4327 19.6187C35.8201 19.95 35.3134 20.2269 34.9594 20.4213L35.4408 21.2978ZM35.0321 21.5229C35.1264 21.4708 35.2645 21.3946 35.4407 21.2979L34.9594 20.4213C34.7823 20.5186 34.6434 20.5952 34.5485 20.6477L35.0321 21.5229ZM34.8863 21.6037L35.0325 21.5227L34.548 20.6479L34.4018 20.7289L34.8863 21.6037ZM34.3805 22.6023C34.3295 22.1972 34.5299 21.8017 34.8869 21.6033L34.4012 20.7292C33.6872 21.1259 33.2863 21.9169 33.3883 22.7273L34.3805 22.6023ZM34.3935 31.1299L34.3844 22.6643L33.3844 22.6653L33.3935 31.131L34.3935 31.1299ZM34.8947 31.8165C34.6169 31.6615 34.4293 31.3836 34.3896 31.068L33.3974 31.193C33.4769 31.8242 33.852 32.38 34.4077 32.6898L34.8947 31.8165ZM35.9067 31.8078C35.454 31.9439 35.1332 31.9525 34.8989 31.8188L34.4034 32.6875C35.0129 33.0351 35.6843 32.9188 36.1945 32.7655L35.9067 31.8078ZM35.9718 31.7726L35.8418 31.8323L36.2594 32.7409L36.3894 32.6812L35.9718 31.7726ZM36.4594 31.5467C36.2495 31.6444 36.0843 31.7207 35.9714 31.7728L36.3898 32.681C36.5037 32.6285 36.6701 32.5516 36.8814 32.4533L36.4594 31.5467ZM37.3125 31.1469C36.9798 31.3039 36.692 31.4384 36.4594 31.5467L36.8814 32.4533C37.1153 32.3444 37.4046 32.2091 37.7391 32.0514L37.3125 31.1469ZM38.1993 30.7261C37.878 30.8795 37.5806 31.0205 37.3125 31.1469L37.7391 32.0514C38.0085 31.9243 38.3073 31.7827 38.6302 31.6285L38.1993 30.7261ZM38.4422 30.6102L38.1994 30.7261L38.6301 31.6286L38.8729 31.5127L38.4422 30.6102ZM44.4983 27.643C42.6691 28.5928 39.9535 29.8889 38.4422 30.6102L38.8729 31.5127C40.3793 30.7937 43.1119 29.4897 44.9591 28.5305L44.4983 27.643ZM48.022 25.7278C46.9126 26.3661 45.6984 27.0198 44.4983 27.643L44.9591 28.5305C46.1672 27.9031 47.3949 27.2423 48.5207 26.5946L48.022 25.7278ZM47.1196 28.9431C47.7765 28.3009 48.3341 27.3925 48.7381 26.3405L47.8046 25.982C47.4382 26.9359 46.95 27.7104 46.4205 28.2281L47.1196 28.9431ZM29.7393 38.439L47.0093 29.0246L46.5307 28.1466L29.2607 37.561L29.7393 38.439ZM29.0538 35.0697C28.843 35.3134 28.6308 35.5579 28.4674 35.7941C28.3039 36.0304 28.1557 36.3043 28.1145 36.6168C28.0235 37.3074 28.4737 37.8656 29.2037 38.4027L29.7963 37.5973C29.1089 37.0914 29.0927 36.8479 29.1059 36.7475C29.1169 36.6645 29.1634 36.5457 29.2897 36.3631C29.4161 36.1804 29.5887 35.9799 29.8102 35.7238L29.0538 35.0697ZM28.6302 20.922C30.9222 25.7476 31.3544 28.8735 31.0735 30.9728C30.7952 33.0523 29.8106 34.1947 29.0538 35.0697L29.8102 35.7238C30.5914 34.8206 31.7455 33.4901 32.0647 31.1054C32.3811 28.7404 31.8693 25.4108 29.5335 20.493L28.6302 20.922ZM5.46505 16.6644C8.15636 16.682 12.627 16.7117 17.122 17.2857C21.6411 17.8627 26.0783 18.9786 28.7725 21.1003L29.3912 20.3147C26.4662 18.0111 21.7865 16.8731 17.2486 16.2937C12.6865 15.7112 8.16005 15.682 5.47159 15.6644L5.46505 16.6644ZM2.74994 15.567C2.71449 15.5875 2.63778 15.6347 2.57251 15.7184C2.4953 15.8174 2.40557 16.0157 2.50093 16.2425C2.57364 16.4154 2.71294 16.4913 2.7561 16.5134C2.81543 16.5439 2.87237 16.5607 2.91009 16.5703C3.05002 16.6061 3.25286 16.622 3.46207 16.6323C3.90703 16.6543 4.60126 16.6588 5.46505 16.6644L5.4716 15.6644C4.59625 15.6587 3.9294 15.6542 3.51152 15.6335C3.40834 15.6284 3.32552 15.6226 3.26166 15.616C3.22991 15.6128 3.20507 15.6096 3.18627 15.6067C3.177 15.6053 3.16997 15.604 3.16491 15.603C3.15975 15.602 3.15762 15.6015 3.15795 15.6015C3.15808 15.6016 3.16273 15.6028 3.17068 15.6055C3.17813 15.6081 3.19331 15.6138 3.21289 15.6239C3.23191 15.6336 3.35604 15.6962 3.42276 15.8549C3.51215 16.0675 3.42563 16.2506 3.36106 16.3334C3.30842 16.4009 3.25378 16.4308 3.25006 16.433L2.74994 15.567ZM19.5383 10.4383C17.6705 10.8997 13.9271 11.9233 10.4371 12.955C8.69171 13.4711 7.00533 13.9904 5.64585 14.4436C4.3085 14.8894 3.23173 15.2888 2.74994 15.567L3.25006 16.433C3.62599 16.2159 4.59586 15.8477 5.9621 15.3923C7.30623 14.9442 8.98043 14.4285 10.7206 13.914C14.2019 12.8848 17.9298 11.8657 19.7781 11.4092L19.5383 10.4383ZM19.8605 11.6748C19.9412 11.5022 20.0251 11.3215 20.1119 11.1338L19.2045 10.7137C19.1178 10.901 19.0345 11.0804 18.9547 11.2512L19.8605 11.6748ZM19.7398 11.9317C19.7793 11.8481 19.8195 11.7624 19.8605 11.6748L18.9547 11.2512C18.9141 11.3379 18.8745 11.4223 18.8358 11.5041L19.7398 11.9317ZM19.8075 14.2011C19.4228 13.4991 19.3977 12.6553 19.7398 11.9316L18.8357 11.5042C18.3568 12.5174 18.392 13.6987 18.9305 14.6816L19.8075 14.2011ZM21.6837 15.4799C20.8896 15.3786 20.192 14.9032 19.8075 14.2011L18.9304 14.6816C19.4689 15.6645 20.4455 16.3301 21.5572 16.4719L21.6837 15.4799ZM27.5842 16.2326L21.6837 15.4799L21.5572 16.4719L27.4577 17.2246L27.5842 16.2326Z\\\" fill=\\\"currentColor\\\"></path></g><path id=\\\"Vector 2_2\\\" d=\\\"M22 13L27.9005 13.7527C35.7204 -5.47592 43.5914 1.80677 44.1005 14.3013C44.0496 6.10544 41.4074 -0.0498744 33.7029 0.000304595C27.5393 0.0404478 24.1269 8.50061 22 13Z\\\" fill=\\\"currentColor\\\"></path><path id=\\\"Vector\\\" d=\\\"M30.0146 35.5184C30.6209 34.4891 31.0856 32.6318 31.0919 29.3392C30.6547 23.0315 29.594 21.1437 28.0037 20.1879C27.075 19.6298 25.7496 19.2525 23.6724 18.9311C22.4151 18.7366 21.0244 18.5798 19.4032 18.3969C18.3173 18.2744 17.1281 18.1402 15.8062 17.9753C14.4882 17.8108 13.3113 17.65 12.2415 17.5038C10.7839 17.3046 9.52502 17.1325 8.3785 17.0155C6.3889 16.8124 5.1769 16.8342 4.37736 17.0632C3.75934 17.2402 3.34932 17.5441 2.9782 18.3246C2.54305 19.2397 2.20891 20.7381 2.00005 23.2152C2.01122 29.3363 3.26876 31.3737 4.77762 32.3943C5.64876 32.9836 6.81469 33.386 8.46877 33.7555C9.28645 33.9381 10.1726 34.1028 11.1646 34.2866L11.1946 34.2922C12.1523 34.4696 13.1959 34.663 14.2995 34.8984C16.2798 35.2154 18.1882 35.6107 19.9036 35.966C20.7256 36.1363 21.5034 36.2974 22.2235 36.4363C24.575 36.8898 26.3227 37.1091 27.6414 36.9478C28.8125 36.8045 29.5026 36.3874 30.0146 35.5184Z\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"4\\\"></path><path id=\\\"Vector 3\\\" d=\\\"M36.6921 29L36.6921 23.1034C40.7408 21.1901 45.2593 18.8099 48 17.5C49.86 16.611 51.371 17.3214 51.7408 19.1901C52 20.5 51.1543 21.8739 50 22.5C48.8457 23.1261 36.6921 29 36.6921 29Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar-editor\":\"avatar-editor__avatar-editor__q1zyB\",\"avatarEditor\":\"avatar-editor__avatar-editor__q1zyB\"};","module.exports = __webpack_public_path__ + \"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav\";","module.exports = \"<svg viewBox=\\\"0 0 31 31\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"15.5\\\" cy=\\\"15.5\\\" r=\\\"14.5\\\" fill=\\\"currentColor\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M18.3345 12.9125C17.944 12.522 17.3108 12.522 16.9203 12.9125L14.8338 14.999L16.7466 16.9118L18.8331 14.8253C19.2236 14.4348 19.2236 13.8016 18.8331 13.4111L18.3345 12.9125ZM16.2152 17.4432L14.3024 15.5304L7.70711 22.1257C7.31658 22.5162 7.31658 23.1494 7.70711 23.5399L8.20568 24.0385C8.59621 24.429 9.22937 24.429 9.6199 24.0385L16.2152 17.4432Z\\\" fill=\\\"white\\\"></path><path d=\\\"M14.539 5.58541C14.5989 5.40115 14.8595 5.40115 14.9194 5.58541L15.4653 7.26541C15.4921 7.34781 15.5688 7.40361 15.6555 7.40361H17.4219C17.6157 7.40361 17.6962 7.65153 17.5395 7.76541L16.1104 8.80371C16.0403 8.85463 16.011 8.94491 16.0378 9.02731L16.5836 10.7073C16.6435 10.8916 16.4326 11.0448 16.2759 10.9309L14.8468 9.89262C14.7767 9.84169 14.6817 9.84169 14.6116 9.89262L13.1826 10.9309C13.0258 11.0448 12.8149 10.8916 12.8748 10.7073L13.4206 9.02731C13.4474 8.94491 13.4181 8.85463 13.348 8.80371L11.9189 7.76541C11.7622 7.65153 11.8427 7.40361 12.0365 7.40361H13.8029C13.8896 7.40361 13.9664 7.34781 13.9931 7.26541L14.539 5.58541Z\\\" fill=\\\"white\\\"></path><path d=\\\"M21.728 8.36823C21.7878 8.18397 22.0485 8.18397 22.1084 8.36823L22.3939 9.24703C22.4207 9.32943 22.4975 9.38523 22.5841 9.38523H23.5081C23.7019 9.38523 23.7824 9.63315 23.6257 9.74703L22.8782 10.2902C22.8081 10.3411 22.7787 10.4314 22.8055 10.5138L23.091 11.3926C23.1509 11.5768 22.94 11.73 22.7833 11.6162L22.0357 11.073C21.9656 11.0221 21.8707 11.0221 21.8006 11.073L21.0531 11.6162C20.8963 11.73 20.6854 11.5768 20.7453 11.3926L21.0308 10.5138C21.0576 10.4314 21.0283 10.3411 20.9582 10.2902L20.2106 9.74703C20.0539 9.63315 20.1344 9.38523 20.3282 9.38523H21.2522C21.3388 9.38523 21.4156 9.32943 21.4424 9.24703L21.728 8.36823Z\\\" fill=\\\"white\\\"></path><path d=\\\"M22.1918 15.3253C22.2516 15.141 22.5123 15.141 22.5722 15.3253L22.9618 16.5246C22.9886 16.607 23.0654 16.6628 23.1521 16.6628H24.4131C24.6068 16.6628 24.6874 16.9107 24.5306 17.0246L23.5104 17.7658C23.4403 17.8167 23.411 17.907 23.4378 17.9894L23.8275 19.1887C23.8873 19.3729 23.6764 19.5261 23.5197 19.4123L22.4995 18.6711C22.4294 18.6201 22.3345 18.6201 22.2644 18.6711L21.2442 19.4123C21.0875 19.5261 20.8766 19.3729 20.9365 19.1887L21.3261 17.9894C21.3529 17.907 21.3236 17.8167 21.2535 17.7658L20.2333 17.0246C20.0766 16.9107 20.1571 16.6628 20.3509 16.6628H21.6119C21.6985 16.6628 21.7753 16.607 21.8021 16.5246L22.1918 15.3253Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"11.5005\\\" y=\\\"23\\\" width=\\\"10\\\" height=\\\"2\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M10.5005 9C8.84363 9 7.50049 10.3431 7.50049 12V20C7.50049 21.6569 8.84363 23 10.5005 23H22.5005C24.1573 23 25.5005 21.6569 25.5005 20V12C25.5005 10.3431 24.1573 9 22.5005 9H10.5005ZM11.5005 12C10.9482 12 10.5005 12.4477 10.5005 13V19C10.5005 19.5523 10.9482 20 11.5005 20H21.5005C22.0528 20 22.5005 19.5523 22.5005 19V13C22.5005 12.4477 22.0528 12 21.5005 12H11.5005Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"black\\\" stroke-opacity=\\\"0.01\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"1\\\"></circle><rect x=\\\"11.5005\\\" y=\\\"23\\\" width=\\\"10\\\" height=\\\"2\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M10.5005 9C8.84363 9 7.50049 10.3431 7.50049 12V20C7.50049 21.6569 8.84363 23 10.5005 23H22.5005C24.1573 23 25.5005 21.6569 25.5005 20V12C25.5005 10.3431 24.1573 9 22.5005 9H10.5005ZM11.5005 12C10.9482 12 10.5005 12.4477 10.5005 13V19C10.5005 19.5523 10.9482 20 11.5005 20H21.5005C22.0528 20 22.5005 19.5523 22.5005 19V13C22.5005 12.4477 22.0528 12 21.5005 12H11.5005Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"8.00049\\\" y=\\\"11\\\" width=\\\"14\\\" height=\\\"11\\\" rx=\\\"2\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M25.8032 12.7057C25.3814 12.5114 24.8337 12.5587 24.4733 12.8475L20.8237 15.7718C20.3927 16.1171 20.3927 16.677 20.8237 17.0224L24.568 20.0225C24.902 20.2901 25.3968 20.3503 25.8032 20.2032V12.7057Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"black\\\" stroke-opacity=\\\"0.01\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"1\\\"></circle><rect x=\\\"8.00049\\\" y=\\\"11\\\" width=\\\"14\\\" height=\\\"11\\\" rx=\\\"2\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M25.8032 12.7057C25.3814 12.5114 24.8337 12.5587 24.4733 12.8475L20.8237 15.7718C20.3927 16.1171 20.3927 16.677 20.8237 17.0224L24.568 20.0225C24.902 20.2901 25.3968 20.3503 25.8032 20.2032V12.7057Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"black\\\" stroke-opacity=\\\"0.01\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"1\\\"></circle><path d=\\\"M8.75049 24H24.2505C24.5266 24 24.7505 24.2239 24.7505 24.5C24.7505 24.7761 24.5266 25 24.2505 25H9.75049C9.1982 25 8.75049 24.5523 8.75049 24Z\\\" fill=\\\"white\\\"></path><path d=\\\"M10.0005 17.9508L14.0005 22L10.1844 23.0407C9.43889 23.2441 8.7543 22.561 8.95595 21.815L10.0005 17.9508ZM24.7934 9.8226C25.1839 10.2131 25.1839 10.8463 24.7934 11.2368L14.5497 21.4805L10.5207 17.4508L20.7637 7.20715C21.1542 6.81661 21.7874 6.8166 22.1779 7.20713L24.7934 9.8226Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><path d=\\\"M8.75049 24H24.2505C24.5266 24 24.7505 24.2239 24.7505 24.5C24.7505 24.7761 24.5266 25 24.2505 25H9.75049C9.1982 25 8.75049 24.5523 8.75049 24Z\\\" fill=\\\"white\\\"></path><path d=\\\"M10.0005 17.9508L14.0005 22L10.1844 23.0407C9.43889 23.2441 8.7543 22.561 8.95595 21.815L10.0005 17.9508ZM24.7934 9.8226C25.1839 10.2131 25.1839 10.8463 24.7934 11.2368L14.5497 21.4805L10.5207 17.4508L20.7637 7.20715C21.1542 6.81661 21.7874 6.8166 22.1779 7.20713L24.7934 9.8226Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"black\\\" stroke-opacity=\\\"0.01\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"1\\\"></circle><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M8.26715 10C7.56759 10 7.00049 10.5698 7.00049 11.2727V22.7273C7.00049 23.4302 7.56759 24 8.26715 24H24.7338C25.4334 24 26.0005 23.4302 26.0005 22.7273V11.2727C26.0005 10.5698 25.4334 10 24.7338 10H8.26715ZM9.13382 11C8.5079 11 8.00049 11.1628 8.00049 11.3636V14.6364C8.00049 14.8372 8.5079 15 9.13382 15H23.8672C24.4931 15 25.0005 14.8372 25.0005 14.6364V11.3636C25.0005 11.1628 24.4931 11 23.8672 11H9.13382Z\\\" fill=\\\"white\\\"></path><circle cx=\\\"16.5005\\\" cy=\\\"19.5\\\" r=\\\"3\\\" stroke=\\\"#404040\\\"></circle></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 33 33\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"16.5005\\\" cy=\\\"16.5\\\" r=\\\"14.5\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M8.26715 10C7.56759 10 7.00049 10.5698 7.00049 11.2727V22.7273C7.00049 23.4302 7.56759 24 8.26715 24H24.7338C25.4334 24 26.0005 23.4302 26.0005 22.7273V11.2727C26.0005 10.5698 25.4334 10 24.7338 10H8.26715ZM9.13382 11C8.5079 11 8.00049 11.1628 8.00049 11.3636V14.6364C8.00049 14.8372 8.5079 15 9.13382 15H23.8672C24.4931 15 25.0005 14.8372 25.0005 14.6364V11.3636C25.0005 11.1628 24.4931 11 23.8672 11H9.13382Z\\\" fill=\\\"white\\\"></path><circle cx=\\\"16.5005\\\" cy=\\\"19.5\\\" r=\\\"3\\\" stroke=\\\"#404040\\\"></circle></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"74\\\" width=\\\"22\\\" height=\\\"10\\\"><rect x=\\\"53.3186\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"65\\\" width=\\\"22\\\" height=\\\"19\\\"><rect x=\\\"53.3186\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3186\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3186 72.8113C53.3186 78.7104 58.0995 83.4926 63.997 83.4926C69.8945 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8945 19.8526 63.997 19.8526C58.0995 19.8526 53.3186 24.6347 53.3186 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3187\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"56\\\" width=\\\"22\\\" height=\\\"28\\\"><rect x=\\\"53.3187\\\" y=\\\"56.2183\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3187\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"47\\\" width=\\\"22\\\" height=\\\"37\\\"><rect x=\\\"53.3187\\\" y=\\\"47.1268\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"56.2183\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3187\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"38\\\" width=\\\"22\\\" height=\\\"46\\\"><rect x=\\\"53.3187\\\" y=\\\"38.0354\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"currentColor\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"47.1268\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"currentColor\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"56.2183\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"currentColor\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"currentColor\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"currentColor\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3187\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"28\\\" width=\\\"22\\\" height=\\\"56\\\"><rect x=\\\"53.3187\\\" y=\\\"28.944\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"38.0354\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"47.1268\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"56.2183\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"58\\\" fill=\\\"#404040\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"12\\\" stroke-miterlimit=\\\"3.8637\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0633\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7202 72.799C49.7202 65.9079 42.1165 62.6609 40.3617 69.3249C39.9447 70.9085 39.7242 72.5592 39.7242 74.2557C39.7242 86.1656 50.5929 95.8204 64 95.8204C77.4072 95.8204 88.2759 86.1656 88.2759 74.2557C88.2759 72.5593 88.0554 70.9085 87.6384 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8867 87.0789 64.0001 87.0789C56.1135 87.0789 49.7202 80.6856 49.7202 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3187\\\" y=\\\"19.8621\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"white\\\"></path><mask id=\\\"mask0\\\" mask-type=\\\"alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"53\\\" y=\\\"19\\\" width=\\\"22\\\" height=\\\"65\\\"><rect x=\\\"53.3187\\\" y=\\\"19.8525\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"28.944\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"38.0354\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"47.1268\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"56.2183\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"65.3097\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect><rect x=\\\"53.3187\\\" y=\\\"74.4011\\\" width=\\\"21.36\\\" height=\\\"9.09143\\\" fill=\\\"#C4C4C4\\\"></rect></mask><g mask=\\\"url(#mask0)\\\"><path d=\\\"M53.3187 72.8113C53.3187 78.7104 58.0995 83.4926 63.997 83.4926C69.8946 83.4926 74.6754 78.7104 74.6754 72.8113V30.5338C74.6754 24.6347 69.8946 19.8526 63.997 19.8526C58.0995 19.8526 53.3187 24.6347 53.3187 30.5338V72.8113Z\\\" fill=\\\"currentColor\\\"></path></g></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"white\\\"></path><path d=\\\"M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FFEAED\\\"></path><path d=\\\"M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FFD2D8\\\"></path><path d=\\\"M87.4633 47.6226L90.2918 50.451L87.4633 47.6226ZM64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FFAEB9\\\"></path><path d=\\\"M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FF8D9D\\\"></path><path d=\\\"M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FF7083\\\"></path><path d=\\\"M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4633 47.6226C89.416 45.67 89.416 42.5042 87.4633 40.5515C85.5107 38.5989 82.3449 38.5989 80.3923 40.5515L64.0148 56.929L47.6375 40.5516C45.6848 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6848 89.4011 47.6375 87.4485L64.0148 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4633 87.4486C89.416 85.4959 89.416 82.3301 87.4633 80.3775L71.0859 64.0001L87.4633 47.6226Z\\\" fill=\\\"#FF6479\\\"></path><path d=\\\"M64.0148 56.929L61.1864 59.7574L64.0148 62.5858L66.8433 59.7574L64.0148 56.929ZM47.6375 40.5516L44.809 43.38L47.6375 40.5516ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM56.9438 64.0001L59.7722 66.8285L62.6006 64.0001L59.7722 61.1716L56.9438 64.0001ZM40.5664 80.3774L37.738 77.549L40.5664 80.3774ZM47.6375 87.4485L44.809 84.6201L47.6375 87.4485ZM64.0148 71.0711L66.8433 68.2427L64.0148 65.4143L61.1864 68.2427L64.0148 71.0711ZM87.4633 87.4486L90.2918 90.277L90.2918 90.277L87.4633 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.6349 43.38C85.0254 43.7705 85.0254 44.4037 84.6349 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.6349 43.38ZM83.2207 43.38C83.6112 42.9894 84.2444 42.9894 84.6349 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.809 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.809 43.38ZM43.3948 43.38C43.7853 42.9895 44.4185 42.9895 44.809 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2232 41.2379 34.2232 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1153 66.8285L59.7722 61.1716ZM43.3948 83.2059L59.7722 66.8285L54.1153 61.1716L37.738 77.549L43.3948 83.2059ZM43.3948 84.6201C43.0043 84.2295 43.0043 83.5964 43.3948 83.2059L37.738 77.549C34.2232 81.0637 34.2232 86.7622 37.738 90.2769L43.3948 84.6201ZM44.809 84.6201C44.4185 85.0106 43.7853 85.0106 43.3948 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.809 84.6201ZM61.1864 68.2427L44.809 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5638 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6112 85.0107 83.2207 84.6201L77.5638 90.277C81.0786 93.7917 86.777 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0254 83.5964 85.0254 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9143 61.1716L68.2575 66.8285ZM84.6349 44.7942L68.2575 61.1716L73.9143 66.8285L90.2918 50.451L84.6349 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","module.exports = \"<svg viewBox=\\\"0 0 128 128\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><circle cx=\\\"64\\\" cy=\\\"64\\\" r=\\\"64\\\" fill=\\\"#404040\\\"></circle><rect x=\\\"58.5789\\\" y=\\\"94.0632\\\" width=\\\"10.8424\\\" height=\\\"14.0748\\\" fill=\\\"white\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M49.7201 72.799C49.7201 65.9079 42.1164 62.6609 40.3616 69.3249C39.9447 70.9085 39.7241 72.5592 39.7241 74.2557C39.7241 86.1656 50.5928 95.8204 64 95.8204C77.4072 95.8204 88.2758 86.1656 88.2758 74.2557C88.2758 72.5593 88.0553 70.9085 87.6383 69.325C85.8837 62.6611 78.28 65.908 78.28 72.799C78.28 80.6856 71.8866 87.0789 64.0001 87.0789C56.1135 87.0789 49.7201 80.6856 49.7201 72.799Z\\\" fill=\\\"white\\\"></path><rect x=\\\"53.3186\\\" y=\\\"19.862\\\" width=\\\"21.3628\\\" height=\\\"63.6407\\\" rx=\\\"10.6814\\\" fill=\\\"white\\\"></rect><mask id=\\\"path-5-outside-1\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\" fill=\\\"black\\\"><rect fill=\\\"white\\\" x=\\\"10.9819\\\" y=\\\"11.4462\\\" width=\\\"106.066\\\" height=\\\"106.066\\\"></rect><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4634 47.6226C89.416 45.67 89.416 42.5042 87.4634 40.5515C85.5108 38.5989 82.3449 38.5989 80.3923 40.5515L64.0149 56.929L47.6375 40.5516C45.6849 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6849 89.4011 47.6375 87.4485L64.0149 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4634 87.4486C89.416 85.4959 89.416 82.3301 87.4634 80.3775L71.0859 64.0001L87.4634 47.6226Z\\\"></path></mask><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M87.4634 47.6226C89.416 45.67 89.416 42.5042 87.4634 40.5515C85.5108 38.5989 82.3449 38.5989 80.3923 40.5515L64.0149 56.929L47.6375 40.5516C45.6849 38.599 42.519 38.599 40.5664 40.5516C38.6138 42.5042 38.6138 45.67 40.5664 47.6227L56.9438 64.0001L40.5664 80.3774C38.6138 82.3301 38.6138 85.4959 40.5664 87.4485C42.519 89.4011 45.6849 89.4011 47.6375 87.4485L64.0149 71.0711L80.3923 87.4486C82.3449 89.4012 85.5107 89.4012 87.4634 87.4486C89.416 85.4959 89.416 82.3301 87.4634 80.3775L71.0859 64.0001L87.4634 47.6226Z\\\" fill=\\\"#FF3550\\\"></path><path d=\\\"M64.0149 56.929L61.1864 59.7574L64.0149 62.5858L66.8433 59.7574L64.0149 56.929ZM40.5664 40.5516L43.3948 43.38L40.5664 40.5516ZM40.5664 47.6227L43.3948 44.7942L40.5664 47.6227ZM56.9438 64.0001L59.7722 66.8285L62.6007 64.0001L59.7722 61.1716L56.9438 64.0001ZM64.0149 71.0711L66.8433 68.2427L64.0149 65.4143L61.1864 68.2427L64.0149 71.0711ZM87.4634 87.4486L90.2918 90.277L90.2918 90.277L87.4634 87.4486ZM71.0859 64.0001L68.2575 61.1716L65.4291 64.0001L68.2575 66.8285L71.0859 64.0001ZM84.635 43.38C85.0255 43.7705 85.0255 44.4037 84.635 44.7942L90.2918 50.451C93.8065 46.9363 93.8065 41.2378 90.2918 37.7231L84.635 43.38ZM83.2207 43.38C83.6113 42.9894 84.2444 42.9894 84.635 43.38L90.2918 37.7231C86.7771 34.2084 81.0786 34.2084 77.5639 37.7231L83.2207 43.38ZM66.8433 59.7574L83.2207 43.38L77.5639 37.7231L61.1864 54.1006L66.8433 59.7574ZM44.8091 43.38L61.1864 59.7574L66.8433 54.1006L50.4659 37.7232L44.8091 43.38ZM43.3948 43.38C43.7854 42.9895 44.4185 42.9895 44.8091 43.38L50.4659 37.7232C46.9512 34.2084 41.2527 34.2084 37.738 37.7232L43.3948 43.38ZM43.3948 44.7942C43.0043 44.4037 43.0043 43.7705 43.3948 43.38L37.738 37.7232C34.2233 41.2379 34.2233 46.9364 37.738 50.4511L43.3948 44.7942ZM59.7722 61.1716L43.3948 44.7942L37.738 50.4511L54.1154 66.8285L59.7722 61.1716ZM43.3949 83.2059L59.7722 66.8285L54.1154 61.1716L37.738 77.549L43.3949 83.2059ZM43.3949 84.6201C43.0043 84.2295 43.0043 83.5964 43.3949 83.2059L37.738 77.549C34.2233 81.0637 34.2233 86.7622 37.738 90.2769L43.3949 84.6201ZM44.8091 84.6201C44.4185 85.0106 43.7854 85.0106 43.3949 84.6201L37.738 90.2769C41.2527 93.7916 46.9512 93.7917 50.4659 90.2769L44.8091 84.6201ZM61.1864 68.2427L44.8091 84.6201L50.4659 90.2769L66.8433 73.8995L61.1864 68.2427ZM83.2207 84.6201L66.8433 68.2427L61.1864 73.8995L77.5639 90.277L83.2207 84.6201ZM84.6349 84.6201C84.2444 85.0107 83.6113 85.0107 83.2207 84.6201L77.5639 90.277C81.0786 93.7917 86.7771 93.7917 90.2918 90.277L84.6349 84.6201ZM84.6349 83.2059C85.0255 83.5964 85.0255 84.2296 84.6349 84.6201L90.2918 90.277C93.8065 86.7623 93.8065 81.0638 90.2918 77.5491L84.6349 83.2059ZM68.2575 66.8285L84.6349 83.2059L90.2918 77.5491L73.9144 61.1716L68.2575 66.8285ZM84.635 44.7942L68.2575 61.1716L73.9144 66.8285L90.2918 50.451L84.635 44.7942Z\\\" fill=\\\"#404040\\\" mask=\\\"url(#path-5-outside-1)\\\"></path></svg>\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"label\":\"spectating-label__label__GyRbZ\"};","module.exports = \"#version 300 es\\r\\nprecision highp float;\\r\\nprecision highp int;\\r\\n\\r\\n// Keep these separate so three only sets them once\\r\\nuniform mat4 viewMatrix;\\r\\nuniform mat4 projectionMatrix;\\r\\n\\r\\nlayout(std140) uniform InstanceData {\\r\\n  mat4 transforms[MAX_INSTANCES];\\r\\n  vec4 colors[MAX_INSTANCES];\\r\\n  vec4 uvTransforms[MAX_INSTANCES];\\r\\n  vec4 mapSettings[MAX_INSTANCES];\\r\\n\\r\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\r\\n\\r\\n  vec3 hubs_InteractorOnePos;\\r\\n  bool hubs_IsFrozen;\\r\\n\\r\\n  vec3 hubs_InteractorTwoPos;\\r\\n  float hubs_Time;\\r\\n\\r\\n} instanceData;\\r\\n\\r\\nout vec3 hubs_WorldPosition;\\r\\nout float fogDepth;\\r\\n\\r\\nin vec3 position;\\r\\nin vec2 uv;\\r\\n\\r\\n#ifdef PSEUDO_INSTANCING\\r\\nin float instance;\\r\\nflat out uint vInstance;\\r\\n#endif\\r\\n\\r\\n#ifdef VERTEX_COLORS\\r\\nin vec3 color;\\r\\n#endif\\r\\n\\r\\nout vec2 vUv;\\r\\nout vec4 vColor;\\r\\n\\r\\nflat out vec4 vUVTransform;\\r\\nflat out vec4 vMapSettings;\\r\\n\\r\\nvoid main() {\\r\\n  #ifdef PSEUDO_INSTANCING\\r\\n  uint instanceIndex = uint(instance);\\r\\n  #elif\\r\\n  uint instanceIndex = gl_InstanceID;\\r\\n  #endif\\r\\n\\r\\n  vColor = instanceData.colors[instanceIndex];\\r\\n\\r\\n  #ifdef VERTEX_COLORS\\r\\n  vColor *= vec4(color, 1.0);\\r\\n  #endif\\r\\n\\r\\n  vUv = uv;\\r\\n  vUVTransform = instanceData.uvTransforms[instanceIndex];\\r\\n  vMapSettings = instanceData.mapSettings[instanceIndex];\\r\\n\\r\\n  vec4 mvPosition = viewMatrix * instanceData.transforms[instanceIndex] * vec4(position, 1.0);\\r\\n\\r\\n  gl_Position = projectionMatrix * mvPosition;\\r\\n\\r\\n  hubs_WorldPosition = (instanceData.transforms[instanceIndex] * vec4(position, 1.0)).xyz;\\r\\n  vInstance = instanceIndex;\\r\\n\\r\\n  fogDepth = -mvPosition.z;\\r\\n}\\r\\n\"","module.exports = \"#version 300 es\\r\\nprecision highp float;\\r\\nprecision highp int;\\r\\nprecision highp sampler2DArray;\\r\\n\\r\\nlayout(std140) uniform InstanceData {\\r\\n  mat4 transforms[MAX_INSTANCES];\\r\\n  vec4 colors[MAX_INSTANCES];\\r\\n  vec4 uvTransforms[MAX_INSTANCES];\\r\\n  vec4 mapSettings[MAX_INSTANCES];\\r\\n\\r\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\r\\n\\r\\n  vec3 hubs_InteractorOnePos;\\r\\n  bool hubs_IsFrozen;\\r\\n\\r\\n  vec3 hubs_InteractorTwoPos;\\r\\n  float hubs_Time;\\r\\n\\r\\n} instanceData;\\r\\nin vec3 hubs_WorldPosition;\\r\\n#ifdef PSEUDO_INSTANCING\\r\\nflat in uint vInstance;\\r\\n#endif\\r\\n\\r\\n\\r\\nuniform sampler2DArray map;\\r\\n\\r\\nin float fogDepth;\\r\\nuniform vec3 fogColor;\\r\\n\\r\\n// Fog Type\\r\\n// 0.0 -> disabled\\r\\n// 1.0 -> linear\\r\\n// 2.0 -> exponential\\r\\nuniform vec4 fogOptions; // r = type; g = density; b = near; a = far;\\r\\n\\r\\nin vec2 vUv;\\r\\nin vec4 vColor;\\r\\nflat in vec4 vUVTransform;\\r\\nflat in vec4 vMapSettings;\\r\\n\\r\\nout vec4 outColor;\\r\\n\\r\\nfloat applyWrapping(float value, int mode) {\\r\\n  if (mode == 0) {\\r\\n    // CLAMP_TO_EDGE - default\\r\\n    return clamp(value, 0.0, 1.0);\\r\\n  } else if (mode == 1) {\\r\\n    // REPEAT\\r\\n    return fract(value);\\r\\n  } else {\\r\\n    // MIRRORED_REPEAT\\r\\n    float n = mod(value, 2.0);\\r\\n    return mix(n, 2.0 - n, step(1.0, n));\\r\\n  }\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n  vec2 uv = vUv;\\r\\n\\r\\n  int wrapS = int(vMapSettings.y);\\r\\n  int wrapT = int(vMapSettings.z);\\r\\n  uv.s = applyWrapping(uv.s, wrapS);\\r\\n  uv.t = applyWrapping(uv.t, wrapT);\\r\\n\\r\\n  vec2 uvMin = vUVTransform.xy;\\r\\n  vec2 uvScale = vUVTransform.zw;\\r\\n  uv = uvMin + uv * uvScale;\\r\\n\\r\\n  int mapIdx = int(vMapSettings.x);\\r\\n  outColor = texture(map, vec3(uv, mapIdx)) * vColor;\\r\\n  if(outColor.a == 0.0) {\\r\\n      discard;\\r\\n  }\\r\\n\\r\\n  bool hubs_HighlightInteractorOne = instanceData.hubs_SweepParams[vInstance].z > 0.0;\\r\\n  bool hubs_HighlightInteractorTwo = instanceData.hubs_SweepParams[vInstance].w > 0.0;\\r\\n  bool hubs_IsFrozen = instanceData.hubs_IsFrozen;\\r\\n\\r\\n  if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\r\\n\\r\\n      bool hubs_EnableSweepingEffect = true;\\r\\n      vec2 hubs_SweepParams = instanceData.hubs_SweepParams[vInstance].xy;\\r\\n      float hubs_Time = instanceData.hubs_Time;\\r\\n\\r\\n      float ratio = 0.0;\\r\\n      float size = hubs_SweepParams.t - hubs_SweepParams.s;\\r\\n\\r\\n      if (hubs_EnableSweepingEffect) {\\r\\n          float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\r\\n\\r\\n          if (hubs_WorldPosition.y < line) {\\r\\n              // Highlight with a sweeping gradient.\\r\\n              ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\r\\n          }\\r\\n      }\\r\\n\\r\\n      // Highlight with a gradient falling off with distance.\\r\\n      float pulse = 1.0 / (size + 0.2) * 8.0 + 1.0 / (size + 0.3) * 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\r\\n\\r\\n      if (hubs_HighlightInteractorOne) {\\r\\n          float dist1 = distance(hubs_WorldPosition, instanceData.hubs_InteractorOnePos);\\r\\n          ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\r\\n      }\\r\\n\\r\\n      if (hubs_HighlightInteractorTwo) {\\r\\n          float dist2 = distance(hubs_WorldPosition, instanceData.hubs_InteractorTwoPos);\\r\\n          ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\r\\n      }\\r\\n\\r\\n      ratio = min(1.0, ratio);\\r\\n\\r\\n      // Gamma corrected highlight color\\r\\n      vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\r\\n\\r\\n      outColor = vec4((outColor.rgb * (1.0 - ratio)) + (highlightColor * ratio), outColor.a);\\r\\n  }\\r\\n\\r\\n  float fogType = fogOptions.r;\\r\\n\\r\\n  if (fogType > 0.5) {\\r\\n    float fogFactor = 0.0;\\r\\n\\r\\n    if (fogType < 1.5) {\\r\\n      float fogNear = fogOptions.z;\\r\\n      float fogFar = fogOptions.w;\\r\\n      fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\r\\n    } else {\\r\\n      float fogDensity = fogOptions.y;\\r\\n      fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\\r\\n    }\\r\\n\\r\\n    outColor.rgb = mix( outColor.rgb, fogColor, fogFactor );\\r\\n  }\\r\\n}\\r\\n\"","module.exports = __webpack_public_path__ + \"assets/images/spritesheets/sprite-system-action-spritesheet-63df7c855b130ea65c284bd3f8e98afc.png\";","module.exports = __webpack_public_path__ + \"assets/images/spritesheets/sprite-system-notice-spritesheet-0b7026f818dc58d5d33db88931d02c7a.png\";","module.exports = \"attribute vec4 mvCol0;\\r\\nattribute vec4 mvCol1;\\r\\nattribute vec4 mvCol2;\\r\\nattribute vec4 mvCol3;\\r\\nattribute vec3 a_vertices;\\r\\nattribute vec2 a_uvs;\\r\\nvarying vec2 v_uvs;\\r\\nattribute float a_hubs_EnableSweepingEffect;\\r\\nvarying float v_hubs_EnableSweepingEffect;\\r\\nattribute vec2 a_hubs_SweepParams;\\r\\nvarying vec2 v_hubs_SweepParams;\\r\\nvarying vec3 hubs_WorldPosition;\\r\\n\\r\\nvoid main() {\\r\\n  mat4 mv = mat4(mvCol0, mvCol1, mvCol2, mvCol3);\\r\\n  gl_Position = projectionMatrix * modelViewMatrix * mv * vec4(a_vertices, 1.0);\\r\\n  v_uvs = a_uvs;\\r\\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\\r\\n  v_hubs_SweepParams = a_hubs_SweepParams;\\r\\n\\r\\n  vec4 wt = vec4(a_vertices, 1.0);\\r\\n  hubs_WorldPosition = (mv * wt).xyz;\\r\\n}\\r\\n\"","module.exports = \"precision mediump float;\\r\\n\\r\\nuniform sampler2D u_spritesheet;\\r\\n\\r\\nvarying vec2 v_uvs;\\r\\n\\r\\nvarying float v_hubs_EnableSweepingEffect;\\r\\nvarying vec2 v_hubs_SweepParams;\\r\\nvarying vec3 hubs_WorldPosition;\\r\\nuniform bool hubs_HighlightInteractorOne;\\r\\nuniform vec3 hubs_InteractorOnePos;\\r\\nuniform bool hubs_HighlightInteractorTwo;\\r\\nuniform vec3 hubs_InteractorTwoPos;\\r\\nuniform float hubs_Time;\\r\\n\\r\\n#define GAMMA_FACTOR 2.2\\r\\n\\r\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\r\\n  return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\\r\\n}\\r\\n\\r\\nvec4 linearToOutputTexel( vec4 value ) {\\r\\n  return LinearToGamma( value, float( GAMMA_FACTOR ) );\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\\r\\n\\r\\n    float ratio = 0.0;\\r\\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\\r\\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\\r\\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\\r\\n        if (hubs_WorldPosition.y < line) {\\r\\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\r\\n        }\\r\\n\\r\\n    }\\r\\n    ratio = min(1.0, ratio);\\r\\n\\r\\n    vec4 highlightColor = linearToOutputTexel(vec4(0.184, 0.499, 0.933, 1.0));\\r\\n    gl_FragColor = vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a);\\r\\n}\\r\\n\"","import qsTruthy from \"./qs_truthy\";\r\n\r\nconst showLog = qsTruthy(\"debug_log\");\r\n\r\nif (showLog) {\r\n  const template = document.createElement(\"template\");\r\n  template.innerHTML = `\r\n    <style>\r\n      #debug-log {\r\n        position: absolute;\r\n        top: 13em;\r\n        background: white;\r\n        opacity: 0.7;\r\n        z-index: 1000;\r\n      }\r\n      #debug-log, #debug-log-input {\r\n        font-family: monospace;\r\n        font-size: 11px;\r\n        width: 100%;\r\n      }\r\n\r\n      #debug-log-controls {\r\n        display: flex;\r\n        padding: 0.2em;\r\n      }\r\n\r\n      #debug-log-eval {\r\n        display: flex;\r\n        flex: 1;\r\n      }\r\n\r\n      #debug-log-log {\r\n        overflow: auto;\r\n        height: 30vh;\r\n      }\r\n      #debug-log-log.minimized {\r\n        height: auto;\r\n      }\r\n      #debug-log-log.minimized .entry {\r\n        display: none;\r\n      }\r\n      #debug-log-log.minimized .entry:last-child {\r\n        display: block;\r\n      }\r\n      #debug-log-log .entry {\r\n        border: 1px solid grey;\r\n        margin: 0.2em;\r\n        padding: 0.2em;\r\n      }\r\n      #debug-log-log .entry.error { background-color: pink; }\r\n      #debug-log-log .entry.warn { background-color: orange; }\r\n    </style>\r\n    <div id=\"debug-log\">\r\n        <div id=\"debug-log-controls\">\r\n          <form id=\"debug-log-eval\">\r\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\r\n            <button>&gt;</button>\r\n          </form>\r\n          <button id=\"debug-log-minimize\">_</button>\r\n        </div>\r\n        <div id=\"debug-log-log\"></div>\r\n    </div>\r\n  `;\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", () => {\r\n    document.body.appendChild(template.content);\r\n  });\r\n\r\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\r\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\r\n\r\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\r\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\r\n  debugLogEval.onsubmit = e => {\r\n    e.preventDefault();\r\n    console.log(eval(`(${debugLogInput.value})`));\r\n  };\r\n\r\n  let minimized = false;\r\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\r\n  debugLogMinimize.onclick = () => {\r\n    minimized = !minimized;\r\n    debugLog.className = minimized ? \"minimized\" : \"\";\r\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\r\n  };\r\n\r\n  const origConsoleInfo = console.info;\r\n  const origConsoleLog = console.log;\r\n  const origConsoleError = console.error;\r\n  const origConsoleWarn = console.warn;\r\n\r\n  const log = function(className, objs) {\r\n    let entry;\r\n    if (debugLog.childNodes.length > 1000) {\r\n      entry = debugLog.firstChild;\r\n    } else {\r\n      entry = document.createElement(\"div\");\r\n      entry.classList.add(\"entry\");\r\n    }\r\n    entry.classList.remove(\"warn\", \"error\");\r\n    entry.classList.add(className);\r\n\r\n    const arr = Array.from(objs);\r\n    const firstObj = arr[0];\r\n    let content;\r\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\r\n      content = firstObj.replace(/%c/g, \"\");\r\n    } else if (firstObj instanceof Error) {\r\n      content = `${firstObj.message}\\n${firstObj.stack}`;\r\n    } else {\r\n      content = arr\r\n        .map(obj => {\r\n          if (typeof obj === \"string\") return obj;\r\n          return JSON.stringify(obj);\r\n        })\r\n        .join(\" \");\r\n    }\r\n\r\n    const time = new Date().toISOString().substring(11, 23);\r\n    entry.textContent = `[${time}] ${content}`;\r\n\r\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\r\n    debugLog.append(entry);\r\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\r\n  };\r\n\r\n  console.warn = function() {\r\n    origConsoleWarn.apply(null, arguments);\r\n    log(\"warn\", arguments);\r\n  };\r\n\r\n  console.error = function() {\r\n    origConsoleError.apply(null, arguments);\r\n    log(\"error\", arguments);\r\n  };\r\n\r\n  console.log = function() {\r\n    origConsoleLog.apply(null, arguments);\r\n    log(\"log\", arguments);\r\n  };\r\n\r\n  console.info = function() {\r\n    origConsoleInfo.apply(null, arguments);\r\n    log(\"info\", arguments);\r\n  };\r\n\r\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\r\n  window.onerror = e => log(\"error\", [e]);\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ui\":\"hub__ui__pgoMN\",\"ui-dialog\":\"hub__ui-dialog__Ak7tl\",\"uiDialog\":\"hub__ui-dialog__Ak7tl\",\"ui-interactive\":\"hub__ui-interactive__qK0OX\",\"uiInteractive\":\"hub__ui-interactive__qK0OX\",\"object-list\":\"hub__object-list__3U63N\",\"objectList\":\"hub__object-list__3U63N\",\"presence-info\":\"hub__presence-info__2BAFd\",\"presenceInfo\":\"hub__presence-info__2BAFd\",\"corner-button\":\"hub__corner-button__2pPS3\",\"cornerButton\":\"hub__corner-button__2pPS3\",\"profile-entry\":\"hub__profile-entry__1S9EW\",\"profileEntry\":\"hub__profile-entry__1S9EW\",\"form-submit\":\"hub__form-submit__1Deud\",\"formSubmit\":\"hub__form-submit__1Deud\",\"nag-corner-button\":\"hub__nag-corner-button__6Gq-K\",\"nagCornerButton\":\"hub__nag-corner-button__6Gq-K\",\"choose-scene-button\":\"hub__choose-scene-button__2oKSu\",\"chooseSceneButton\":\"hub__choose-scene-button__2oKSu\",\"choose-avatar\":\"hub__choose-avatar__39Vsn\",\"chooseAvatar\":\"hub__choose-avatar__39Vsn\",\"entry-button-secondary\":\"hub__entry-button-secondary__2R5P7\",\"entryButtonSecondary\":\"hub__entry-button-secondary__2R5P7\",\"entry-panel\":\"hub__entry-panel__2Eo1-\",\"entryPanel\":\"hub__entry-panel__2Eo1-\",\"button-container\":\"hub__button-container__1nJnb\",\"buttonContainer\":\"hub__button-container__1nJnb\",\"secondary-action-button\":\"hub__secondary-action-button__162JJ\",\"secondaryActionButton\":\"hub__secondary-action-button__162JJ\",\"leave-button\":\"hub__leave-button__1ElRU\",\"leaveButton\":\"hub__leave-button__1ElRU\",\"interstitial\":\"hub__interstitial__2eHL1\",\"entry-button\":\"hub__entry-button__1f-Xy\",\"entryButton\":\"hub__entry-button__1f-Xy\",\"action-button\":\"hub__action-button__2gUGB\",\"actionButton\":\"hub__action-button__2gUGB\",\"collapse-button\":\"hub__collapse-button__wcPy4\",\"collapseButton\":\"hub__collapse-button__wcPy4\",\"favorite-button\":\"hub__favorite-button__2b3Do\",\"favoriteButton\":\"hub__favorite-button__2b3Do\",\"back\":\"hub__back__3ncWD\",\"form-field-text\":\"hub__form-field-text__1fWQz\",\"formFieldText\":\"hub__form-field-text__1fWQz\",\"lobby-label\":\"hub__lobby-label__kNBf9\",\"lobbyLabel\":\"hub__lobby-label__kNBf9\",\"label\":\"hub__label__Vfjn7\",\"title\":\"hub__title__1OPRp\",\"name\":\"hub__name__3hNYt\",\"rename-button\":\"hub__rename-button__2ygnT\",\"renameButton\":\"hub__rename-button__2ygnT\",\"center\":\"hub__center__BWAyA\",\"wide-button\":\"hub__wide-button__2OoRR\",\"wideButton\":\"hub__wide-button__2OoRR\",\"screen-sharing\":\"hub__screen-sharing__BRwnB\",\"screenSharing\":\"hub__screen-sharing__BRwnB\",\"checkbox\":\"hub__checkbox__BYAPx\",\"close\":\"hub__close__3996n\",\"invite-tip\":\"hub__invite-tip__2wywh\",\"inviteTip\":\"hub__invite-tip__2wywh\",\"loading-text\":\"hub__loading-text__3Qa06\",\"loadingText\":\"hub__loading-text__3Qa06\",\"streaming-tip\":\"hub__streaming-tip__2j8qR\",\"streamingTip\":\"hub__streaming-tip__2j8qR\",\"streaming-tip-attach-point\":\"hub__streaming-tip-attach-point__tSMh3\",\"streamingTipAttachPoint\":\"hub__streaming-tip-attach-point__tSMh3\",\"streaming-tip-close\":\"hub__streaming-tip-close__3Tgkp\",\"streamingTipClose\":\"hub__streaming-tip-close__3Tgkp\",\"streaming-tip-message\":\"hub__streaming-tip-message__3MoEP\",\"streamingTipMessage\":\"hub__streaming-tip-message__3MoEP\",\"ui-dialog-box-contents\":\"hub__ui-dialog-box-contents__3cXTf\",\"uiDialogBoxContents\":\"hub__ui-dialog-box-contents__3cXTf\",\"backgrounded\":\"hub__backgrounded__3FEjb\",\"in-room-favorite-button\":\"hub__in-room-favorite-button__2idpt\",\"inRoomFavoriteButton\":\"hub__in-room-favorite-button__2idpt\",\"help-button\":\"hub__help-button__1HLgx\",\"helpButton\":\"hub__help-button__1HLgx\",\"occupant-count\":\"hub__occupant-count__qFwOJ\",\"occupantCount\":\"hub__occupant-count__qFwOJ\",\"presence-info-selected\":\"hub__presence-info-selected__2pV0r\",\"presenceInfoSelected\":\"hub__presence-info-selected__2pV0r\",\"camera-mode-exit-button\":\"hub__camera-mode-exit-button__3brlu\",\"cameraModeExitButton\":\"hub__camera-mode-exit-button__3brlu\",\"corner-button-selected\":\"hub__corner-button-selected__t9jt6\",\"cornerButtonSelected\":\"hub__corner-button-selected__t9jt6\",\"invite-tip-attach-point\":\"hub__invite-tip-attach-point__2zxRI\",\"inviteTipAttachPoint\":\"hub__invite-tip-attach-point__2zxRI\",\"avatar-editor\":\"hub__avatar-editor__3hHmJ\",\"avatarEditor\":\"hub__avatar-editor__3hHmJ\",\"logo\":\"hub__logo__1e4o1\",\"form\":\"hub__form__1G2iQ\",\"box\":\"hub__box__3GFv5\",\"links\":\"hub__links__1atZb\",\"display-name\":\"hub__display-name__2wr08\",\"displayName\":\"hub__display-name__2wr08\",\"preview\":\"hub__preview__2cpNi\",\"edit-avatar\":\"hub__edit-avatar__K-Dcd\",\"editAvatar\":\"hub__edit-avatar__K-Dcd\",\"entry-dialog\":\"hub__entry-dialog__1fsVG\",\"entryDialog\":\"hub__entry-dialog__1fsVG\",\"favorited\":\"hub__favorited__3KVcZ\",\"icon\":\"hub__icon__28RYE\",\"bolded\":\"hub__bolded__ZJ7OA\",\"subtitle\":\"hub__subtitle__vweyD\",\"room-subtitle\":\"hub__room-subtitle__3EN0O\",\"roomSubtitle\":\"hub__room-subtitle__3EN0O\",\"lobby\":\"hub__lobby__iE459\",\"profile-icon\":\"hub__profile-icon__1REYn\",\"profileIcon\":\"hub__profile-icon__1REYn\",\"button-subtitle\":\"hub__button-subtitle__2oDTx\",\"buttonSubtitle\":\"hub__button-subtitle__2oDTx\",\"audio-loader\":\"hub__audio-loader__W-L8o\",\"audioLoader\":\"hub__audio-loader__W-L8o\",\"webvr-link-container\":\"hub__webvr-link-container__4MCS0\",\"webvrLinkContainer\":\"hub__webvr-link-container__4MCS0\",\"webvr-link\":\"hub__webvr-link__1mRHO\",\"webvrLink\":\"hub__webvr-link__1mRHO\",\"secondary\":\"hub__secondary__2TxMu\"};","/**\r\n * Chrome and Safari will start Audio contexts in a \"suspended\" state.\r\n * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\r\n */\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const ctx = THREE.AudioContext.getContext();\r\n\r\n  function resume() {\r\n    ctx.resume();\r\n\r\n    setTimeout(function() {\r\n      if (ctx.state === \"running\") {\r\n        document.body.removeEventListener(\"touchend\", resume, false);\r\n        document.body.removeEventListener(\"mouseup\", resume, false);\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  document.body.addEventListener(\"touchend\", resume, false);\r\n  document.body.addEventListener(\"mouseup\", resume, false);\r\n});\r\n","// Monkeypatch to address performance issue with updating panner nodes\r\n// TODO this needs to be merged into 3.js\r\n\r\nTHREE.PositionalAudio.prototype.updateMatrixWorld = (function() {\r\n  const position = new THREE.Vector3();\r\n  const quaternion = new THREE.Quaternion();\r\n\r\n  const scale = new THREE.Vector3();\r\n  const orientation = new THREE.Vector3();\r\n\r\n  return function updateMatrixWorld(force) {\r\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\r\n\r\n    let setInitial = false;\r\n\r\n    if (!this._lastPosition) {\r\n      setInitial = true;\r\n      this._lastPosition = new THREE.Vector3();\r\n      this._lastOrientation = new THREE.Vector3();\r\n      this._lastListenerPosition = new THREE.Vector3();\r\n    }\r\n\r\n    const panner = this.panner;\r\n    const listener = panner.context.listener;\r\n    this.matrixWorld.decompose(position, quaternion, scale);\r\n    orientation.set(0, 0, 1).applyQuaternion(quaternion);\r\n\r\n    // Need to update the position on this node if either the listener moves or this node moves,\r\n    // because otherwise there are audio artifacts in Chrome.\r\n    if (\r\n      setInitial ||\r\n      Math.abs(position.x - this._lastPosition.x) > Number.EPSILON ||\r\n      Math.abs(position.y - this._lastPosition.y) > Number.EPSILON ||\r\n      Math.abs(position.z - this._lastPosition.z) > Number.EPSILON ||\r\n      Math.abs(orientation.x - this._lastOrientation.x) > Number.EPSILON ||\r\n      Math.abs(orientation.y - this._lastOrientation.y) > Number.EPSILON ||\r\n      Math.abs(orientation.z - this._lastOrientation.z) > Number.EPSILON ||\r\n      (listener.positionX && Math.abs(listener.positionX.value - this._lastListenerPosition.x) > Number.EPSILON) ||\r\n      (listener.positionY && Math.abs(listener.positionY.value - this._lastListenerPosition.y) > Number.EPSILON) ||\r\n      (listener.positionZ && Math.abs(listener.positionZ.value - this._lastListenerPosition.z) > Number.EPSILON)\r\n    ) {\r\n      panner.setPosition(position.x, position.y, position.z);\r\n      panner.setOrientation(orientation.x, orientation.y, orientation.z);\r\n\r\n      this._lastPosition.x = position.x;\r\n      this._lastPosition.y = position.y;\r\n      this._lastPosition.z = position.z;\r\n\r\n      this._lastOrientation.x = orientation.x;\r\n      this._lastOrientation.y = orientation.y;\r\n      this._lastOrientation.z = orientation.z;\r\n\r\n      if (listener.positionX && listener.positionY && listener.positionZ) {\r\n        this._lastListenerPosition.x = listener.positionX.value;\r\n        this._lastListenerPosition.y = listener.positionY.value;\r\n        this._lastListenerPosition.z = listener.positionZ.value;\r\n      }\r\n    }\r\n  };\r\n})();\r\n","AFRAME.registerComponent(\"scale-in-screen-space\", {\r\n  schema: {\r\n    baseScale: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\r\n    addedScale: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } }\r\n  },\r\n\r\n  play() {\r\n    if (!this.didRegister) {\r\n      this.didRegister = true;\r\n      this.el.sceneEl.systems[\"hubs-systems\"].scaleInScreenSpaceSystem.register(this);\r\n    }\r\n  },\r\n  remove() {\r\n    if (this.didRegister) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].scaleInScreenSpaceSystem.unregister(this);\r\n    }\r\n  }\r\n});\r\n","/**\r\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\r\n * @namespace avatar\r\n * @component bone-mute-state-indicator\r\n */\r\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\r\n  schema: {\r\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\r\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\r\n    onPos: { default: 0.81 },\r\n    offPos: { default: 0.5 }\r\n  },\r\n\r\n  init() {\r\n    this.onStateToggled = this.onStateToggled.bind(this);\r\n    this.el.addEventListener(\"model-loaded\", () => {\r\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\r\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\r\n      this.modelLoaded = true;\r\n\r\n      this.updateMuteState();\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateToggled);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateToggled);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateToggled);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateToggled);\r\n  },\r\n\r\n  onStateToggled(e) {\r\n    if (!e.detail.state === \"muted\") return;\r\n    this.updateMuteState();\r\n  },\r\n\r\n  updateMuteState() {\r\n    if (!this.modelLoaded) return;\r\n    const muted = this.el.sceneEl.is(\"muted\");\r\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\r\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\r\n    this.mutedBone.matrixNeedsUpdate = true;\r\n    this.unmutedBone.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n","/**\r\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\r\n * @namespace avatar\r\n * @component bone-visibility\r\n */\r\nAFRAME.registerComponent(\"bone-visibility\", {\r\n  tick() {\r\n    const { visible } = this.el.object3D;\r\n\r\n    if (this.lastVisible !== visible) {\r\n      if (visible) {\r\n        this.el.object3D.scale.set(1, 1, 1);\r\n      } else {\r\n        // Three.js doesn't like updating matrices with 0 scale, so we set it to a near zero number.\r\n        this.el.object3D.scale.set(0.00000001, 0.00000001, 0.00000001);\r\n      }\r\n\r\n      this.lastVisible = visible;\r\n      this.el.object3D.updateMatrices(true, true);\r\n      this.el.object3D.updateMatrixWorld(true, true);\r\n    }\r\n  }\r\n});\r\n","/**\r\n * Creates a box around the element (assumed to be the camera's PoV) which can be used for fade-to-black.\r\n */\r\n\r\nconst FADE_DURATION_MS = 750;\r\n\r\nAFRAME.registerComponent(\"fader\", {\r\n  schema: {\r\n    direction: { type: \"string\", default: \"none\" } // \"in\", \"out\", or \"none\"\r\n  },\r\n\r\n  init() {\r\n    const mesh = new THREE.Mesh(\r\n      new THREE.BoxGeometry(),\r\n      new THREE.MeshBasicMaterial({ color: 0x0, side: THREE.BackSide, opacity: 0, transparent: true, fog: false })\r\n    );\r\n    mesh.scale.x = mesh.scale.y = 1;\r\n    mesh.scale.z = 0.15;\r\n    mesh.matrixNeedsUpdate = true;\r\n    this.el.object3D.add(mesh);\r\n    this.mesh = mesh;\r\n  },\r\n\r\n  fadeOut() {\r\n    return this.beginTransition(\"out\");\r\n  },\r\n\r\n  fadeIn() {\r\n    return this.beginTransition(\"in\");\r\n  },\r\n\r\n  async beginTransition(direction) {\r\n    if (this._resolveFinish) {\r\n      throw new Error(\"Cannot fade while a fade is happening.\");\r\n    }\r\n\r\n    this.el.setAttribute(\"fader\", { direction });\r\n\r\n    return new Promise(res => {\r\n      if (this.mesh.material.opacity === (direction == \"in\" ? 0 : 1)) {\r\n        res();\r\n      } else {\r\n        this._resolveFinish = res;\r\n      }\r\n    });\r\n  },\r\n\r\n  tick(t, dt) {\r\n    const mat = this.mesh.material;\r\n    this.mesh.visible = this.data.direction === \"out\" || mat.opacity !== 0;\r\n    if (!this.mesh.visible) return;\r\n\r\n    if (this.data.direction === \"in\") {\r\n      mat.opacity = Math.max(0, mat.opacity - (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\r\n    } else if (this.data.direction === \"out\") {\r\n      mat.opacity = Math.min(1, mat.opacity + (1.0 / FADE_DURATION_MS) * Math.min(dt, 50));\r\n    }\r\n\r\n    if (mat.opacity === 0 || mat.opacity === 1) {\r\n      if (this.data.direction !== \"none\") {\r\n        if (this._resolveFinish) {\r\n          this._resolveFinish();\r\n          this._resolveFinish = null;\r\n        }\r\n      }\r\n\r\n      this.el.setAttribute(\"fader\", { direction: \"none\" });\r\n    }\r\n  }\r\n});\r\n","/**\r\n * A button with an image, tooltip, hover states.\r\n * @namespace ui\r\n * @component icon-button\r\n */\r\nAFRAME.registerComponent(\"icon-button\", {\r\n  schema: {\r\n    image: { type: \"string\" },\r\n    hoverImage: { type: \"string\" },\r\n    activeImage: { type: \"string\" },\r\n    activeHoverImage: { type: \"string\" },\r\n    disabledImage: { type: \"string\" },\r\n    active: { type: \"boolean\" },\r\n    disabled: { type: \"boolean\" },\r\n    tooltip: { type: \"selector\" },\r\n    tooltipText: { type: \"string\" },\r\n    activeTooltipText: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n    this.onHover = () => {\r\n      this.hovering = true;\r\n      if (this.data.tooltip) {\r\n        this.data.tooltip.object3D.visible = true;\r\n      }\r\n      this.updateButtonState();\r\n    };\r\n    this.onHoverOut = () => {\r\n      this.hovering = false;\r\n      if (this.data.tooltip) {\r\n        this.data.tooltip.object3D.visible = false;\r\n      }\r\n      this.updateButtonState();\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.updateButtonState();\r\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  update() {\r\n    this.updateButtonState();\r\n  },\r\n\r\n  updateButtonState() {\r\n    const hovering = this.hovering;\r\n    const active = this.data.active;\r\n    const disabled = this.data.disabled;\r\n\r\n    let image;\r\n    if (disabled) {\r\n      image = \"disabledImage\";\r\n    } else if (active) {\r\n      image = hovering ? \"activeHoverImage\" : \"activeImage\";\r\n    } else {\r\n      image = hovering ? \"hoverImage\" : \"image\";\r\n    }\r\n\r\n    if (this.el.components.sprite) {\r\n      if (this.data[image]) {\r\n        this.el.setAttribute(\"sprite\", \"name\", this.data[image]);\r\n      } else {\r\n        console.warn(`No ${image} image on me.`, this);\r\n      }\r\n    } else {\r\n      console.error(\"No sprite.\");\r\n    }\r\n\r\n    if (this.data.tooltip && hovering) {\r\n      const tooltipText =\r\n        (this.data.active ? this.data.activeTooltipText : this.data.tooltipText) + (disabled ? \" Disabled\" : \"\");\r\n      this.data.tooltip.querySelector(\"[text]\").setAttribute(\"text\", \"value\", tooltipText);\r\n    }\r\n  }\r\n});\r\n","/**\r\n * A button with text\r\n * @namespace ui\r\n * @component text-button\r\n */\r\nAFRAME.registerComponent(\"text-button\", {\r\n  schema: {\r\n    textHoverColor: { type: \"string\" },\r\n    textColor: { type: \"string\" },\r\n    backgroundHoverColor: { type: \"string\" },\r\n    backgroundColor: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n    this.onHover = () => {\r\n      this.hovering = true;\r\n      this.updateButtonState();\r\n    };\r\n    this.onHoverOut = () => {\r\n      this.hovering = false;\r\n      this.updateButtonState();\r\n    };\r\n    this.textEl = this.el.querySelector(\"[text]\");\r\n  },\r\n\r\n  play() {\r\n    this.updateButtonState();\r\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\r\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\r\n  },\r\n\r\n  update() {\r\n    this.updateButtonState();\r\n  },\r\n\r\n  updateButtonState() {\r\n    const hovering = this.hovering;\r\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\r\n\r\n    if (this.textEl) {\r\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\r\n    }\r\n  }\r\n});\r\n\r\nconst noop = function() {};\r\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\r\nAFRAME.registerComponent(\"text-raycast-hack\", {\r\n  dependencies: [\"text\"],\r\n  init() {\r\n    this.el.getObject3D(\"text\").raycast = noop;\r\n  }\r\n});\r\n","/**\r\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\r\n * @namespace network\r\n * @component block-button\r\n */\r\nAFRAME.registerComponent(\"block-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      this.block(this.owner);\r\n    };\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.owner = networkedEl.components.networked.data.owner;\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  block(clientId) {\r\n    window.APP.hubChannel.hide(clientId);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"mute-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      this.mute(this.owner);\r\n    };\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.owner = networkedEl.components.networked.data.owner;\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  async mute(clientId) {\r\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"kick-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      this.kick(this.owner);\r\n    };\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.owner = networkedEl.components.networked.data.owner;\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  async kick(clientId) {\r\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"leave-room-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      this.el.sceneEl.emit(\"leave_room_requested\");\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"visible-if-permitted\", {\r\n  schema: {\r\n    type: \"string\"\r\n  },\r\n  init() {\r\n    this.updateVisibility = this.updateVisibility.bind(this);\r\n    this.updateVisibility();\r\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\r\n  },\r\n  updateVisibility() {\r\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\r\n  },\r\n  remove() {\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"visibility-on-content-types\", {\r\n  schema: {\r\n    contentTypes: { type: \"string\" }, // Space separate content types. Or partial type, like video/\r\n    contentSubtype: { type: \"string\" },\r\n    visible: { type: \"boolean\", default: true }\r\n  },\r\n\r\n  init() {\r\n    this.updateVisibility = this.updateVisibility.bind(this);\r\n\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(el => {\r\n        this.networkedEl = el;\r\n        el.addEventListener(\"media_resolved\", ({ detail: { contentType } }) => this.updateVisibility(contentType));\r\n        this.updateVisibility();\r\n      })\r\n      .catch(() => {\r\n        // Non-networked, do not handle for now.\r\n      });\r\n  },\r\n\r\n  updateVisibility(contentType) {\r\n    const mediaLoader = this.networkedEl.components[\"media-loader\"];\r\n    const mediaImage = this.networkedEl.components[\"media-image\"];\r\n    const mediaVideo = this.networkedEl.components[\"media-video\"];\r\n    const mediaPdf = this.networkedEl.components[\"media-pdf\"];\r\n    const currentContentType =\r\n      contentType ||\r\n      (mediaVideo && mediaVideo.data.contentType) ||\r\n      (mediaImage && mediaImage.data.contentType) ||\r\n      (mediaPdf && mediaPdf.data.contentType);\r\n\r\n    let matchesType = !this.data.contentTypes;\r\n\r\n    if (this.data.contentTypes && currentContentType) {\r\n      for (const contentType of this.data.contentTypes.split(\" \")) {\r\n        const targetContentType = currentContentType.toLowerCase().split(\";\")[0];\r\n\r\n        if (\r\n          targetContentType === contentType ||\r\n          (contentType.endsWith(\"/\") && targetContentType.startsWith(contentType))\r\n        ) {\r\n          matchesType = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    const matchesSubtype =\r\n      !this.data.contentSubtype ||\r\n      (mediaLoader.data.contentSubtype && mediaLoader.data.contentSubtype === this.data.contentSubtype);\r\n    const matches = !!(matchesType && matchesSubtype);\r\n    this.el.object3D.visible = this.data.visible ? matches : !matches;\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"hide-when-pinned-and-forbidden\", {\r\n  schema: {\r\n    // Hide regardless of being forbidden.\r\n    whenPinned: { type: \"boolean\" }\r\n  },\r\n  init() {\r\n    this._updateUI = this._updateUI.bind(this);\r\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n\r\n      this._updateUI();\r\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\r\n    });\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    if (this.targetEl) {\r\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\r\n    }\r\n  },\r\n\r\n  _updateUIOnStateChange(e) {\r\n    if (e.detail !== \"frozen\") return;\r\n    this._updateUI();\r\n  },\r\n\r\n  _updateUI() {\r\n    if (!this.targetEl) return;\r\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\r\n\r\n    if (this.data.whenPinned) {\r\n      this.el.object3D.visible = !isPinned;\r\n    } else {\r\n      const pinnedAndForbidden = isPinned && !window.APP.hubChannel.canOrWillIfCreator(\"pin_objects\");\r\n      this.el.object3D.visible = !pinnedAndForbidden;\r\n    }\r\n  }\r\n});\r\n","/**\r\n * Stores networked avatar state.\r\n * @namespace avatar\r\n * @component networked-avatar\r\n */\r\nAFRAME.registerComponent(\"networked-avatar\", {\r\n  schema: {\r\n    left_hand_pose: { default: 0 },\r\n    right_hand_pose: { default: 0 }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"pinnable\", {\r\n  schema: {\r\n    pinned: { default: false }\r\n  },\r\n\r\n  init() {\r\n    this._fireEventsAndAnimate = this._fireEventsAndAnimate.bind(this);\r\n\r\n    // Fire pinned events when media is refreshed since the version will be bumped.\r\n    this.el.addEventListener(\"media_refreshed\", this._fireEventsAndAnimate);\r\n\r\n    // Fire pinned events when page changes so we can persist the page.\r\n    this.el.addEventListener(\"owned-pager-page-changed\", this._fireEventsAndAnimate);\r\n\r\n    // Fire pinned events when video state changes so we can persist the page.\r\n    this.el.addEventListener(\"owned-video-state-changed\", this._fireEventsAndAnimate);\r\n  },\r\n\r\n  update(oldData) {\r\n    this._fireEventsAndAnimate(oldData);\r\n  },\r\n\r\n  _fireEventsAndAnimate(oldData, force) {\r\n    // We need to guard against _fireEventsAndAnimate being called during entity initialization,\r\n    // when the networked component isn't initialized yet.\r\n    if (!this.el.components.networked || !this.el.components.networked.data) return;\r\n\r\n    const isMine = NAF.utils.isMine(this.el);\r\n\r\n    // Avoid firing events during initialization by checking if the pin state has changed before doing so.\r\n    const pinStateChanged = !!oldData.pinned !== this.data.pinned;\r\n\r\n    if (this.data.pinned) {\r\n      if (pinStateChanged || force) {\r\n        this.el.emit(\"pinned\", { el: this.el });\r\n      }\r\n\r\n      if (isMine) {\r\n        this.el.removeAttribute(\"animation__pin-start\");\r\n        this.el.removeAttribute(\"animation__pin-end\");\r\n        const currentScale = this.el.object3D.scale;\r\n\r\n        this.el.setAttribute(\"animation__pin-start\", {\r\n          property: \"scale\",\r\n          dur: 200,\r\n          from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\r\n          to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n\r\n        this.el.setAttribute(\"animation__pin-end\", {\r\n          property: \"scale\",\r\n          delay: 200,\r\n          dur: 200,\r\n          from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\r\n          to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n\r\n        if (this.el.components[\"body-helper\"] && !this.el.sceneEl.systems.interaction.isHeld(this.el)) {\r\n          this.el.setAttribute(\"body-helper\", { type: \"kinematic\" });\r\n        }\r\n      }\r\n    } else {\r\n      if (pinStateChanged || force) {\r\n        this.el.emit(\"unpinned\", { el: this.el });\r\n      }\r\n    }\r\n  },\r\n\r\n  isHeld(el) {\r\n    const { leftHand, rightHand, rightRemote } = el.sceneEl.systems.interaction.state;\r\n    return leftHand.held === el || rightHand.held === el || rightRemote.held === el;\r\n  },\r\n\r\n  tick() {\r\n    const held = this.isHeld(this.el);\r\n    const isMine = this.el.components.networked && this.el.components.networked.data && NAF.utils.isMine(this.el);\r\n\r\n    let didFireThisFrame = false;\r\n    if (!held && this.wasHeld && isMine) {\r\n      didFireThisFrame = true;\r\n      this._fireEventsAndAnimate(this.data, true);\r\n    }\r\n\r\n    this.wasHeld = held;\r\n\r\n    this.transformObjectSystem = this.transformObjectSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\r\n    const transforming = this.transformObjectSystem.transforming && this.transformObjectSystem.target.el === this.el;\r\n    if (!didFireThisFrame && !transforming && this.wasTransforming && isMine) {\r\n      this._fireEventsAndAnimate(this.data, true);\r\n    }\r\n    this.wasTransforming = transforming;\r\n  }\r\n});\r\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nAFRAME.registerComponent(\"drop-object-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\r\n\r\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\r\n      this.targetEl.setAttribute(\"body-helper\", {\r\n        type: \"dynamic\",\r\n        gravity: { x: 0, y: -9.8, z: 0 },\r\n        angularDamping: 0.01,\r\n        linearDamping: 0.01,\r\n        linearSleepingThreshold: 1.6,\r\n        angularSleepingThreshold: 2.5,\r\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\r\n      });\r\n\r\n      const physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n      if (this.targetEl.components[\"body-helper\"].uuid) {\r\n        physicsSystem.activateBody(this.targetEl.components[\"body-helper\"].uuid);\r\n      }\r\n\r\n      // Remove drop button after using it\r\n      this.el.parentNode.removeChild(this.el);\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"remove-networked-object-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\r\n\r\n      this.targetEl.setAttribute(\"animation__remove\", {\r\n        property: \"scale\",\r\n        dur: 200,\r\n        to: { x: 0.01, y: 0.01, z: 0.01 },\r\n        easing: \"easeInQuad\"\r\n      });\r\n\r\n      this.el.parentNode.removeAttribute(\"visibility-while-frozen\");\r\n      this.el.parentNode.setAttribute(\"visible\", false);\r\n\r\n      this.targetEl.addEventListener(\"animationcomplete\", () => {\r\n        NAF.utils.takeOwnership(this.targetEl);\r\n        this.targetEl.parentNode.removeChild(this.targetEl);\r\n      });\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"camera-focus-button\", {\r\n  schema: {\r\n    track: { default: false },\r\n    selector: { default: null }\r\n  },\r\n\r\n  init() {\r\n    this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      if (this.data.selector) {\r\n        this.targetEl = networkedEl.querySelector(this.data.selector);\r\n      } else {\r\n        this.targetEl = networkedEl;\r\n      }\r\n    });\r\n\r\n    this.onClick = () => {\r\n      const myCamera = this.cameraSystem.getMyCamera();\r\n      if (!myCamera) return;\r\n\r\n      myCamera.components[\"camera-tool\"].focus(this.targetEl, this.data.track);\r\n    };\r\n  },\r\n\r\n  tick() {\r\n    const isVisible = this.el.object3D.visible;\r\n    const shouldBeVisible = !!(this.cameraSystem && this.cameraSystem.getMyCamera());\r\n\r\n    if (isVisible !== shouldBeVisible) {\r\n      this.el.setAttribute(\"visible\", shouldBeVisible);\r\n    }\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","/**\r\n * Toggles the visibility of this entity based on networked ownership\r\n * @namespace ui\r\n * @component visible-to-owner\r\n */\r\nAFRAME.registerComponent(\"visible-to-owner\", {\r\n  init() {\r\n    this.onStateChange = e => {\r\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\r\n    };\r\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\r\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\r\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\r\n    });\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"emit-state-change\", {\r\n  multiple: true,\r\n  schema: {\r\n    state: { type: \"string\" },\r\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\r\n    event: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this.stateadded = this.stateadded.bind(this);\r\n    this.stateremoved = this.stateremoved.bind(this);\r\n  },\r\n\r\n  stateadded(e) {\r\n    if (e.detail === this.data.state) {\r\n      this.el.emit(this.data.event);\r\n    }\r\n  },\r\n  stateremoved(e) {\r\n    if (e.detail === this.data.state) {\r\n      this.el.emit(this.data.event);\r\n    }\r\n  },\r\n\r\n  update() {\r\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\r\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\r\n\r\n    if (this.data.transform === \"rising\") {\r\n      this.el.addEventListener(\"stateadded\", this.stateadded);\r\n    }\r\n    if (this.data.transform === \"falling\") {\r\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"action-to-event\", {\r\n  multiple: true,\r\n\r\n  schema: {\r\n    path: { type: \"string\" },\r\n    event: { type: \"string\" },\r\n    withPermission: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this.needsPermission = !!this.data.withPermission;\r\n    this.updatePermissions = () => {\r\n      if (!this.needsPermission || !window.APP.hubChannel) return;\r\n      this.hasPermission = window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions);\r\n    this.updatePermissions();\r\n  },\r\n\r\n  pause() {\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updatePermissions);\r\n  },\r\n\r\n  tick() {\r\n    if (this.needsPermission && !this.hasPermission) return;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    if (userinput.get(this.data.path)) {\r\n      this.el.emit(this.data.event);\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"action-to-remove\", {\r\n  multiple: true,\r\n\r\n  schema: {\r\n    path: { type: \"string\" },\r\n    requireOwnership: { type: \"boolean\", default: true }\r\n  },\r\n\r\n  init() {\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.networkedEl = networkedEl;\r\n    });\r\n  },\r\n\r\n  tick() {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    if (!userinput.get(this.data.path)) return;\r\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\r\n\r\n    this.el.parentNode.removeChild(this.el);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\r\n  schema: {\r\n    event: { default: null }\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.event) {\r\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"follow-in-fov\", {\r\n  schema: {\r\n    target: { type: \"selector\" },\r\n    offset: { type: \"vec3\" },\r\n    speed: { type: \"number\", default: 0.003 },\r\n    angle: { type: \"number\", default: 45 }\r\n  },\r\n\r\n  init() {\r\n    this.targetPos = new THREE.Vector3();\r\n    this.offset = new THREE.Vector3();\r\n    this.offset.copy(this.data.offset);\r\n\r\n    this.snappedRot = new THREE.Euler();\r\n    this.snappedQ = new THREE.Quaternion();\r\n    this.snappedXForm = new THREE.Matrix4();\r\n    this.snappedXFormWorld = new THREE.Matrix4();\r\n    this.tempVector = new THREE.Vector3();\r\n  },\r\n\r\n  tick(t, dt) {\r\n    if (!this.el.object3D.visible) return;\r\n    if (!this.data.target) return;\r\n\r\n    const obj = this.el.object3D;\r\n    const target = this.data.target.object3D;\r\n\r\n    // Slow updating position if the element or any subelement is hovered.\r\n    let isHovered = false;\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n\r\n    const hoveredEl = interaction.state.rightRemote.hovered || interaction.state.leftRemote.hovered;\r\n\r\n    if (hoveredEl) {\r\n      let el = hoveredEl;\r\n\r\n      while (el) {\r\n        if (this.el === el) {\r\n          isHovered = true;\r\n          break;\r\n        }\r\n\r\n        el = el.parentNode;\r\n      }\r\n    }\r\n\r\n    if (!isHovered) {\r\n      this._hoveredFrames = 0;\r\n    } else {\r\n      this._hoveredFrames += 1;\r\n    }\r\n\r\n    // Compute position + rotation by projecting offset along a downward ray in target space,\r\n    // and mask out Z rotation.\r\n    this._applyMaskedTargetRotation(\r\n      -this.data.angle * THREE.Math.DEG2RAD,\r\n      target.rotation.y,\r\n      0,\r\n      this.snappedXFormWorld\r\n    );\r\n\r\n    this.targetPos.copy(this.offset);\r\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\r\n\r\n    if (obj.parent) {\r\n      obj.parent.worldToLocal(this.targetPos);\r\n    }\r\n\r\n    if (!this.started) {\r\n      obj.position.copy(this.targetPos);\r\n      this.started = true;\r\n    } else {\r\n      // Slow down movement if hovering by dampening speed each frame.\r\n      const speed = this._hoveredFrames\r\n        ? this.data.speed * (1.0 / ((this._hoveredFrames + 5.0) * 0.2))\r\n        : this.data.speed;\r\n      const t = speed * dt;\r\n\r\n      obj.position.set(\r\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\r\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\r\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\r\n      );\r\n    }\r\n\r\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\r\n    obj.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  reset() {\r\n    this.started = false;\r\n  },\r\n\r\n  _applyMaskedTargetRotation(x, y, z, to) {\r\n    const target = this.data.target.object3D;\r\n    this.snappedRot.set(x, y, z, target.rotation.order);\r\n    this.snappedQ.setFromEuler(this.snappedRot);\r\n\r\n    this.snappedXForm.compose(\r\n      target.position,\r\n      this.snappedQ,\r\n      target.scale\r\n    );\r\n\r\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"matrix-auto-update\", {\r\n  schema: {\r\n    target: { type: \"string\" }\r\n  },\r\n\r\n  init: function() {\r\n    this._updateMatrixAutoUpdate = this._updateMatrixAutoUpdate.bind(this);\r\n    this._updateMatrixAutoUpdate();\r\n  },\r\n\r\n  play: function() {\r\n    this.el.sceneEl.addEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\r\n  },\r\n\r\n  pause: function() {\r\n    this.el.sceneEl.removeEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\r\n  },\r\n\r\n  _updateMatrixAutoUpdate: function() {\r\n    if (this.data.target) {\r\n      this.el.getObject3D(this.data.target).matrixAutoUpdate = true;\r\n    } else {\r\n      this.el.object3D.matrixAutoUpdate = true;\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"hover-menu\", {\r\n  multiple: true,\r\n  schema: {\r\n    template: { type: \"selector\" },\r\n    dirs: { type: \"array\" },\r\n    dim: { default: true },\r\n    withPermission: { type: \"string\" }\r\n  },\r\n\r\n  async init() {\r\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\r\n    this.hovering = false;\r\n    await this.getHoverMenu();\r\n    this.applyHoverState();\r\n  },\r\n\r\n  getHoverMenu() {\r\n    if (this.menuPromise) return this.menuPromise;\r\n    return (this.menuPromise = new Promise(resolve => {\r\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\r\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\r\n      setTimeout(() => {\r\n        this.menu = menu;\r\n\r\n        // HACK workaround for now due to position-at-box-shape-border having problems\r\n        // with nested entities, when using 'mirror' viewing.\r\n        //\r\n        // TODO Revisit once that component is removed/deprecated. If we disable repositioning,\r\n        // the menu will only appear on the front of the object (which is fine for our purposes)\r\n        const isMirroredMedia = this.el.parentEl.id === \"media-mirror-target\";\r\n        const enableRepositioning = !isMirroredMedia;\r\n\r\n        if (enableRepositioning) {\r\n          this.el.setAttribute(\"position-at-box-shape-border\", {\r\n            target: \".hover-container\",\r\n            dirs: this.data.dirs,\r\n            animate: false,\r\n            scale: false\r\n          });\r\n        } else {\r\n          const hoverContainer = this.el.querySelector(\".hover-container\");\r\n          hoverContainer.object3D.position.z = 0.001;\r\n          hoverContainer.object3D.matrixNeedsUpdate = true;\r\n        }\r\n\r\n        resolve(this.menu);\r\n      });\r\n    }));\r\n  },\r\n\r\n  onFrozenStateChange(e) {\r\n    if (!e.detail === \"frozen\") return;\r\n    this.applyHoverState();\r\n  },\r\n\r\n  applyHoverState() {\r\n    if (!this.menu) return;\r\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\r\n    this.menu.object3D.visible = allowed && !this.el.sceneEl.is(\"frozen\") && this.hovering;\r\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\r\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\r\n    }\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\r\n  init() {\r\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"set-active-camera\", {\r\n  init() {\r\n    // This is a hack needed to set the active camera because sometimes A-Frame will create the default camera and set it to the active camera on startup because the query selector to find an existing camera in the scene fails.\r\n\r\n    const cameraSystem = this.el.sceneEl.systems.camera;\r\n    const currentActiveCamera = cameraSystem.activeCameraEl;\r\n\r\n    if (currentActiveCamera !== this.el) {\r\n      cameraSystem.setActiveCamera(this.el);\r\n\r\n      // Also A-Frame fails to delete the default camera :P\r\n      currentActiveCamera.parentNode.removeChild(currentActiveCamera);\r\n\r\n      // Look controls leaves behind this CSS class.\r\n      this.el.sceneEl.canvas.classList.remove(\"a-grab-cursor\");\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"track-pose\", {\r\n  schema: {\r\n    path: { type: \"string\" }\r\n  },\r\n\r\n  play() {\r\n    if (!this.didRegister) {\r\n      this.didRegister = true;\r\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.register(this.el.object3D, this.data.path);\r\n    }\r\n  },\r\n  remove() {\r\n    if (this.didRegister) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].cursorPoseTrackingSystem.unregister(this.el.object3D);\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"replay\", {\r\n  init: function() {\r\n    this.playhead = 0;\r\n    this.poseIndex = 0;\r\n  },\r\n\r\n  tick: function(t, dt) {\r\n    let overflow = false;\r\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\r\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\r\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n      this.poseIndex += 1;\r\n      overflow = this.poseIndex === this.poses.length;\r\n    }\r\n\r\n    this.playhead += dt;\r\n\r\n    if (overflow) {\r\n      this.playhead = 0;\r\n      this.poseIndex = 0;\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"visibility-by-path\", {\r\n  schema: {\r\n    path: { type: \"string\" }\r\n  },\r\n  tick() {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const shouldBeVisible = !!userinput.get(this.data.path);\r\n    if (this.el.object3D.visible !== shouldBeVisible) {\r\n      this.el.setAttribute(\"visible\", shouldBeVisible);\r\n    }\r\n  }\r\n});\r\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\n// Billboard component that only updates visible objects and only those in the camera view on mobile VR.\r\nAFRAME.registerComponent(\"billboard\", {\r\n  init: function() {\r\n    this.target = new THREE.Vector3();\r\n    this._updateBillboard = this._updateBillboard.bind(this);\r\n    this._updateIsInView = this._updateIsInView.bind(this);\r\n\r\n    if (isMobileVR) {\r\n      this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateIsInView, \"billboards\");\r\n    }\r\n  },\r\n  remove() {\r\n    if (isMobileVR) {\r\n      this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateIsInView, \"billboards\");\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    if (this.isInView || !isMobileVR) {\r\n      this._updateBillboard();\r\n    }\r\n  },\r\n\r\n  _updateIsInView: (function() {\r\n    const frustum = new THREE.Frustum();\r\n    const frustumMatrix = new THREE.Matrix4();\r\n    const box = new THREE.Box3();\r\n    const boxTemp = new THREE.Box3();\r\n\r\n    const expandBox = o => {\r\n      if (o.geometry) {\r\n        o.updateMatrices();\r\n        o.geometry.computeBoundingBox();\r\n        boxTemp.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld);\r\n        box.expandByPoint(boxTemp.min);\r\n        box.expandByPoint(boxTemp.max);\r\n      }\r\n    };\r\n\r\n    const isInViewOfCamera = (obj, screenCamera) => {\r\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\r\n      frustum.setFromMatrix(frustumMatrix);\r\n      box.makeEmpty();\r\n      obj.traverse(expandBox);\r\n\r\n      // NOTE: not using box.setFromObject here because text nodes do not have Z values in their geometry buffer,\r\n      // and that routine ultimately assumes they do.\r\n      return frustum.intersectsBox(box);\r\n    };\r\n\r\n    return function() {\r\n      if (!this.el.object3D.visible) {\r\n        this.isInView = false;\r\n        return;\r\n      }\r\n\r\n      if (!this.playerCamera) {\r\n        this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\r\n      }\r\n\r\n      if (!this.playerCamera) return;\r\n\r\n      this.isInView = this.el.sceneEl.is(\"vr-mode\") ? true : isInViewOfCamera(this.el.object3D, this.playerCamera);\r\n\r\n      if (!this.isInView) {\r\n        // Check in-game camera if rendering to viewfinder and owned\r\n        const cameraTools = this.el.sceneEl.systems[\"camera-tools\"];\r\n\r\n        if (cameraTools) {\r\n          cameraTools.ifMyCameraRenderingViewfinder(cameraTool => {\r\n            this.isInView = this.isInView || isInViewOfCamera(this.el.object3D, cameraTool.camera);\r\n          });\r\n        }\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _updateBillboard: function() {\r\n    if (!this.el.object3D.visible) return;\r\n\r\n    const camera = this.el.sceneEl.camera;\r\n    const object3D = this.el.object3D;\r\n\r\n    if (camera) {\r\n      // Set the camera world position as the target.\r\n      this.target.setFromMatrixPosition(camera.matrixWorld);\r\n      object3D.lookAt(this.target);\r\n      object3D.matrixNeedsUpdate = true;\r\n    }\r\n  }\r\n});\r\n","const SYNC_DURATION_MS = 5000;\r\n\r\n// HACK this is a hacky component that is used to mitigate the situation where a first sync is missed on critical\r\n// networked elements. (At the time of this writing, specifically just the user's avatar.) The motivation\r\n// is that there have been a variety of issues resulting in missed avatar instantiation messages, and\r\n// this is meant to ensure we recover from those in the cases where they occur.\r\n//\r\n// This component, when added, will re-send a isFirstSync message for the networked object is it attached to\r\n// every SYNC_DURATION_MS milliseconds.\r\nAFRAME.registerComponent(\"periodic-full-syncs\", {\r\n  init() {\r\n    this.lastSync = 0;\r\n  },\r\n\r\n  tick() {\r\n    const now = performance.now();\r\n\r\n    if (now - this.lastSync >= SYNC_DURATION_MS && this.el.components && this.el.components.networked) {\r\n      this.lastSync = now;\r\n\r\n      // Sends an undirected first sync message.\r\n      this.el.components.networked.syncAll(null, true);\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"set-max-resolution\", {\r\n  init() {\r\n    const store = window.APP.store;\r\n    this.onStoreChanged = () => {\r\n      const width =\r\n        store.state.preferences.maxResolutionWidth === undefined ? 1920 : store.state.preferences.maxResolutionWidth;\r\n      const height =\r\n        store.state.preferences.maxResolutionHeight === undefined ? 1920 : store.state.preferences.maxResolutionHeight;\r\n      this.el.sceneEl.maxCanvasSize = { width, height };\r\n      this.el.sceneEl.resize();\r\n    };\r\n    this.onStoreChanged();\r\n    store.addEventListener(\"statechanged\", this.onStoreChanged);\r\n  }\r\n});\r\n","// Given a function and a queue name, schedules things so a single function\r\n// from a given queue will be called per frame.\r\nAFRAME.registerSystem(\"frame-scheduler\", {\r\n  init() {\r\n    // Registry a map from queue name to list of registered functions.\r\n    this.registry = new Map();\r\n    this.queues = [];\r\n    this.frameIndex = 0;\r\n  },\r\n\r\n  schedule(func, queue) {\r\n    if (!this.registry.has(queue)) {\r\n      this.queues.push(queue);\r\n      this.registry.set(queue, []);\r\n    }\r\n\r\n    this.registry.get(queue).push(func);\r\n  },\r\n\r\n  unschedule(func) {\r\n    for (let i = 0; i < this.queues.length; i++) {\r\n      const queue = this.queues[i];\r\n      const entries = this.registry.get(queue);\r\n      const idx = entries.indexOf(func);\r\n\r\n      if (idx >= 0) {\r\n        entries.splice(idx, 1);\r\n      }\r\n    }\r\n  },\r\n\r\n  tick: function() {\r\n    for (let i = 0; i < this.queues.length; i++) {\r\n      const queue = this.queues[i];\r\n      const entries = this.registry.get(queue);\r\n      if (entries.length === 0) continue;\r\n\r\n      entries[this.frameIndex % entries.length]();\r\n    }\r\n\r\n    this.frameIndex++;\r\n  }\r\n});\r\n","/* global AFRAME */\r\n\r\n/**\r\n * Toggle visibility of an entity based on if the user is in vr mode or not\r\n * @namespace vr-mode\r\n * @component vr-mode-toggle-visibility\r\n */\r\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\r\n  schema: {\r\n    invert: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    this.updateComponentState = this.updateComponentState.bind(this);\r\n  },\r\n\r\n  play() {\r\n    this.updateComponentState();\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  updateComponentState() {\r\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle the isPlaying state of a component based on app mode\r\n * @namespace vr-mode\r\n * @component vr-mode-toggle-playing\r\n */\r\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\r\n  multiple: true,\r\n  schema: {\r\n    invert: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    this.updateComponentState = this.updateComponentState.bind(this);\r\n  },\r\n\r\n  play() {\r\n    this.updateComponentState();\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  updateComponentState() {\r\n    const componentName = this.id;\r\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\r\n  }\r\n});\r\n\r\n/**\r\n * Toggle a CSS class based upon app mode.\r\n * @namespace vr-mode\r\n * @component vr-mode-toggle-class\r\n */\r\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\r\n  multiple: true,\r\n  schema: {\r\n    invert: { type: \"boolean\", default: false },\r\n    class: { type: \"string\", default: \"\" }\r\n  },\r\n\r\n  init() {\r\n    this.updateComponentState = this.updateComponentState.bind(this);\r\n  },\r\n\r\n  play() {\r\n    this.updateComponentState();\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\r\n  },\r\n\r\n  updateComponentState() {\r\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n\r\n    if (inVRMode) {\r\n      this.el.classList.add(this.data.class);\r\n    } else {\r\n      this.el.classList.remove(this.data.class);\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerSystem(\"permissions\", {\r\n  onPermissionsUpdated(handler) {\r\n    if (window.APP.hubChannel) {\r\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", handler);\r\n    } else {\r\n      window.addEventListener(\r\n        \"hub_channel_ready\",\r\n        () => window.APP.hubChannel.addEventListener(\"permissions_updated\", handler),\r\n        { once: true }\r\n      );\r\n    }\r\n  },\r\n  can(permissionName) {\r\n    return !!window.APP.hubChannel.can(permissionName);\r\n  },\r\n  canOrWillIfCreator(permissionName) {\r\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\r\n  },\r\n  fetchPermissions() {\r\n    return window.APP.hubChannel.fetchPermissions();\r\n  }\r\n});\r\n","/**\r\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\r\n * @system exit-on-blur\r\n */\r\nAFRAME.registerSystem(\"exit-on-blur\", {\r\n  init() {\r\n    this.onBlur = this.onBlur.bind(this);\r\n    this.onFocus = this.onFocus.bind(this);\r\n    this.onTimeout = this.onTimeout.bind(this);\r\n    this.onEnterVR = this.onEnterVR.bind(this);\r\n\r\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\r\n    this.enteredVR = false;\r\n\r\n    window.addEventListener(\"blur\", this.onBlur);\r\n    window.addEventListener(\"focus\", this.onFocus);\r\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\r\n\r\n    this.lastTimeoutCheck = 0;\r\n    this.exitTimeout = null;\r\n  },\r\n\r\n  tick(t) {\r\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\r\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\r\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\r\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\r\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\r\n    if (\r\n      this.isOculusBrowser &&\r\n      this.enteredVR &&\r\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\r\n    ) {\r\n      this.lastTimeoutCheck = t;\r\n      clearTimeout(this.exitTimeout);\r\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\r\n    }\r\n  },\r\n\r\n  onEnterVR() {\r\n    this.enteredVR = true;\r\n  },\r\n\r\n  onBlur() {\r\n    if (this.el.isMobile) {\r\n      clearTimeout(this.exitTimeout);\r\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\r\n    }\r\n  },\r\n\r\n  onFocus() {\r\n    if (this.el.isMobile) {\r\n      clearTimeout(this.exitTimeout);\r\n    }\r\n  },\r\n\r\n  onTimeout() {\r\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\r\n  },\r\n\r\n  remove() {\r\n    clearTimeout(this.exitTimeout);\r\n    window.removeEventListener(\"blur\", this.onBlur);\r\n  }\r\n});\r\n","// On high-DPI displays, measures the median FPS over time and reduces the\r\n// pixelRatio if the FPS drops below a threshold.\r\n\r\nconst LOW_FPS_THRESHOLD = 30;\r\nconst HIGH_FPS_THRESHOLD = 48;\r\nconst SKIP_SECONDS_AFTER_SCENE_VISIBLE = 30;\r\nconst MEASUREMENT_PERIOD_SECONDS = 5;\r\nconst MIN_PIXEL_RATIO = 1;\r\nconst CHANGE_RATE = 1;\r\nconst NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO = 3;\r\n\r\nAFRAME.registerSystem(\"auto-pixel-ratio\", {\r\n  init() {\r\n    // For now let's only enabled this on macs, since they tend to have retina displays.\r\n    // Note this test will also include iPads running iPadOS.\r\n    this.enabled = window.devicePixelRatio > 1 && /macintosh/i.test(navigator.userAgent);\r\n    this.deltas = [];\r\n    this.secondsSinceMeasurementStart = 0;\r\n    this.secondsSinceSceneVisible = 0;\r\n    this.maxPixelRatio = window.devicePixelRatio;\r\n    this.pixelRatioToTimesDecreased = {};\r\n\r\n    this.disabledByPref = !!window.APP.store.state.preferences.disableAutoPixelRatio;\r\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\r\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\r\n  },\r\n  onPreferenceChange() {\r\n    this.disabledByPref = !!window.APP.store.state.preferences.disableAutoPixelRatio;\r\n  },\r\n  tick(time, delta) {\r\n    if (!this.enabled || this.disabledByPref || this.maxPixelRatio === MIN_PIXEL_RATIO) return;\r\n    if (!this.el.is(\"visible\")) return;\r\n    if (this.secondsSinceSceneVisible < SKIP_SECONDS_AFTER_SCENE_VISIBLE) {\r\n      this.secondsSinceSceneVisible += delta / 1000;\r\n      return;\r\n    }\r\n    if (document.visibilityState === \"hidden\") return;\r\n\r\n    this.deltas.push(delta);\r\n    this.secondsSinceMeasurementStart += delta / 1000;\r\n\r\n    if (this.secondsSinceMeasurementStart > MEASUREMENT_PERIOD_SECONDS) {\r\n      this.deltas.sort();\r\n      const medianDelta = this.deltas[Math.floor(this.deltas.length / 2)];\r\n      const medianFps = 1000 / medianDelta;\r\n\r\n      const currentPixelRatio = this.el.renderer.getPixelRatio();\r\n\r\n      const shouldDecrease = currentPixelRatio > MIN_PIXEL_RATIO && medianFps < LOW_FPS_THRESHOLD;\r\n      const shouldIncrease = currentPixelRatio < this.maxPixelRatio && medianFps > HIGH_FPS_THRESHOLD;\r\n      if (shouldDecrease || shouldIncrease) {\r\n        const newPixelRatio = currentPixelRatio + (CHANGE_RATE * shouldIncrease ? 1 : -1);\r\n        console.info(\r\n          `Hubs auto-pixel-ratio: Median FPS (${medianFps.toFixed()}) was ${\r\n            shouldIncrease ? `above ${HIGH_FPS_THRESHOLD}` : `below ${LOW_FPS_THRESHOLD}`\r\n          }. ` + `Adjusting pixel ratio to ${newPixelRatio}.`\r\n        );\r\n        this.el.renderer.setPixelRatio(newPixelRatio);\r\n        if (shouldDecrease) {\r\n          const timesDecreased = (this.pixelRatioToTimesDecreased[currentPixelRatio] || 0) + 1;\r\n          this.pixelRatioToTimesDecreased[currentPixelRatio] = timesDecreased;\r\n          if (timesDecreased >= NUM_TIMES_DECREASED_BEFORE_CHANGING_MAX_PIXEL_RATIO) {\r\n            console.info(\r\n              `Hubs auto-pixel-ratio: Attempts to maintain high frame rate with pixel ratio ${currentPixelRatio} failed ${timesDecreased} times and will not be attempted again. Lowering maximum pixel ratio to ${newPixelRatio}.`\r\n            );\r\n            this.maxPixelRatio = newPixelRatio;\r\n          }\r\n        }\r\n      }\r\n\r\n      // Clear deltas so that we start measuring a new median.\r\n      this.deltas.length = 0;\r\n      this.secondsSinceMeasurementStart = 0;\r\n    }\r\n  }\r\n});\r\n","AFRAME.registerSystem(\"listed-media\", {\r\n  init: function() {\r\n    this.els = [];\r\n  },\r\n\r\n  register: function(el) {\r\n    this.els.push(el);\r\n    this.el.emit(\"listed_media_changed\");\r\n  },\r\n\r\n  unregister: function(el) {\r\n    this.els.splice(this.els.indexOf(el), 1);\r\n    this.el.emit(\"listed_media_changed\");\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"listed-media\", {\r\n  init: function() {\r\n    this.system.register(this.el);\r\n  },\r\n\r\n  remove: function() {\r\n    this.system.unregister(this.el);\r\n  }\r\n});\r\n","// Provides the idea of \"media linking\" -- if two media objects are linked\r\n// then updates to one (src, page, etc) will be reflected on the other, and vice versa.\r\n//\r\n// When you link a media element from A -> B via registerLinkage, a few notes:\r\n// - The media is assumed to be of the same kind, ideally created via media-utils/cloneMedia\r\n// - Sync is bidirectional, however, elB is assumed to be a 'derivate of' elA. this means:\r\n//   - for the video case, elA will have its volume set to zero and restored if elB is removed\r\n//   - when elA is removed, elB will be removed (done in media-loader) but not vice-versa\r\n//\r\nAFRAME.registerSystem(\"linked-media\", {\r\n  init: function() {\r\n    this.handlers = [];\r\n    this.addLinkageHandler = this.addLinkageHandler.bind(this);\r\n    this.syncLinkage = this.syncLinkage.bind(this);\r\n  },\r\n\r\n  addLinkageHandler(elA, elB) {\r\n    const handler = () => {\r\n      // Since elB will have its event fired here if we change something, ignore it.\r\n      if (elB._handlingLinkage) return;\r\n      elA._handlingLinkage = true;\r\n      this.syncLinkage(elA, elB);\r\n      elA._handlingLinkage = false;\r\n    };\r\n\r\n    if (elA.components[\"media-loader\"].data) {\r\n      elA.addEventListener(\"componentchanged\", handler);\r\n    } else {\r\n      const waitForMediaLoader = evt => {\r\n        if (evt.detail.name === \"media-loader\") {\r\n          elA.removeEventListener(\"componentinitialized\", waitForMediaLoader);\r\n          elA.addEventListener(\"componentchanged\", handler);\r\n        }\r\n      };\r\n\r\n      elA.addEventListener(\"componentinitialized\", waitForMediaLoader);\r\n    }\r\n\r\n    return handler;\r\n  },\r\n\r\n  registerLinkage: function(elA, elB) {\r\n    this.syncLinkage(elA, elB);\r\n\r\n    const handlerA = this.addLinkageHandler(elA, elB);\r\n    const handlerB = this.addLinkageHandler(elB, elA);\r\n    elA.setAttribute(\"linked-media\", \"\");\r\n    elB.setAttribute(\"linked-media\", \"\");\r\n\r\n    // As a convenience, if elA is a video, we turn its volume off so we don't hear it twice\r\n    if (elA.components[\"media-video\"]) {\r\n      elA.setAttribute(\"media-video\", \"volume\", 0);\r\n    }\r\n\r\n    this.handlers.push([elA, elB, handlerA, handlerB]);\r\n  },\r\n\r\n  deregisterLinkage: function(el) {\r\n    // Deregister elA -> elB, get list of elBs, and remove them\r\n    for (const [elA, elB, handlerA, handlerB] of this.handlers) {\r\n      if (el === elA || el === elB) {\r\n        elA.removeEventListener(\"componentchanged\", handlerA);\r\n        elB.removeEventListener(\"componentchanged\", handlerB);\r\n      }\r\n\r\n      // As a convenience, if elA is a video, we restore its volume to 50% since we muted it upon link.\r\n      if (elA.components[\"media-video\"]) {\r\n        elA.setAttribute(\"media-video\", \"volume\", 0.5);\r\n      }\r\n    }\r\n\r\n    this.handlers = this.handlers.filter(([elA, elB]) => elA !== el && elB !== el);\r\n  },\r\n\r\n  syncLinkage(elA, elB) {\r\n    if (elB.components[\"networked\"]) {\r\n      // Take ownership before updating\r\n      if (!NAF.utils.isMine(elB) && !NAF.utils.takeOwnership(elB)) return;\r\n    }\r\n\r\n    const { src, version } = elA.components[\"media-loader\"].data;\r\n\r\n    // For now, manually sync linkable properties.\r\n    elB.setAttribute(\"media-loader\", { src, version });\r\n\r\n    if (elA.components[\"media-pdf\"]) {\r\n      const { index } = elA.components[\"media-pdf\"].data;\r\n      elB.setAttribute(\"media-pdf\", { index });\r\n    }\r\n\r\n    if (elA.components[\"media-video\"]) {\r\n      const { time, videoPaused, loop, hidePlaybackControls } = elA.components[\"media-video\"].data;\r\n\r\n      // Sync time, pause state, playback controls, and tighten sync tolerance since its local\r\n      const syncedVideoAttributes = { time, videoPaused, loop, hidePlaybackControls };\r\n\r\n      const targetIsNetworked = !elB.components.networked;\r\n      if (targetIsNetworked) {\r\n        syncedVideoAttributes.syncTolerance = 0.25;\r\n      }\r\n\r\n      elB.setAttribute(\"media-video\", syncedVideoAttributes);\r\n      elB.components[\"media-video\"].updatePlaybackState(true);\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"linked-media\", {\r\n  remove: function() {\r\n    this.system.deregisterLinkage(this.el);\r\n  }\r\n});\r\n","/* global AFRAME NAF performance */\r\nAFRAME.registerComponent(\"owned-object-limiter\", {\r\n  schema: {\r\n    counter: { type: \"selector\" }\r\n  },\r\n\r\n  init() {\r\n    this.counter = this.data.counter.components[\"networked-counter\"];\r\n  },\r\n\r\n  tick() {\r\n    this._syncCounterRegistration();\r\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\r\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\r\n      this.counter.timestamps.set(this.el, performance.now());\r\n    }\r\n    this.wasHeld = isHeld;\r\n  },\r\n\r\n  remove() {\r\n    this.counter.deregister(this.el);\r\n  },\r\n\r\n  _syncCounterRegistration() {\r\n    if (!this.el.components[\"networked\"]) return;\r\n\r\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\r\n\r\n    if (NAF.utils.isMine(this.el) && !isPinned) {\r\n      this.counter.register(this.el);\r\n    } else {\r\n      this.counter.deregister(this.el);\r\n    }\r\n  }\r\n});\r\n","/* global performance */\r\nAFRAME.registerComponent(\"owned-object-cleanup-timeout\", {\r\n  schema: {\r\n    counter: { type: \"selector\" },\r\n    ttl: { default: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.counter = this.data.counter.components[\"networked-counter\"];\r\n    this.timeout = Number.POSITIVE_INFINITY;\r\n  },\r\n\r\n  tick() {\r\n    if (this.el.components[\"networked\"] && NAF.utils.isMine(this.el)) {\r\n      const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\r\n      if (NAF.utils.isMine(this.el) && !isPinned && performance.now() >= this.timeout) {\r\n        this.el.parentNode.removeChild(this.el);\r\n        this.timeout = Number.POSITIVE_INFINITY;\r\n      }\r\n    }\r\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\r\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\r\n      this.timeout = performance.now() + this.data.ttl * 1000;\r\n    } else if (isHeld && !this.wasHeld) {\r\n      this.timeout = Number.POSITIVE_INFINITY;\r\n    }\r\n    this.wasHeld = isHeld;\r\n  }\r\n});\r\n","/* global NAF */\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\r\n  init() {\r\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\r\n  },\r\n  play() {\r\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\r\n\r\n    if (!this.didThisOnce) {\r\n      // Do this in play instead of init so that the ammo-body and networked components are done\r\n      this.didThisOnce = true;\r\n\r\n      if (!this.el.components.networked || !NAF.utils.isMine(this.el)) {\r\n        this.setBodyKinematic();\r\n      }\r\n    }\r\n  },\r\n  pause() {\r\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\r\n  },\r\n  setBodyKinematic() {\r\n    this.el.setAttribute(\"body-helper\", {\r\n      type: \"kinematic\",\r\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\r\n    });\r\n    if (this.el.components[\"floaty-object\"]) {\r\n      this.el.components[\"floaty-object\"].locked = true;\r\n    }\r\n  }\r\n});\r\n","/* global AFRAME performance */\r\n/**\r\n * Limits networked interactables to a maximum number at any given time\r\n * @namespace network\r\n * @component networked-counter\r\n */\r\nAFRAME.registerComponent(\"networked-counter\", {\r\n  schema: {\r\n    max: { default: 3 }\r\n  },\r\n\r\n  init() {\r\n    this.timestamps = new Map();\r\n    this.el.object3D.visible = false;\r\n  },\r\n\r\n  remove() {\r\n    this.timestamps.clear();\r\n  },\r\n\r\n  count() {\r\n    return this.timestamps.size;\r\n  },\r\n\r\n  register(el) {\r\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\r\n\r\n    this.timestamps.set(el, performance.now());\r\n    if (this.timestamps.size > this.data.max) {\r\n      this._destroyOldest();\r\n    }\r\n  },\r\n\r\n  deregister(el) {\r\n    if (!this.timestamps.has(el)) return;\r\n    this.timestamps.delete(el);\r\n  },\r\n\r\n  _destroyOldest() {\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    let oldestEl = null,\r\n      minTs = Number.MAX_VALUE;\r\n    this.timestamps.forEach((ts, el) => {\r\n      if (ts < minTs && !interaction.isHeld(el) && NAF.utils.isMine(el)) {\r\n        oldestEl = el;\r\n        minTs = ts;\r\n      }\r\n    });\r\n    this._destroy(oldestEl);\r\n  },\r\n\r\n  _destroy(el) {\r\n    // Pause the entity so that it won't just re-register itself immediately in owned-object-limiter.\r\n    el.pause();\r\n    // networked-interactable's remove will also call deregister, but it will happen async so we do it here as well.\r\n    this.deregister(el);\r\n    el.parentNode.removeChild(el);\r\n  }\r\n});\r\n","AFRAME.registerComponent(\"set-yxz-order\", {\r\n  init: function() {\r\n    this.el.object3D.rotation.order = \"YXZ\";\r\n  }\r\n});\r\n","/**\r\n * Initializes teleporters when the environment bundle has loaded.\r\n * @namespace environment\r\n * @component nav-mesh-helper\r\n */\r\nAFRAME.registerComponent(\"nav-mesh-helper\", {\r\n  init: function() {\r\n    this.el.addEventListener(\"model-loaded\", () => {\r\n      const teleporters = document.querySelectorAll(\"[teleporter]\");\r\n      for (let i = 0; i < teleporters.length; i++) {\r\n        teleporters[i].components[\"teleporter\"].queryCollisionEntities();\r\n      }\r\n    });\r\n  }\r\n});\r\n","/**\r\n * Drawing Manager\r\n * Manages what networked-drawings are available to pen components\r\n * @namespace drawing\r\n * @component drawing-manager\r\n */\r\nAFRAME.registerComponent(\"drawing-manager\", {\r\n  schema: {\r\n    penSpawner: { type: \"selector\" }\r\n  },\r\n\r\n  init() {\r\n    this.el.object3D.visible = false;\r\n    this.drawingToPen = new Map();\r\n    this.data.penSpawner.addEventListener(\"spawned-entity-created\", () => {\r\n      if (!this.drawingEl) {\r\n        this.createDrawing();\r\n      }\r\n    });\r\n  },\r\n\r\n  createDrawing() {\r\n    if (!this.createDrawingPromise) {\r\n      this.createDrawingPromise = new Promise(resolve => {\r\n        this.drawingEl = document.createElement(\"a-entity\");\r\n        this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\r\n        this.el.sceneEl.appendChild(this.drawingEl);\r\n\r\n        const handNetworkedDrawingInit = e => {\r\n          if (e.detail.name === \"networked-drawing\") {\r\n            this.drawing = this.drawingEl.components[\"networked-drawing\"];\r\n            this.drawingEl.removeEventListener(\"componentinitialized\", handNetworkedDrawingInit);\r\n            resolve();\r\n          }\r\n        };\r\n\r\n        this.drawingEl.addEventListener(\"componentinitialized\", handNetworkedDrawingInit);\r\n      });\r\n    }\r\n    return this.createDrawingPromise;\r\n  },\r\n\r\n  destroyDrawing(networkedDrawing) {\r\n    if (this.drawing === networkedDrawing) {\r\n      this.drawingToPen.delete(this.drawing);\r\n      this.drawing = null;\r\n      this.drawingEl = null;\r\n      this.createDrawingPromise = null;\r\n      this.getDrawingPromise = null;\r\n    }\r\n  },\r\n\r\n  getDrawing(pen) {\r\n    //TODO: future handling of multiple drawings\r\n    if (!this.getDrawingPromise) {\r\n      this.getDrawingPromise = new Promise((resolve, reject) => {\r\n        if (!this.drawingEl) {\r\n          this.createDrawing().then(() => {\r\n            this.drawingToPen.set(this.drawing, pen);\r\n            resolve(this.drawing);\r\n          });\r\n        } else if (\r\n          this.drawing &&\r\n          (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)\r\n        ) {\r\n          this.drawingToPen.set(this.drawing, pen);\r\n          resolve(this.drawing);\r\n        } else {\r\n          reject();\r\n        }\r\n      });\r\n    }\r\n    return this.getDrawingPromise;\r\n  },\r\n\r\n  returnDrawing(pen) {\r\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\r\n      this.drawingToPen.delete(this.drawing);\r\n    }\r\n  }\r\n});\r\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\r\n\r\nconst bindAllEvents = function(elements, events, f) {\r\n  if (!elements || !elements.length) return;\r\n  for (const el of elements) {\r\n    events.length &&\r\n      events.forEach(e => {\r\n        el.addEventListener(e, f);\r\n      });\r\n  }\r\n};\r\nconst unbindAllEvents = function(elements, events, f) {\r\n  if (!elements || !elements.length) return;\r\n  for (const el of elements) {\r\n    events.length &&\r\n      events.forEach(e => {\r\n        el.removeEventListener(e, f);\r\n      });\r\n  }\r\n};\r\n\r\n/**\r\n * Toggles the microphone on the current network connection based on the given events.\r\n * @namespace network\r\n * @component mute-mic\r\n */\r\nAFRAME.registerComponent(\"mute-mic\", {\r\n  schema: {\r\n    eventSrc: { type: \"selectorAll\" },\r\n    toggleEvents: { type: \"array\" },\r\n    muteEvents: { type: \"array\" },\r\n    unmuteEvents: { type: \"array\" }\r\n  },\r\n  init: function() {\r\n    this.onToggle = this.onToggle.bind(this);\r\n    this.onMute = this.onMute.bind(this);\r\n    this.onUnmute = this.onUnmute.bind(this);\r\n  },\r\n\r\n  play: function() {\r\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\r\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\r\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\r\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\r\n  },\r\n\r\n  pause: function() {\r\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\r\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\r\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\r\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\r\n  },\r\n\r\n  onToggle: function() {\r\n    if (!NAF.connection.adapter) return;\r\n    if (!this.el.sceneEl.is(\"entered\")) return;\r\n\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\r\n    if (this.el.is(\"muted\")) {\r\n      NAF.connection.adapter.enableMicrophone(true);\r\n      this.el.removeState(\"muted\");\r\n    } else {\r\n      NAF.connection.adapter.enableMicrophone(false);\r\n      this.el.addState(\"muted\");\r\n    }\r\n  },\r\n\r\n  onMute: function() {\r\n    if (!NAF.connection.adapter) return;\r\n    if (!this.el.is(\"muted\")) {\r\n      NAF.connection.adapter.enableMicrophone(false);\r\n      this.el.addState(\"muted\");\r\n    }\r\n  },\r\n\r\n  onUnmute: function() {\r\n    if (this.el.is(\"muted\")) {\r\n      NAF.connection.adapter.enableMicrophone(true);\r\n      this.el.removeState(\"muted\");\r\n    }\r\n  }\r\n});\r\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\r\n/**\r\n * HUD panel for muting, freezing, and other controls that don't necessarily have hardware buttons.\r\n * @namespace ui\r\n * @component in-world-hud\r\n */\r\nAFRAME.registerComponent(\"in-world-hud\", {\r\n  init() {\r\n    this.mic = this.el.querySelector(\".mic\");\r\n    this.spawn = this.el.querySelector(\".spawn\");\r\n    this.pen = this.el.querySelector(\".penhud\");\r\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\r\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\r\n    this.background = this.el.querySelector(\".bg\");\r\n\r\n    this.updateButtonStates = () => {\r\n      this.mic.setAttribute(\"mic-button\", \"active\", this.el.sceneEl.is(\"muted\"));\r\n      this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\r\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\r\n      if (window.APP.hubChannel) {\r\n        this.spawn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_and_move_media\"));\r\n        this.pen.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_drawing\"));\r\n        this.cameraBtn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_camera\"));\r\n      }\r\n    };\r\n\r\n    this.onStateChange = evt => {\r\n      if (!(evt.detail === \"muted\" || evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\"))\r\n        return;\r\n      this.updateButtonStates();\r\n    };\r\n\r\n    this.onMicClick = () => {\r\n      this.el.emit(\"action_mute\");\r\n    };\r\n\r\n    this.onSpawnClick = () => {\r\n      if (!window.APP.hubChannel.can(\"spawn_and_move_media\")) return;\r\n      this.el.emit(\"action_spawn\");\r\n    };\r\n\r\n    this.onPenClick = e => {\r\n      if (!window.APP.hubChannel.can(\"spawn_drawing\")) return;\r\n      this.el.emit(\"spawn_pen\", { object3D: e.object3D });\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\r\n    };\r\n\r\n    this.onCameraClick = () => {\r\n      if (!window.APP.hubChannel.can(\"spawn_camera\")) return;\r\n      this.el.emit(\"action_toggle_camera\");\r\n    };\r\n\r\n    this.onInviteClick = () => {\r\n      this.el.emit(\"action_invite\");\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\r\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates);\r\n    this.updateButtonStates();\r\n\r\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\r\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\r\n    this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\r\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\r\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateButtonStates);\r\n\r\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\r\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\r\n    this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\r\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\r\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\r\n  }\r\n});\r\n","/* global performance */\r\n\r\nimport { SOUND_SPAWN_EMOJI } from \"../systems/sound-effects-system\";\r\n\r\nAFRAME.registerComponent(\"emoji\", {\r\n  schema: {\r\n    emitDecayTime: { default: 1.5 },\r\n    emitFadeTime: { default: 0.5 },\r\n    emitEndTime: { default: 0 },\r\n    particleEmitterConfig: {\r\n      default: null,\r\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\r\n      stringify: JSON.stringify\r\n    }\r\n  },\r\n\r\n  init() {\r\n    this.data.emitEndTime = performance.now() + this.data.emitDecayTime * 1000;\r\n    this.physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n\r\n    this.emojiHud = document.querySelector(\"[emoji-hud]\").components[\"emoji-hud\"];\r\n  },\r\n\r\n  play() {\r\n    const mediaLoader = this.el.components[\"media-loader\"];\r\n    if (this.emojiHud.emojiUrls.indexOf(mediaLoader.data.src) === -1) {\r\n      this.el.parentNode.removeChild(this.el);\r\n      return;\r\n    }\r\n\r\n    const uuid = this.el.components[\"body-helper\"].uuid;\r\n    this.lastLinearVelocity = this.physicsSystem.getLinearVelocity(uuid);\r\n    this.lastAngularVelocity = this.physicsSystem.getAngularVelocity(uuid);\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playPositionalSoundFollowing(\r\n      SOUND_SPAWN_EMOJI,\r\n      this.el.object3D\r\n    );\r\n    this.particleEmitter = this.el.querySelector(\".particle-emitter\");\r\n  },\r\n\r\n  update() {\r\n    if (!this.particleConfig && this.data.particleEmitterConfig) {\r\n      this.particleConfig = Object.assign({}, this.data.particleEmitterConfig);\r\n      this.originalParticleCount = this.particleConfig.particleCount;\r\n    }\r\n  },\r\n\r\n  tick(t, dt) {\r\n    const isMine = this.el.components.networked.initialized && this.el.components.networked.isMine();\r\n\r\n    if (this.particleConfig && isMine) {\r\n      const now = performance.now();\r\n\r\n      const uuid = this.el.components[\"body-helper\"].uuid;\r\n\r\n      const linearVelocity = this.physicsSystem.getLinearVelocity(uuid);\r\n      const linearAcceleration = ((linearVelocity - this.lastLinearVelocity) / dt) * 1000;\r\n      this.lastLinearVelocity = linearVelocity;\r\n\r\n      const angularVelocity = this.physicsSystem.getAngularVelocity(uuid);\r\n      const angularAcceleration = ((angularVelocity - this.lastAngularVelocity) / dt) * 1000;\r\n      this.lastAngularVelocity = angularVelocity;\r\n\r\n      if (Math.abs(linearAcceleration) > 33 || Math.abs(angularAcceleration) > 33) {\r\n        this.data.emitEndTime = now + this.data.emitDecayTime * 1000;\r\n      }\r\n\r\n      const emitFadeTime = this.data.emitFadeTime * 1000;\r\n\r\n      if (now < this.data.emitEndTime && this.particleConfig.startOpacity < 1) {\r\n        this.particleConfig.particleCount = this.originalParticleCount;\r\n        this.particleConfig.startOpacity = 1;\r\n        this.particleConfig.middleOpacity = 1;\r\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\r\n      } else if (now >= this.data.emitEndTime && this.particleConfig.startOpacity > 0.001) {\r\n        const timeSinceStop = Math.min(now - this.data.emitEndTime, emitFadeTime);\r\n        const opacity = 1 - timeSinceStop / emitFadeTime;\r\n        const particleCount = opacity < 0.001 && this.particleConfig.particleCount > 0 ? 0 : this.originalParticleCount;\r\n        this.particleConfig.particleCount = particleCount;\r\n        this.particleConfig.startOpacity = opacity;\r\n        this.particleConfig.middleOpacity = opacity;\r\n        this.particleEmitter.setAttribute(\"particle-emitter\", this.particleConfig, true);\r\n      }\r\n    }\r\n  }\r\n});\r\n","import emoji_particle_0 from \"../assets/images/emojis/emoji_0.png\";\r\nimport emoji_particle_1 from \"../assets/images/emojis/emoji_1.png\";\r\nimport emoji_particle_2 from \"../assets/images/emojis/emoji_2.png\";\r\nimport emoji_particle_3 from \"../assets/images/emojis/emoji_3.png\";\r\nimport emoji_particle_4 from \"../assets/images/emojis/emoji_4.png\";\r\nimport emoji_particle_5 from \"../assets/images/emojis/emoji_5.png\";\r\nimport emoji_particle_6 from \"../assets/images/emojis/emoji_6.png\";\r\n\r\nimport emoji_0 from \"../assets/models/emojis/emoji_0.glb\";\r\nimport emoji_1 from \"../assets/models/emojis/emoji_1.glb\";\r\nimport emoji_2 from \"../assets/models/emojis/emoji_2.glb\";\r\nimport emoji_3 from \"../assets/models/emojis/emoji_3.glb\";\r\nimport emoji_4 from \"../assets/models/emojis/emoji_4.glb\";\r\nimport emoji_5 from \"../assets/models/emojis/emoji_5.glb\";\r\nimport emoji_6 from \"../assets/models/emojis/emoji_6.glb\";\r\n\r\nimport { TYPE } from \"three-ammo/constants\";\r\n\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\n\r\nconst emojis = [emoji_0, emoji_1, emoji_2, emoji_3, emoji_4, emoji_5, emoji_6];\r\nconst particles = [\r\n  emoji_particle_0,\r\n  emoji_particle_1,\r\n  emoji_particle_2,\r\n  emoji_particle_3,\r\n  emoji_particle_4,\r\n  emoji_particle_5,\r\n  emoji_particle_6\r\n];\r\n\r\nfunction setOffsetVector(i, totalNumEmojis, width, spacing, offsetVector) {\r\n  const sign = i & 1 ? -1 : 1;\r\n  offsetVector.y = 0;\r\n  if (totalNumEmojis % 2 === 0) {\r\n    offsetVector.x = (spacing / 2 + width / 2 + Math.floor(i / 2) * (width + spacing)) * sign;\r\n    offsetVector.z = (Math.floor(i / 2) * width) / 2;\r\n  } else if (i !== 0) {\r\n    offsetVector.x = (width + spacing) * Math.floor((i + 1) / 2) * -sign;\r\n    offsetVector.z = (Math.floor((i + 1) / 2) * width) / 2;\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"emoji-hud\", {\r\n  schema: {\r\n    spawnerScale: { default: 0.1 },\r\n    spawnedScale: { default: 0.5 },\r\n    camera: { type: \"selector\" },\r\n    hudAngle: { default: -0.5 },\r\n    minHudAngle: { default: -0.2 },\r\n    maxHudAngle: { default: 0.7 },\r\n    hudDistance: { default: 0.4 },\r\n    spawnerPlatformWidth: { default: 0.0625 },\r\n    spawnerPlatformSpacing: { default: 0.021 }\r\n  },\r\n\r\n  init: (() => {\r\n    const cameraWorldPosition = new THREE.Vector3();\r\n    const offsetVector = new THREE.Vector3();\r\n    return function() {\r\n      this._onFrozen = this._onFrozen.bind(this);\r\n      this._onThaw = this._onThaw.bind(this);\r\n\r\n      const width = this.data.spawnerPlatformWidth;\r\n      const spacing = this.data.spawnerPlatformSpacing;\r\n\r\n      this.emojiUrls = [];\r\n\r\n      this.spawnerEntities = [];\r\n\r\n      for (let i = 0; i < emojis.length; i++) {\r\n        const spawnerEntity = document.createElement(\"a-entity\");\r\n        const url = new URL(emojis[i], window.location.href).href;\r\n        this.emojiUrls.push(url);\r\n        spawnerEntity.setAttribute(\"media-loader\", { src: url });\r\n        spawnerEntity.setAttribute(\"hoverable-visuals\", \"\");\r\n        spawnerEntity.setAttribute(\"scale\", {\r\n          x: this.data.spawnerScale,\r\n          y: this.data.spawnerScale,\r\n          z: this.data.spawnerScale\r\n        });\r\n        spawnerEntity.setAttribute(\"is-remote-hover-target\", \"\");\r\n        spawnerEntity.setAttribute(\"tags\", { isHandCollisionTarget: false });\r\n        spawnerEntity.setAttribute(\"visibility-while-frozen\", {\r\n          requireHoverOnNonMobile: false,\r\n          withPermission: \"spawn_emoji\"\r\n        });\r\n        spawnerEntity.setAttribute(\"css-class\", \"interactable\");\r\n        spawnerEntity.setAttribute(\"body-helper\", {\r\n          mass: 0,\r\n          type: TYPE.STATIC,\r\n          collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\r\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\r\n        });\r\n\r\n        const particle = new URL(particles[i], window.location.href).href;\r\n        const particleEmitterConfig = {\r\n          src: particle,\r\n          resolve: false,\r\n          particleCount: 20,\r\n          startSize: 0.01,\r\n          endSize: 0.2,\r\n          sizeRandomness: 0.05,\r\n          lifetime: 1,\r\n          lifetimeRandomness: 0.2,\r\n          ageRandomness: 1,\r\n          startVelocity: { x: 0, y: 1, z: 0 },\r\n          endVelocity: { x: 0, y: 0.25, z: 0 },\r\n          startOpacity: 1,\r\n          middleOpacity: 1,\r\n          endOpacity: 0\r\n        };\r\n\r\n        spawnerEntity.addEventListener(\"spawned-entity-created\", e => {\r\n          if (this.el.sceneEl.is(\"vr-mode\")) {\r\n            return;\r\n          }\r\n          const object3D = e.detail.target.object3D;\r\n          const cameraObject3D = this.data.camera.object3D;\r\n          object3D.updateMatrices();\r\n          cameraObject3D.getWorldPosition(cameraWorldPosition);\r\n          object3D.lookAt(cameraWorldPosition.x, object3D.position.y, cameraWorldPosition.z);\r\n          object3D.matrixNeedsUpdate = true;\r\n        });\r\n\r\n        spawnerEntity.addEventListener(\"spawned-entity-loaded\", e => {\r\n          e.detail.target.querySelector(\".particle-emitter\").setAttribute(\"particle-emitter\", particleEmitterConfig);\r\n          e.detail.target.setAttribute(\"emoji\", { particleEmitterConfig: particleEmitterConfig });\r\n        });\r\n\r\n        spawnerEntity.setAttribute(\"super-spawner\", {\r\n          src: url,\r\n          template: \"#interactable-emoji\",\r\n          spawnScale: { x: this.data.spawnedScale, y: this.data.spawnedScale, z: this.data.spawnedScale }\r\n        });\r\n\r\n        const cylinder = document.createElement(\"a-cylinder\");\r\n        cylinder.setAttribute(\"visibility-while-frozen\", {\r\n          requireHoverOnNonMobile: false,\r\n          withPermission: \"spawn_emoji\"\r\n        });\r\n        cylinder.setAttribute(\"material\", { opacity: 0.2, color: \"#2f7fee\" });\r\n        cylinder.setAttribute(\"segments-height\", 1);\r\n        cylinder.setAttribute(\"segments-radial\", 16);\r\n        cylinder.setAttribute(\"scale\", { x: width / 2, y: width / 20, z: width / 5 });\r\n        cylinder.setAttribute(\"rotation\", { x: 45, y: 0, z: 0 });\r\n\r\n        setOffsetVector(i, emojis.length, width, spacing, offsetVector);\r\n\r\n        spawnerEntity.object3D.position.copy(offsetVector);\r\n        spawnerEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n        cylinder.object3D.position.set(offsetVector.x, -width / 2, offsetVector.z + 0.01); //move back to avoid transparency issues with emojis\r\n        cylinder.object3D.matrixNeedsUpdate = true;\r\n\r\n        this.el.appendChild(spawnerEntity);\r\n        this.el.appendChild(cylinder);\r\n\r\n        this.spawnerEntities.push(spawnerEntity);\r\n      }\r\n    };\r\n  })(),\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this._onFrozen);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._onThaw);\r\n    this._updateOffset();\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._onFrozen);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._onThaw);\r\n  },\r\n\r\n  _onFrozen(e) {\r\n    if (e.detail === \"frozen\") {\r\n      this._updateOffset();\r\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\r\n        this.spawnerEntities[i].components.tags.data.isHandCollisionTarget = true;\r\n      }\r\n    }\r\n  },\r\n\r\n  _onThaw(e) {\r\n    if (e.detail === \"frozen\") {\r\n      for (let i = 0; i < this.spawnerEntities.length; i++) {\r\n        this.spawnerEntities[i].components.tags.data.isHandCollisionTarget = false;\r\n      }\r\n    }\r\n  },\r\n\r\n  _updateOffset: (function() {\r\n    const targetWorldPos = new THREE.Vector3();\r\n    const cameraForward = new THREE.Vector3();\r\n    const projectedCameraForward = new THREE.Vector3();\r\n    const angledCameraForward = new THREE.Vector3();\r\n    const defaultRight = new THREE.Vector3(1, 0, 0);\r\n    return function() {\r\n      const obj = this.el.object3D;\r\n      const cameraObject3D = this.data.camera.object3D;\r\n      cameraObject3D.updateMatrices();\r\n      cameraForward.set(0, 0, -1);\r\n      cameraForward.transformDirection(cameraObject3D.matrixWorld);\r\n      projectedCameraForward.set(0, 0, -1);\r\n      projectedCameraForward.transformDirection(cameraObject3D.matrixWorld);\r\n      projectedCameraForward.projectOnPlane(THREE.Object3D.DefaultUp).normalize();\r\n      const angle =\r\n        Math.sign(THREE.Object3D.DefaultUp.dot(cameraForward)) * projectedCameraForward.angleTo(cameraForward);\r\n      const angleOffset = angle - Math.max(this.data.minHudAngle, Math.min(this.data.maxHudAngle, angle));\r\n      angledCameraForward.set(0, 0, -1);\r\n      angledCameraForward.applyAxisAngle(defaultRight, this.data.hudAngle - angleOffset);\r\n      angledCameraForward.multiplyScalar(this.data.hudDistance);\r\n      cameraObject3D.localToWorld(angledCameraForward);\r\n      obj.parent.worldToLocal(angledCameraForward);\r\n      obj.position.copy(angledCameraForward);\r\n      obj.updateMatrices(true);\r\n      cameraObject3D.getWorldPosition(targetWorldPos);\r\n      obj.lookAt(targetWorldPos);\r\n      obj.matrixNeedsUpdate = true;\r\n    };\r\n  })()\r\n});\r\n","import nipplejs from \"nipplejs\";\r\nimport styles from \"./virtual-gamepad-controls.css\";\r\nconst HIDDEN_JOYSTICK_STYLE = `${styles.mockJoystick}__hidden`;\r\n\r\n/**\r\n * Instantiates 2D virtual gamepads and emits associated events.\r\n * @namespace user-input\r\n * @component virtual-gamepad-controls\r\n */\r\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\r\n  schema: {},\r\n\r\n  init() {\r\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\r\n\r\n    this.onEnterVr = this.onEnterVr.bind(this);\r\n    this.onExitVr = this.onExitVr.bind(this);\r\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\r\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\r\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\r\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\r\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\r\n\r\n    this.mockJoystickContainer = document.createElement(\"div\");\r\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\r\n    this.leftMock = document.createElement(\"div\");\r\n    this.leftMock.classList.add(styles.mockJoystick);\r\n    this.leftMockSmall = document.createElement(\"div\");\r\n    this.leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\r\n    this.leftMock.appendChild(this.leftMockSmall);\r\n    this.mockJoystickContainer.appendChild(this.leftMock);\r\n    this.rightMock = document.createElement(\"div\");\r\n    this.rightMock.classList.add(styles.mockJoystick);\r\n    this.rightMockSmall = document.createElement(\"div\");\r\n    this.rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\r\n    this.rightMock.appendChild(this.rightMockSmall);\r\n    this.mockJoystickContainer.appendChild(this.rightMock);\r\n\r\n    this.enableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\r\n    this.enableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\r\n    if (this.enableLeft || this.enableRight) {\r\n      document.body.appendChild(this.mockJoystickContainer);\r\n    }\r\n    if (this.enableLeft) {\r\n      this.createLeftStick();\r\n    } else {\r\n      this.leftMock.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.leftMockSmall.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n    }\r\n    if (this.enableRight) {\r\n      this.createRightStick();\r\n    } else {\r\n      this.rightMock.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.rightMockSmall.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n    }\r\n    this.onPreferenceChange = this.onPreferenceChange.bind(this);\r\n    window.APP.store.addEventListener(\"statechanged\", this.onPreferenceChange);\r\n\r\n    this.inVr = false;\r\n    this.moving = false;\r\n    this.rotating = false;\r\n\r\n    this.displacement = new THREE.Vector3();\r\n    this.lookDy = 0;\r\n    this.lookDx = 0;\r\n\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\r\n  },\r\n\r\n  onPreferenceChange() {\r\n    const newEnableLeft = window.APP.store.state.preferences.enableOnScreenJoystickLeft;\r\n    const newEnableRight = window.APP.store.state.preferences.enableOnScreenJoystickRight;\r\n    const isChanged = this.enableLeft !== newEnableLeft || this.enableRight !== newEnableRight;\r\n    if (!isChanged) {\r\n      return;\r\n    }\r\n    if (!this.enableLeft && newEnableLeft) {\r\n      this.createLeftStick();\r\n    } else if (this.enableLeft && !newEnableLeft) {\r\n      this.leftMock.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.leftMockSmall.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.leftStick.destroy();\r\n      this.leftTouchZone.parentNode.removeChild(this.leftTouchZone);\r\n      this.leftStick = null;\r\n      this.leftTouchZone = null;\r\n    }\r\n    if (!this.enableRight && newEnableRight) {\r\n      this.createRightStick();\r\n    } else if (this.enableRight && !newEnableRight) {\r\n      this.rightMock.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.rightMockSmall.classList.add(HIDDEN_JOYSTICK_STYLE);\r\n      this.rightStick.destroy();\r\n      this.rightTouchZone.parentNode.removeChild(this.rightTouchZone);\r\n      this.rightStick = null;\r\n      this.rightTouchZone = null;\r\n    }\r\n    this.enableLeft = newEnableLeft;\r\n    this.enableRight = newEnableRight;\r\n\r\n    if (this.enableLeft) {\r\n      this.leftMock.classList.remove(HIDDEN_JOYSTICK_STYLE);\r\n      this.leftMockSmall.classList.remove(HIDDEN_JOYSTICK_STYLE);\r\n      this.leftStick.on(\"start\", this.onFirstInteraction);\r\n    }\r\n    if (this.enableRight) {\r\n      this.rightMock.classList.remove(HIDDEN_JOYSTICK_STYLE);\r\n      this.rightMockSmall.classList.remove(HIDDEN_JOYSTICK_STYLE);\r\n      this.rightStick.on(\"start\", this.onFirstInteraction);\r\n    }\r\n    if ((this.enableLeft || this.enableRight) && !this.mockJoystickContainer.parentNode) {\r\n      document.body.appendChild(this.mockJoystickContainer);\r\n    }\r\n    if (!this.enableLeft && !this.enableRight) {\r\n      this.mockJoystickContainer.parentNode &&\r\n        this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\r\n    }\r\n  },\r\n\r\n  createRightStick() {\r\n    this.rightTouchZone = document.createElement(\"div\");\r\n    this.rightTouchZone.classList.add(styles.touchZone, styles.right);\r\n    document.body.appendChild(this.rightTouchZone);\r\n    this.rightStick = nipplejs.create({\r\n      zone: this.rightTouchZone,\r\n      color: \"white\",\r\n      fadeTime: 0\r\n    });\r\n    this.rightStick.on(\"start\", this.onFirstInteraction);\r\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\r\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\r\n  },\r\n\r\n  createLeftStick() {\r\n    this.leftTouchZone = document.createElement(\"div\");\r\n    this.leftTouchZone.classList.add(styles.touchZone, styles.left);\r\n    document.body.appendChild(this.leftTouchZone);\r\n    this.leftStick = nipplejs.create({\r\n      zone: this.leftTouchZone,\r\n      color: \"white\",\r\n      fadeTime: 0\r\n    });\r\n    this.leftStick.on(\"start\", this.onFirstInteraction);\r\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\r\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\r\n  },\r\n\r\n  onFirstInteraction() {\r\n    if (this.leftStick) this.leftStick.off(\"start\", this.onFirstInteraction);\r\n    if (this.rightStick) this.rightStick.off(\"start\", this.onFirstInteraction);\r\n    this.mockJoystickContainer.parentNode &&\r\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\r\n  },\r\n\r\n  onMoveJoystickChanged(event, joystick) {\r\n    if (window.APP.preferenceScreenIsVisible) return;\r\n    const angle = joystick.angle.radian;\r\n    const force = joystick.force < 1 ? joystick.force : 1;\r\n    this.displacement.set(Math.cos(angle), 0, Math.sin(angle)).multiplyScalar(force * 1.85);\r\n    this.moving = true;\r\n  },\r\n\r\n  onMoveJoystickEnd() {\r\n    this.moving = false;\r\n    this.displacement.set(0, 0, 0);\r\n  },\r\n\r\n  onLookJoystickChanged(event, joystick) {\r\n    if (window.APP.preferenceScreenIsVisible) return;\r\n    // Set pitch and yaw angles on right stick move\r\n    const angle = joystick.angle.radian;\r\n    const force = joystick.force < 1 ? joystick.force : 1;\r\n    const turnStrength = 0.05;\r\n    this.rotating = true;\r\n    this.lookDy = -Math.cos(angle) * force * turnStrength;\r\n    this.lookDx = Math.sin(angle) * force * turnStrength;\r\n  },\r\n\r\n  onLookJoystickEnd() {\r\n    this.rotating = false;\r\n    this.lookDx = 0;\r\n    this.lookDy = 0;\r\n    this.el.sceneEl.emit(\"rotateX\", this.lookDx);\r\n  },\r\n\r\n  tick() {\r\n    if (this.inVr) {\r\n      return;\r\n    }\r\n    if (this.moving) {\r\n      this.characterController.enqueueRelativeMotion(this.displacement);\r\n    }\r\n    if (this.rotating) {\r\n      this.characterController.enqueueInPlaceRotationAroundWorldUp(this.lookDy);\r\n      this.el.sceneEl.emit(\"rotateX\", this.lookDx);\r\n    }\r\n  },\r\n\r\n  onEnterVr() {\r\n    // Hide the joystick controls\r\n    this.inVr = true;\r\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"none\";\r\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"none\";\r\n  },\r\n\r\n  onExitVr() {\r\n    // Show the joystick controls\r\n    this.inVr = false;\r\n    if (this.leftTouchZone) this.leftTouchZone.style.display = \"block\";\r\n    if (this.rightTouchZone) this.rightTouchZone.style.display = \"block\";\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\r\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\r\n    this.mockJoystickContainer.parentNode &&\r\n      this.mockJoystickContainer.parentNode.removeChild(this.mockJoystickContainer);\r\n    if (this.leftTouchZone) document.body.removeChild(this.leftTouchZone);\r\n    if (this.rightTouchZone) document.body.removeChild(this.rightTouchZone);\r\n  }\r\n});\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nconst { Vector3, Quaternion, Matrix4, Euler } = THREE;\r\n\r\nfunction quaternionAlmostEquals(epsilon, u, v) {\r\n  // Note: q and -q represent same rotation\r\n  return (\r\n    (Math.abs(u.x - v.x) < epsilon &&\r\n      Math.abs(u.y - v.y) < epsilon &&\r\n      Math.abs(u.z - v.z) < epsilon &&\r\n      Math.abs(u.w - v.w) < epsilon) ||\r\n    (Math.abs(-u.x - v.x) < epsilon &&\r\n      Math.abs(-u.y - v.y) < epsilon &&\r\n      Math.abs(-u.z - v.z) < epsilon &&\r\n      Math.abs(-u.w - v.w) < epsilon)\r\n  );\r\n}\r\n\r\n/**\r\n * Provides access to the end effectors for IK.\r\n * @namespace avatar\r\n * @component ik-root\r\n */\r\nAFRAME.registerComponent(\"ik-root\", {\r\n  schema: {\r\n    camera: { type: \"string\", default: \".camera\" },\r\n    leftController: { type: \"string\", default: \".left-controller\" },\r\n    rightController: { type: \"string\", default: \".right-controller\" }\r\n  },\r\n  update(oldData) {\r\n    if (this.data.camera !== oldData.camera) {\r\n      this.camera = this.el.querySelector(this.data.camera);\r\n    }\r\n\r\n    if (this.data.leftController !== oldData.leftController) {\r\n      this.leftController = this.el.querySelector(this.data.leftController);\r\n    }\r\n\r\n    if (this.data.rightController !== oldData.rightController) {\r\n      this.rightController = this.el.querySelector(this.data.rightController);\r\n    }\r\n  }\r\n});\r\n\r\nfunction findIKRoot(entity) {\r\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\r\n    entity = entity.parentNode;\r\n  }\r\n  return entity && entity.components[\"ik-root\"];\r\n}\r\n\r\nconst HAND_ROTATIONS = {\r\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\r\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\r\n};\r\n\r\n/**\r\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\r\n * @namespace avatar\r\n * @component ik-controller\r\n */\r\nAFRAME.registerComponent(\"ik-controller\", {\r\n  schema: {\r\n    leftEye: { type: \"string\", default: \"LeftEye\" },\r\n    rightEye: { type: \"string\", default: \"RightEye\" },\r\n    head: { type: \"string\", default: \"Head\" },\r\n    neck: { type: \"string\", default: \"Neck\" },\r\n    leftHand: { type: \"string\", default: \"LeftHand\" },\r\n    rightHand: { type: \"string\", default: \"RightHand\" },\r\n    chest: { type: \"string\", default: \"Spine\" },\r\n    rotationSpeed: { default: 5 },\r\n    alwaysUpdate: { type: \"boolean\", default: false }\r\n  },\r\n\r\n  init() {\r\n    this._runScheduledWork = this._runScheduledWork.bind(this);\r\n    this._updateIsInView = this._updateIsInView.bind(this);\r\n\r\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\r\n\r\n    this.cameraForward = new Matrix4();\r\n    this.headTransform = new Matrix4();\r\n    this.hipsPosition = new Vector3();\r\n\r\n    this.invHipsToHeadVector = new Vector3();\r\n\r\n    this.middleEyeMatrix = new Matrix4();\r\n    this.middleEyePosition = new Vector3();\r\n    this.invMiddleEyeToHead = new Matrix4();\r\n\r\n    this.cameraYRotation = new Euler();\r\n    this.cameraYQuaternion = new Quaternion();\r\n\r\n    this.invHipsQuaternion = new Quaternion();\r\n    this.headQuaternion = new Quaternion();\r\n\r\n    this.rootToChest = new Matrix4();\r\n    this.invRootToChest = new Matrix4();\r\n\r\n    this.ikRoot = findIKRoot(this.el);\r\n\r\n    this.isInView = true;\r\n    this.hasConvergedHips = false;\r\n    this.lastCameraTransform = new THREE.Matrix4();\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\r\n    });\r\n\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\r\n    this.forceIkUpdate = true;\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\r\n  },\r\n\r\n  update(oldData) {\r\n    this.avatar = this.el.object3D;\r\n\r\n    if (this.data.leftEye !== oldData.leftEye) {\r\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\r\n    }\r\n\r\n    if (this.data.rightEye !== oldData.rightEye) {\r\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\r\n    }\r\n\r\n    if (this.data.head !== oldData.head) {\r\n      this.head = this.el.object3D.getObjectByName(this.data.head);\r\n    }\r\n\r\n    if (this.data.neck !== oldData.neck) {\r\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\r\n    }\r\n\r\n    if (this.data.leftHand !== oldData.leftHand) {\r\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\r\n    }\r\n\r\n    if (this.data.rightHand !== oldData.rightHand) {\r\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\r\n    }\r\n\r\n    if (this.data.chest !== oldData.chest) {\r\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\r\n    }\r\n\r\n    // Set middleEye's position to be right in the middle of the left and right eyes.\r\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\r\n    this.middleEyePosition.divideScalar(2);\r\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\r\n    this.invMiddleEyeToHead = this.middleEyeMatrix.getInverse(this.middleEyeMatrix);\r\n\r\n    this.invHipsToHeadVector\r\n      .addVectors(this.chest.position, this.neck.position)\r\n      .add(this.head.position)\r\n      .negate();\r\n  },\r\n\r\n  tick(time, dt) {\r\n    if (!this.ikRoot) {\r\n      return;\r\n    }\r\n\r\n    const root = this.ikRoot.el.object3D;\r\n    root.updateMatrices();\r\n    const { camera, leftController, rightController } = this.ikRoot;\r\n\r\n    camera.object3D.updateMatrix();\r\n\r\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\r\n\r\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\r\n    // then the avatar does not need any IK this frame.\r\n    //\r\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\r\n    if (\r\n      this.data.alwaysUpdate ||\r\n      this.forceIkUpdate ||\r\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\r\n    ) {\r\n      if (hasNewCameraTransform) {\r\n        this.lastCameraTransform.copy(camera.object3D.matrix);\r\n      }\r\n\r\n      const {\r\n        avatar,\r\n        head,\r\n        neck,\r\n        chest,\r\n        cameraForward,\r\n        headTransform,\r\n        invMiddleEyeToHead,\r\n        invHipsToHeadVector,\r\n        flipY,\r\n        cameraYRotation,\r\n        cameraYQuaternion,\r\n        invHipsQuaternion,\r\n        rootToChest,\r\n        invRootToChest\r\n      } = this;\r\n\r\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\r\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\r\n\r\n      // Compute the head position such that the hmd position would be in line with the middleEye\r\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\r\n\r\n      // Then position the avatar such that the head is aligned with headTransform\r\n      // (which positions middleEye in line with the hmd)\r\n      //\r\n      // Note that we position the avatar itself, *not* the hips, since positioning the\r\n      // hips will use vertex skinning to do the root displacement, which results in\r\n      // frustum culling errors since three.js does not take into account skinning when\r\n      // computing frustum culling sphere bounds.\r\n      avatar.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\r\n\r\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\r\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\r\n      cameraYRotation.x = 0;\r\n      cameraYRotation.z = 0;\r\n      cameraYQuaternion.setFromEuler(cameraYRotation);\r\n\r\n      if (this._hadFirstTick) {\r\n        Quaternion.slerp(\r\n          avatar.quaternion,\r\n          cameraYQuaternion,\r\n          avatar.quaternion,\r\n          (this.data.rotationSpeed * dt) / 1000\r\n        );\r\n      } else {\r\n        avatar.quaternion.copy(cameraYQuaternion);\r\n      }\r\n\r\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, avatar.quaternion);\r\n\r\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\r\n      // and apply it to the head\r\n      invHipsQuaternion.copy(avatar.quaternion).inverse();\r\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\r\n\r\n      avatar.updateMatrix();\r\n      rootToChest.multiplyMatrices(avatar.matrix, chest.matrix);\r\n      invRootToChest.getInverse(rootToChest);\r\n\r\n      root.matrixNeedsUpdate = true;\r\n      neck.matrixNeedsUpdate = true;\r\n      head.matrixNeedsUpdate = true;\r\n      chest.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    const { leftHand, rightHand } = this;\r\n\r\n    if (leftHand) this.updateHand(HAND_ROTATIONS.left, leftHand, leftController.object3D, true, this.isInView);\r\n    if (rightHand) this.updateHand(HAND_ROTATIONS.right, rightHand, rightController.object3D, false, this.isInView);\r\n    this.forceIkUpdate = false;\r\n\r\n    if (!this._hadFirstTick) {\r\n      // Ensure the avatar is not shown until we've done our first IK step, to prevent seeing mis-oriented/t-pose pose or our own avatar at the wrong place.\r\n      this.ikRoot.el.object3D.visible = true;\r\n      this._hasFirstTick = true;\r\n    }\r\n  },\r\n\r\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\r\n    const handMatrix = handObject3D.matrix;\r\n\r\n    // TODO: This coupling with personal-space-invader is not ideal.\r\n    // There should be some intermediate thing managing multiple opinions about object visibility\r\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\r\n\r\n    if (spaceInvader) {\r\n      // If this hand has an invader, defer to it to manage visibility overall but tell it to hide based upon controller state\r\n      spaceInvader.setAlwaysHidden(!controllerObject3D.visible);\r\n    } else {\r\n      handObject3D.visible = controllerObject3D.visible;\r\n    }\r\n\r\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\r\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\r\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\r\n\r\n      handMatrix.multiply(handRotation);\r\n\r\n      handObject3D.position.setFromMatrixPosition(handMatrix);\r\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\r\n      handObject3D.matrixNeedsUpdate = true;\r\n    }\r\n  },\r\n\r\n  _runScheduledWork() {\r\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\r\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\r\n    // every frame.\r\n    this.forceIkUpdate = true;\r\n\r\n    this._updateIsInView();\r\n  },\r\n\r\n  _updateIsInView: (function() {\r\n    const frustum = new THREE.Frustum();\r\n    const frustumMatrix = new THREE.Matrix4();\r\n    const cameraWorld = new THREE.Vector3();\r\n    const isInViewOfCamera = (screenCamera, pos) => {\r\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\r\n      frustum.setFromMatrix(frustumMatrix);\r\n      return frustum.containsPoint(pos);\r\n    };\r\n\r\n    return function() {\r\n      if (!this.playerCamera) return;\r\n\r\n      const camera = this.ikRoot.camera.object3D;\r\n      camera.getWorldPosition(cameraWorld);\r\n\r\n      // Check player camera\r\n      this.isInView = isInViewOfCamera(this.playerCamera, cameraWorld);\r\n\r\n      if (!this.isInView) {\r\n        // Check in-game camera if rendering to viewfinder and owned\r\n        const cameraTools = this.el.sceneEl.systems[\"camera-tools\"];\r\n\r\n        if (cameraTools) {\r\n          cameraTools.ifMyCameraRenderingViewfinder(cameraTool => {\r\n            this.isInView = this.isInView || isInViewOfCamera(cameraTool.camera, cameraWorld);\r\n          });\r\n        }\r\n      }\r\n    };\r\n  })()\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\n\r\nconst POSES = {\r\n  open: \"open\",\r\n  point: \"point\",\r\n  fist: \"fist\",\r\n  hold: \"hold\",\r\n  thumbUp: \"thumbUp\",\r\n  thumbDown: \"thumbDown\",\r\n  indexDown: \"indexDown\",\r\n  pinch: \"pinch\",\r\n  mrpDown: \"mrpDown\"\r\n};\r\n\r\n/**\r\n * Emits events indicating that avatar hands should be posed differently.\r\n * @namespace user-input\r\n * @component hand-controls2\r\n */\r\nAFRAME.registerComponent(\"hand-controls2\", {\r\n  schema: { default: \"left\" },\r\n\r\n  init() {\r\n    this.pose = POSES.open;\r\n  },\r\n\r\n  poseForFingers(thumb, index, middleRingPinky) {\r\n    if (!thumb && !index && !middleRingPinky) {\r\n      return POSES.open;\r\n    } else if (thumb && index && middleRingPinky) {\r\n      return POSES.fist;\r\n    } else if (!thumb && index && middleRingPinky) {\r\n      return POSES.thumbUp;\r\n    } else if (!thumb && !index && middleRingPinky) {\r\n      return POSES.mrpDown;\r\n    } else if (!thumb && index && !middleRingPinky) {\r\n      return POSES.indexDown;\r\n    } else if (thumb && !index && !middleRingPinky) {\r\n      return POSES.thumbDown;\r\n    } else if (thumb && index && !middleRingPinky) {\r\n      return POSES.pinch;\r\n    } else if (thumb && !index && middleRingPinky) {\r\n      return POSES.point;\r\n    }\r\n\r\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\r\n    return POSES.open;\r\n  },\r\n\r\n  tick() {\r\n    const hand = this.data;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\r\n    const thumb = userinput.get(subpath.thumb);\r\n    const index = userinput.get(subpath.index);\r\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\r\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\r\n    if (pose !== this.pose) {\r\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\r\n      this.pose = pose;\r\n    }\r\n  }\r\n});\r\n","import { showHoverEffect } from \"../utils/permissions-utils\";\r\n\r\n/**\r\n * Applies effects to a hoverer based on hover state.\r\n * @namespace interactables\r\n * @component hover-visuals\r\n */\r\nAFRAME.registerComponent(\"hover-visuals\", {\r\n  schema: {\r\n    hand: { type: \"string\" }\r\n  },\r\n  init() {\r\n    // uniforms are set from the component responsible for loading the mesh.\r\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\r\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\r\n    this.hadLeftVisualLastFrame = false;\r\n    this.hadRightVisualLastFrame = false;\r\n    this.uniforms = null;\r\n    this.sweepParams = [0, 1.0];\r\n  },\r\n  remove() {\r\n    this.uniforms = null;\r\n  },\r\n  tick() {\r\n    if (!this.uniforms || !this.uniforms.length) return;\r\n\r\n    // Push down loops to assist JIT:\r\n    if (this.data.hand === \"left\") {\r\n      this.handleLeftVisuals();\r\n    } else {\r\n      this.handleRightVisuals();\r\n    }\r\n  },\r\n\r\n  handleLeftVisuals: function() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\r\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\r\n\r\n    // Last frame, we didn't have a visual so no need to update uniforms.\r\n    if (hideVisual && !this.hadLeftVisualLastFrame) return;\r\n    this.hadLeftVisualLastFrame = !hideVisual;\r\n\r\n    const elements = this.el.object3D.matrixWorld.elements;\r\n\r\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\r\n      const uniform = this.uniforms[i];\r\n      uniform.hubs_HighlightInteractorOne.value = !hideVisual;\r\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\r\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\r\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\r\n    }\r\n  },\r\n\r\n  handleRightVisuals: function() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n\r\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\r\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\r\n\r\n    // Last frame, we didn't have a visual so no need to update uniforms.\r\n    if (hideVisual && !this.hadRightVisualLastFrame) return;\r\n    this.hadRightVisualLastFrame = !hideVisual;\r\n\r\n    const elements = this.el.object3D.matrixWorld.elements;\r\n\r\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\r\n      const uniform = this.uniforms[i];\r\n      uniform.hubs_SweepParams.value = this.sweepParams;\r\n\r\n      uniform.hubs_HighlightInteractorTwo.value = !hideVisual;\r\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\r\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\r\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\r\n    }\r\n  }\r\n});\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\n/**\r\n * Positions an entity relative to a given target when the given event is fired.\r\n * @component offset-relative-to\r\n */\r\nAFRAME.registerComponent(\"offset-relative-to\", {\r\n  schema: {\r\n    target: {\r\n      type: \"selector\"\r\n    },\r\n    offset: {\r\n      type: \"vec3\"\r\n    },\r\n    on: {\r\n      type: \"string\"\r\n    },\r\n    orientation: {\r\n      default: 1 // see doc/image_orientations.gif\r\n    },\r\n    selfDestruct: {\r\n      default: false\r\n    },\r\n    lookAt: {\r\n      default: false\r\n    }\r\n  },\r\n  init() {\r\n    this.updateOffset = this.updateOffset.bind(this);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      if (this.data.on) {\r\n        this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\r\n      } else {\r\n        this.updateOffset();\r\n      }\r\n    });\r\n  },\r\n\r\n  updateOffset: (function() {\r\n    const y = new THREE.Vector3(0, 1, 0);\r\n    const z = new THREE.Vector3(0, 0, -1);\r\n    const QUARTER_CIRCLE = Math.PI / 2;\r\n    const offsetVector = new THREE.Vector3();\r\n    const targetWorldPos = new THREE.Vector3();\r\n    return function() {\r\n      const obj = this.el.object3D;\r\n      const target = this.data.target.object3D;\r\n      offsetVector.copy(this.data.offset);\r\n      target.localToWorld(offsetVector);\r\n      if (obj.parent) {\r\n        obj.parent.worldToLocal(offsetVector);\r\n      }\r\n      obj.position.copy(offsetVector);\r\n      if (this.data.lookAt) {\r\n        target.getWorldPosition(targetWorldPos);\r\n        obj.updateMatrices(true);\r\n        obj.lookAt(targetWorldPos);\r\n      } else {\r\n        target.getWorldQuaternion(obj.quaternion);\r\n      }\r\n\r\n      // See doc/image_orientations.gif\r\n      switch (this.data.orientation) {\r\n        case 8:\r\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\r\n          break;\r\n        case 7:\r\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\r\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\r\n          break;\r\n        case 6:\r\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\r\n          break;\r\n        case 5:\r\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\r\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\r\n          break;\r\n        case 4:\r\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\r\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\r\n          break;\r\n        case 3:\r\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\r\n          break;\r\n        case 2:\r\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\r\n          break;\r\n        case 1:\r\n        default:\r\n          break;\r\n      }\r\n\r\n      obj.matrixNeedsUpdate = true;\r\n\r\n      if (this.data.selfDestruct) {\r\n        if (this.data.on) {\r\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\r\n        }\r\n        this.el.removeAttribute(\"offset-relative-to\");\r\n      }\r\n    };\r\n  })()\r\n});\r\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\r\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\r\nimport { registerComponentInstance } from \"../utils/component-utils\";\r\nimport { deregisterComponentInstance } from \"../utils/component-utils\";\r\n\r\nfunction ensureAvatarNodes(json) {\r\n  const { nodes } = json;\r\n  if (!nodes.some(node => node.name === \"Head\")) {\r\n    // If the avatar model doesn't have a Head node. The user has probably chosen a custom GLB.\r\n    // So, we need to construct a suitable hierarchy for avatar functionality to work.\r\n    // We re-parent the original root node to the Head node and set the scene root to a new AvatarRoot.\r\n\r\n    // Note: We assume that the first node in the primary scene is the one we care about.\r\n    const originalRoot = json.scenes[json.scene].nodes[0];\r\n    nodes.push({ name: \"LeftEye\", extensions: { MOZ_hubs_components: {} } });\r\n    nodes.push({ name: \"RightEye\", extensions: { MOZ_hubs_components: {} } });\r\n    nodes.push({\r\n      name: \"Head\",\r\n      children: [originalRoot, nodes.length - 1, nodes.length - 2],\r\n      extensions: { MOZ_hubs_components: { \"scale-audio-feedback\": \"\" } }\r\n    });\r\n    nodes.push({ name: \"Neck\", children: [nodes.length - 1] });\r\n    nodes.push({ name: \"Spine\", children: [nodes.length - 1] });\r\n    nodes.push({ name: \"Hips\", children: [nodes.length - 1] });\r\n    nodes.push({ name: \"AvatarRoot\", children: [nodes.length - 1] });\r\n    json.scenes[json.scene].nodes[0] = nodes.length - 1;\r\n  }\r\n  return json;\r\n}\r\n\r\n/**\r\n * Sets player info state, including avatar choice and display name.\r\n * @namespace avatar\r\n * @component player-info\r\n */\r\nAFRAME.registerComponent(\"player-info\", {\r\n  schema: {\r\n    avatarSrc: { type: \"string\" },\r\n    avatarType: { type: \"string\", default: AVATAR_TYPES.SKINNABLE }\r\n  },\r\n  init() {\r\n    this.displayName = null;\r\n    this.identityName = null;\r\n    this.isOwner = false;\r\n    this.isRecording = false;\r\n    this.applyProperties = this.applyProperties.bind(this);\r\n    this.updateDisplayName = this.updateDisplayName.bind(this);\r\n    this.applyDisplayName = this.applyDisplayName.bind(this);\r\n    this.handleModelError = this.handleModelError.bind(this);\r\n    this.update = this.update.bind(this);\r\n\r\n    this.isLocalPlayerInfo = this.el.id === \"avatar-rig\";\r\n    this.playerSessionId = null;\r\n\r\n    if (!this.isLocalPlayerInfo) {\r\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\r\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\r\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\r\n        if (playerPresence) {\r\n          this.updateDisplayNameFromPresenceMeta(playerPresence.metas[0]);\r\n        }\r\n      });\r\n    }\r\n    registerComponentInstance(this, \"player-info\");\r\n  },\r\n  remove() {\r\n    deregisterComponentInstance(this, \"player-info\");\r\n  },\r\n  play() {\r\n    this.el.addEventListener(\"model-loaded\", this.applyProperties);\r\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.updateDisplayName);\r\n    if (this.isLocalPlayerInfo) {\r\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleModelError);\r\n    }\r\n    window.APP.store.addEventListener(\"statechanged\", this.update);\r\n\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.update);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.update);\r\n  },\r\n  pause() {\r\n    this.el.removeEventListener(\"model-loaded\", this.applyProperties);\r\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.updateDisplayName);\r\n    if (this.isLocalPlayerInfo) {\r\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleModelError);\r\n    }\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.update);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.update);\r\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\r\n  },\r\n\r\n  update() {\r\n    this.applyProperties();\r\n  },\r\n  updateDisplayName(e) {\r\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\r\n      this.playerSessionId = NAF.clientId;\r\n    }\r\n    if (!this.playerSessionId) return;\r\n    if (this.playerSessionId !== e.detail.sessionId) return;\r\n\r\n    this.updateDisplayNameFromPresenceMeta(e.detail);\r\n  },\r\n  updateDisplayNameFromPresenceMeta(presenceMeta) {\r\n    this.displayName = presenceMeta.profile.displayName;\r\n    this.identityName = presenceMeta.profile.identityName;\r\n    this.isRecording = !!(presenceMeta.streaming || presenceMeta.recording);\r\n    this.isOwner = !!(presenceMeta.roles && presenceMeta.roles.owner);\r\n    this.applyDisplayName();\r\n  },\r\n  applyDisplayName() {\r\n    const store = window.APP.store;\r\n\r\n    const infoShouldBeHidden =\r\n      this.isLocalPlayerInfo || (store.state.preferences.onlyShowNametagsInFreeze && !this.el.sceneEl.is(\"frozen\"));\r\n\r\n    const nametagEl = this.el.querySelector(\".nametag\");\r\n    if (this.displayName && nametagEl) {\r\n      nametagEl.setAttribute(\"text\", { value: this.displayName });\r\n      nametagEl.object3D.visible = !infoShouldBeHidden;\r\n    }\r\n    const identityNameEl = this.el.querySelector(\".identityName\");\r\n    if (identityNameEl) {\r\n      if (this.identityName) {\r\n        identityNameEl.setAttribute(\"text\", { value: this.identityName });\r\n        identityNameEl.object3D.visible = this.el.sceneEl.is(\"frozen\");\r\n      }\r\n    }\r\n    const recordingBadgeEl = this.el.querySelector(\".recordingBadge\");\r\n    if (recordingBadgeEl) {\r\n      recordingBadgeEl.object3D.visible = this.isRecording && !infoShouldBeHidden;\r\n    }\r\n\r\n    const modBadgeEl = this.el.querySelector(\".modBadge\");\r\n    if (modBadgeEl) {\r\n      modBadgeEl.object3D.visible = !this.isRecording && this.isOwner && !infoShouldBeHidden;\r\n    }\r\n  },\r\n  applyProperties(e) {\r\n    this.applyDisplayName();\r\n\r\n    const modelEl = this.el.querySelector(\".model\");\r\n    if (this.data.avatarSrc && modelEl) {\r\n      modelEl.components[\"gltf-model-plus\"].jsonPreprocessor = ensureAvatarNodes;\r\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\r\n    }\r\n\r\n    if (!e || e.target === modelEl) {\r\n      const uniforms = injectCustomShaderChunks(this.el.object3D);\r\n      this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\r\n        el.components[\"hover-visuals\"].uniforms = uniforms;\r\n      });\r\n    }\r\n  },\r\n  handleModelError() {\r\n    window.APP.store.resetToRandomDefaultAvatar();\r\n  }\r\n});\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\n\r\nconst POSES = {\r\n  open: \"allOpen\",\r\n  thumbDown: \"thumbDown\",\r\n  indexDown: \"indexDown\",\r\n  mrpDown: \"mrpDown\",\r\n  thumbUp: \"thumbsUp\",\r\n  point: \"point\",\r\n  fist: \"allGrip\",\r\n  pinch: \"pinch\"\r\n};\r\n\r\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\r\n\r\n/**\r\n * Animates between poses based on networked pose state using an animation mixer.\r\n * @namespace avatar\r\n * @component hand-pose\r\n */\r\nAFRAME.registerComponent(\"hand-pose\", {\r\n  multiple: true,\r\n\r\n  init() {\r\n    this.pose = 0;\r\n    this.animatePose = this.animatePose.bind(this);\r\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\r\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\r\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\r\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\r\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\r\n      this.el.removeAttribute(\"hand-pose\");\r\n      return;\r\n    }\r\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\r\n    this.from.play();\r\n    this.networkField = `${this.id}_hand_pose`;\r\n\r\n    const getNetworkedAvatar = el => {\r\n      if (!el) {\r\n        window.setTimeout(() => {\r\n          getNetworkedAvatar(this.el);\r\n        }, 1000);\r\n        return;\r\n      }\r\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\r\n      if (networkedAvatar) {\r\n        return networkedAvatar;\r\n      }\r\n      return getNetworkedAvatar(el.parentEl);\r\n    };\r\n    this.networkedAvatar = getNetworkedAvatar(this.el);\r\n  },\r\n\r\n  tick() {\r\n    if (\r\n      !this.networkedAvatar ||\r\n      !this.networkedAvatar.data ||\r\n      this.networkedAvatar.data[this.networkField] === this.pose\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[this.networkField]]);\r\n    this.pose = this.networkedAvatar.data[this.networkField];\r\n  },\r\n\r\n  animatePose(prev, curr) {\r\n    this.from.stop();\r\n    this.to.stop();\r\n\r\n    const duration = 0.065;\r\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\r\n    this.from = this.mixer.clipAction(prev + suffix);\r\n    this.to = this.mixer.clipAction(curr + suffix);\r\n\r\n    this.from.fadeOut(duration);\r\n    this.to.fadeIn(duration);\r\n    this.to.play();\r\n    this.from.play();\r\n\r\n    this.mixer.update(0.001);\r\n  }\r\n});\r\n\r\n/**\r\n * Sets the networked hand pose state based on hand-pose events.\r\n * @namespace avatar\r\n * @component hand-pose-controller\r\n */\r\nAFRAME.registerComponent(\"hand-pose-controller\", {\r\n  multiple: true,\r\n  schema: {\r\n    eventSrc: { type: \"selector\" },\r\n    networkedAvatar: { type: \"selector\" }\r\n  },\r\n  init: function() {\r\n    this.setHandPose = this.setHandPose.bind(this);\r\n  },\r\n\r\n  play: function() {\r\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\r\n  },\r\n\r\n  pause: function() {\r\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\r\n  },\r\n\r\n  setHandPose: function(evt) {\r\n    this.data.networkedAvatar.setAttribute(\r\n      \"networked-avatar\",\r\n      `${this.id}_hand_pose`,\r\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\r\n    );\r\n  }\r\n});\r\n","import { CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\r\nconst TWOPI = Math.PI * 2;\r\nfunction deltaAngle(a, b) {\r\n  const p = Math.abs(b - a) % TWOPI;\r\n  return p > Math.PI ? TWOPI - p : p;\r\n}\r\n\r\n/**\r\n * Positions the HUD and toggles app mode based on where the user is looking\r\n * @namespace ui\r\n * @component hud-controller\r\n */\r\nAFRAME.registerComponent(\"hud-controller\", {\r\n  schema: {\r\n    head: { type: \"selector\" },\r\n    offset: { default: 0.7 }, // distance from hud above head,\r\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\r\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\r\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\r\n  },\r\n  init() {\r\n    this.onChildHovered = this.onChildHovered.bind(this);\r\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\r\n    this.isYLocked = false;\r\n    this.lockedHeadPositionY = 0;\r\n    this.lookDir = new THREE.Vector3();\r\n    this.lookEuler = new THREE.Euler();\r\n    this.store = window.APP.store;\r\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\r\n  },\r\n\r\n  tick() {\r\n    const hud = this.el.object3D;\r\n    const head = this.data.head.object3D;\r\n\r\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\r\n\r\n    const pitch = head.rotation.x * THREE.Math.RAD2DEG;\r\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.Math.RAD2DEG;\r\n\r\n    // HUD is always visible until first hover, to increase discoverability.\r\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\r\n\r\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\r\n    let t = 1 - THREE.Math.clamp(lookCutoff - pitch, 0, animRange) / animRange;\r\n\r\n    // HUD is locked down while showing tooltip or if forced.\r\n    if (forceHudVisible) {\r\n      t = 1;\r\n    }\r\n\r\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\r\n    if (t === 1) {\r\n      this.lockedHeadPositionY = head.position.y;\r\n      this.hudLocked = true;\r\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\r\n      this.hudLocked = false;\r\n    }\r\n\r\n    if (this.hudLocked) {\r\n      t = 1;\r\n    }\r\n\r\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\r\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\r\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\r\n\r\n    if (hudOutOfView) {\r\n      this.lookDir.set(0, 0, -1);\r\n      this.lookDir.applyQuaternion(head.quaternion);\r\n      this.lookDir.add(head.position);\r\n      hud.position.x = this.lookDir.x;\r\n      hud.position.z = this.lookDir.z;\r\n      hud.rotation.copy(head.rotation);\r\n      hud.rotation.x = 0;\r\n      hud.rotation.z = 0;\r\n    }\r\n\r\n    hud.visible =\r\n      (!hudOutOfView || forceHudVisible) &&\r\n      this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_FIRST_PERSON;\r\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\r\n    hud.rotation.x = (1 - t) * THREE.Math.DEG2RAD * 90;\r\n    hud.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  play() {\r\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\r\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\r\n    }\r\n  },\r\n\r\n  pause() {\r\n    this.removeHoverEvents();\r\n  },\r\n\r\n  removeHoverEvents() {\r\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\r\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\r\n    }\r\n  },\r\n\r\n  onChildHovered() {\r\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\r\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\r\n      this.removeHoverEvents();\r\n    }\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\r\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\r\n\r\n/**\r\n * Toggles freezing of network traffic on the given event.\r\n * @namespace network\r\n * @component freeze-controller\r\n */\r\nAFRAME.registerComponent(\"freeze-controller\", {\r\n  init: function() {\r\n    this.onToggle = this.onToggle.bind(this);\r\n  },\r\n\r\n  tick: function() {\r\n    const scene = this.el.sceneEl;\r\n    if (!scene.is(\"entered\")) return;\r\n    const inspecting = scene.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT;\r\n    if (inspecting) {\r\n      if (this.el.is(\"frozen\")) {\r\n        this.onToggle();\r\n      }\r\n      if (!NAF.connection.adapter.frozen) {\r\n        NAF.connection.adapter.toggleFreeze();\r\n      }\r\n      this.wasInspecting = true;\r\n    } else if (this.wasInspecting) {\r\n      if (NAF.connection.adapter.frozen) {\r\n        NAF.connection.adapter.toggleFreeze();\r\n      }\r\n      this.wasInspecting = false;\r\n    } else {\r\n      const userinput = scene.systems.userinput;\r\n      const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\r\n      const thaw = userinput.get(paths.actions.thaw);\r\n      const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\r\n\r\n      const toggleFreezeDueToInput =\r\n        (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\r\n\r\n      if (toggleFreezeDueToInput) {\r\n        this.onToggle();\r\n      }\r\n    }\r\n  },\r\n\r\n  onToggle: function() {\r\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\r\n    if (!NAF.connection.adapter) return;\r\n    NAF.connection.adapter.toggleFreeze();\r\n    if (NAF.connection.adapter.frozen) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\r\n      this.el.addState(\"frozen\");\r\n    } else {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\r\n      this.el.removeState(\"frozen\");\r\n    }\r\n  }\r\n});\r\n","import { getLastWorldPosition } from \"../utils/three-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\n\r\n/**\r\n * Toggles the visibility of this entity when the scene is frozen.\r\n * @namespace ui\r\n * @component visibility-while-frozen\r\n */\r\nAFRAME.registerComponent(\"visibility-while-frozen\", {\r\n  schema: {\r\n    withinDistance: { type: \"number\" },\r\n    visible: { type: \"boolean\", default: true },\r\n    requireHoverOnNonMobile: { type: \"boolean\", default: true },\r\n    withPermission: { type: \"string\" },\r\n    withoutPermission: { type: \"string\" },\r\n    visibleIfOwned: { type: \"boolean\", default: true }\r\n  },\r\n\r\n  init() {\r\n    this.updateVisibility = this.updateVisibility.bind(this);\r\n    this.camWorldPos = new THREE.Vector3();\r\n    this.objWorldPos = new THREE.Vector3();\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.cam = document.getElementById(\"viewing-camera\").object3D;\r\n      this.updateVisibility();\r\n    });\r\n\r\n    let hoverableSearch = this.el;\r\n\r\n    while (hoverableSearch !== document) {\r\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\r\n        this.hoverable = hoverableSearch;\r\n        break;\r\n      }\r\n\r\n      hoverableSearch = hoverableSearch.parentNode;\r\n    }\r\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\r\n      console.error(\"Didn't find a remote hover target.\");\r\n    }\r\n\r\n    if (!this.data.visibleIfOwned) {\r\n      NAF.utils\r\n        .getNetworkedEntity(this.el)\r\n        .then(networkedEl => {\r\n          this.networkedEl = networkedEl;\r\n        })\r\n        .then(() => {}); //ignore exception, entity might not be networked\r\n    }\r\n\r\n    this.onStateChange = evt => {\r\n      if (!evt.detail === \"frozen\") return;\r\n      this.updateVisibility();\r\n    };\r\n    this.updateVisibility();\r\n  },\r\n\r\n  tick() {\r\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\r\n    const isVisible = this.el.object3D.visible;\r\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\r\n    if (!isVisible && shouldNotBeVisible) return;\r\n\r\n    this.updateVisibility();\r\n  },\r\n\r\n  updateVisibility() {\r\n    if (!this.cam) return;\r\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\r\n\r\n    let isWithinDistance = true;\r\n    const isVisible = this.el.object3D.visible;\r\n\r\n    if (this.data.withinDistance) {\r\n      if (!isVisible) {\r\n        // Edge case, if the object is not visible force a matrix update\r\n        // since the main matrix update loop will not do it.\r\n        this.el.object3D.updateMatrices(true, true);\r\n      }\r\n\r\n      getLastWorldPosition(this.cam, this.camWorldPos);\r\n      this.objWorldPos.copy(this.el.object3D.position);\r\n      this.el.object3D.localToWorld(this.objWorldPos);\r\n\r\n      isWithinDistance =\r\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\r\n    }\r\n\r\n    const isTransforming = this.el.sceneEl.systems[\"transform-selected-object\"].transforming;\r\n\r\n    if (this.data.withPermission && this.data.withoutPermission) {\r\n      throw new Error(\r\n        \"only withPermission or withoutPermission can be speciifed on visibility-while-frozen, not both.\"\r\n      );\r\n    }\r\n\r\n    const allowed = !!(\r\n      (!this.data.withPermission && !this.data.withoutPermission) ||\r\n      (this.data.withPermission &&\r\n        window.APP.hubChannel &&\r\n        window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission)) ||\r\n      (this.data.withoutPermission &&\r\n        window.APP.hubChannel &&\r\n        !window.APP.hubChannel.canOrWillIfCreator(this.data.withoutPermission))\r\n    );\r\n\r\n    let shouldBeVisible =\r\n      allowed &&\r\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) &&\r\n      isWithinDistance &&\r\n      !isTransforming;\r\n\r\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\r\n      shouldBeVisible =\r\n        shouldBeVisible &&\r\n        ((this.hoverable &&\r\n          (this.el.sceneEl.systems.interaction.state.rightRemote.hovered === this.hoverable ||\r\n            this.el.sceneEl.systems.interaction.state.leftRemote.hovered === this.hoverable)) ||\r\n          isVisible);\r\n    }\r\n\r\n    if (!this.data.visibleIfOwned) {\r\n      shouldBeVisible = shouldBeVisible && this.networkedEl && !NAF.utils.isMine(this.networkedEl);\r\n    }\r\n\r\n    if (isVisible !== shouldBeVisible) {\r\n      this.el.setAttribute(\"visible\", shouldBeVisible);\r\n    }\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\r\n\r\n    if (this.hoverable) {\r\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\r\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\r\n    }\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\r\n\r\n    if (this.hoverable) {\r\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\r\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\r\n    }\r\n  }\r\n});\r\n\r\n/**\r\n * Toggles the interactivity of a UI entity while the scene is frozen.\r\n * @namespace ui\r\n * @component ui-class-while-frozen\r\n */\r\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\r\n  init() {\r\n    this.onStateChange = evt => {\r\n      if (!evt.detail === \"frozen\") return;\r\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\r\n    };\r\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\r\n  },\r\n\r\n  play() {\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\r\n  },\r\n\r\n  pause() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\r\n  }\r\n});\r\n","import \"./stats-plus.css\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\r\n\r\nfunction createStats(scene) {\r\n  const threeStats = new window.threeStats(scene.renderer);\r\n  const aframeStats = new window.aframeStats(scene);\r\n  const plugins = scene.isMobile ? [] : [threeStats, aframeStats];\r\n  return new window.rStats({\r\n    css: [], // Our stylesheet is injected from AFrame.\r\n    values: {\r\n      fps: { caption: \"fps\", below: 30 },\r\n      batchdraws: { caption: \"Draws\" },\r\n      batchinstances: { caption: \"Instances\" },\r\n      batchatlassize: { caption: \"Atlas Size\" }\r\n    },\r\n    groups: [\r\n      { caption: \"Framerate\", values: [\"fps\", \"raf\", \"physics\"] },\r\n      { caption: \"Batching\", values: [\"batchdraws\", \"batchinstances\", \"batchatlassize\"] }\r\n    ],\r\n    plugins: plugins\r\n  });\r\n}\r\n\r\nconst HIDDEN_CLASS = \"a-hidden\";\r\n\r\nAFRAME.registerComponent(\"stats-plus\", {\r\n  // Whether or not the stats panel is expanded.\r\n  // Shows FPS counter when collapsed.\r\n  schema: { default: false },\r\n  init() {\r\n    this.onExpand = this.onExpand.bind(this);\r\n    this.onCollapse = this.onCollapse.bind(this);\r\n    this.onEnterVr = this.onEnterVr.bind(this);\r\n    this.onExitVr = this.onExitVr.bind(this);\r\n\r\n    const scene = this.el.sceneEl;\r\n    this.stats = createStats(scene);\r\n    this.statsEl = document.querySelector(\".rs-base\");\r\n    // HACK for now in rare case where dom isn't ready, just bail\r\n    if (!this.statsEl) return;\r\n\r\n    // Add header to stats panel so we can collapse it\r\n    const statsHeaderEl = document.createElement(\"div\");\r\n    statsHeaderEl.classList.add(\"rs-header\");\r\n\r\n    const statsTitleEl = document.createElement(\"h1\");\r\n    statsTitleEl.innerHTML = \"Stats\";\r\n    statsHeaderEl.appendChild(statsTitleEl);\r\n\r\n    const collapseEl = document.createElement(\"div\");\r\n    collapseEl.classList.add(\"rs-collapse-btn\");\r\n    collapseEl.innerHTML = \"X\";\r\n    collapseEl.addEventListener(\"click\", this.onCollapse);\r\n    statsHeaderEl.appendChild(collapseEl);\r\n\r\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\r\n\r\n    // Add fps counter to the page\r\n    this.fpsEl = document.createElement(\"div\");\r\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\r\n    this.fpsEl.classList.add(\"rs-fps-counter\");\r\n    document.body.appendChild(this.fpsEl);\r\n    this.lastFpsUpdate = performance.now();\r\n    this.lastFps = 0;\r\n    this.frameCount = 0;\r\n    this.inVR = scene.is(\"vr-mode\");\r\n\r\n    if (scene.isMobile) {\r\n      this.statsEl.classList.add(\"rs-mobile\");\r\n      this.fpsEl.classList.add(\"rs-mobile\");\r\n    }\r\n\r\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\r\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\r\n\r\n    this.vrStatsEnabled = qsTruthy(\"vrstats\");\r\n    if (this.vrStatsEnabled) {\r\n      this.initVRStats();\r\n    }\r\n    this.lastUpdate = 0;\r\n  },\r\n  initVRStats() {\r\n    this.vrPanel = document.createElement(\"a-entity\");\r\n    this.vrPanel.setAttribute(\"text\", { width: 0.5, whiteSpace: \"pre\", value: \"_\", baseline: \"bottom\" });\r\n    this.vrPanel.addEventListener(\r\n      \"loaded\",\r\n      () =>\r\n        this.vrPanel.object3D.traverse(x => {\r\n          if (x.material) x.material.depthTest = false;\r\n        }),\r\n      { once: true }\r\n    );\r\n    this.el.append(this.vrPanel);\r\n    const background = document.createElement(\"a-plane\");\r\n    background.setAttribute(\"color\", \"#333333\");\r\n    background.setAttribute(\"material\", \"shader\", \"flat\");\r\n    background.setAttribute(\"material\", \"depthTest\", false);\r\n    background.setAttribute(\"width\", 0.1);\r\n    background.setAttribute(\"height\", 0.12);\r\n    background.setAttribute(\"position\", \"-0.2 0.055 0\");\r\n    this.el.append(background);\r\n  },\r\n  toggleVRStats() {\r\n    if (this.vrStatsEnabled) {\r\n      this.el.object3D.visible = false;\r\n      this.vrStatsEnabled = false;\r\n    } else {\r\n      if (!this.vrPanel) {\r\n        this.initVRStats();\r\n      }\r\n      this.el.object3D.visible = true;\r\n      this.vrStatsEnabled = true;\r\n    }\r\n  },\r\n  update(oldData) {\r\n    if (oldData !== this.data) {\r\n      if (this.data) {\r\n        this.statsEl.classList.remove(HIDDEN_CLASS);\r\n        this.fpsEl.classList.add(HIDDEN_CLASS);\r\n      } else {\r\n        this.statsEl.classList.add(HIDDEN_CLASS);\r\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\r\n      }\r\n    }\r\n  },\r\n  tick(time) {\r\n    const stats = this.stats;\r\n    if (!this.statsEl) return;\r\n    if (this.data || this.vrStatsEnabled) {\r\n      // Update rStats\r\n      stats(\"rAF\").tick();\r\n      stats(\"FPS\").frame();\r\n      stats(\"physics\").set(this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem.stepDuration);\r\n\r\n      const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\r\n      if (batchManagerSystem.batchingEnabled) {\r\n        const batchManager = batchManagerSystem.batchManager;\r\n        stats(\"batchdraws\").set(batchManager.batches.length);\r\n        stats(\"batchinstances\").set(batchManager.instanceCount);\r\n        stats(\"batchatlassize\").set(batchManager.atlas.arrayDepth);\r\n      }\r\n\r\n      stats().update();\r\n    } else if (!this.inVR) {\r\n      // Update the fps counter\r\n      const now = performance.now();\r\n      this.frameCount++;\r\n\r\n      // Update the fps counter text once a second\r\n      if (now >= this.lastFpsUpdate + 1000) {\r\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\r\n        if (fps !== this.lastFps) {\r\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\r\n          this.lastFps = fps;\r\n        }\r\n        this.lastFpsUpdate = now;\r\n        this.frameCount = 0;\r\n      }\r\n    }\r\n    if (this.vrStatsEnabled && time - this.lastUpdate > 100) {\r\n      this.vrPanel.setAttribute(\r\n        \"text\",\r\n        \"value\",\r\n        [\r\n          `f ${stats(\"fps\")\r\n            .value()\r\n            .toFixed(0)}`,\r\n          `r ${stats(\"raf\")\r\n            .value()\r\n            .toFixed(0)}`,\r\n          `p ${stats(\"physics\")\r\n            .value()\r\n            .toFixed(0)}`,\r\n          `c ${this.el.sceneEl.renderer.info.render.calls}`,\r\n          `t ${(this.el.sceneEl.renderer.info.render.triangles / 1000).toFixed(0)}k`\r\n        ].join(\"\\n\")\r\n      );\r\n      this.lastUpdate = time;\r\n    }\r\n  },\r\n  onEnterVr() {\r\n    this.inVR = true;\r\n    // Hide all stats elements when entering VR on mobile\r\n    if (this.el.sceneEl.isMobile) {\r\n      this.statsEl.classList.add(HIDDEN_CLASS);\r\n      this.fpsEl.classList.add(HIDDEN_CLASS);\r\n    }\r\n  },\r\n  onExitVr() {\r\n    this.inVR = false;\r\n    // Revert to previous state whe exiting VR on mobile\r\n    if (this.el.sceneEl.isMobile) {\r\n      if (this.data) {\r\n        this.statsEl.classList.remove(HIDDEN_CLASS);\r\n      } else {\r\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\r\n      }\r\n    }\r\n  },\r\n  onExpand() {\r\n    this.el.setAttribute(this.name, true);\r\n  },\r\n  onCollapse() {\r\n    this.el.setAttribute(this.name, false);\r\n  },\r\n  remove() {\r\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\r\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\r\n\r\n    if (this.statsEl) {\r\n      this.statsEl.parentNode.removeChild(this.statsEl);\r\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\r\n    }\r\n  }\r\n});\r\n","import { cloneMedia, closeExistingMediaMirror } from \"./media-utils\";\r\nlet mirrorTarget;\r\nexport function getCurrentMirroredMedia() {\r\n  mirrorTarget = mirrorTarget || document.querySelector(\"#media-mirror-target\");\r\n  const mirrorEl = mirrorTarget.firstChild;\r\n  const linkedEl = mirrorEl && mirrorEl.components[\"media-loader\"] && mirrorEl.components[\"media-loader\"].data.linkedEl;\r\n  return linkedEl;\r\n}\r\nexport async function refreshMediaMirror() {\r\n  const linkedEl = getCurrentMirroredMedia();\r\n  if (!linkedEl) {\r\n    return;\r\n  }\r\n  await closeExistingMediaMirror();\r\n  const { entity } = cloneMedia(\r\n    linkedEl,\r\n    \"#linked-media\",\r\n    linkedEl.components[\"media-loader\"].data.src,\r\n    false,\r\n    true,\r\n    mirrorTarget\r\n  );\r\n\r\n  entity.object3D.scale.set(0.75, 0.75, 0.75);\r\n  entity.object3D.matrixNeedsUpdate = true;\r\n\r\n  const refreshButton = entity.querySelector(\"[refresh-media-button]\");\r\n  if (refreshButton) {\r\n    refreshButton.parentNode.removeChild(refreshButton);\r\n  }\r\n\r\n  const localRefreshButton = entity.querySelector(\"[local-refresh-media-button]\");\r\n  if (localRefreshButton) {\r\n    localRefreshButton.parentNode.removeChild(localRefreshButton);\r\n  }\r\n\r\n  mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\r\n  mirrorTarget.parentEl.object3D.visible = true;\r\n}\r\n","/* global performance THREE AFRAME NAF MediaStream setTimeout */\r\nimport configs from \"../utils/configs\";\r\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\r\nimport errorImageSrc from \"!!url-loader!../assets/images/media-error.gif\";\r\nimport audioIcon from \"../assets/images/audio.png\";\r\nimport { paths } from \"../systems/userinput/paths\";\r\nimport HLS from \"hls.js/dist/hls.light.js\";\r\nimport { addAndArrangeMedia, createImageTexture, createBasisTexture } from \"../utils/media-utils\";\r\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\r\nimport { buildAbsoluteURL } from \"url-toolkit\";\r\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\r\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\r\nimport pdfjs from \"pdfjs-dist\";\r\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\r\nimport { refreshMediaMirror, getCurrentMirroredMedia } from \"../utils/mirror-utils\";\r\n\r\n// Using external CDN to reduce build size\r\nif (!pdfjs.GlobalWorkerOptions.workerSrc) {\r\n  pdfjs.GlobalWorkerOptions.workerSrc =\r\n    \"https://assets-prod.reticulum.io/assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js\";\r\n}\r\n\r\nconst ONCE_TRUE = { once: true };\r\nconst TYPE_IMG_PNG = { type: \"image/png\" };\r\nconst parseGIF = promisifyWorker(new GIFWorker());\r\n\r\nconst isIOS = AFRAME.utils.device.isIOS();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\nconst isFirefoxReality = isMobileVR && navigator.userAgent.match(/Firefox/);\r\nconst HLS_TIMEOUT = 10000; // HLS can sometimes fail, we re-try after this duration\r\nconst audioIconTexture = new THREE.TextureLoader().load(audioIcon);\r\n\r\nexport const VOLUME_LABELS = [];\r\nfor (let i = 0; i <= 20; i++) {\r\n  let s = \"[\";\r\n  for (let j = 1; j <= 20; j++) {\r\n    s += i >= j ? \"|\" : \" \";\r\n  }\r\n  s += \"]\";\r\n  VOLUME_LABELS[i] = s;\r\n}\r\n\r\nclass GIFTexture extends THREE.Texture {\r\n  constructor(frames, delays, disposals) {\r\n    super(document.createElement(\"canvas\"));\r\n    this.image.width = frames[0].width;\r\n    this.image.height = frames[0].height;\r\n\r\n    this._ctx = this.image.getContext(\"2d\");\r\n\r\n    this.generateMipmaps = false;\r\n    this.isVideoTexture = true;\r\n    this.minFilter = THREE.NearestFilter;\r\n\r\n    this.frames = frames;\r\n    this.delays = delays;\r\n    this.disposals = disposals;\r\n\r\n    this.frame = 0;\r\n    this.frameStartTime = Date.now();\r\n  }\r\n\r\n  update() {\r\n    if (!this.frames || !this.delays || !this.disposals) return;\r\n    const now = Date.now();\r\n    if (now - this.frameStartTime > this.delays[this.frame]) {\r\n      if (this.disposals[this.frame] === 2) {\r\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\r\n      }\r\n      this.frame = (this.frame + 1) % this.frames.length;\r\n      this.frameStartTime = now;\r\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\r\n      this.needsUpdate = true;\r\n    }\r\n  }\r\n}\r\n\r\nasync function createGIFTexture(url) {\r\n  return new Promise((resolve, reject) => {\r\n    fetch(url, { mode: \"cors\" })\r\n      .then(r => r.arrayBuffer())\r\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\r\n      .then(result => {\r\n        const { frames, delayTimes, disposals } = result;\r\n        let loadCnt = 0;\r\n        for (let i = 0; i < frames.length; i++) {\r\n          const img = new Image();\r\n          img.onload = e => {\r\n            loadCnt++;\r\n            frames[i] = e.target;\r\n            if (loadCnt === frames.length) {\r\n              const texture = new GIFTexture(frames, delayTimes, disposals);\r\n              texture.image.src = url;\r\n              texture.encoding = THREE.sRGBEncoding;\r\n              texture.minFilter = THREE.LinearFilter;\r\n              resolve(texture);\r\n            }\r\n          };\r\n          img.src = frames[i];\r\n        }\r\n      })\r\n      .catch(reject);\r\n  });\r\n}\r\n\r\n/**\r\n * Create video element to be used as a texture.\r\n *\r\n * @param {string} src - Url to a video file.\r\n * @returns {Element} Video element.\r\n */\r\nfunction createVideoOrAudioEl(type) {\r\n  const el = document.createElement(type);\r\n  el.setAttribute(\"playsinline\", \"\");\r\n  el.setAttribute(\"webkit-playsinline\", \"\");\r\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\r\n  el.autoplay = true;\r\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\r\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\r\n  el.muted = isIOS;\r\n  el.preload = \"auto\";\r\n  el.crossOrigin = \"anonymous\";\r\n\r\n  return el;\r\n}\r\n\r\nfunction scaleToAspectRatio(el, ratio) {\r\n  const width = Math.min(1.0, 1.0 / ratio);\r\n  const height = Math.min(1.0, ratio);\r\n  el.object3DMap.mesh.scale.set(width, height, 1);\r\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\r\n}\r\n\r\nfunction disposeTexture(texture) {\r\n  if (texture.image instanceof HTMLVideoElement) {\r\n    const video = texture.image;\r\n    video.pause();\r\n    video.src = \"\";\r\n    video.load();\r\n  }\r\n\r\n  if (texture.hls) {\r\n    texture.hls.stopLoad();\r\n    texture.hls.detachMedia();\r\n    texture.hls.destroy();\r\n    texture.hls = null;\r\n  }\r\n\r\n  texture.dispose();\r\n}\r\n\r\nclass TextureCache {\r\n  cache = new Map();\r\n\r\n  key(src, version) {\r\n    return `${src}_${version}`;\r\n  }\r\n\r\n  set(src, version, texture) {\r\n    const image = texture.image;\r\n    this.cache.set(this.key(src, version), {\r\n      texture,\r\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\r\n      count: 0\r\n    });\r\n    return this.retain(src, version);\r\n  }\r\n\r\n  has(src, version) {\r\n    return this.cache.has(this.key(src, version));\r\n  }\r\n\r\n  get(src, version) {\r\n    return this.cache.get(this.key(src, version));\r\n  }\r\n\r\n  retain(src, version) {\r\n    const cacheItem = this.cache.get(this.key(src, version));\r\n    cacheItem.count++;\r\n    // console.log(\"retain\", src, cacheItem.count);\r\n    return cacheItem;\r\n  }\r\n\r\n  release(src, version) {\r\n    const cacheItem = this.cache.get(this.key(src, version));\r\n\r\n    if (!cacheItem) {\r\n      console.error(`Releasing uncached texture src ${src}`);\r\n      return;\r\n    }\r\n\r\n    cacheItem.count--;\r\n    // console.log(\"release\", src, cacheItem.count);\r\n    if (cacheItem.count <= 0) {\r\n      // Unload the video element to prevent it from continuing to play in the background\r\n      disposeTexture(cacheItem.texture);\r\n      this.cache.delete(this.key(src, version));\r\n    }\r\n  }\r\n}\r\n\r\nconst textureCache = new TextureCache();\r\nconst inflightTextures = new Map();\r\n\r\nconst errorImage = new Image();\r\nerrorImage.src = errorImageSrc;\r\nconst errorTexture = new THREE.Texture(errorImage);\r\nerrorTexture.magFilter = THREE.NearestFilter;\r\nerrorImage.onload = () => {\r\n  errorTexture.needsUpdate = true;\r\n};\r\nconst errorCacheItem = { texture: errorTexture, ratio: 1 };\r\n\r\nfunction timeFmt(t) {\r\n  let s = Math.floor(t),\r\n    h = Math.floor(s / 3600);\r\n  s -= h * 3600;\r\n  let m = Math.floor(s / 60);\r\n  s -= m * 60;\r\n  if (h < 10) h = `0${h}`;\r\n  if (m < 10) m = `0${m}`;\r\n  if (s < 10) s = `0${s}`;\r\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\r\n}\r\n\r\nAFRAME.registerComponent(\"media-video\", {\r\n  schema: {\r\n    src: { type: \"string\" },\r\n    audioSrc: { type: \"string\" },\r\n    contentType: { type: \"string\" },\r\n    volume: { type: \"number\", default: 0.5 },\r\n    loop: { type: \"boolean\", default: true },\r\n    audioType: { type: \"string\", default: \"pannernode\" },\r\n    hidePlaybackControls: { type: \"boolean\", default: false },\r\n    distanceModel: { type: \"string\", default: \"inverse\" },\r\n    rolloffFactor: { type: \"number\", default: 1 },\r\n    refDistance: { type: \"number\", default: 1 },\r\n    maxDistance: { type: \"number\", default: 10000 },\r\n    coneInnerAngle: { type: \"number\", default: 360 },\r\n    coneOuterAngle: { type: \"number\", default: 0 },\r\n    coneOuterGain: { type: \"number\", default: 0 },\r\n    videoPaused: { type: \"boolean\" },\r\n    projection: { type: \"string\", default: \"flat\" },\r\n    time: { type: \"number\" },\r\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\r\n    syncTolerance: { default: 2 }\r\n  },\r\n\r\n  init() {\r\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\r\n    this.updateHoverMenu = this.updateHoverMenu.bind(this);\r\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\r\n    this.ensureOwned = this.ensureOwned.bind(this);\r\n    this.isMineOrLocal = this.isMineOrLocal.bind(this);\r\n    this.updateSrc = this.updateSrc.bind(this);\r\n\r\n    this.seekForward = this.seekForward.bind(this);\r\n    this.seekBack = this.seekBack.bind(this);\r\n    this.volumeUp = this.volumeUp.bind(this);\r\n    this.volumeDown = this.volumeDown.bind(this);\r\n    this.snap = this.snap.bind(this);\r\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\r\n    this.togglePlaying = this.togglePlaying.bind(this);\r\n\r\n    this.lastUpdate = 0;\r\n    this.videoMutedAt = 0;\r\n    this.localSnapCount = 0;\r\n    this.isSnapping = false;\r\n    this.videoIsLive = null; // value null until we've determined if the video is live or not.\r\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\r\n\r\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", dirs: [\"forward\", \"back\"] });\r\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\r\n      // If we got removed while waiting, do nothing.\r\n      if (!this.el.parentNode) return;\r\n\r\n      this.hoverMenu = menu;\r\n\r\n      this.playbackControls = this.el.querySelector(\".video-playback\");\r\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\r\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\r\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\r\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\r\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\r\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\r\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\r\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\r\n\r\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\r\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\r\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\r\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\r\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\r\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\r\n\r\n      this.updateVolumeLabel();\r\n      this.updateHoverMenu();\r\n      this.updatePlaybackState();\r\n    });\r\n\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(networkedEl => {\r\n        this.networkedEl = networkedEl;\r\n        applyPersistentSync(this.networkedEl.components.networked.data.networkId);\r\n        this.updatePlaybackState();\r\n\r\n        this.networkedEl.addEventListener(\"pinned\", this.updateHoverMenu);\r\n        this.networkedEl.addEventListener(\"unpinned\", this.updateHoverMenu);\r\n        window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateHoverMenu);\r\n\r\n        // For scene-owned videos, take ownership after a random delay if nobody\r\n        // else has so there is a timekeeper. Do not due this on iOS because iOS has an\r\n        // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\r\n        // at once, which will pause the videos for everyone in the room if owned.\r\n        if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\r\n          setTimeout(() => {\r\n            if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\r\n              NAF.utils.takeOwnership(this.networkedEl);\r\n            }\r\n          }, 2000 + Math.floor(Math.random() * 2000));\r\n        }\r\n      })\r\n      .catch(() => {\r\n        // Non-networked\r\n        this.updatePlaybackState();\r\n      });\r\n\r\n    // from a-sound\r\n    const sceneEl = this.el.sceneEl;\r\n    sceneEl.audioListener = sceneEl.audioListener || new THREE.AudioListener();\r\n    if (sceneEl.camera) {\r\n      sceneEl.camera.add(sceneEl.audioListener);\r\n    }\r\n    sceneEl.addEventListener(\"camera-set-active\", function(evt) {\r\n      evt.detail.cameraEl.getObject3D(\"camera\").add(sceneEl.audioListener);\r\n    });\r\n  },\r\n\r\n  isMineOrLocal() {\r\n    return !this.el.components.networked || (this.networkedEl && NAF.utils.isMine(this.networkedEl));\r\n  },\r\n\r\n  ensureOwned() {\r\n    return (\r\n      !this.el.components.networked ||\r\n      ((this.networkedEl && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl))\r\n    );\r\n  },\r\n\r\n  seekForward() {\r\n    if (!this.videoIsLive && this.ensureOwned()) {\r\n      this.video.currentTime += 30;\r\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\r\n    }\r\n  },\r\n\r\n  seekBack() {\r\n    if (!this.videoIsLive && this.ensureOwned()) {\r\n      this.video.currentTime -= 10;\r\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\r\n    }\r\n  },\r\n\r\n  changeVolumeBy(v) {\r\n    this.el.setAttribute(\"media-video\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\r\n    this.updateVolumeLabel();\r\n  },\r\n\r\n  volumeUp() {\r\n    this.changeVolumeBy(0.1);\r\n  },\r\n\r\n  volumeDown() {\r\n    this.changeVolumeBy(-0.1);\r\n  },\r\n\r\n  async snap() {\r\n    if (this.isSnapping) return;\r\n    this.isSnapping = true;\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = this.video.videoWidth;\r\n    canvas.height = this.video.videoHeight;\r\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\r\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\r\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\r\n\r\n    this.localSnapCount++;\r\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount);\r\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\r\n  },\r\n\r\n  togglePlaying() {\r\n    // See onPauseStateChanged for note about iOS\r\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\r\n      this.video.play();\r\n      return;\r\n    }\r\n\r\n    if (this.ensureOwned()) {\r\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\r\n    }\r\n  },\r\n\r\n  onPauseStateChange() {\r\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\r\n    // easy to reason about, we *never* broadcast pauses from iOS.\r\n    //\r\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\r\n    // which isn't great, but this check will at least ensure they don't pause those videos\r\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\r\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\r\n    //\r\n    // This specific case will diverge the network schema and the video player state, so that\r\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\r\n    // have stopped. So we deal with this special case as well when we press the play button.\r\n    if (isIOS && this.video.paused && this.isMineOrLocal()) {\r\n      return;\r\n    }\r\n\r\n    // Used in the HACK in hub.js for dealing with auto-pause in Oculus Browser\r\n    if (this._ignorePauseStateChanges) return;\r\n\r\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\r\n\r\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n      this.el.emit(\"owned-video-state-changed\");\r\n    }\r\n  },\r\n\r\n  updatePlaybackState(force) {\r\n    this.updateHoverMenu();\r\n\r\n    // Only update playback position for videos you don't own\r\n    if (this.video && (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl)))) {\r\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\r\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\r\n      } else {\r\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\r\n      }\r\n    }\r\n\r\n    // Volume is local, always update it\r\n    if (this.audio) {\r\n      const globalMediaVolume =\r\n        window.APP.store.state.preferences.globalMediaVolume !== undefined\r\n          ? window.APP.store.state.preferences.globalMediaVolume\r\n          : 100;\r\n      this.audio.gain.gain.value = (globalMediaVolume / 100) * this.data.volume;\r\n    }\r\n  },\r\n\r\n  tryUpdateVideoPlaybackState(pause, currentTime) {\r\n    if (this._playbackStateChangeTimeout) {\r\n      clearTimeout(this._playbackStateChangeTimeout);\r\n      delete this._playbackStateChangeTimeout;\r\n    }\r\n\r\n    // Update current time if we've determined this video is not a live stream, since otherwise we may\r\n    // update the video to currentTime = 0\r\n    if (this.videoIsLive === false && currentTime !== undefined) {\r\n      this.video.currentTime = currentTime;\r\n    }\r\n\r\n    if (this.hoverMenu) {\r\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\r\n    }\r\n\r\n    if (pause) {\r\n      this.video.pause();\r\n    } else {\r\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\r\n      this.video.play().catch(() => {\r\n        if (pause !== this.data.videoPaused) return;\r\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\r\n      });\r\n    }\r\n  },\r\n\r\n  async update(oldData) {\r\n    const src = this.data.src;\r\n    this.updatePlaybackState();\r\n\r\n    if (!src || src === oldData.src) return;\r\n    return this.updateSrc(oldData);\r\n  },\r\n\r\n  async updateSrc(oldData) {\r\n    const { src, linkedVideoTexture, linkedAudioSource, linkedMediaElementAudioSource } = this.data;\r\n\r\n    this.cleanUp();\r\n    if (this.mesh && this.mesh.material) {\r\n      this.mesh.material.map = null;\r\n      this.mesh.material.needsUpdate = true;\r\n    }\r\n\r\n    let texture, audioSourceEl;\r\n    try {\r\n      if (linkedVideoTexture) {\r\n        texture = linkedVideoTexture;\r\n        audioSourceEl = linkedAudioSource;\r\n      } else {\r\n        ({ texture, audioSourceEl } = await this.createVideoTextureAudioSourceEl());\r\n        if (getCurrentMirroredMedia() === this.el) {\r\n          await refreshMediaMirror();\r\n        }\r\n      }\r\n\r\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\r\n      if (this.data.src !== src) {\r\n        disposeTexture(texture);\r\n        return;\r\n      }\r\n\r\n      this.mediaElementAudioSource = null;\r\n\r\n      if (!src.startsWith(\"hubs://\")) {\r\n        // iOS video audio is broken, see: https://github.com/mozilla/hubs/issues/1797\r\n        if (!isIOS) {\r\n          // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\r\n          const mediaElementAudioSource =\r\n            linkedMediaElementAudioSource ||\r\n            this.el.sceneEl.audioListener.context.createMediaElementSource(audioSourceEl);\r\n\r\n          if (this.data.audioType === \"pannernode\") {\r\n            this.audio = new THREE.PositionalAudio(this.el.sceneEl.audioListener);\r\n            this.audio.setDistanceModel(this.data.distanceModel);\r\n            this.audio.setRolloffFactor(this.data.rolloffFactor);\r\n            this.audio.setRefDistance(this.data.refDistance);\r\n            this.audio.setMaxDistance(this.data.maxDistance);\r\n            this.audio.panner.coneInnerAngle = this.data.coneInnerAngle;\r\n            this.audio.panner.coneOuterAngle = this.data.coneOuterAngle;\r\n            this.audio.panner.coneOuterGain = this.data.coneOuterGain;\r\n          } else {\r\n            this.audio = new THREE.Audio(this.el.sceneEl.audioListener);\r\n          }\r\n\r\n          this.mediaElementAudioSource = mediaElementAudioSource;\r\n          this.audio.setNodeSource(mediaElementAudioSource);\r\n          this.el.setObject3D(\"sound\", this.audio);\r\n        }\r\n      }\r\n\r\n      this.video = texture.image;\r\n      this.video.loop = this.data.loop;\r\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\r\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\r\n\r\n      if (texture.hls) {\r\n        const updateLiveState = () => {\r\n          if (texture.hls.currentLevel >= 0) {\r\n            const videoWasLive = !!this.videoIsLive;\r\n            this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\r\n            this.updateHoverMenu();\r\n\r\n            if (!videoWasLive && this.videoIsLive) {\r\n              this.el.emit(\"video_is_live_update\", { videoIsLive: this.videoIsLive });\r\n              // We just determined the video is live (there can be a delay due to autoplay issues, etc)\r\n              // so catch it up to HEAD.\r\n              if (!isFirefoxReality) {\r\n                // HACK this causes live streams to freeze in FxR due to https://github.com/MozillaReality/FirefoxReality/issues/1602, TODO remove once 1.4 ships\r\n                this.video.currentTime = this.video.duration - 0.01;\r\n              }\r\n            }\r\n          }\r\n        };\r\n        texture.hls.on(HLS.Events.LEVEL_LOADED, updateLiveState);\r\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateLiveState);\r\n        if (texture.hls.currentLevel >= 0) {\r\n          updateLiveState();\r\n        }\r\n      } else {\r\n        this.videoIsLive = this.video.duration === Infinity;\r\n        this.el.emit(\"video_is_live_update\", { videoIsLive: this.videoIsLive });\r\n        this.updateHoverMenu();\r\n      }\r\n\r\n      if (isIOS) {\r\n        const template = document.getElementById(\"video-unmute\");\r\n        this.el.appendChild(document.importNode(template.content, true));\r\n        this.el.setAttribute(\"position-at-box-shape-border__unmute-ui\", {\r\n          target: \".unmute-ui\",\r\n          dirs: [\"forward\", \"back\"]\r\n        });\r\n      }\r\n\r\n      this.videoTexture = texture;\r\n      this.audioSource = audioSourceEl;\r\n    } catch (e) {\r\n      console.error(\"Error loading video\", this.data.src, e);\r\n      texture = errorTexture;\r\n      this.videoTexture = this.audioSource = null;\r\n    }\r\n\r\n    const projection = this.data.projection;\r\n\r\n    if (!this.mesh || projection !== oldData.projection) {\r\n      const material = new THREE.MeshBasicMaterial();\r\n\r\n      let geometry;\r\n\r\n      if (projection === \"360-equirectangular\") {\r\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\r\n        // invert the geometry on the x-axis so that all of the faces point inward\r\n        geometry.scale(-1, 1, 1);\r\n      } else {\r\n        geometry = new THREE.PlaneBufferGeometry();\r\n        material.side = THREE.DoubleSide;\r\n      }\r\n\r\n      this.mesh = new THREE.Mesh(geometry, material);\r\n      this.el.setObject3D(\"mesh\", this.mesh);\r\n    }\r\n\r\n    if (this.data.contentType.startsWith(\"audio/\")) {\r\n      this.mesh.material.map = audioIconTexture;\r\n    } else {\r\n      this.mesh.material.map = texture;\r\n    }\r\n    this.mesh.material.needsUpdate = true;\r\n\r\n    if (projection === \"flat\" && !this.data.contentType.startsWith(\"audio/\")) {\r\n      scaleToAspectRatio(\r\n        this.el,\r\n        (texture.image.videoHeight || texture.image.height) / (texture.image.videoWidth || texture.image.width)\r\n      );\r\n    }\r\n\r\n    this.updatePlaybackState(true);\r\n\r\n    if (this.video && this.video.muted) {\r\n      this.videoMutedAt = performance.now();\r\n    }\r\n\r\n    this.el.emit(\"video-loaded\", { projection: projection });\r\n  },\r\n\r\n  async createVideoTextureAudioSourceEl() {\r\n    const url = this.data.src;\r\n    const contentType = this.data.contentType;\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      if (this._audioSyncInterval) {\r\n        clearInterval(this._audioSyncInterval);\r\n        this._audioSyncInterval = null;\r\n      }\r\n\r\n      const videoEl = createVideoOrAudioEl(\"video\");\r\n\r\n      let texture, audioEl, isReady;\r\n      if (contentType.startsWith(\"audio/\")) {\r\n        // We want to treat audio almost exactly like video, so we mock a video texture with an image property.\r\n        texture = new THREE.Texture();\r\n        texture.image = videoEl;\r\n        isReady = () => true;\r\n      } else {\r\n        texture = new THREE.VideoTexture(videoEl);\r\n        texture.minFilter = THREE.LinearFilter;\r\n        texture.encoding = THREE.sRGBEncoding;\r\n        isReady = () =>\r\n          (texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width);\r\n      }\r\n\r\n      // Set src on video to begin loading.\r\n      if (url.startsWith(\"hubs://\")) {\r\n        const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\r\n        const stream = await NAF.connection.adapter.getMediaStream(streamClientId, \"video\");\r\n        videoEl.srcObject = new MediaStream(stream.getVideoTracks());\r\n        // If hls.js is supported we always use it as it gives us better events\r\n      } else if (AFRAME.utils.material.isHLS(url, contentType)) {\r\n        if (HLS.isSupported()) {\r\n          const corsProxyPrefix = `https://${configs.CORS_PROXY_SERVER}/`;\r\n          const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\r\n          const setupHls = () => {\r\n            if (texture.hls) {\r\n              texture.hls.stopLoad();\r\n              texture.hls.detachMedia();\r\n              texture.hls.destroy();\r\n              texture.hls = null;\r\n            }\r\n\r\n            const hls = new HLS({\r\n              xhrSetup: (xhr, u) => {\r\n                if (u.startsWith(corsProxyPrefix)) {\r\n                  u = u.substring(corsProxyPrefix.length);\r\n                }\r\n\r\n                // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\r\n                // TODO extend HLS.js to allow overriding of its internal resolving instead\r\n                if (!u.startsWith(\"http\")) {\r\n                  u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\r\n                }\r\n\r\n                xhr.open(\"GET\", proxiedUrlFor(u));\r\n              }\r\n            });\r\n\r\n            texture.hls = hls;\r\n            hls.loadSource(url);\r\n            hls.attachMedia(videoEl);\r\n\r\n            hls.on(HLS.Events.ERROR, function(event, data) {\r\n              if (data.fatal) {\r\n                switch (data.type) {\r\n                  case HLS.ErrorTypes.NETWORK_ERROR:\r\n                    // try to recover network error\r\n                    hls.startLoad();\r\n                    break;\r\n                  case HLS.ErrorTypes.MEDIA_ERROR:\r\n                    hls.recoverMediaError();\r\n                    break;\r\n                  default:\r\n                    reject(event);\r\n                    return;\r\n                }\r\n              }\r\n            });\r\n          };\r\n\r\n          setupHls();\r\n\r\n          // Sometimes for weird streams HLS fails to initialize.\r\n          const setupInterval = setInterval(() => {\r\n            // Stop retrying if the src changed.\r\n            const isNoLongerSrc = this.data.src !== url;\r\n\r\n            if (isReady() || isNoLongerSrc) {\r\n              clearInterval(setupInterval);\r\n            } else {\r\n              console.warn(\"HLS failed to read video, trying again\");\r\n              setupHls();\r\n            }\r\n          }, HLS_TIMEOUT);\r\n          // If not, see if native support will work\r\n        } else if (videoEl.canPlayType(contentType)) {\r\n          videoEl.src = url;\r\n          videoEl.onerror = reject;\r\n        } else {\r\n          reject(\"HLS unsupported\");\r\n        }\r\n      } else {\r\n        videoEl.src = url;\r\n        videoEl.onerror = reject;\r\n\r\n        if (this.data.audioSrc) {\r\n          // If there's an audio src, create an audio element to play it that we keep in sync\r\n          // with the video while this component is active.\r\n          audioEl = createVideoOrAudioEl(\"audio\");\r\n          audioEl.src = this.data.audioSrc;\r\n          audioEl.onerror = reject;\r\n\r\n          this._audioSyncInterval = setInterval(() => {\r\n            if (Math.abs(audioEl.currentTime - videoEl.currentTime) >= 0.33) {\r\n              // In Chrome, drift of a few frames seems persistent\r\n              audioEl.currentTime = videoEl.currentTime;\r\n            }\r\n\r\n            // During pause state change, correct any drift that remains.\r\n            if (videoEl.paused !== audioEl.paused) {\r\n              videoEl.paused ? audioEl.pause() : audioEl.play();\r\n              audioEl.currentTime = videoEl.currentTime;\r\n            }\r\n          }, 1000);\r\n        }\r\n      }\r\n\r\n      // NOTE: We used to use the canplay event here to yield the texture, but that fails to fire on iOS Safari\r\n      // and also sometimes in Chrome it seems.\r\n      const poll = () => {\r\n        if (isReady()) {\r\n          resolve({ texture, audioSourceEl: audioEl || texture.image });\r\n        } else {\r\n          setTimeout(poll, 500);\r\n        }\r\n      };\r\n\r\n      poll();\r\n    });\r\n  },\r\n\r\n  updateHoverMenu() {\r\n    if (!this.hoverMenu) return;\r\n\r\n    const pinnableElement = this.el.components[\"media-loader\"].data.linkedEl || this.el;\r\n    const isPinned = pinnableElement.components.pinnable && pinnableElement.components.pinnable.data.pinned;\r\n    this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\r\n    this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\r\n\r\n    this.snapButton.object3D.visible =\r\n      !!this.video && !this.data.contentType.startsWith(\"audio/\") && window.APP.hubChannel.can(\"spawn_and_move_media\");\r\n    this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\r\n\r\n    const mayModifyPlayHead =\r\n      !!this.video && !this.videoIsLive && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\r\n\r\n    this.playPauseButton.object3D.visible = this.seekForwardButton.object3D.visible = this.seekBackButton.object3D.visible = mayModifyPlayHead;\r\n\r\n    if (this.videoIsLive) {\r\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\r\n    }\r\n  },\r\n\r\n  updateVolumeLabel() {\r\n    this.volumeLabel.setAttribute(\r\n      \"text\",\r\n      \"value\",\r\n      this.data.volume === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\r\n    );\r\n  },\r\n\r\n  tick() {\r\n    if (!this.video) return;\r\n\r\n    const userinput = this.el.sceneEl.systems.userinput;\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    const volumeModRight = userinput.get(paths.actions.cursor.right.mediaVolumeMod);\r\n    if (interaction.state.rightRemote.hovered === this.el && volumeModRight) {\r\n      this.changeVolumeBy(volumeModRight);\r\n    }\r\n    const volumeModLeft = userinput.get(paths.actions.cursor.left.mediaVolumeMod);\r\n    if (interaction.state.leftRemote.hovered === this.el && volumeModLeft) {\r\n      this.changeVolumeBy(volumeModLeft);\r\n    }\r\n\r\n    const isHeld = interaction.isHeld(this.el);\r\n\r\n    if (this.wasHeld && !isHeld) {\r\n      this.localSnapCount = 0;\r\n    }\r\n\r\n    this.wasHeld = isHeld;\r\n\r\n    if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\r\n      this.timeLabel.setAttribute(\r\n        \"text\",\r\n        \"value\",\r\n        `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\r\n      );\r\n    }\r\n\r\n    // If a known non-live video is currently playing and we own it, send out time updates\r\n    if (\r\n      !this.data.videoPaused &&\r\n      this.videoIsLive === false &&\r\n      this.networkedEl &&\r\n      NAF.utils.isMine(this.networkedEl)\r\n    ) {\r\n      const now = performance.now();\r\n      if (now - this.lastUpdate > this.data.tickRate) {\r\n        this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\r\n        this.lastUpdate = now;\r\n      }\r\n    }\r\n  },\r\n\r\n  cleanUp() {\r\n    if (this.mesh && this.mesh.material) {\r\n      if (!this.data.linkedVideoTexture) {\r\n        disposeTexture(this.mesh.material.map);\r\n      }\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.cleanUp();\r\n\r\n    if (this.mesh) {\r\n      this.el.removeObject3D(\"mesh\");\r\n    }\r\n\r\n    if (this._audioSyncInterval) {\r\n      clearInterval(this._audioSyncInterval);\r\n      this._audioSyncInterval = null;\r\n    }\r\n\r\n    if (this.audio) {\r\n      this.el.removeObject3D(\"sound\");\r\n      this.audio.disconnect();\r\n      delete this.audio;\r\n    }\r\n\r\n    if (this.networkedEl) {\r\n      this.networkedEl.removeEventListener(\"pinned\", this.updateHoverMenu);\r\n      this.networkedEl.removeEventListener(\"unpinned\", this.updateHoverMenu);\r\n    }\r\n\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateHoverMenu);\r\n\r\n    if (this.video) {\r\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\r\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\r\n    }\r\n\r\n    if (this.hoverMenu) {\r\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\r\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\r\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\r\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\r\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"media-image\", {\r\n  schema: {\r\n    src: { type: \"string\" },\r\n    version: { type: \"number\" },\r\n    projection: { type: \"string\", default: \"flat\" },\r\n    contentType: { type: \"string\" },\r\n    batch: { default: false }\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.batch && this.mesh) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.mesh);\r\n    }\r\n    if (this.currentSrcIsRetained) {\r\n      textureCache.release(this.data.src, this.data.version);\r\n      this.currentSrcIsRetained = false;\r\n    }\r\n  },\r\n\r\n  async update(oldData) {\r\n    let texture;\r\n    let ratio = 1;\r\n\r\n    const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\r\n\r\n    try {\r\n      const { src, version, contentType } = this.data;\r\n      if (!src) return;\r\n\r\n      this.el.emit(\"image-loading\");\r\n\r\n      if (this.mesh && this.mesh.material.map && (src !== oldData.src || version !== oldData.version)) {\r\n        this.mesh.material.map = null;\r\n        this.mesh.material.needsUpdate = true;\r\n        if (this.mesh.material.map !== errorTexture) {\r\n          textureCache.release(oldData.src, oldData.version);\r\n          this.currentSrcIsRetained = false;\r\n        }\r\n      }\r\n\r\n      let cacheItem;\r\n      if (textureCache.has(src, version)) {\r\n        if (this.currentSrcIsRetained) {\r\n          cacheItem = textureCache.get(src, version);\r\n        } else {\r\n          cacheItem = textureCache.retain(src, version);\r\n        }\r\n      } else {\r\n        const inflightKey = textureCache.key(src, version);\r\n\r\n        if (src === \"error\") {\r\n          cacheItem = errorCacheItem;\r\n        } else if (inflightTextures.has(inflightKey)) {\r\n          await inflightTextures.get(inflightKey);\r\n          cacheItem = textureCache.retain(src, version);\r\n        } else {\r\n          let promise;\r\n          if (contentType.includes(\"image/gif\")) {\r\n            promise = createGIFTexture(src);\r\n          } else if (contentType.includes(\"image/basis\")) {\r\n            promise = createBasisTexture(src);\r\n          } else if (contentType.startsWith(\"image/\")) {\r\n            promise = createImageTexture(src);\r\n          } else {\r\n            throw new Error(`Unknown image content type: ${contentType}`);\r\n          }\r\n          inflightTextures.set(inflightKey, promise);\r\n          texture = await promise;\r\n          inflightTextures.delete(inflightKey);\r\n          cacheItem = textureCache.set(src, version, texture);\r\n        }\r\n\r\n        // No way to cancel promises, so if src has changed or this entity was removed while we were creating the texture just throw it away.\r\n        if (this.data.src !== src || this.data.version !== version || !this.el.parentNode) {\r\n          textureCache.release(src, version);\r\n          return;\r\n        }\r\n      }\r\n\r\n      texture = cacheItem.texture;\r\n      ratio = cacheItem.ratio;\r\n\r\n      this.currentSrcIsRetained = true;\r\n    } catch (e) {\r\n      console.error(\"Error loading image\", this.data.src, e);\r\n      texture = errorTexture;\r\n      this.currentSrcIsRetained = false;\r\n    }\r\n\r\n    const projection = this.data.projection;\r\n\r\n    if (this.mesh && this.data.batch) {\r\n      // This is a no-op if the mesh was just created.\r\n      // Otherwise we want to ensure the texture gets updated.\r\n      batchManagerSystem.removeObject(this.mesh);\r\n    }\r\n\r\n    if (!this.mesh || projection !== oldData.projection) {\r\n      const material = new THREE.MeshBasicMaterial();\r\n\r\n      let geometry;\r\n\r\n      if (projection === \"360-equirectangular\") {\r\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\r\n        // invert the geometry on the x-axis so that all of the faces point inward\r\n        geometry.scale(-1, 1, 1);\r\n\r\n        // Flip uvs on the geometry\r\n        if (!texture.flipY) {\r\n          const uvs = geometry.attributes.uv.array;\r\n\r\n          for (let i = 1; i < uvs.length; i += 2) {\r\n            uvs[i] = 1 - uvs[i];\r\n          }\r\n        }\r\n      } else {\r\n        geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\r\n        material.side = THREE.DoubleSide;\r\n      }\r\n\r\n      this.mesh = new THREE.Mesh(geometry, material);\r\n      this.el.setObject3D(\"mesh\", this.mesh);\r\n    }\r\n\r\n    // We only support transparency on gifs. Other images will support cutout as part of batching, but not alpha transparency for now\r\n    this.mesh.material.transparent =\r\n      !this.data.batch ||\r\n      texture == errorTexture ||\r\n      this.data.contentType.includes(\"image/gif\") ||\r\n      (texture.image && texture.image.hasAlpha);\r\n\r\n    this.mesh.material.map = texture;\r\n    this.mesh.material.needsUpdate = true;\r\n\r\n    if (projection === \"flat\") {\r\n      scaleToAspectRatio(this.el, ratio);\r\n    }\r\n\r\n    if (texture !== errorTexture && this.data.batch && !texture.isCompressedTexture) {\r\n      batchManagerSystem.addObject(this.mesh);\r\n    }\r\n\r\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"media-pdf\", {\r\n  schema: {\r\n    src: { type: \"string\" },\r\n    projection: { type: \"string\", default: \"flat\" },\r\n    contentType: { type: \"string\" },\r\n    index: { default: 0 },\r\n    batch: { default: false }\r\n  },\r\n\r\n  init() {\r\n    this.snap = this.snap.bind(this);\r\n    this.canvas = document.createElement(\"canvas\");\r\n    this.canvasContext = this.canvas.getContext(\"2d\");\r\n    this.localSnapCount = 0;\r\n    this.isSnapping = false;\r\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\r\n    this.texture = new THREE.CanvasTexture(this.canvas);\r\n\r\n    this.texture.encoding = THREE.sRGBEncoding;\r\n    this.texture.minFilter = THREE.LinearFilter;\r\n\r\n    this.el.addEventListener(\"pager-snap-clicked\", () => this.snap());\r\n  },\r\n\r\n  async snap() {\r\n    if (this.isSnapping) return;\r\n    this.isSnapping = true;\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\r\n\r\n    const blob = await new Promise(resolve => this.canvas.toBlob(resolve));\r\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\r\n\r\n    this.localSnapCount++;\r\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount, false, 1);\r\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\r\n  },\r\n\r\n  remove() {\r\n    if (this.data.batch && this.mesh) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.mesh);\r\n    }\r\n  },\r\n\r\n  async update(oldData) {\r\n    let texture;\r\n    let ratio = 1;\r\n\r\n    try {\r\n      const { src, index } = this.data;\r\n      if (!src) return;\r\n\r\n      if (this.renderTask) {\r\n        await this.renderTask.promise;\r\n        if (src !== this.data.src || index !== this.data.index) return;\r\n      }\r\n\r\n      this.el.emit(\"pdf-loading\");\r\n\r\n      if (src !== oldData.src) {\r\n        const loadingSrc = this.data.src;\r\n        const pdf = await pdfjs.getDocument(src);\r\n        if (loadingSrc !== this.data.src) return;\r\n\r\n        this.pdf = pdf;\r\n        this.el.setAttribute(\"media-pager\", { maxIndex: this.pdf.numPages - 1 });\r\n      }\r\n\r\n      const page = await this.pdf.getPage(index + 1);\r\n      if (src !== this.data.src || index !== this.data.index) return;\r\n\r\n      const viewport = page.getViewport({ scale: 3 });\r\n      const pw = viewport.width;\r\n      const ph = viewport.height;\r\n      texture = this.texture;\r\n      ratio = ph / pw;\r\n\r\n      this.canvas.width = pw;\r\n      this.canvas.height = ph;\r\n\r\n      this.renderTask = page.render({ canvasContext: this.canvasContext, viewport });\r\n\r\n      await this.renderTask.promise;\r\n\r\n      this.renderTask = null;\r\n\r\n      if (src !== this.data.src || index !== this.data.index) return;\r\n\r\n      this.currentPageTextureIsRetained = true;\r\n    } catch (e) {\r\n      console.error(\"Error loading PDF\", this.data.src, e);\r\n      texture = errorTexture;\r\n    }\r\n\r\n    if (!this.mesh) {\r\n      const material = new THREE.MeshBasicMaterial();\r\n      const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\r\n      material.side = THREE.DoubleSide;\r\n\r\n      this.mesh = new THREE.Mesh(geometry, material);\r\n      this.el.setObject3D(\"mesh\", this.mesh);\r\n    }\r\n\r\n    this.mesh.material.transparent = texture == errorTexture;\r\n    this.mesh.material.map = texture;\r\n    this.mesh.material.map.needsUpdate = true;\r\n    this.mesh.material.needsUpdate = true;\r\n\r\n    scaleToAspectRatio(this.el, ratio);\r\n\r\n    if (texture !== errorTexture && this.data.batch) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.mesh);\r\n    }\r\n\r\n    if (this.el.components[\"media-pager\"] && this.el.components[\"media-pager\"].data.index !== this.data.index) {\r\n      this.el.setAttribute(\"media-pager\", { index: this.data.index });\r\n    }\r\n\r\n    this.el.emit(\"pdf-loaded\", { src: this.data.src });\r\n  }\r\n});\r\n","import { VOLUME_LABELS } from \"./media-views\";\r\nconst MAX_VOLUME = 8;\r\nconst SMALL_STEP = 1 / (VOLUME_LABELS.length / 2);\r\nconst BIG_STEP = (MAX_VOLUME - 1) / (VOLUME_LABELS.length / 2);\r\n\r\nAFRAME.registerComponent(\"avatar-volume-controls\", {\r\n  schema: {\r\n    volume: { type: \"number\", default: 1.0 }\r\n  },\r\n\r\n  init() {\r\n    this.volumeUp = this.volumeUp.bind(this);\r\n    this.volumeDown = this.volumeDown.bind(this);\r\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\r\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\r\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\r\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\r\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\r\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\r\n    this.update = this.update.bind(this);\r\n    window.APP.store.addEventListener(\"statechanged\", this.update);\r\n\r\n    this.updateVolumeLabel();\r\n  },\r\n  remove() {\r\n    window.APP.store.removeEventListener(\"statechanged\", this.update);\r\n  },\r\n\r\n  changeVolumeBy(v) {\r\n    this.el.setAttribute(\"avatar-volume-controls\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, MAX_VOLUME));\r\n    this.updateVolumeLabel();\r\n  },\r\n\r\n  volumeUp() {\r\n    const step = this.data.volume > 1 - SMALL_STEP ? BIG_STEP : SMALL_STEP;\r\n    this.changeVolumeBy(step);\r\n  },\r\n\r\n  volumeDown() {\r\n    const step = this.data.volume > 1 + SMALL_STEP ? BIG_STEP : SMALL_STEP;\r\n    this.changeVolumeBy(-1 * step);\r\n  },\r\n\r\n  update() {\r\n    if (this.audio) {\r\n      const globalVoiceVolume =\r\n        window.APP.store.state.preferences.globalVoiceVolume !== undefined\r\n          ? window.APP.store.state.preferences.globalVoiceVolume\r\n          : 100;\r\n      this.audio.gain.gain.value = (globalVoiceVolume / 100) * this.data.volume;\r\n    }\r\n  },\r\n\r\n  updateVolumeLabel() {\r\n    const numBars = Math.min(\r\n      VOLUME_LABELS.length - 1,\r\n      this.data.volume <= 1.001\r\n        ? Math.floor(this.data.volume / SMALL_STEP)\r\n        : Math.floor(VOLUME_LABELS.length / 2 + (this.data.volume - 1) / BIG_STEP)\r\n    );\r\n    this.volumeLabel.setAttribute(\"text\", \"value\", this.data.volume === 0 ? \"Muted\" : VOLUME_LABELS[numBars]);\r\n  },\r\n\r\n  tick() {\r\n    if (this.audio) return;\r\n\r\n    // Walk up to Spine and then search down.\r\n    const source = this.el.parentNode.parentNode.querySelector(\"[networked-audio-source]\");\r\n    if (!source) return;\r\n\r\n    this.audio = source.components[\"networked-audio-source\"].sound;\r\n    this.update();\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\n\r\nAFRAME.registerComponent(\"pinch-to-move\", {\r\n  schema: {\r\n    speed: { default: 0.25 }\r\n  },\r\n  init() {\r\n    this.axis = [0, 0];\r\n  },\r\n  tick() {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\r\n    if (pinch) {\r\n      this.axis[1] = pinch * this.data.speed;\r\n      this.el.emit(\"move\", { axis: this.axis });\r\n    }\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\n\r\nconst rotatePitchAndYaw = (function() {\r\n  const opq = new THREE.Quaternion();\r\n  const owq = new THREE.Quaternion();\r\n  const oq = new THREE.Quaternion();\r\n  const pq = new THREE.Quaternion();\r\n  const yq = new THREE.Quaternion();\r\n  const q = new THREE.Quaternion();\r\n  const right = new THREE.Vector3();\r\n  const v = new THREE.Vector3();\r\n  const UP = new THREE.Vector3(0, 1, 0);\r\n\r\n  return function rotatePitchAndYaw(o, p, y) {\r\n    o.parent.updateMatrices();\r\n    o.updateMatrices();\r\n    o.parent.getWorldQuaternion(opq);\r\n    o.getWorldQuaternion(owq);\r\n    oq.copy(o.quaternion);\r\n    v.set(0, 1, 0).applyQuaternion(oq);\r\n    const initialUpDot = v.dot(UP);\r\n    v.set(0, 0, 1).applyQuaternion(oq);\r\n    const initialForwardDotUp = Math.abs(v.dot(UP));\r\n    right.set(1, 0, 0).applyQuaternion(owq);\r\n    pq.setFromAxisAngle(right, p);\r\n    yq.setFromAxisAngle(UP, y);\r\n\r\n    q.copy(owq)\r\n      .premultiply(pq)\r\n      .premultiply(yq)\r\n      .premultiply(opq.inverse());\r\n    v.set(0, 1, 0).applyQuaternion(q);\r\n    const newUpDot = v.dot(UP);\r\n    v.set(0, 0, 1).applyQuaternion(q);\r\n    const newForwardDotUp = Math.abs(v.dot(UP));\r\n    // Ensure our pitch is in an accepted range and our head would not be flipped upside down\r\n    if ((newForwardDotUp > 0.9 && newForwardDotUp > initialForwardDotUp) || (newUpDot < 0 && newUpDot < initialUpDot)) {\r\n      // TODO: Apply a partial rotation that does not exceed the bounds for nicer UX\r\n      return;\r\n    } else {\r\n      o.quaternion.copy(q);\r\n      o.matrixNeedsUpdate = true;\r\n      o.updateMatrices();\r\n    }\r\n  };\r\n})();\r\n\r\nlet uiRoot;\r\nlet scenePreviewNode;\r\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\r\n  init() {\r\n    this.pendingXRotation = 0;\r\n    this.el.sceneEl.addEventListener(\"rotateX\", e => {\r\n      this.pendingXRotation += e.detail;\r\n    });\r\n    this.on = true;\r\n  },\r\n\r\n  tick() {\r\n    if (this.on) {\r\n      const scene = AFRAME.scenes[0];\r\n      const userinput = scene.systems.userinput;\r\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n      scenePreviewNode = scenePreviewNode || document.getElementById(\"scene-preview-node\");\r\n      const lobby = !scene.is(\"entered\");\r\n      const isGhost = lobby && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n      const cameraDelta = userinput.get(lobby ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta);\r\n      if (cameraDelta) {\r\n        rotatePitchAndYaw(\r\n          lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D,\r\n          this.pendingXRotation + cameraDelta[1],\r\n          cameraDelta[0]\r\n        );\r\n      } else if (this.pendingXRotation) {\r\n        rotatePitchAndYaw(lobby && !isGhost ? scenePreviewNode.object3D : this.el.object3D, this.pendingXRotation, 0);\r\n      }\r\n    }\r\n    this.pendingXRotation = 0;\r\n  }\r\n});\r\n","import { getBox } from \"../utils/auto-box-collider.js\";\r\nimport { getLastWorldPosition } from \"../utils/three-utils\";\r\nimport { CAMERA_MODE_FIRST_PERSON } from \"../systems/camera-system\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nconst PI = Math.PI;\r\nconst HALF_PI = PI / 2;\r\nconst THREE_HALF_PI = 3 * HALF_PI;\r\nconst right = new THREE.Vector3(1, 0, 0);\r\nconst forward = new THREE.Vector3(0, 0, 1);\r\nconst left = new THREE.Vector3(-1, 0, 0);\r\nconst back = new THREE.Vector3(0, 0, -1);\r\nconst zero = new THREE.Vector3(0, 0, 0);\r\nconst dirs = {\r\n  left: {\r\n    dir: left,\r\n    rotation: THREE_HALF_PI,\r\n    halfExtent: \"x\"\r\n  },\r\n  right: {\r\n    dir: right,\r\n    rotation: HALF_PI,\r\n    halfExtent: \"x\"\r\n  },\r\n  forward: {\r\n    dir: forward,\r\n    rotation: 0,\r\n    halfExtent: \"z\"\r\n  },\r\n  back: {\r\n    dir: back,\r\n    rotation: PI,\r\n    halfExtent: \"z\"\r\n  }\r\n};\r\n\r\nAFRAME.registerComponent(\"position-at-box-shape-border\", {\r\n  multiple: true,\r\n  schema: {\r\n    target: { type: \"string\" },\r\n    dirs: { default: [\"left\", \"right\", \"forward\", \"back\"] },\r\n    animate: { default: true },\r\n    scale: { default: true }\r\n  },\r\n\r\n  init() {\r\n    this.cam = this.el.sceneEl.camera.el.object3D;\r\n    this._updateBox = this._updateBox.bind(this);\r\n    this._setupTarget = this._setupTarget.bind(this);\r\n    this.halfExtents = new THREE.Vector3();\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateBox, \"media-components\");\r\n\r\n    this._setupTarget();\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateBox, \"media-components\");\r\n  },\r\n\r\n  update() {\r\n    this.dirs = this.data.dirs.map(d => dirs[d]);\r\n  },\r\n\r\n  async _setupTarget() {\r\n    await waitForDOMContentLoaded();\r\n\r\n    this.targetEl = this.el.querySelector(this.data.target);\r\n    this.target = this.targetEl.object3D;\r\n\r\n    this.targetEl.addEventListener(\"animationcomplete\", () => {\r\n      this.targetEl.removeAttribute(\"animation__show\");\r\n    });\r\n\r\n    this.target.scale.setScalar(0.01); // To avoid \"pop\" of gigantic button first time\r\n    this.target.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  tick() {\r\n    if (!this.target) return;\r\n\r\n    if (!this.el.getObject3D(\"mesh\")) {\r\n      return;\r\n    }\r\n\r\n    const isVisible = this.targetEl.object3D.visible;\r\n    const opening = isVisible && !this.wasVisible;\r\n    const scaleChanged =\r\n      this.el.object3D.scale.x !== this.previousScaleX ||\r\n      this.el.object3D.scale.y !== this.previousScaleY ||\r\n      this.el.object3D.scale.z !== this.previousScaleZ;\r\n    const isAnimating = this.targetEl.getAttribute(\"animation__show\");\r\n\r\n    // If the target is being shown or the scale changed while the opening animation is being run,\r\n    // we need to start or re-start the animation.\r\n    if (opening || (scaleChanged && isAnimating)) {\r\n      this._updateBox(this.data.animate, true);\r\n    }\r\n\r\n    this.wasVisible = isVisible;\r\n    this.previousScaleX = this.el.object3D.scale.x;\r\n    this.previousScaleY = this.el.object3D.scale.y;\r\n    this.previousScaleZ = this.el.object3D.scale.z;\r\n  },\r\n\r\n  _updateBox: (function() {\r\n    const camWorldPos = new THREE.Vector3();\r\n    const targetPosition = new THREE.Vector3();\r\n    const pointOnBoxFace = new THREE.Vector3();\r\n    const pointOnBoxFaceToCamera = new THREE.Vector3();\r\n    const boxCenter = new THREE.Vector3();\r\n    const tempParentWorldScale = new THREE.Vector3();\r\n    const boxFaceNormal = new THREE.Vector3();\r\n    const min = new THREE.Vector3(0.001, 0.001, 0.001);\r\n\r\n    return function(animate, forceNewExtents) {\r\n      if (forceNewExtents || this.mesh !== this.el.getObject3D(\"mesh\")) {\r\n        this.mesh = this.el.getObject3D(\"mesh\");\r\n        if (!this.mesh) return;\r\n\r\n        const box = getBox(this.el, this.mesh);\r\n        this.halfExtents = box.min\r\n          .clone()\r\n          .negate()\r\n          .add(box.max)\r\n          .multiplyScalar(0.65);\r\n\r\n        this.halfExtents.max(min);\r\n      }\r\n\r\n      if (!this.target) return;\r\n\r\n      getLastWorldPosition(this.cam, camWorldPos);\r\n\r\n      let targetSquareDistance = Infinity;\r\n      let targetDir = this.dirs[0].dir;\r\n      let targetHalfExtentStr = this.dirs[0].halfExtent;\r\n      let targetHalfExtent = this.halfExtents[targetHalfExtentStr];\r\n      let targetRotation = this.dirs[0].rotation;\r\n      let targetCameraDot = -1.1;\r\n\r\n      this.el.object3D.updateMatrices();\r\n\r\n      for (let i = 0; i < this.dirs.length; i++) {\r\n        const dir = this.dirs[i].dir;\r\n        const halfExtentStr = this.dirs[i].halfExtent;\r\n        const halfExtent = this.halfExtents[halfExtentStr];\r\n        pointOnBoxFace.copy(dir).multiplyScalar(halfExtent);\r\n        boxCenter.copy(zero);\r\n\r\n        this.el.object3D.localToWorld(pointOnBoxFace);\r\n        this.el.object3D.localToWorld(boxCenter);\r\n\r\n        pointOnBoxFaceToCamera.subVectors(camWorldPos, pointOnBoxFace);\r\n        pointOnBoxFaceToCamera.normalize();\r\n\r\n        boxFaceNormal.subVectors(pointOnBoxFace, boxCenter);\r\n        boxFaceNormal.normalize();\r\n\r\n        // Compute dot between camera + box normal to ensure menus are going to be\r\n        // somewhat perpendicular to camera frustum\r\n        const cameraAngleDotBoxNormal = boxFaceNormal.dot(pointOnBoxFaceToCamera);\r\n\r\n        const squareDistance = pointOnBoxFace.distanceToSquared(camWorldPos);\r\n        if (cameraAngleDotBoxNormal > targetCameraDot) {\r\n          targetSquareDistance = squareDistance;\r\n          targetDir = dir;\r\n          targetHalfExtent = halfExtent;\r\n          targetRotation = this.dirs[i].rotation;\r\n          targetHalfExtentStr = halfExtentStr;\r\n          targetCameraDot = cameraAngleDotBoxNormal;\r\n        }\r\n      }\r\n\r\n      this.target.position.copy(targetPosition.copy(targetDir).multiplyScalar(targetHalfExtent));\r\n      this.target.rotation.set(0, targetRotation, 0);\r\n\r\n      tempParentWorldScale.setFromMatrixScale(this.target.parent.matrixWorld);\r\n\r\n      const distance = Math.sqrt(targetSquareDistance);\r\n      const scale = Math.max(this.halfExtents.x, this.halfExtents.z) * distance;\r\n      const targetScale = Math.min(\r\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_FIRST_PERSON ? 2.0 : 4.0,\r\n        Math.max(0.5, scale * tempParentWorldScale.x)\r\n      );\r\n      const finalScale = this.data.scale ? targetScale / tempParentWorldScale.x : 1;\r\n\r\n      if (animate) {\r\n        this.targetEl.removeAttribute(\"animation__show\");\r\n\r\n        this.targetEl.setAttribute(\"animation__show\", {\r\n          property: \"scale\",\r\n          dur: 300,\r\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\r\n          to: { x: finalScale, y: finalScale, z: finalScale },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n      } else if (!this.targetEl.getAttribute(\"animation__show\")) {\r\n        this.target.scale.setScalar(finalScale);\r\n      }\r\n\r\n      this.target.matrixNeedsUpdate = true;\r\n    };\r\n  })()\r\n});\r\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\r\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\r\nimport { applyThemeToTextButton } from \"../utils/theme\";\r\n\r\nAFRAME.registerComponent(\"pin-networked-object-button\", {\r\n  schema: {\r\n    // Selector for label informing users about Discord bridging of pins.\r\n    tipSelector: { type: \"string\" },\r\n\r\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\r\n    labelSelector: { type: \"string\" }\r\n  },\r\n\r\n  init() {\r\n    this._updateUI = this._updateUI.bind(this);\r\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\r\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n\r\n      this._updateUI();\r\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\r\n    });\r\n\r\n    this.onHovered = () => {\r\n      this.hovering = true;\r\n      this._updateUI();\r\n    };\r\n\r\n    this.onUnhovered = () => {\r\n      this.hovering = false;\r\n      this._updateUI();\r\n    };\r\n\r\n    this.onClick = () => {\r\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\r\n\r\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\r\n      this.targetEl.setAttribute(\"pinnable\", \"pinned\", !wasPinned);\r\n      if (!wasPinned) {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\r\n      }\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\r\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\r\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    if (this.targetEl) {\r\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\r\n    }\r\n  },\r\n\r\n  _discordBridges() {\r\n    return window.APP.hubChannel.discordBridges();\r\n  },\r\n\r\n  _updateUIOnStateChange(e) {\r\n    if (e.detail !== \"frozen\") return;\r\n    this._updateUI();\r\n  },\r\n\r\n  _updateUI() {\r\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\r\n    const canPin =\r\n      window.APP.hubChannel.can(\"pin_objects\") && !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\r\n    this.el.object3D.visible = canPin;\r\n    this.labelEl.object3D.visible = canPin;\r\n\r\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\r\n    const discordBridges = this._discordBridges();\r\n    this.tipEl.object3D.visible = !!(canPin && !isPinned && this.hovering && discordBridges.length > 0);\r\n\r\n    if (!canPin) return;\r\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\r\n    applyThemeToTextButton(this.el, isPinned);\r\n  }\r\n});\r\n","import { cloneMedia } from \"../utils/media-utils\";\r\nimport { closeExistingMediaMirror } from \"../utils/media-utils\";\r\n\r\nAFRAME.registerComponent(\"mirror-media-button\", {\r\n  init() {\r\n    this.updateSrc = () => {\r\n      if (!this.targetEl.parentNode) return; // If removed\r\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\r\n      this.updateSrc();\r\n    });\r\n\r\n    this.onClick = async () => {\r\n      const mirrorTarget = document.querySelector(\"#media-mirror-target\");\r\n\r\n      await closeExistingMediaMirror();\r\n\r\n      const { entity } = cloneMedia(this.targetEl, \"#linked-media\", this.src, false, true, mirrorTarget);\r\n\r\n      entity.object3D.scale.set(0.75, 0.75, 0.75);\r\n      entity.object3D.matrixNeedsUpdate = true;\r\n\r\n      mirrorTarget.parentEl.components[\"follow-in-fov\"].reset();\r\n      mirrorTarget.parentEl.object3D.visible = true;\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { closeExistingMediaMirror } from \"../utils/media-utils\";\r\n\r\nAFRAME.registerComponent(\"close-mirrored-media-button\", {\r\n  init() {\r\n    this.onClick = async () => {\r\n      this.el.object3D.visible = false; // Hide button immediately on click\r\n      await closeExistingMediaMirror();\r\n      this.el.object3D.visible = true;\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\r\n\r\nAFRAME.registerComponent(\"unmute-video-button\", {\r\n  init() {\r\n    this.onClick = () => {\r\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\r\n      const mediaVideo = videoEl.components[\"media-video\"];\r\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\r\n\r\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\r\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\r\n      // occurs seems to help with reducing this.\r\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\r\n        return;\r\n      }\r\n\r\n      if (mediaVideo.video.muted) {\r\n        mediaVideo.video.muted = false;\r\n        this.el.setAttribute(\"visible\", false);\r\n      }\r\n    };\r\n  },\r\n\r\n  play() {\r\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\r\n    // so we have to use a global touchstart event here.\r\n    document.addEventListener(\"touchstart\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    document.removeEventListener(\"touchstart\", this.onClick);\r\n  }\r\n});\r\n","import { getLastWorldPosition } from \"../utils/three-utils\";\r\n\r\nAFRAME.registerComponent(\"destroy-at-extreme-distances\", {\r\n  schema: {\r\n    xMin: { default: -1000 },\r\n    xMax: { default: 1000 },\r\n    yMin: { default: -1000 },\r\n    yMax: { default: 1000 },\r\n    zMin: { default: -1000 },\r\n    zMax: { default: 1000 }\r\n  },\r\n\r\n  init() {\r\n    this._checkForDestroy = this._checkForDestroy.bind(this);\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._checkForDestroy, \"media-components\");\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._checkForDestroy, \"media-components\");\r\n  },\r\n\r\n  _checkForDestroy: (function() {\r\n    const pos = new THREE.Vector3();\r\n    return function() {\r\n      const { xMin, xMax, yMin, yMax, zMin, zMax } = this.data;\r\n      getLastWorldPosition(this.el.object3D, pos);\r\n\r\n      if (pos.x < xMin || pos.x > xMax || pos.y < yMin || pos.y > yMax || pos.z < zMin || pos.z > zMax) {\r\n        if (!this.el.components.networked || NAF.utils.isMine(this.el)) {\r\n          this.el.parentNode.removeChild(this.el);\r\n        }\r\n      }\r\n    };\r\n  })()\r\n});\r\n","import { addAndArrangeMedia } from \"../utils/media-utils\";\r\nimport { createImageBitmap } from \"../utils/image-bitmap-utils\";\r\nimport { ObjectTypes } from \"../object-types\";\r\nimport { paths } from \"../systems/userinput/paths\";\r\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, SOUND_CAMERA_TOOL_COUNTDOWN } from \"../systems/sound-effects-system\";\r\nimport { getAudioFeedbackScale } from \"./audio-feedback\";\r\nimport { cloneObject3D } from \"../utils/three-utils\";\r\nimport { loadModel } from \"./gltf-model-plus\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\r\nimport anime from \"animejs\";\r\n\r\nconst cameraModelPromise = waitForDOMContentLoaded().then(() => loadModel(cameraModelSrc));\r\n\r\nconst pathsMap = {\r\n  \"player-right-controller\": {\r\n    takeSnapshot: paths.actions.rightHand.takeSnapshot\r\n  },\r\n  \"player-left-controller\": {\r\n    takeSnapshot: paths.actions.leftHand.takeSnapshot\r\n  },\r\n  \"right-cursor\": {\r\n    takeSnapshot: paths.actions.cursor.right.takeSnapshot\r\n  },\r\n  \"left-cursor\": {\r\n    takeSnapshot: paths.actions.cursor.left.takeSnapshot\r\n  }\r\n};\r\n\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\nconst VIEWFINDER_FPS = 6;\r\nconst VIDEO_FPS = 25;\r\n// Prefer h264 if available due to faster decoding speec on most platforms\r\nconst videoCodec = [\"h264\", \"vp9,opus\", \"vp8,opus\", \"vp9\", \"vp8\"].find(\r\n  codec => window.MediaRecorder && MediaRecorder.isTypeSupported(`video/webm; codecs=${codec}`)\r\n);\r\nconst videoMimeType = videoCodec ? `video/webm; codecs=${videoCodec}` : null;\r\nconst hasWebGL2 = !!document.createElement(\"canvas\").getContext(\"webgl2\");\r\nconst allowVideo = !!videoMimeType && hasWebGL2;\r\n\r\nconst CAPTURE_WIDTH = isMobileVR ? 640 : 1280;\r\nconst CAPTURE_HEIGHT = isMobileVR ? 360 : 720;\r\nconst RENDER_WIDTH = 1280;\r\nconst RENDER_HEIGHT = 720;\r\nconst CAPTURE_DURATIONS = [3, 7, 15, 30, 60, Infinity];\r\nconst DEFAULT_CAPTURE_DURATION = 7;\r\nconst COUNTDOWN_DURATION = 3;\r\nconst VIDEO_LOOPS = 3; // Number of times to loop the videos we spawn before stopping them (for perf)\r\nconst MAX_DURATION_TO_LIMIT_LOOPS = 31; // Max duration for which we limit loops (eg GIFs vs long form videos)\r\n\r\nconst snapCanvas = document.createElement(\"canvas\");\r\n\r\nasync function pixelsToPNG(pixels, width, height) {\r\n  snapCanvas.width = width;\r\n  snapCanvas.height = height;\r\n  const context = snapCanvas.getContext(\"2d\");\r\n\r\n  const imageData = context.createImageData(width, height);\r\n  imageData.data.set(pixels);\r\n  const bitmap = await createImageBitmap(imageData);\r\n  context.scale(1, -1);\r\n  context.drawImage(bitmap, 0, -height);\r\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\r\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\r\n}\r\n\r\nfunction blitFramebuffer(renderer, src, srcX0, srcY0, srcX1, srcY1, dest, dstX0, dstY0, dstX1, dstY1) {\r\n  const gl = renderer.context;\r\n\r\n  // Copies from one framebuffer to another. Note that at the end of this function, you need to restore\r\n  // the original framebuffer via setRenderTarget\r\n  const srcFramebuffer = renderer.properties.get(src).__webglFramebuffer;\r\n  const destFramebuffer = renderer.properties.get(dest).__webglFramebuffer;\r\n\r\n  if (srcFramebuffer && destFramebuffer) {\r\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, srcFramebuffer);\r\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, destFramebuffer);\r\n\r\n    if (gl.checkFramebufferStatus(gl.READ_FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\r\n      gl.blitFramebuffer(srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, gl.COLOR_BUFFER_BIT, gl.LINEAR);\r\n    }\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"camera-tool\", {\r\n  schema: {\r\n    captureDuration: { default: DEFAULT_CAPTURE_DURATION },\r\n    captureAudio: { default: false },\r\n    isSnapping: { default: false },\r\n    isRecording: { default: false },\r\n    label: { default: \"\" }\r\n  },\r\n\r\n  init() {\r\n    this.el.object3D.visible = false; // Make invisible until model ready\r\n    this.lastUpdate = performance.now();\r\n    this.localSnapCount = 0; // Counter that is used to arrange photos/videos\r\n\r\n    this.showCameraViewfinder = !isMobileVR;\r\n\r\n    this.renderTarget = new THREE.WebGLRenderTarget(RENDER_WIDTH, RENDER_HEIGHT, {\r\n      format: THREE.RGBAFormat,\r\n      minFilter: THREE.LinearFilter,\r\n      magFilter: THREE.NearestFilter,\r\n      encoding: THREE.sRGBEncoding,\r\n      depth: false,\r\n      stencil: false\r\n    });\r\n\r\n    this.camera = new THREE.PerspectiveCamera(50, RENDER_WIDTH / RENDER_HEIGHT, 0.1, 30000);\r\n    this.camera.rotation.set(0, Math.PI, 0);\r\n    this.camera.position.set(0, 0, 0.05);\r\n    this.camera.matrixNeedsUpdate = true;\r\n    this.el.setObject3D(\"camera\", this.camera);\r\n\r\n    const material = new THREE.MeshBasicMaterial({\r\n      map: this.renderTarget.texture\r\n    });\r\n\r\n    // Bit of a hack here to only update the renderTarget when the screens are in view\r\n    material.map.isVideoTexture = true;\r\n    material.map.update = () => {\r\n      if (this.showCameraViewfinder) {\r\n        this.viewfinderInViewThisFrame = true;\r\n      }\r\n    };\r\n\r\n    this.el.sceneEl.addEventListener(\"stateadded\", () => this.updateUI());\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", () => this.updateUI());\r\n\r\n    cameraModelPromise.then(model => {\r\n      const mesh = cloneObject3D(model.scene);\r\n      mesh.scale.set(2, 2, 2);\r\n      mesh.matrixNeedsUpdate = true;\r\n      this.el.setObject3D(\"mesh\", mesh);\r\n\r\n      this.el.object3D.visible = true;\r\n      this.el.object3D.scale.set(0.5, 0.5, 0.5);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n\r\n      const obj = this.el.object3D;\r\n\r\n      const step = (function() {\r\n        const lastValue = {};\r\n        return function(anim) {\r\n          const value = anim.animatables[0].target;\r\n\r\n          value.x = Math.max(Number.MIN_VALUE, value.x);\r\n          value.y = Math.max(Number.MIN_VALUE, value.y);\r\n          value.z = Math.max(Number.MIN_VALUE, value.z);\r\n\r\n          // For animation timeline.\r\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\r\n            return;\r\n          }\r\n\r\n          lastValue.x = value.x;\r\n          lastValue.y = value.y;\r\n          lastValue.z = value.z;\r\n\r\n          obj.scale.set(value.x, value.y, value.z);\r\n          obj.matrixNeedsUpdate = true;\r\n        };\r\n      })();\r\n\r\n      const config = {\r\n        duration: 200,\r\n        easing: \"easeOutQuad\",\r\n        elasticity: 400,\r\n        loop: 0,\r\n        round: false,\r\n        x: 1,\r\n        y: 1,\r\n        z: 1,\r\n        targets: [{ x: 0.5, y: 0.5, z: 0.5 }],\r\n        update: anim => step(anim),\r\n        complete: anim => step(anim)\r\n      };\r\n\r\n      anime(config);\r\n\r\n      const width = 0.28;\r\n      const geometry = new THREE.PlaneBufferGeometry(width, width / this.camera.aspect);\r\n\r\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n      if (environmentMapComponent) {\r\n        environmentMapComponent.applyEnvironmentMap(this.el.object3D);\r\n      }\r\n\r\n      this.screen = new THREE.Mesh(geometry, material);\r\n      this.screen.rotation.set(0, Math.PI, 0);\r\n      this.screen.position.set(0, 0, -0.042);\r\n      this.screen.matrixNeedsUpdate = true;\r\n      this.el.setObject3D(\"screen\", this.screen);\r\n\r\n      this.selfieScreen = new THREE.Mesh(geometry, material);\r\n      this.selfieScreen.position.set(0, 0.4, 0);\r\n      this.selfieScreen.scale.set(-2, 2, 2);\r\n      this.selfieScreen.matrixNeedsUpdate = true;\r\n      this.el.setObject3D(\"selfieScreen\", this.selfieScreen);\r\n\r\n      this.label = this.el.querySelector(\".label\");\r\n      this.labelActionBackground = this.el.querySelector(\".label-action-background\");\r\n      this.labelBackground = this.el.querySelector(\".label-background\");\r\n      this.durationLabel = this.el.querySelector(\".duration\");\r\n\r\n      this.recordIcon = this.el.querySelector(\".record-icon\");\r\n      this.recordAlphaIcon = this.el.querySelector(\".record-alpha-icon\");\r\n\r\n      this.label.object3D.visible = false;\r\n      this.durationLabel.object3D.visible = false;\r\n\r\n      this.snapMenu = this.el.querySelector(\".camera-snap-menu\");\r\n      this.snapButton = this.el.querySelector(\".snap-button\");\r\n      this.recordButton = this.el.querySelector(\".record-button\");\r\n\r\n      this.cancelButton = this.el.querySelector(\".cancel-button\");\r\n      this.nextDurationButton = this.el.querySelector(\".next-duration\");\r\n      this.prevDurationButton = this.el.querySelector(\".prev-duration\");\r\n      this.snapButton.object3D.addEventListener(\"interact\", () => this.snapClicked(true));\r\n      this.recordButton.object3D.addEventListener(\"interact\", () => this.snapClicked(false));\r\n      this.cancelButton.object3D.addEventListener(\"interact\", () => this.cancelSnapping());\r\n      this.nextDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(1));\r\n      this.prevDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(-1));\r\n      this.stopButton = this.el.querySelector(\".stop-button\");\r\n      this.stopButton.object3D.addEventListener(\"interact\", () => this.stopRecording());\r\n      this.captureAudioButton = this.el.querySelector(\".capture-audio\");\r\n      this.captureAudioIcon = this.el.querySelector(\".capture-audio-icon\");\r\n      this.captureAudioButton.object3D.addEventListener(\"interact\", () =>\r\n        this.el.setAttribute(\"camera-tool\", \"captureAudio\", !this.data.captureAudio)\r\n      );\r\n\r\n      this.updateUI();\r\n\r\n      this.updateRenderTargetNextTick = true;\r\n\r\n      this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\r\n      this.cameraSystem.register(this.el);\r\n\r\n      waitForDOMContentLoaded().then(() => {\r\n        this.playerCamera = document.getElementById(\"viewing-camera\").getObject3D(\"camera\");\r\n      });\r\n    });\r\n  },\r\n\r\n  remove() {\r\n    this.cameraSystem.deregister(this.el);\r\n    this.el.sceneEl.emit(\"camera_removed\");\r\n    this.stopRecording();\r\n  },\r\n\r\n  updateViewfinder() {\r\n    this.updateRenderTargetNextTick = true;\r\n  },\r\n\r\n  changeDuration(delta) {\r\n    const idx = CAPTURE_DURATIONS.findIndex(d => this.data.captureDuration == d);\r\n    const newIdx = idx === 0 && delta === -1 ? CAPTURE_DURATIONS.length - 1 : (idx + delta) % CAPTURE_DURATIONS.length;\r\n    this.el.setAttribute(\"camera-tool\", \"captureDuration\", CAPTURE_DURATIONS[newIdx]);\r\n  },\r\n\r\n  focus(el, track) {\r\n    if (track) {\r\n      this.trackTarget = el;\r\n    } else {\r\n      this.trackTarget = null;\r\n    }\r\n\r\n    this.lookAt(el);\r\n  },\r\n\r\n  lookAt: (function() {\r\n    const targetPos = new THREE.Vector3();\r\n    return function(el) {\r\n      targetPos.setFromMatrixPosition(el.object3D.matrixWorld);\r\n      this.el.object3D.lookAt(targetPos);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    };\r\n  })(),\r\n\r\n  snapClicked(isPhoto) {\r\n    if (this.data.isSnapping) return;\r\n    if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) return;\r\n\r\n    this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\r\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\r\n\r\n    this.snapCountdown = COUNTDOWN_DURATION;\r\n    this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\r\n\r\n    this.countdownInterval = setInterval(async () => {\r\n      if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) {\r\n        clearInterval(this.countdownInterval);\r\n        this.countdownInterval = null;\r\n        return;\r\n      }\r\n\r\n      this.snapCountdown--;\r\n\r\n      if (this.snapCountdown === 0) {\r\n        clearInterval(this.countdownInterval);\r\n        this.countdownInterval = null;\r\n\r\n        if (isPhoto) {\r\n          this.el.setAttribute(\"camera-tool\", { label: \"\", isSnapping: false });\r\n          this.takeSnapshotNextTick = true;\r\n        } else {\r\n          this.beginRecording(this.data.captureDuration);\r\n        }\r\n      } else {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\r\n        this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\r\n      }\r\n    }, 1000);\r\n  },\r\n\r\n  cancelSnapping() {\r\n    clearInterval(this.countdownInterval);\r\n    this.stopRecording(true);\r\n    this.updateUI();\r\n  },\r\n\r\n  update() {\r\n    this.updateUI();\r\n  },\r\n\r\n  updateUI() {\r\n    if (!this.label) return;\r\n\r\n    const label = this.data.label;\r\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\r\n    const hasDuration = this.data.captureDuration !== Infinity;\r\n\r\n    const isRecordingUnbound = !hasDuration && this.data.isRecording && this.videoRecorder;\r\n    this.label.object3D.visible = !!label && !isRecordingUnbound;\r\n    const showActionLabelBackground = this.label.object3D.visible && this.data.isRecording && !isRecordingUnbound;\r\n\r\n    if (label) {\r\n      this.label.setAttribute(\"text\", { value: label, color: showActionLabelBackground ? \"#fafafa\" : \"#ff3464\" });\r\n    }\r\n\r\n    this.labelActionBackground.object3D.visible = showActionLabelBackground;\r\n    this.labelBackground.object3D.visible = this.label.object3D.visible && !showActionLabelBackground;\r\n\r\n    this.stopButton.object3D.visible = isRecordingUnbound;\r\n\r\n    if (hasDuration) {\r\n      this.durationLabel.setAttribute(\"text\", \"value\", `${this.data.captureDuration}`);\r\n    }\r\n\r\n    this.durationLabel.object3D.visible = hasDuration && !this.data.isSnapping && !isFrozen && allowVideo;\r\n    this.recordIcon.object3D.visible = !hasDuration && !isFrozen && allowVideo;\r\n    this.recordAlphaIcon.object3D.visible = hasDuration && !isFrozen && allowVideo;\r\n    this.snapButton.object3D.visible = !this.data.isSnapping && !isFrozen;\r\n    this.recordButton.object3D.visible = !this.data.isSnapping && !isFrozen && allowVideo;\r\n    this.cancelButton.object3D.visible = this.data.isSnapping && !isFrozen;\r\n    this.prevDurationButton.object3D.visible = this.nextDurationButton.object3D.visible =\r\n      !this.data.isSnapping && allowVideo && !isFrozen && allowVideo;\r\n\r\n    this.captureAudioIcon.setAttribute(\"icon-button\", \"active\", this.data.captureAudio);\r\n  },\r\n\r\n  async beginRecording(duration) {\r\n    if (!this.videoContext) {\r\n      this.videoCanvas = document.createElement(\"canvas\");\r\n      this.videoCanvas.width = CAPTURE_WIDTH;\r\n      this.videoCanvas.height = CAPTURE_HEIGHT;\r\n      this.videoContext = this.videoCanvas.getContext(\"2d\");\r\n      this.videoImageData = this.videoContext.createImageData(CAPTURE_WIDTH, CAPTURE_HEIGHT);\r\n      this.videoPixels = new Uint8Array(CAPTURE_WIDTH * CAPTURE_HEIGHT * 4);\r\n      this.videoImageData.data.set(this.videoPixels);\r\n    }\r\n\r\n    const stream = new MediaStream();\r\n    const track = this.videoCanvas.captureStream(VIDEO_FPS).getVideoTracks()[0];\r\n\r\n    // HACK: FF 73+ seems to fail to decode videos with no audio track, so we always include a silent track.\r\n    // Note that chrome won't generate the video without some data flowing to the track, hence the oscillator.\r\n    const attachBlankAudio = () => {\r\n      const context = THREE.AudioContext.getContext();\r\n      const oscillator = context.createOscillator();\r\n      const gain = context.createGain();\r\n      const destination = context.createMediaStreamDestination();\r\n      gain.gain.setValueAtTime(0.0001, context.currentTime);\r\n      oscillator.connect(destination);\r\n      gain.connect(destination);\r\n      stream.addTrack(destination.stream.getAudioTracks()[0]);\r\n    };\r\n\r\n    if (this.data.captureAudio) {\r\n      const selfAudio = await NAF.connection.adapter.getMediaStream(NAF.clientId, \"audio\");\r\n\r\n      // NOTE: if we don't have a self audio track, we can end up generating an empty video (browser bug?)\r\n      // if no audio comes through on the listener source. (Eg the room is otherwise silent.)\r\n      // So for now, if we don't have a track, just disable audio capture.\r\n      if (selfAudio && selfAudio.getAudioTracks().length > 0) {\r\n        const context = THREE.AudioContext.getContext();\r\n        const destination = context.createMediaStreamDestination();\r\n\r\n        const listener = this.el.sceneEl.audioListener;\r\n        if (listener) {\r\n          // NOTE audio is not captured from camera vantage point for now.\r\n          listener.getInput().connect(destination);\r\n        }\r\n        context.createMediaStreamSource(selfAudio).connect(destination);\r\n\r\n        const audio = destination.stream.getAudioTracks()[0];\r\n        stream.addTrack(audio);\r\n      } else {\r\n        attachBlankAudio();\r\n      }\r\n    } else {\r\n      attachBlankAudio();\r\n    }\r\n\r\n    stream.addTrack(track);\r\n    this.videoRecorder = new MediaRecorder(stream, { mimeType: videoMimeType });\r\n    const chunks = [];\r\n    const recordingStartTime = performance.now();\r\n\r\n    this.videoRecorder.ondataavailable = e => chunks.push(e.data);\r\n\r\n    this.updateRenderTargetNextTick = true;\r\n\r\n    this.videoRecorder.start();\r\n    this.el.setAttribute(\"camera-tool\", { isRecording: true, label: \" \" });\r\n    this.el.sceneEl.emit(\"action_camera_recording_started\");\r\n\r\n    if (duration !== Infinity) {\r\n      this.videoCountdown = this.data.captureDuration;\r\n      this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\r\n\r\n      this.videoCountdownInterval = setInterval(() => {\r\n        this.videoCountdown--;\r\n\r\n        if (this.videoCountdown === 0) {\r\n          this.stopRecording();\r\n          this.videoCountdownInterval = null;\r\n        } else {\r\n          this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\r\n        }\r\n      }, 1000);\r\n    }\r\n\r\n    this.videoRecorder._free = () => (chunks.length = 0); // Used for cancelling\r\n    this.videoRecorder.onstop = async () => {\r\n      this.el.sceneEl.emit(\"action_camera_recording_ended\");\r\n\r\n      if (chunks.length === 0) return;\r\n      const mimeType = chunks[0].type;\r\n      const recordingDuration = performance.now() - recordingStartTime;\r\n      const blob = new Blob(chunks, { type: mimeType });\r\n\r\n      chunks.length = 0;\r\n\r\n      const { entity, orientation } = addAndArrangeMedia(\r\n        this.el,\r\n        new File([blob], \"capture\", { type: mimeType.split(\";\")[0] }), // Drop codec\r\n        \"video-camera\",\r\n        this.localSnapCount,\r\n        !!this.playerIsBehindCamera\r\n      );\r\n\r\n      entity.addEventListener(\r\n        \"video-loaded\",\r\n        () => {\r\n          // If we were recording audio, then pause the video immediately after starting.\r\n          //\r\n          // Or, to limit the # of concurrent videos playing, if it was a short clip, let it loop\r\n          // a few times and then pause it.\r\n          if (this.data.captureAudio || recordingDuration <= MAX_DURATION_TO_LIMIT_LOOPS * 1000) {\r\n            setTimeout(() => {\r\n              if (!NAF.utils.isMine(entity) && !NAF.utils.takeOwnership(entity)) return;\r\n              entity.components[\"media-video\"].tryUpdateVideoPlaybackState(true);\r\n            }, this.data.captureAudio ? 0 : recordingDuration * VIDEO_LOOPS + 100);\r\n          }\r\n        },\r\n        { once: true }\r\n      );\r\n\r\n      this.localSnapCount++;\r\n\r\n      orientation.then(() => this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA }));\r\n    };\r\n  },\r\n\r\n  stopRecording(cancel) {\r\n    if (this.videoRecorder) {\r\n      if (cancel) {\r\n        this.videoRecorder.onstop = () => {};\r\n        this.videoRecorder._free();\r\n      }\r\n\r\n      this.videoRecorder.stop();\r\n      this.videoRecorder = null;\r\n\r\n      if (!cancel) {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\r\n      }\r\n    }\r\n    clearInterval(this.videoCountdownInterval);\r\n\r\n    this.videoCountdownInterval = null;\r\n    this.el.setAttribute(\"camera-tool\", \"label\", \"\");\r\n    this.el.setAttribute(\"camera-tool\", { isRecording: false, isSnapping: false });\r\n  },\r\n\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\r\n    const heldRightHand = interaction.state.rightHand.held === this.el;\r\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\r\n\r\n    const heldThisFrame =\r\n      (heldLeftHand && userinput.get(interaction.options.leftHand.grabPath)) ||\r\n      (heldRightHand && userinput.get(interaction.options.rightHand.grabPath)) ||\r\n      (heldRightRemote && userinput.get(interaction.options.rightRemote.grabPath));\r\n\r\n    const isHolding = heldLeftHand || heldRightHand || heldRightRemote;\r\n\r\n    this.updateSnapMenuOrientation();\r\n\r\n    if (heldThisFrame) {\r\n      this.localSnapCount = 0;\r\n    }\r\n\r\n    this.showCameraViewfinder = isHolding || !isMobileVR || this.data.isSnapping || this.videoRecorder;\r\n\r\n    if (this.screen && this.selfieScreen) {\r\n      this.screen.visible = this.selfieScreen.visible = !!this.showCameraViewfinder;\r\n    }\r\n\r\n    // Always draw held, snapping, or recording camera viewfinders with a decent framerate\r\n    if (\r\n      (isHolding || this.data.isSnapping || this.videoRecorder) &&\r\n      performance.now() - this.lastUpdate >= 1000 / (this.videoRecorder ? VIDEO_FPS : VIEWFINDER_FPS)\r\n    ) {\r\n      this.updateRenderTargetNextTick = true;\r\n    }\r\n\r\n    const isHoldingTrigger = this.isHoldingSnapshotTrigger();\r\n    const isPermittedToUse = window.APP.hubChannel.can(\"spawn_camera\");\r\n\r\n    if (isPermittedToUse) {\r\n      // If the user lets go of the trigger before 500ms, take a picture, otherwise record until they let go.\r\n      if (isHoldingTrigger && !this.data.isSnapping && !this.snapTriggerTimeout) {\r\n        this.snapTriggerTimeout = setTimeout(() => {\r\n          if (this.isHoldingSnapshotTrigger()) {\r\n            this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\r\n            this.beginRecording(Infinity);\r\n\r\n            const releaseInterval = setInterval(() => {\r\n              if (this.isHoldingSnapshotTrigger()) return;\r\n              this.stopRecording();\r\n              clearInterval(releaseInterval);\r\n            }, 500);\r\n          }\r\n\r\n          this.snapTriggerTimeout = null;\r\n        }, 500);\r\n      } else if (!isHoldingTrigger && !this.data.isSnapping && this.snapTriggerTimeout) {\r\n        clearTimeout(this.snapTriggerTimeout);\r\n        this.snapTriggerTimeout = null;\r\n        this.takeSnapshotNextTick = true;\r\n      }\r\n    }\r\n  },\r\n\r\n  tock: (function() {\r\n    return function tock() {\r\n      const sceneEl = this.el.sceneEl;\r\n      const renderer = this.renderer || sceneEl.renderer;\r\n      const now = performance.now();\r\n      const playerHead = this.cameraSystem.playerHead;\r\n\r\n      // Perform lookAt in tock so it will re-orient after grabs, etc.\r\n      if (this.trackTarget) {\r\n        if (this.trackTarget.parentNode) {\r\n          this.lookAt(this.trackTarget);\r\n        } else {\r\n          this.trackTarget = null; // Target removed\r\n        }\r\n      }\r\n\r\n      if (!this.playerHud) {\r\n        const hudEl = document.getElementById(\"player-hud\");\r\n        this.playerHud = hudEl && hudEl.object3D;\r\n      }\r\n\r\n      if (\r\n        this.takeSnapshotNextTick ||\r\n        (this.updateRenderTargetNextTick && (this.viewfinderInViewThisFrame || this.videoRecorder))\r\n      ) {\r\n        if (playerHead) {\r\n          // We want to scale our own head in between frames now that we're taking a video/photo.\r\n          let scale = 1;\r\n          // TODO: The local-audio-analyser has the non-networked media stream, which is active\r\n          // even while the user is muted. This should be looking at a different analyser that\r\n          // has the networked media stream instead.\r\n          const analyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\r\n\r\n          if (analyser && playerHead.el.components[\"scale-audio-feedback\"]) {\r\n            scale = getAudioFeedbackScale(this.el.object3D, playerHead, 1, 2, analyser.volume);\r\n          }\r\n\r\n          playerHead.visible = true;\r\n          playerHead.scale.set(scale, scale, scale);\r\n          playerHead.updateMatrices(true, true);\r\n          playerHead.updateMatrixWorld(true, true);\r\n        }\r\n\r\n        let playerHudWasVisible = false;\r\n\r\n        if (this.playerHud) {\r\n          playerHudWasVisible = this.playerHud.visible;\r\n          this.playerHud.visible = false;\r\n          if (this.el.sceneEl.systems[\"hubs-systems\"]) {\r\n            for (const mesh of Object.values(this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.meshes)) {\r\n              mesh.visible = false;\r\n            }\r\n          }\r\n        }\r\n\r\n        const bubbleSystem = this.el.sceneEl.systems[\"personal-space-bubble\"];\r\n\r\n        if (bubbleSystem) {\r\n          for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\r\n            bubbleSystem.invaders[i].disable();\r\n          }\r\n        }\r\n\r\n        const tmpVRFlag = renderer.vr.enabled;\r\n        const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\r\n        delete sceneEl.object3D.onAfterRender;\r\n        renderer.vr.enabled = false;\r\n\r\n        if (allowVideo && this.videoRecorder && !this.videoRenderTarget) {\r\n          // Create a separate render target for video becuase we need to flip and (sometimes) downscale it before\r\n          // encoding it to video.\r\n          this.videoRenderTarget = new THREE.WebGLRenderTarget(CAPTURE_WIDTH, CAPTURE_HEIGHT, {\r\n            format: THREE.RGBAFormat,\r\n            minFilter: THREE.LinearFilter,\r\n            magFilter: THREE.NearestFilter,\r\n            encoding: THREE.sRGBEncoding,\r\n            depth: false,\r\n            stencil: false\r\n          });\r\n\r\n          // Used to set up framebuffer in three.js as a side effect\r\n          renderer.setRenderTarget(this.videoRenderTarget);\r\n        }\r\n\r\n        renderer.setRenderTarget(this.renderTarget);\r\n        renderer.render(sceneEl.object3D, this.camera);\r\n        renderer.setRenderTarget(null);\r\n\r\n        renderer.vr.enabled = tmpVRFlag;\r\n        sceneEl.object3D.onAfterRender = tmpOnAfterRender;\r\n        if (playerHead) {\r\n          playerHead.visible = false;\r\n          playerHead.scale.set(0.00000001, 0.00000001, 0.00000001);\r\n          playerHead.updateMatrices(true, true);\r\n          playerHead.updateMatrixWorld(true, true);\r\n        }\r\n\r\n        if (this.playerHud) {\r\n          this.playerHud.visible = playerHudWasVisible;\r\n          if (this.el.sceneEl.systems[\"hubs-systems\"]) {\r\n            for (const mesh of Object.values(this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.meshes)) {\r\n              mesh.visible = true;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (bubbleSystem) {\r\n          for (let i = 0, l = bubbleSystem.invaders.length; i < l; i++) {\r\n            bubbleSystem.invaders[i].enable();\r\n          }\r\n        }\r\n\r\n        this.lastUpdate = now;\r\n\r\n        if (this.videoRecorder) {\r\n          // This blit operation will (if necessary) scale/resample the view finder render target and, importantly,\r\n          // flip the texture on Y\r\n          blitFramebuffer(\r\n            renderer,\r\n            this.renderTarget,\r\n            0,\r\n            0,\r\n            RENDER_WIDTH,\r\n            RENDER_HEIGHT,\r\n            this.videoRenderTarget,\r\n            0,\r\n            CAPTURE_HEIGHT,\r\n            CAPTURE_WIDTH,\r\n            0\r\n          );\r\n          renderer.readRenderTargetPixels(\r\n            this.videoRenderTarget,\r\n            0,\r\n            0,\r\n            CAPTURE_WIDTH,\r\n            CAPTURE_HEIGHT,\r\n            this.videoPixels\r\n          );\r\n          this.videoImageData.data.set(this.videoPixels);\r\n          this.videoContext.putImageData(this.videoImageData, 0, 0);\r\n        }\r\n\r\n        this.updateRenderTargetNextTick = false;\r\n        this.viewfinderInViewThisFrame = false;\r\n      }\r\n\r\n      if (this.takeSnapshotNextTick) {\r\n        if (!this.snapPixels) {\r\n          this.snapPixels = new Uint8Array(RENDER_WIDTH * RENDER_HEIGHT * 4);\r\n        }\r\n        renderer.readRenderTargetPixels(this.renderTarget, 0, 0, RENDER_WIDTH, RENDER_HEIGHT, this.snapPixels);\r\n\r\n        pixelsToPNG(this.snapPixels, RENDER_WIDTH, RENDER_HEIGHT).then(file => {\r\n          const { orientation } = addAndArrangeMedia(\r\n            this.el,\r\n            file,\r\n            \"photo-camera\",\r\n            this.localSnapCount,\r\n            !!this.playerIsBehindCamera\r\n          );\r\n\r\n          orientation.then(() => {\r\n            this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA });\r\n          });\r\n        });\r\n        sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\r\n        this.takeSnapshotNextTick = false;\r\n        this.localSnapCount++;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  isHoldingSnapshotTrigger: function() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\r\n    const heldRightHand = interaction.state.rightHand.held === this.el;\r\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\r\n    const heldLeftRemote = interaction.state.leftRemote.held === this.el;\r\n\r\n    let grabberId;\r\n    if (heldRightHand) {\r\n      grabberId = \"player-right-controller\";\r\n    } else if (heldLeftHand) {\r\n      grabberId = \"player-left-controller\";\r\n    } else if (heldRightRemote) {\r\n      grabberId = \"right-cursor\";\r\n    } else if (heldLeftRemote) {\r\n      grabberId = \"left-cursor\";\r\n    }\r\n\r\n    if (grabberId) {\r\n      const grabberPaths = pathsMap[grabberId];\r\n      if (userinput.get(grabberPaths.takeSnapshot)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return !!userinput.get(paths.actions.takeSnapshot);\r\n  },\r\n\r\n  updateSnapMenuOrientation: (function() {\r\n    const playerWorld = new THREE.Vector3();\r\n    const cameraWorld = new THREE.Vector3();\r\n    const playerToCamera = new THREE.Vector3();\r\n    const cameraForwardPoint = new THREE.Vector3();\r\n    const cameraForwardWorld = new THREE.Vector3();\r\n    return function() {\r\n      if (!this.playerCamera) return;\r\n      this.el.object3D.getWorldPosition(cameraWorld);\r\n      this.playerCamera.getWorldPosition(playerWorld);\r\n      playerToCamera.subVectors(playerWorld, cameraWorld);\r\n      cameraForwardPoint.set(0, 0, 1);\r\n      this.el.object3D.localToWorld(cameraForwardPoint);\r\n      cameraForwardWorld.subVectors(cameraForwardPoint, cameraWorld);\r\n      cameraForwardWorld.normalize();\r\n      playerToCamera.normalize();\r\n\r\n      const playerIsBehindCamera = cameraForwardWorld.dot(playerToCamera) < 0;\r\n\r\n      if (this.playerIsBehindCamera !== playerIsBehindCamera) {\r\n        this.playerIsBehindCamera = playerIsBehindCamera;\r\n        this.snapMenu.object3D.rotation.set(0, this.playerIsBehindCamera ? Math.PI : 0, 0);\r\n        this.snapMenu.object3D.matrixNeedsUpdate = true;\r\n      }\r\n    };\r\n  })()\r\n});\r\n","import { cloneMedia } from \"../utils/media-utils\";\r\nimport { guessContentType } from \"../utils/media-url-utils\";\r\n\r\nAFRAME.registerComponent(\"clone-media-button\", {\r\n  init() {\r\n    this.updateSrc = () => {\r\n      if (!this.targetEl.parentNode) return; // If removed\r\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\r\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\r\n      this.el.object3D.visible = !!visible;\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\r\n      this.updateSrc();\r\n    });\r\n\r\n    this.onClick = () => {\r\n      const { entity } = cloneMedia(this.targetEl, \"#interactable-media\", this.src);\r\n\r\n      entity.object3D.scale.copy(this.targetEl.object3D.scale);\r\n      entity.object3D.matrixNeedsUpdate = true;\r\n\r\n      entity.setAttribute(\"offset-relative-to\", {\r\n        target: \"#avatar-pov-node\",\r\n        offset: { x: 0, y: 0, z: -1.5 * this.targetEl.object3D.scale.z }\r\n      });\r\n    };\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { willRequireUserGesture, showFullScreenIfAvailable } from \"./fullscreen\";\r\nimport screenfull from \"screenfull\";\r\n\r\nlet _isIn2DInterstitial = false;\r\nlet _exitAction = null;\r\n\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\nconst getUserGesture = () => {\r\n  return new Promise(resolve => {\r\n    const scene = document.querySelector(\"a-scene\");\r\n    scene.addEventListener(\"2d-interstitial-gesture-complete\", resolve, { once: true });\r\n    scene.emit(\"2d-interstitial-gesture-required\");\r\n  });\r\n};\r\n\r\nexport async function handleExitTo2DInterstitial(isLower, exitAction, nonFullscreen) {\r\n  const scene = document.querySelector(\"a-scene\");\r\n  if (!scene.is(\"vr-mode\")) {\r\n    if (isMobileVR && willRequireUserGesture()) {\r\n      await getUserGesture();\r\n      await showFullScreenIfAvailable();\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  _isIn2DInterstitial = true;\r\n  _exitAction = exitAction;\r\n\r\n  if (isMobileVR) {\r\n    await scene.exitVR();\r\n\r\n    if (!nonFullscreen) {\r\n      await getUserGesture();\r\n      await showFullScreenIfAvailable();\r\n    }\r\n  } else {\r\n    // Non-immersive browser, show notice\r\n    const vrNotice = document.querySelector(\".vr-notice\");\r\n    vrNotice.object3D.visible = true;\r\n    vrNotice.setAttribute(\"follow-in-fov\", {\r\n      angle: isLower ? 39 : -15\r\n    });\r\n  }\r\n}\r\n\r\nexport async function exit2DInterstitialAndEnterVR(force) {\r\n  if (!force && !_isIn2DInterstitial) {\r\n    return;\r\n  }\r\n\r\n  _isIn2DInterstitial = false;\r\n\r\n  document.querySelector(\".vr-notice\").object3D.visible = false;\r\n\r\n  const scene = document.querySelector(\"a-scene\");\r\n\r\n  if (isMobileVR) {\r\n    if (screenfull.isFullscreen) {\r\n      await screenfull.exit();\r\n      await getUserGesture();\r\n      await scene.enterVR();\r\n    } else {\r\n      await scene.enterVR();\r\n    }\r\n  } else {\r\n    if (!scene.is(\"vr-mode\")) {\r\n      await scene.enterVR();\r\n    }\r\n  }\r\n}\r\n\r\nexport function isIn2DInterstitial() {\r\n  return _isIn2DInterstitial;\r\n}\r\n\r\nexport async function forceExitFrom2DInterstitial() {\r\n  if (!_isIn2DInterstitial) return;\r\n\r\n  if (_exitAction) {\r\n    _exitAction();\r\n    _exitAction = null;\r\n  }\r\n\r\n  await exit2DInterstitialAndEnterVR();\r\n}\r\n","import { isLocalHubsSceneUrl, isHubsRoomUrl, isLocalHubsAvatarUrl } from \"../utils/media-url-utils\";\r\nimport { guessContentType } from \"../utils/media-url-utils\";\r\nimport { handleExitTo2DInterstitial } from \"../utils/vr-interstitial\";\r\n\r\nAFRAME.registerComponent(\"open-media-button\", {\r\n  schema: {\r\n    onlyOpenLink: { type: \"boolean\" }\r\n  },\r\n  init() {\r\n    this.label = this.el.querySelector(\"[text]\");\r\n\r\n    this.updateSrc = async () => {\r\n      if (!this.targetEl.parentNode) return; // If removed\r\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\r\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\r\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\r\n\r\n      this.el.object3D.visible = !!visible;\r\n\r\n      if (visible) {\r\n        let label = \"open link\";\r\n        if (!this.data.onlyOpenLink) {\r\n          if (await isLocalHubsAvatarUrl(src)) {\r\n            label = \"use avatar\";\r\n          } else if ((await isLocalHubsSceneUrl(src)) && mayChangeScene) {\r\n            label = \"use scene\";\r\n          } else if (await isHubsRoomUrl(src)) {\r\n            label = \"visit room\";\r\n          }\r\n        }\r\n        this.label.setAttribute(\"text\", \"value\", label);\r\n      }\r\n    };\r\n\r\n    this.onClick = async () => {\r\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\r\n\r\n      const exitImmersive = async () => await handleExitTo2DInterstitial(false, () => {}, true);\r\n\r\n      if (this.data.onlyOpenLink) {\r\n        await exitImmersive();\r\n        window.open(this.src);\r\n      } else if (await isLocalHubsAvatarUrl(this.src)) {\r\n        const avatarId = new URL(this.src).pathname.split(\"/\").pop();\r\n        window.APP.store.update({ profile: { avatarId } });\r\n        this.el.sceneEl.emit(\"avatar_updated\");\r\n      } else if ((await isLocalHubsSceneUrl(this.src)) && mayChangeScene) {\r\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\r\n      } else if (await isHubsRoomUrl(this.src)) {\r\n        await exitImmersive();\r\n        location.href = this.src;\r\n      } else {\r\n        await exitImmersive();\r\n        window.open(this.src);\r\n      }\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\r\n      this.updateSrc();\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { SOUND_MEDIA_LOADING } from \"../systems/sound-effects-system\";\r\n\r\nAFRAME.registerComponent(\"local-refresh-media-button\", {\r\n  init() {\r\n    this.onClick = async () => {\r\n      if (this.targetEl) {\r\n        this.targetEl.components[\"media-loader\"] &&\r\n          this.targetEl.components[\"media-loader\"].update(this.targetEl.components[\"media-loader\"].data, true);\r\n      }\r\n    };\r\n\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(networkedEl => {\r\n        this.targetEl = networkedEl;\r\n        const isNonLiveVideo =\r\n          this.targetEl.components[\"media-video\"] && this.targetEl.components[\"media-video\"].videoIsLive === false;\r\n        const src =\r\n          (this.targetEl.components[\"media-loader\"] && this.targetEl.components[\"media-loader\"].data.src) || \"\";\r\n        const shouldHaveLocalRefreshButton = !isNonLiveVideo && src.indexOf(\"twitch.tv\") !== -1;\r\n        if (!shouldHaveLocalRefreshButton) {\r\n          this.el.parentNode.removeChild(this.el);\r\n        } else {\r\n          const onVideoIsLiveUpdate = e => {\r\n            if (!e.detail.videoIsLive) {\r\n              this.targetEl.removeEventListener(\"video_is_live_update\", onVideoIsLiveUpdate);\r\n              this.el.parentNode.removeChild(this.el);\r\n            }\r\n          };\r\n          this.targetEl.addEventListener(\"video_is_live_update\", onVideoIsLiveUpdate);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        this.el.parentNode.removeChild(this.el);\r\n      });\r\n  },\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"refresh-media-button\", {\r\n  init() {\r\n    this.updateVisibility = this.updateVisibility.bind(this);\r\n\r\n    this.onClick = async () => {\r\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n\r\n      if (this.targetEl) {\r\n        this.targetEl.components[\"media-loader\"].refresh();\r\n\r\n        // Hide button + do the sound effect here, so only the person who clicked hears it, not everyone.\r\n        this.el.object3D.visible = false;\r\n        const loadingSoundEffect = sfx.playPositionalSoundFollowing(SOUND_MEDIA_LOADING, this.targetEl.object3D, true);\r\n\r\n        this.targetEl.addEventListener(\r\n          \"media_refreshed\",\r\n          () => {\r\n            sfx.stopPositionalAudio(loadingSoundEffect);\r\n            this.el.object3D.visible = true;\r\n            this.updateVisibility();\r\n          },\r\n          { once: true }\r\n        );\r\n      }\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n\r\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\r\n\r\n      if (this.targetEl) {\r\n        this.targetEl.addEventListener(\"pinned\", this.updateVisibility);\r\n        this.targetEl.addEventListener(\"unpinned\", this.updateVisibility);\r\n      }\r\n\r\n      this.updateVisibility();\r\n    });\r\n  },\r\n\r\n  updateVisibility() {\r\n    if (!this.targetEl) return;\r\n\r\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\r\n    this.el.object3D.visible =\r\n      (!isPinned && window.APP.hubChannel.can(\"spawn_and_move_media\")) || window.APP.hubChannel.can(\"pin_objects\");\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  remove() {\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\r\n\r\n    if (this.targetEl) {\r\n      this.targetEl.removeEventListener(\"pinned\", this.updateVisibility);\r\n      this.targetEl.removeEventListener(\"unpinned\", this.updateVisibility);\r\n    }\r\n  }\r\n});\r\n","import configs from \"../utils/configs\";\r\n\r\nAFRAME.registerComponent(\"tweet-media-button\", {\r\n  init() {\r\n    NAF.utils\r\n      .getNetworkedEntity(this.el)\r\n      .then(networkedEl => {\r\n        this.targetEl = networkedEl;\r\n      })\r\n      .catch(() => {\r\n        // Non-networked, do not handle for now, and hide button.\r\n        this.el.object3D.visible = false;\r\n      });\r\n\r\n    this.onClick = () => {\r\n      const hasDiscordBridges = window.APP.hubChannel && window.APP.hubChannel.discordBridges().length > 0;\r\n\r\n      const text = !hasDiscordBridges\r\n        ? `Taken in ${location.hostname} - ` +\r\n          `join me now at ${configs.SHORTLINK_DOMAIN}/${window.APP.hubChannel.hubId}! `\r\n        : `Taken in ${location.hostname} `;\r\n\r\n      const { src, contentSubtype } = this.targetEl.components[\"media-loader\"].data;\r\n      this.el.sceneEl.emit(\"action_media_tweet\", { url: src, contentSubtype, text, el: this.targetEl });\r\n    };\r\n  },\r\n\r\n  play() {\r\n    if (!configs.AVAILABLE_INTEGRATIONS.twitter) {\r\n      this.el.object3D.visible = false;\r\n      return;\r\n    }\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { idForAvatarUrl } from \"../utils/media-url-utils\";\r\nimport { fetchAvatar, remixAvatar } from \"../utils/avatar-utils\";\r\n\r\nconst REMIX_LABEL = \"copy avatar\";\r\nAFRAME.registerComponent(\"remix-avatar-button\", {\r\n  init() {\r\n    this.label = this.el.querySelector(\"[text]\");\r\n    this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\r\n    this.updateSrc = async () => {\r\n      this.src = this.targetEl.components[\"media-loader\"].data.src;\r\n      try {\r\n        this.avatar = await fetchAvatar(idForAvatarUrl(this.src));\r\n        this.el.object3D.visible = this.avatar && this.avatar.allow_remixing && this.avatar.type === \"avatar_listing\";\r\n      } catch (e) {\r\n        console.error(e);\r\n        this.el.object3D.visible = false;\r\n      }\r\n    };\r\n\r\n    this.onClick = async () => {\r\n      if (this.copying || !this.avatar) return;\r\n\r\n      try {\r\n        this.copying = true;\r\n        this.label.setAttribute(\"text\", \"value\", \"Copying...\");\r\n\r\n        await remixAvatar(this.avatar.avatar_id, this.avatar.name);\r\n\r\n        this.label.setAttribute(\"text\", \"value\", \"Copied!\");\r\n      } catch (e) {\r\n        this.label.setAttribute(\"text\", \"value\", \"Error\");\r\n      }\r\n\r\n      setTimeout(() => {\r\n        this.label.setAttribute(\"text\", \"value\", REMIX_LABEL);\r\n        this.copying = false;\r\n      }, 2000);\r\n    };\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\r\n      this.updateSrc();\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\r\n\r\nexport const TRANSFORM_MODE = {\r\n  AXIS: \"axis\",\r\n  PUPPET: \"puppet\",\r\n  CURSOR: \"cursor\",\r\n  ALIGN: \"align\",\r\n  SCALE: \"scale\"\r\n};\r\n\r\nconst STEP_LENGTH = Math.PI / 10;\r\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\r\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\r\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\r\nconst v = new THREE.Vector3();\r\nconst v2 = new THREE.Vector3();\r\nconst q = new THREE.Quaternion();\r\nconst q2 = new THREE.Quaternion();\r\n\r\nconst eps = 0.001;\r\nfunction qAlmostEquals(a, b) {\r\n  return (\r\n    Math.abs(a.x - b.x) < eps && Math.abs(a.y - b.y) < eps && Math.abs(a.z - b.z) < eps && Math.abs(a.w - b.w) < eps\r\n  );\r\n}\r\n\r\nAFRAME.registerComponent(\"transform-button\", {\r\n  schema: {\r\n    mode: {\r\n      type: \"string\",\r\n      oneof: Object.values(TRANSFORM_MODE),\r\n      default: TRANSFORM_MODE.CURSOR\r\n    },\r\n    axis: { type: \"vec3\", default: null }\r\n  },\r\n  init() {\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n    });\r\n    let leftHand, rightHand;\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      leftHand = document.getElementById(\"player-left-controller\");\r\n      rightHand = document.getElementById(\"player-right-controller\");\r\n    });\r\n    this.onGrabStart = e => {\r\n      if (!leftHand || !rightHand) return;\r\n\r\n      if (!this.targetEl) {\r\n        return;\r\n      }\r\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\r\n        return;\r\n      }\r\n      if (this.targetEl.body) {\r\n        this.targetEl.setAttribute(\"body-helper\", AMMO_BODY_ATTRIBUTES);\r\n      }\r\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\r\n      this.transformSystem.startTransform(\r\n        this.targetEl.object3D,\r\n        e.object3D.el.id === \"right-cursor\"\r\n          ? rightHand.object3D\r\n          : e.object3D.el.id === \"left-cursor\"\r\n            ? leftHand.object3D\r\n            : e.object3D,\r\n        this.data\r\n      );\r\n    };\r\n    this.onGrabEnd = () => {\r\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\r\n      this.transformSystem.stopTransform();\r\n    };\r\n  },\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\r\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\r\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\r\n  },\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\r\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\r\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\r\n  }\r\n});\r\n\r\nAFRAME.registerSystem(\"transform-selected-object\", {\r\n  init() {\r\n    this.target = null;\r\n    this.mode = null;\r\n    this.transforming = false;\r\n    this.axis = new THREE.Vector3();\r\n    this.store = window.APP.store;\r\n    this.startQ = new THREE.Quaternion();\r\n\r\n    this.dxStore = 0;\r\n    this.dxApplied = 0;\r\n    this.dyAll = 0;\r\n    this.dyStore = 0;\r\n    this.dyApplied = 0;\r\n    this.raycasters = {};\r\n\r\n    this.puppet = {\r\n      initialControllerOrientation: new THREE.Quaternion(),\r\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\r\n      initialObjectOrientation: new THREE.Quaternion(),\r\n      currentControllerOrientation: new THREE.Quaternion(),\r\n      controllerOrientationDelta: new THREE.Quaternion()\r\n    };\r\n\r\n    this.planarInfo = {\r\n      plane: new THREE.Mesh(\r\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\r\n        new THREE.MeshBasicMaterial({\r\n          visible: false,\r\n          wireframe: true,\r\n          side: THREE.DoubleSide,\r\n          transparent: true,\r\n          opacity: 0.3\r\n        })\r\n      ),\r\n      normal: new THREE.Vector3(),\r\n      intersections: [],\r\n      previousPointOnPlane: new THREE.Vector3(),\r\n      currentPointOnPlane: new THREE.Vector3(),\r\n      deltaOnPlane: new THREE.Vector3(),\r\n      finalProjectedVec: new THREE.Vector3()\r\n    };\r\n    this.el.object3D.add(this.planarInfo.plane);\r\n  },\r\n\r\n  stopTransform: (function() {\r\n    const q = new THREE.Quaternion();\r\n    const PI_AROUND_Y = new THREE.Quaternion(0, 1, 0, 0);\r\n    const pInv = new THREE.Quaternion();\r\n    return function stopTransform() {\r\n      this.transforming = false;\r\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\r\n        this.target.getWorldQuaternion(q);\r\n        if (qAlmostEquals(q, this.startQ)) {\r\n          q.multiply(PI_AROUND_Y);\r\n          this.target.parent.getWorldQuaternion(pInv);\r\n          pInv.inverse();\r\n          this.target.quaternion.copy(pInv).multiply(q);\r\n          this.target.matrixNeedsUpdate = true;\r\n        }\r\n      }\r\n    };\r\n  })(),\r\n\r\n  startPlaneCasting() {\r\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\r\n\r\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\r\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\r\n    this.target.getWorldPosition(plane.position);\r\n    plane.matrixNeedsUpdate = true;\r\n    plane.updateMatrixWorld(true);\r\n\r\n    intersections.length = 0;\r\n    this.raycasters.right =\r\n      this.raycasters.right ||\r\n      document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"].raycaster;\r\n    this.raycasters.left =\r\n      this.raycasters.left ||\r\n      document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"].raycaster;\r\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\r\n    const far = raycaster.far;\r\n    raycaster.far = 1000;\r\n    plane.raycast(raycaster, intersections);\r\n    raycaster.far = far;\r\n    this.transforming = !!intersections[0];\r\n    if (!this.transforming) {\r\n      return;\r\n    }\r\n\r\n    previousPointOnPlane.copy(intersections[0].point);\r\n\r\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\r\n\r\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\r\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\r\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\r\n\r\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\r\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\r\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\r\n\r\n    this.dyAll = 0;\r\n    this.dyStore = 0;\r\n    this.dyApplied = 0;\r\n    this.dxAll = 0;\r\n    this.dxStore = 0;\r\n    this.dxApplied = 0;\r\n  },\r\n\r\n  startTransform(target, hand, data) {\r\n    this.target = target;\r\n    this.hand = hand;\r\n    this.mode = data.mode;\r\n    this.transforming = true;\r\n\r\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\r\n      this.store.update({ activity: { hasRecentered: true } });\r\n      return;\r\n    } else {\r\n      this.store.update({ activity: { hasRotated: true } });\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\r\n      this.target.getWorldQuaternion(this.startQ);\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\r\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\r\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\r\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).inverse();\r\n      return;\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.AXIS) {\r\n      this.axis.copy(data.axis);\r\n    }\r\n\r\n    this.startPlaneCasting();\r\n  },\r\n\r\n  puppetingTick() {\r\n    const {\r\n      currentControllerOrientation,\r\n      controllerOrientationDelta,\r\n      initialControllerOrientation_inverse,\r\n      initialObjectOrientation\r\n    } = this.puppet;\r\n    this.hand.getWorldQuaternion(currentControllerOrientation);\r\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\r\n    this.target.quaternion\r\n      .copy(initialObjectOrientation)\r\n      .premultiply(controllerOrientationDelta)\r\n      .premultiply(controllerOrientationDelta);\r\n    this.target.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  cursorAxisOrScaleTick() {\r\n    const {\r\n      plane,\r\n      normal,\r\n      intersections,\r\n      previousPointOnPlane,\r\n      currentPointOnPlane,\r\n      deltaOnPlane,\r\n      finalProjectedVec\r\n    } = this.planarInfo;\r\n    this.target.getWorldPosition(plane.position);\r\n    //    this.el.camera.getWorldQuaternion(plane.quaternion);\r\n    this.el.camera.getWorldPosition(v);\r\n    plane.matrixNeedsUpdate = true;\r\n    const cameraToPlaneDistance = v.sub(plane.position).length();\r\n\r\n    intersections.length = 0;\r\n    const raycaster = this.hand.el.id === \"player-left-controller\" ? this.raycasters.left : this.raycasters.right;\r\n    const far = raycaster.far;\r\n    raycaster.far = 1000;\r\n    plane.raycast(raycaster, intersections);\r\n    raycaster.far = far;\r\n    const intersection = intersections[0];\r\n    if (!intersection) return;\r\n\r\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\r\n\r\n    currentPointOnPlane.copy(intersection.point);\r\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\r\n    const SENSITIVITY = 10;\r\n    finalProjectedVec\r\n      .copy(deltaOnPlane)\r\n      .projectOnPlane(normal)\r\n      .applyQuaternion(q.copy(plane.quaternion).inverse())\r\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\r\n    if (this.mode === TRANSFORM_MODE.CURSOR) {\r\n      const modify = AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\r\n\r\n      this.dyAll = this.dyStore + finalProjectedVec.y;\r\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\r\n      this.dyStore = this.dyAll - this.dyApplied;\r\n\r\n      this.dxAll = this.dxStore + finalProjectedVec.x;\r\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\r\n      this.dxStore = this.dxAll - this.dxApplied;\r\n\r\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\r\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\r\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\r\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\r\n\r\n        if (modify) {\r\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\r\n        } else {\r\n          v.set(0, 1, 0);\r\n        }\r\n        q2.setFromAxisAngle(v, this.dxApplied);\r\n\r\n        this.target.quaternion.premultiply(q).premultiply(q2);\r\n      }\r\n\r\n      this.target.matrixNeedsUpdate = true;\r\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\r\n      this.dxAll = this.dxStore + finalProjectedVec.x;\r\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\r\n      this.dxStore = this.dxAll - this.dxApplied;\r\n\r\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\r\n      this.target.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    previousPointOnPlane.copy(currentPointOnPlane);\r\n  },\r\n\r\n  tick() {\r\n    if (!this.transforming) {\r\n      return;\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.SCALE) {\r\n      return; // Taken care of by scale-button\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\r\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\r\n      this.target.lookAt(CAMERA_WORLD_POSITION);\r\n      this.transforming = false;\r\n      return;\r\n    }\r\n\r\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\r\n      this.puppetingTick();\r\n      return;\r\n    }\r\n    this.cursorAxisOrScaleTick();\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"transform-button-selector\", {\r\n  tick() {\r\n    this.userinput = this.userinput || this.el.sceneEl.systems.userinput;\r\n    const hasHand = this.userinput.get(paths.actions.rightHand.pose) || this.userinput.get(paths.actions.leftHand.pose);\r\n    if (!hasHand) {\r\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\r\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\r\n      }\r\n    } else {\r\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\r\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nconst FORWARD = new THREE.Vector3(0, 0, 1);\r\nconst TWO_PI = 2 * Math.PI;\r\nAFRAME.registerComponent(\"visible-if-transforming\", {\r\n  schema: {\r\n    hand: { type: \"string\" }\r\n  },\r\n  init() {},\r\n  tick(t) {\r\n    const shouldBeVisible =\r\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming &&\r\n      AFRAME.scenes[0].systems[\"transform-selected-object\"].hand.el.id.indexOf(this.data.hand) !== -1;\r\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\r\n    if (visibleNeedsUpdate) {\r\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\r\n    }\r\n\r\n    if (shouldBeVisible) {\r\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n    }\r\n  }\r\n});\r\n","import { setMatrixWorld } from \"../utils/three-utils\";\r\nimport { TRANSFORM_MODE } from \"./transform-object-button\";\r\n\r\nconst calculatePlaneMatrix = (function() {\r\n  const planeMatrix = new THREE.Matrix4();\r\n  const planeUp = new THREE.Vector3();\r\n  const planeForward = new THREE.Vector3();\r\n  const planeRight = new THREE.Vector3();\r\n  const planePosition = new THREE.Vector3();\r\n  const camPosition = new THREE.Vector3();\r\n\r\n  return function calculatePlaneMatrix(camera, button) {\r\n    camera.updateMatrices();\r\n    camPosition.setFromMatrixPosition(camera.matrixWorld);\r\n    button.updateMatrices();\r\n    planePosition.setFromMatrixPosition(button.matrixWorld);\r\n    planeForward.subVectors(planePosition, camPosition);\r\n    planeForward.y = 0;\r\n    planeForward.normalize();\r\n    planeUp.set(0, 1, 0);\r\n    planeRight.crossVectors(planeForward, planeUp);\r\n    planeMatrix.makeBasis(planeRight, planeUp, planeForward.multiplyScalar(-1));\r\n    planeMatrix.elements[12] = planePosition.x;\r\n    planeMatrix.elements[13] = planePosition.y;\r\n    planeMatrix.elements[14] = planePosition.z;\r\n    return planeMatrix;\r\n  };\r\n})();\r\n\r\nconst planeForLeftCursor = new THREE.Mesh(\r\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\r\n  new THREE.MeshBasicMaterial({\r\n    visible: true,\r\n    wireframe: false,\r\n    side: THREE.DoubleSide,\r\n    transparent: true,\r\n    opacity: 0.3\r\n  })\r\n);\r\nconst planeForRightCursor = new THREE.Mesh(\r\n  new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\r\n  new THREE.MeshBasicMaterial({\r\n    visible: true,\r\n    wireframe: false,\r\n    side: THREE.DoubleSide,\r\n    transparent: true,\r\n    opacity: 0.3\r\n  })\r\n);\r\n\r\nAFRAME.registerComponent(\"scale-button\", {\r\n  init() {\r\n    this.isScaling = false;\r\n    this.planeRotation = new THREE.Matrix4();\r\n    this.planeUp = new THREE.Vector3();\r\n    this.planeRight = new THREE.Vector3();\r\n    this.intersections = [];\r\n    this.initialIntersectionPoint = new THREE.Vector3();\r\n    this.intersectionPoint = new THREE.Vector3();\r\n    this.initialObjectScale = new THREE.Vector3();\r\n    this.desiredObjectScale = new THREE.Vector3();\r\n    this.deltaScale = new THREE.Vector3();\r\n    this.objectMatrix = new THREE.Matrix4();\r\n    this.dragVector = new THREE.Vector3();\r\n    this.currentObjectScale = new THREE.Vector3();\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.objectToScale = networkedEl.object3D;\r\n    });\r\n    const camPosition = new THREE.Vector3();\r\n    const objectPosition = new THREE.Vector3();\r\n    const objectToCam = new THREE.Vector3();\r\n    this.startScaling = e => {\r\n      if (this.isScaling || !this.objectToScale) {\r\n        return;\r\n      }\r\n      if (!this.didGetObjectReferences) {\r\n        this.didGetObjectReferences = true;\r\n        this.leftEventer = document.getElementById(\"left-cursor\").object3D;\r\n        this.leftCursorController = document.getElementById(\"left-cursor-controller\");\r\n        this.leftRaycaster = this.leftCursorController.components[\"cursor-controller\"].raycaster;\r\n        this.rightCursorController = document.getElementById(\"right-cursor-controller\");\r\n        this.rightRaycaster = this.rightCursorController.components[\"cursor-controller\"].raycaster;\r\n        this.viewingCamera = document.getElementById(\"viewing-camera\").object3D;\r\n      }\r\n      this.plane = e.object3D === this.leftEventer ? planeForLeftCursor : planeForRightCursor;\r\n      setMatrixWorld(this.plane, calculatePlaneMatrix(this.viewingCamera, this.el.object3D));\r\n      this.planeRotation.extractRotation(this.plane.matrixWorld);\r\n      this.planeUp.set(0, 1, 0).applyMatrix4(this.planeRotation);\r\n      this.planeRight.set(1, 0, 0).applyMatrix4(this.planeRotation);\r\n      this.raycaster = e.object3D === this.leftEventer ? this.leftRaycaster : this.rightRaycaster;\r\n      const intersection = this.raycastOnPlane();\r\n      if (!intersection) return;\r\n      this.isScaling = true;\r\n      this.initialIntersectionPoint.copy(intersection.point);\r\n      this.objectToScale.updateMatrices();\r\n      this.initialObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\r\n      this.initialDistanceToObject = objectToCam\r\n        .subVectors(\r\n          camPosition.setFromMatrixPosition(this.viewingCamera.matrixWorld),\r\n          objectPosition.setFromMatrixPosition(this.el.object3D.matrixWorld)\r\n        )\r\n        .length();\r\n      window.APP.store.update({ activity: { hasScaled: true } });\r\n\r\n      // TODO: Refactor transform-selected-object system so this isn't so awkward\r\n      this.transformSelectedObjectSystem =\r\n        this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\r\n      this.transformSelectedObjectSystem.transforming = true;\r\n      this.transformSelectedObjectSystem.mode = TRANSFORM_MODE.SCALE;\r\n      this.transformSelectedObjectSystem.target = this.objectToScale;\r\n      this.transformSelectedObjectSystem.hand =\r\n        e.object3D === this.leftEventer ? this.leftCursorController.object3D : this.rightCursorController.object3D;\r\n    };\r\n    this.endScaling = e => {\r\n      if (!this.isScaling) {\r\n        return;\r\n      }\r\n      if (\r\n        (e.object3D === this.leftEventer && this.raycaster === this.leftRaycaster) ||\r\n        (e.object3D !== this.leftEventer && this.raycaster === this.rightRaycaster)\r\n      ) {\r\n        this.isScaling = false;\r\n        this.transformSelectedObjectSystem =\r\n          this.transformSelectedObjectSystem || this.el.sceneEl.systems[\"transform-selected-object\"];\r\n        this.transformSelectedObjectSystem.transforming = false;\r\n      }\r\n    };\r\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.startScaling);\r\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.endScaling);\r\n  },\r\n  raycastOnPlane() {\r\n    this.intersections.length = 0;\r\n    const far = this.raycaster.far;\r\n    this.raycaster.far = 1000;\r\n    this.plane.raycast(this.raycaster, this.intersections);\r\n    this.raycaster.far = far;\r\n    return this.intersections[0];\r\n  },\r\n  tick() {\r\n    if (!this.isScaling) return;\r\n    const intersection = this.raycastOnPlane();\r\n    if (!intersection) return;\r\n    this.intersectionPoint.copy(intersection.point);\r\n    this.dragVector.subVectors(this.intersectionPoint, this.initialIntersectionPoint);\r\n    const dotFactor =\r\n      (this.dragVector.dot(this.planeUp) + this.dragVector.dot(this.planeRight)) / this.initialDistanceToObject;\r\n\r\n    let scaleFactor = 1;\r\n    if (dotFactor > 0) {\r\n      scaleFactor = 1 + dotFactor;\r\n    } else if (dotFactor < 0) {\r\n      scaleFactor = 1 / (1 + Math.abs(dotFactor));\r\n    }\r\n    this.desiredObjectScale.copy(this.initialObjectScale).multiplyScalar(scaleFactor);\r\n    this.objectToScale.updateMatrices();\r\n    this.currentObjectScale.setFromMatrixScale(this.objectToScale.matrixWorld);\r\n    this.deltaScale.set(\r\n      this.desiredObjectScale.x / this.currentObjectScale.x,\r\n      this.desiredObjectScale.y / this.currentObjectScale.y,\r\n      this.desiredObjectScale.z / this.currentObjectScale.z\r\n    );\r\n    this.objectMatrix.copy(this.objectToScale.matrixWorld);\r\n    this.objectMatrix.scale(this.deltaScale);\r\n    setMatrixWorld(this.objectToScale, this.objectMatrix);\r\n  }\r\n});\r\n","import { CYLINDER_TEXTURE } from \"./cylinder-texture\";\r\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\r\n\r\nfunction easeIn(t) {\r\n  return t * t;\r\n}\r\n\r\nfunction easeOutIn(t) {\r\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\r\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\r\n}\r\n\r\nconst RayCurve = function(numPoints, width) {\r\n  this.geometry = new THREE.BufferGeometry();\r\n  this.vertices = new Float32Array(numPoints * 3 * 2);\r\n  this.uvs = new Float32Array(numPoints * 2 * 2);\r\n  this.width = width;\r\n\r\n  this.geometry.addAttribute(\"position\", new THREE.BufferAttribute(this.vertices, 3).setDynamic(true));\r\n\r\n  this.material = new THREE.MeshBasicMaterial({\r\n    side: THREE.DoubleSide,\r\n    transparent: true\r\n  });\r\n\r\n  this.mesh = new THREE.Mesh(this.geometry, this.material);\r\n  this.mesh.drawMode = THREE.TriangleStripDrawMode;\r\n\r\n  this.mesh.frustumCulled = false;\r\n  this.mesh.vertices = this.vertices;\r\n\r\n  this.direction = new THREE.Vector3();\r\n  this.numPoints = numPoints;\r\n};\r\n\r\nRayCurve.prototype = {\r\n  setDirection: function(direction) {\r\n    const UP = new THREE.Vector3(0, 1, 0);\r\n    this.direction\r\n      .copy(direction)\r\n      .cross(UP)\r\n      .normalize()\r\n      .multiplyScalar(this.width / 2);\r\n  },\r\n\r\n  setWidth: function(width) {\r\n    this.width = width;\r\n  },\r\n\r\n  setPoint: (function() {\r\n    const posA = new THREE.Vector3();\r\n    const posB = new THREE.Vector3();\r\n\r\n    return function(i, point) {\r\n      posA.copy(point).add(this.direction);\r\n      posB.copy(point).sub(this.direction);\r\n\r\n      let idx = 2 * 3 * i;\r\n      this.vertices[idx++] = posA.x;\r\n      this.vertices[idx++] = posA.y;\r\n      this.vertices[idx++] = posA.z;\r\n\r\n      this.vertices[idx++] = posB.x;\r\n      this.vertices[idx++] = posB.y;\r\n      this.vertices[idx++] = posB.z;\r\n\r\n      this.geometry.attributes.position.needsUpdate = true;\r\n    };\r\n  })()\r\n};\r\n\r\nfunction parabolicCurve(p0, v0, t, out) {\r\n  out.x = p0.x + v0.x * t;\r\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\r\n  out.z = p0.z + v0.z * t;\r\n  return out;\r\n}\r\n\r\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\r\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\r\n  return THREE.Math.RAD2DEG * angleNormals <= landingMaxAngle;\r\n}\r\n\r\nconst checkLineIntersection = (function() {\r\n  const direction = new THREE.Vector3();\r\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\r\n    direction.copy(end).sub(start);\r\n    const distance = direction.length();\r\n    raycaster.far = distance;\r\n    raycaster.set(start, direction.normalize());\r\n    const intersects = raycaster.intersectObjects(meshes, true);\r\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\r\n      hitPoint.copy(intersects[0].point);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n})();\r\n\r\nfunction getMeshes(collisionEntities) {\r\n  return collisionEntities\r\n    .map(function(entity) {\r\n      return entity.getObject3D(\"mesh\");\r\n    })\r\n    .filter(function(n) {\r\n      return n;\r\n    });\r\n}\r\n\r\nconst MISS_OPACITY = 0.1;\r\nconst HIT_OPACITY = 0.3;\r\nconst MISS_COLOR = 0xff0000;\r\nconst HIT_COLOR = 0x00ff00;\r\nconst FORWARD = new THREE.Vector3(0, 0, -1);\r\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\r\nconst MAX_LANDING_ANGLE = 45;\r\nconst DRAW_TIME_MS = 400;\r\nconst q = new THREE.Quaternion();\r\nconst vecHelper = new THREE.Vector3();\r\nconst v = new THREE.Vector3();\r\n\r\nlet uiRoot;\r\nAFRAME.registerComponent(\"teleporter\", {\r\n  schema: {\r\n    start: { type: \"string\" },\r\n    confirm: { type: \"string\" },\r\n    speed: { default: 12 },\r\n    collisionEntities: { default: \"\" },\r\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\r\n    hitCylinderRadius: { default: 0.25, min: 0 },\r\n    outerRadius: { default: 0.6, min: 0 },\r\n    hitCylinderHeight: { default: 0.3, min: 0 }\r\n  },\r\n\r\n  init() {\r\n    this.characterController = this.el.sceneEl.systems[\"hubs-systems\"].characterController;\r\n    this.isTeleporting = false;\r\n    this.rayCurve = new RayCurve(20, 0.025);\r\n    this.rayCurve.mesh.visible = false;\r\n    this.teleportEntity = document.createElement(\"a-entity\");\r\n    this.teleportEntity.setObject3D(\"mesh\", this.rayCurve.mesh);\r\n    this.el.sceneEl.appendChild(this.teleportEntity);\r\n\r\n    this.p0 = new THREE.Vector3();\r\n    this.v0 = new THREE.Vector3();\r\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\r\n    this.hit = false;\r\n    this.hitPoint = new THREE.Vector3();\r\n    this.meshes = [];\r\n    this.raycaster = new THREE.Raycaster();\r\n    this.rigWorldPosition = new THREE.Vector3();\r\n    this.newRigWorldPosition = new THREE.Vector3();\r\n    this.teleportOriginWorldPosition = new THREE.Vector3();\r\n\r\n    this.teleportEventDetail = {\r\n      oldPosition: this.rigWorldPosition,\r\n      newPosition: this.newRigWorldPosition,\r\n      hitPoint: this.hitPoint\r\n    };\r\n    this.prevHitHeight = 0;\r\n    this.direction = new THREE.Vector3();\r\n    this.hitEntity = this.createHitEntity();\r\n    this.hitEntity.object3D.visible = false;\r\n    this.el.sceneEl.appendChild(this.hitEntity);\r\n    this.queryCollisionEntities();\r\n  },\r\n\r\n  queryCollisionEntities: function() {\r\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\r\n    this.meshes = getMeshes(this.collisionEntities);\r\n  },\r\n\r\n  remove() {\r\n    this.stopPlayingTeleportSound();\r\n  },\r\n\r\n  stopPlayingTeleportSound() {\r\n    if (this.teleportingSound) {\r\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n      sfx.stopSoundNode(this.teleportingSound.source);\r\n      this.teleportingSound = null;\r\n    }\r\n  },\r\n\r\n  tick(t, dt) {\r\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n    const entered = this.el.sceneEl.is(\"entered\");\r\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n    if (!entered && !isGhost) return;\r\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const { start, confirm, speed } = this.data;\r\n    const object3D = this.el.object3D;\r\n\r\n    if (\r\n      !this.isTeleporting &&\r\n      userinput.get(start) &&\r\n      !this.characterController.isTeleportingDisabled &&\r\n      !window.APP.store.state.preferences.disableTeleporter\r\n    ) {\r\n      this.isTeleporting = true;\r\n      this.timeTeleporting = 0;\r\n      this.hit = false;\r\n      this.rayCurve.mesh.visible = true;\r\n      this.rayCurve.mesh.updateMatrixWorld();\r\n      this.rayCurve.mesh.material.opacity = MISS_OPACITY;\r\n      this.rayCurve.mesh.material.color.set(MISS_COLOR);\r\n      this.rayCurve.mesh.material.needsUpdate = true;\r\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\r\n      if (this.teleportingSound) {\r\n        this.teleportingSound.gain.gain.value = 0.005;\r\n      }\r\n    }\r\n\r\n    if (!this.isTeleporting) {\r\n      return;\r\n    }\r\n    if (this.teleportingSound) {\r\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\r\n    }\r\n\r\n    if (userinput.get(confirm)) {\r\n      this.hitEntity.setAttribute(\"visible\", false);\r\n      this.isTeleporting = false;\r\n      this.rayCurve.mesh.visible = false;\r\n\r\n      if (this.teleportingSound) {\r\n        this.stopPlayingTeleportSound();\r\n      }\r\n\r\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\r\n        return;\r\n      }\r\n\r\n      this.characterController.teleportTo(this.hitPoint);\r\n\r\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\r\n      return;\r\n    }\r\n\r\n    this.timeTeleporting += dt;\r\n    object3D.updateMatrixWorld();\r\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\r\n    this.direction\r\n      .copy(FORWARD)\r\n      .applyQuaternion(q)\r\n      .normalize();\r\n    this.rayCurve.setDirection(this.direction);\r\n    this.el.object3D.updateMatrices();\r\n    const playerScale = v.setFromMatrixColumn(this.characterController.avatarPOV.object3D.matrixWorld, 1).length();\r\n    this.v0.copy(this.direction).multiplyScalar(speed * Math.sqrt(playerScale));\r\n\r\n    let collidedIndex = this.rayCurve.numPoints - 1;\r\n\r\n    this.hit = false;\r\n    this.parabola[0].copy(this.p0);\r\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\r\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\r\n      const t = i * timeSegment;\r\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\r\n      this.parabola[i].copy(vecHelper);\r\n\r\n      if (\r\n        checkLineIntersection(\r\n          this.parabola[i - 1],\r\n          this.parabola[i],\r\n          this.meshes,\r\n          this.raycaster,\r\n          LANDING_NORMAL,\r\n          MAX_LANDING_ANGLE,\r\n          this.hitPoint\r\n        )\r\n      ) {\r\n        this.hit = true;\r\n        collidedIndex = i;\r\n        break;\r\n      }\r\n    }\r\n    if (this.characterController.isTeleportingDisabled) {\r\n      this.hit = false;\r\n    }\r\n\r\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\r\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\r\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\r\n\r\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\r\n      const t = i * segmentT;\r\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\r\n      this.rayCurve.setPoint(i, vecHelper);\r\n    }\r\n\r\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\r\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\r\n    this.rayCurve.material.color.set(color);\r\n    this.rayCurve.material.opacity = opacity;\r\n\r\n    this.hitEntity.setAttribute(\"visible\", this.hit);\r\n    if (this.hit) {\r\n      this.hitEntity.setAttribute(\"position\", this.hitPoint);\r\n      this.hitEntity.object3D.traverse(o => {\r\n        o.matrixNeedsUpdate = true;\r\n      });\r\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\r\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\r\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\r\n      this.outerTorus.object3D.scale.set(outerScale, outerScale, 1);\r\n      this.torus.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\r\n      this.cylinder.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\r\n    }\r\n  },\r\n\r\n  createHitEntity() {\r\n    const data = this.data;\r\n\r\n    // Parent.\r\n    const hitEntity = document.createElement(\"a-entity\");\r\n    hitEntity.className = \"hitEntity\";\r\n\r\n    // Torus.\r\n    this.torus = document.createElement(\"a-entity\");\r\n    this.torus.setAttribute(\"geometry\", {\r\n      primitive: \"torus\",\r\n      radius: data.hitCylinderRadius,\r\n      radiusTubular: 0.01,\r\n      segmentsRadial: 16,\r\n      segmentsTubular: 18\r\n    });\r\n    this.torus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\r\n    this.torus.setAttribute(\"material\", {\r\n      shader: \"flat\",\r\n      color: data.hitCylinderColor,\r\n      side: \"double\",\r\n      depthTest: false\r\n    });\r\n    hitEntity.appendChild(this.torus);\r\n\r\n    // Cylinder.\r\n    this.cylinder = document.createElement(\"a-entity\");\r\n    this.cylinder.setAttribute(\"position\", { x: 0, y: data.hitCylinderHeight / 2, z: 0 });\r\n    this.cylinder.setAttribute(\"geometry\", {\r\n      primitive: \"cylinder\",\r\n      segmentsHeight: 1,\r\n      radius: data.hitCylinderRadius,\r\n      height: data.hitCylinderHeight,\r\n      openEnded: true\r\n    });\r\n    this.cylinder.setAttribute(\"material\", {\r\n      shader: \"flat\",\r\n      color: data.hitCylinderColor,\r\n      side: \"double\",\r\n      src: CYLINDER_TEXTURE,\r\n      transparent: true,\r\n      depthTest: false\r\n    });\r\n    hitEntity.appendChild(this.cylinder);\r\n\r\n    // create another torus for animating when the hit destination is ready to go\r\n    this.outerTorus = document.createElement(\"a-entity\");\r\n    this.outerTorus.setAttribute(\"geometry\", {\r\n      primitive: \"torus\",\r\n      radius: data.outerRadius,\r\n      radiusTubular: 0.01,\r\n      segmentsRadial: 16,\r\n      segmentsTubular: 18\r\n    });\r\n    this.outerTorus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\r\n    this.outerTorus.setAttribute(\"material\", {\r\n      shader: \"flat\",\r\n      color: data.hitCylinderColor,\r\n      side: \"double\",\r\n      opacity: HIT_OPACITY,\r\n      depthTest: false\r\n    });\r\n    this.outerTorus.setAttribute(\"id\", \"outerTorus\");\r\n    hitEntity.appendChild(this.outerTorus);\r\n\r\n    return hitEntity;\r\n  }\r\n});\r\n","export const CYLINDER_TEXTURE =\r\n  \"data:image/png;base64,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\";\r\n","export function isTagged(el, tag) {\r\n  return el && el.components && el.components.tags && el.components.tags.data[tag];\r\n}\r\n\r\nAFRAME.registerComponent(\"tags\", {\r\n  schema: {\r\n    isHandCollisionTarget: { default: false },\r\n    isHoldable: { default: false },\r\n    offersHandConstraint: { default: false },\r\n    offersRemoteConstraint: { default: false },\r\n    togglesHoveredActionSet: { default: false },\r\n    singleActionButton: { default: false },\r\n    holdableButton: { default: false },\r\n    isPen: { default: false },\r\n    isHoverMenuChild: { default: false },\r\n    isStatic: { default: false },\r\n    inspectable: { default: false }\r\n  },\r\n  update() {\r\n    if (this.didUpdateOnce) {\r\n      console.warn(\"Do not edit tags with .setAttribute\");\r\n    }\r\n    this.didUpdateOnce = true;\r\n  },\r\n\r\n  remove() {\r\n    const interaction = this.el.sceneEl.systems.interaction;\r\n    if (interaction.isHeld(this.el)) {\r\n      interaction.release(this.el);\r\n      this.el.sceneEl.systems[\"hubs-systems\"].constraintsSystem.release(this.el);\r\n    }\r\n  }\r\n});\r\n","import createTextGeometry from \"three-bmfont-text\";\r\n\r\n// 1 to match other A-Frame default widths.\r\nconst DEFAULT_WIDTH = 1;\r\n\r\n// @bryik set anisotropy to 16. Improves look of large amounts of text when viewed from angle.\r\nconst MAX_ANISOTROPY = 16;\r\n\r\n/**\r\n * Due to using negative scale, we return the opposite side specified.\r\n * https://github.com/mrdoob/three.js/pull/12787/\r\n */\r\nfunction parseSide(side) {\r\n  switch (side) {\r\n    case \"back\": {\r\n      return THREE.FrontSide;\r\n    }\r\n    case \"double\": {\r\n      return THREE.DoubleSide;\r\n    }\r\n    default: {\r\n      return THREE.BackSide;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Determine wrap pixel count. Either specified or by experimental fudge factor.\r\n * Note that experimental factor will never be correct for variable width fonts.\r\n */\r\nfunction computeWidth(wrapPixels, wrapCount, widthFactor) {\r\n  return wrapPixels || (0.5 + wrapCount) * widthFactor;\r\n}\r\n\r\n/**\r\n * Compute default font width factor to use.\r\n */\r\nfunction computeFontWidthFactor(font) {\r\n  let sum = 0;\r\n  let digitsum = 0;\r\n  let digits = 0;\r\n  for (const ch of font.chars) {\r\n    sum += ch.xadvance;\r\n    if (ch.id >= 48 && ch.id <= 57) {\r\n      digits++;\r\n      digitsum += ch.xadvance;\r\n    }\r\n  }\r\n  return digits ? digitsum / digits : sum / font.chars.length;\r\n}\r\n\r\nfunction loadFont(src) {\r\n  return fetch(src)\r\n    .then(resp => resp.json())\r\n    .then(font => {\r\n      // Fix negative Y offsets for Roboto MSDF font from tool. Experimentally determined.\r\n      if (src.indexOf(\"/Roboto-msdf.json\") >= 0) {\r\n        for (const ch of font.chars) {\r\n          ch.yoffset += 30;\r\n        }\r\n      }\r\n      font.widthFactor = computeFontWidthFactor(font);\r\n      return font;\r\n    });\r\n}\r\n\r\nfunction loadTexture(src) {\r\n  return new Promise((resolve, reject) => {\r\n    new THREE.ImageLoader().load(\r\n      src,\r\n      image => {\r\n        const texture = new THREE.Texture();\r\n        texture.image = image;\r\n        texture.needsUpdate = true;\r\n        texture.anisotropy = MAX_ANISOTROPY;\r\n        resolve(texture);\r\n      },\r\n      undefined,\r\n      err => {\r\n        console.error(\"Error loading font image\", src, err);\r\n        reject(null);\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nconst FONTS = {\r\n  roboto: {\r\n    json: loadFont(\"https://cdn.aframe.io/fonts/Roboto-msdf.json\"),\r\n    texture: loadTexture(\"https://cdn.aframe.io/fonts/Roboto-msdf.png\")\r\n  }\r\n};\r\n\r\nAFRAME.registerComponent(\"text\", {\r\n  multiple: true,\r\n  schema: {\r\n    align: { type: \"string\", default: \"left\", oneOf: [\"left\", \"right\", \"center\"] },\r\n    alphaTest: { default: 0.5 },\r\n    // `anchor` defaults to center to match geometries.\r\n    anchor: { default: \"center\", oneOf: [\"left\", \"right\", \"center\", \"align\"] },\r\n    baseline: { default: \"center\", oneOf: [\"top\", \"center\", \"bottom\"] },\r\n    color: { type: \"color\", default: \"#FFF\" },\r\n    font: { type: \"string\", default: \"roboto\" },\r\n    // `height` has no default, will be populated at layout.\r\n    height: { type: \"number\" },\r\n    letterSpacing: { type: \"number\", default: 0 },\r\n    // `lineHeight` defaults to font's `lineHeight` value.\r\n    lineHeight: { type: \"number\" },\r\n    // `negate` must be true for fonts generated with older versions of msdfgen (white background).\r\n    negate: { type: \"boolean\", default: true },\r\n    opacity: { type: \"number\", default: 1.0 },\r\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] },\r\n    tabSize: { default: 4 },\r\n    transparent: { default: true },\r\n    value: { type: \"string\" },\r\n    whiteSpace: { default: \"normal\", oneOf: [\"normal\", \"pre\", \"nowrap\"] },\r\n    // `width` defaults to geometry width if present, else `DEFAULT_WIDTH`.\r\n    width: { type: \"number\" },\r\n    // `wrapCount` units are about one default font character. Wrap roughly at this number.\r\n    wrapCount: { type: \"number\", default: 40 },\r\n    // `wrapPixels` will wrap using bmfont pixel units (e.g., dejavu's is 32 pixels).\r\n    wrapPixels: { type: \"number\" },\r\n    // `xOffset` to add padding.\r\n    xOffset: { type: \"number\", default: 0 },\r\n    // `zOffset` will provide a small z offset to avoid z-fighting.\r\n    zOffset: { type: \"number\", default: 0.001 }\r\n  },\r\n\r\n  init: function() {\r\n    const shaderData = this.getShaderData(this.data);\r\n    this.shaderObject = new AFRAME.shaders[\"msdf\"].Shader();\r\n    this.shaderObject.el = this.el;\r\n    this.shaderObject.init(shaderData);\r\n    this.shaderObject.update(shaderData);\r\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\r\n    this.shaderObject.material.side = shaderData.side;\r\n    this.geometry = createTextGeometry();\r\n    this.mesh = new THREE.Mesh(this.geometry, this.shaderObject.material);\r\n    this.el.setObject3D(this.attrName, this.mesh);\r\n  },\r\n\r\n  update: function(oldData) {\r\n    const data = this.data;\r\n    const shaderData = this.getShaderData(this.data);\r\n    this.shaderObject.update(shaderData);\r\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\r\n    this.shaderObject.material.side = shaderData.side;\r\n\r\n    // New font. `updateFont` will later change data and layout.\r\n    if (oldData.font !== data.font) {\r\n      this.updateFont().catch(err => console.error(err));\r\n    }\r\n\r\n    // Not a new font, but we need to accomodate other changes with the existing font.\r\n    if (this.currentFont != null) {\r\n      this.updateGeometry(this.geometry, this.currentFont);\r\n      this.updateLayout(this.currentFont);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Clean up geometry, material, texture, mesh, objects.\r\n   */\r\n  remove: function() {\r\n    this.geometry.dispose();\r\n    this.geometry = null;\r\n    this.el.removeObject3D(this.attrName);\r\n    this.shaderObject.material.dispose();\r\n    this.shaderObject.material = null;\r\n    delete this.shaderObject;\r\n  },\r\n\r\n  getShaderData: (function() {\r\n    const shaderData = {};\r\n    return function(data) {\r\n      shaderData.alphaTest = data.alphaTest;\r\n      shaderData.color = data.color;\r\n      shaderData.opacity = data.opacity;\r\n      shaderData.side = parseSide(data.side);\r\n      shaderData.transparent = data.transparent;\r\n      shaderData.negate = data.negate;\r\n      return shaderData;\r\n    };\r\n  })(),\r\n\r\n  /**\r\n   * Load font for geometry, load font image for material, and apply.\r\n   */\r\n  updateFont: function() {\r\n    const data = this.data;\r\n    const geometry = this.geometry;\r\n\r\n    // Make invisible during font swap.\r\n    this.mesh.visible = false;\r\n    const fetchFontData = Promise.all([FONTS[data.font].json, FONTS[data.font].texture]);\r\n    return fetchFontData.then(([font, texture]) => {\r\n      if (font.pages.length !== 1) {\r\n        throw new Error(\"Currently only single-page bitmap fonts are supported.\");\r\n      }\r\n      this.currentFont = font;\r\n      this.updateGeometry(geometry, font);\r\n      this.shaderObject.update({ map: texture });\r\n      this.updateLayout(font);\r\n      this.mesh.visible = true;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Update layout with anchor, alignment, baseline, and considering any meshes.\r\n   */\r\n  updateLayout: function(font) {\r\n    const el = this.el;\r\n    const data = this.data;\r\n    const geometry = this.geometry;\r\n    const mesh = this.mesh;\r\n\r\n    if (!geometry.layout) {\r\n      return;\r\n    }\r\n\r\n    // Determine width to use (defined width, geometry's width, or default width).\r\n    const geometryComponent = el.getAttribute(\"geometry\");\r\n    const width = data.width || (geometryComponent && geometryComponent.width) || DEFAULT_WIDTH;\r\n\r\n    // Determine wrap pixel count. Either specified or by experimental fudge factor.\r\n    // Note that experimental factor will never be correct for variable width fonts.\r\n    const textRenderWidth = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\r\n    const textScale = width / textRenderWidth;\r\n\r\n    // Determine height to use.\r\n    const layout = geometry.layout;\r\n    const height = textScale * (layout.height + layout.descender);\r\n\r\n    // Update geometry dimensions to match text layout if width and height are set to 0.\r\n    // For example, scales a plane to fit text.\r\n    if (geometryComponent && geometryComponent.primitive === \"plane\") {\r\n      if (!geometryComponent.width) {\r\n        el.setAttribute(\"geometry\", \"width\", width);\r\n      }\r\n      if (!geometryComponent.height) {\r\n        el.setAttribute(\"geometry\", \"height\", height);\r\n      }\r\n    }\r\n\r\n    // Calculate X position to anchor text left, center, or right.\r\n    const anchor = data.anchor === \"align\" ? data.align : data.anchor;\r\n    let x, y;\r\n    if (anchor === \"left\") {\r\n      x = 0;\r\n    } else if (anchor === \"right\") {\r\n      x = -1 * layout.width;\r\n    } else if (anchor === \"center\") {\r\n      x = (-1 * layout.width) / 2;\r\n    } else {\r\n      throw new TypeError(\"Invalid text.anchor property value\", anchor);\r\n    }\r\n\r\n    // Calculate Y position to anchor text top, center, or bottom.\r\n    const baseline = data.baseline;\r\n    if (baseline === \"bottom\") {\r\n      y = 0;\r\n    } else if (baseline === \"top\") {\r\n      y = -1 * layout.height + layout.ascender;\r\n    } else if (baseline === \"center\") {\r\n      y = (-1 * layout.height) / 2;\r\n    } else {\r\n      throw new TypeError(\"Invalid text.baseline property value\", baseline);\r\n    }\r\n\r\n    // Position and scale mesh to apply layout.\r\n    mesh.position.x = x * textScale + data.xOffset;\r\n    mesh.position.y = y * textScale;\r\n    // Place text slightly in front to avoid Z-fighting.\r\n    mesh.position.z = data.zOffset;\r\n    mesh.scale.set(textScale, -1 * textScale, textScale);\r\n    mesh.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  /**\r\n   * Update the text geometry using `three-bmfont-text.update`.\r\n   */\r\n  updateGeometry: (function() {\r\n    const geometryUpdateBase = {};\r\n    const geometryUpdateData = {};\r\n    const newLineRegex = /\\\\n/g;\r\n    const tabRegex = /\\\\t/g;\r\n\r\n    return function(geometry, font) {\r\n      const data = this.data;\r\n\r\n      geometryUpdateData.font = font;\r\n      geometryUpdateData.lineHeight =\r\n        data.lineHeight && isFinite(data.lineHeight) ? data.lineHeight : font.common.lineHeight;\r\n      geometryUpdateData.text = data.value\r\n        .toString()\r\n        .replace(newLineRegex, \"\\n\")\r\n        .replace(tabRegex, \"\\t\");\r\n      geometryUpdateData.width = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\r\n      geometry.update(Object.assign(geometryUpdateBase, data, geometryUpdateData));\r\n      geometry.boundingBox = null;\r\n      geometry.boundingSphere = null;\r\n    };\r\n  })()\r\n});\r\n","import { getInspectable } from \"../systems/camera-system\";\r\n\r\nAFRAME.registerComponent(\"inspect-button\", {\r\n  tick() {\r\n    if (!this.initializedInTick) {\r\n      // initialize in tick so that parent's `tags` component has been initialized\r\n      this.initializedInTick = true;\r\n\r\n      this.inspectable = getInspectable(this.el);\r\n      if (!this.inspectable) {\r\n        console.error(\"You put an inspect button but I could not find what you want to inspect.\", this.el);\r\n        return;\r\n      }\r\n      this.el.object3D.addEventListener(\"holdable-button-down\", () => {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.inspect(this.inspectable.object3D);\r\n      });\r\n      this.el.object3D.addEventListener(\"holdable-button-up\", () => {\r\n        this.el.sceneEl.systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n      });\r\n    }\r\n  }\r\n});\r\n","export const sets = {};\r\nsets.global = \"global\";\r\nsets.inputFocused = \"inputFocused\";\r\nsets.rightCursorHoveringOnPen = \"rightCursorHoveringOnPen\";\r\nsets.rightCursorHoveringOnCamera = \"rightCursorHoveringOnCamera\";\r\nsets.rightCursorHoveringOnInteractable = \"rightCursorHoveringOnInteractable\";\r\nsets.rightCursorHoveringOnUI = \"rightCursorHoveringOnUI\";\r\nsets.rightCursorHoveringOnVideo = \"rightCursorHoveringOnVideo\";\r\nsets.rightCursorHoveringOnNothing = \"rightCursorHoveringOnNothing\";\r\nsets.rightCursorHoldingPen = \"rightCursorHoldingPen\";\r\nsets.rightCursorHoldingCamera = \"rightCursorHoldingCamera\";\r\nsets.rightCursorHoldingInteractable = \"rightCursorHoldingInteractable\";\r\nsets.rightCursorHoldingUI = \"rightCursorHoldingUI\";\r\nsets.rightCursorHoldingNothing = \"rightCursorHoldingNothing\";\r\nsets.leftCursorHoveringOnPen = \"leftCursorHoveringOnPen\";\r\nsets.leftCursorHoveringOnCamera = \"leftCursorHoveringOnCamera\";\r\nsets.leftCursorHoveringOnInteractable = \"leftCursorHoveringOnInteractable\";\r\nsets.leftCursorHoveringOnUI = \"leftCursorHoveringOnUI\";\r\nsets.leftCursorHoveringOnVideo = \"leftCursorHoveringOnVideo\";\r\nsets.leftCursorHoveringOnNothing = \"leftCursorHoveringOnNothing\";\r\nsets.leftCursorHoldingPen = \"leftCursorHoldingPen\";\r\nsets.leftCursorHoldingCamera = \"leftCursorHoldingCamera\";\r\nsets.leftCursorHoldingInteractable = \"leftCursorHoldingInteractable\";\r\nsets.leftCursorHoldingUI = \"leftCursorHoldingUI\";\r\nsets.leftCursorHoldingNothing = \"leftCursorHoldingNothing\";\r\nsets.rightHandTeleporting = \"rightHandTeleporting\";\r\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\r\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\r\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\r\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\r\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\r\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\r\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\r\nsets.leftHandTeleporting = \"leftHandTeleporting\";\r\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\r\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\r\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\r\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\r\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\r\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\r\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\r\nsets.debugUserInput = \"debugUserInput\";\r\nsets.inspecting = \"inspecting\";\r\n","const { detect } = require(\"detect-browser\");\r\n\r\nconst browser = detect();\r\n\r\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\r\n// available, or definitely *not* available, and assume it may be available otherwise.\r\nexport const VR_DEVICE_AVAILABILITY = {\r\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\r\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\r\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\r\n};\r\n\r\nfunction isMaybeGearVRCompatibleDevice(ua) {\r\n  return /\\WAndroid\\W/.test(ua);\r\n}\r\n\r\nfunction isMaybeDaydreamCompatibleDevice(ua) {\r\n  return /\\WAndroid\\W/.test(ua);\r\n}\r\n\r\n// Blacklist of VR device name regex matchers that we do not want to consider as valid VR devices\r\n// that can be entered into as a \"generic\" entry flow.\r\nconst GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST = [/cardboard/i];\r\n\r\n// Tries to determine VR entry compatibility regardless of the current browser.\r\n//\r\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\r\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\r\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\r\n// the software was setup, an HMD was purchased, etc.\r\n//\r\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\r\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\r\n// haven't installed the software, our guess about their phone was wrong, etc.)\r\n//\r\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\r\n//\r\n// - screen: Enter \"on-screen\" in 2D\r\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\r\n// - daydream: Google Daydream\r\n// - gearvr: Oculus GearVR\r\n// - cardboard: Google Cardboard\r\n//\r\nexport async function getAvailableVREntryTypes() {\r\n  const ua = navigator.userAgent;\r\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\r\n  const isMobile = AFRAME.utils.device.isMobile();\r\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\r\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\r\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\r\n\r\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\r\n  const isIDevice = AFRAME.utils.device.isIOS();\r\n  const isFirefoxBrowser = browser.name === \"firefox\";\r\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\r\n\r\n  const safari = isIDevice\r\n    ? !isUIWebView\r\n      ? VR_DEVICE_AVAILABILITY.yes\r\n      : VR_DEVICE_AVAILABILITY.maybe\r\n    : VR_DEVICE_AVAILABILITY.no;\r\n\r\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\r\n\r\n  let displays = [];\r\n  try {\r\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\r\n    // See https://github.com/mozilla/hubs/issues/892\r\n    if (browser.name !== \"chrome\" || isMobile) {\r\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\r\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\r\n    }\r\n  } catch (e) {\r\n    console.warn(\"navigator.getVRDisplays() failed\", e);\r\n  }\r\n\r\n  const isOculusBrowser = /Oculus/.test(ua);\r\n\r\n  const screen = isMobileVR\r\n    ? VR_DEVICE_AVAILABILITY.no\r\n    : isIDevice && isUIWebView\r\n      ? VR_DEVICE_AVAILABILITY.maybe\r\n      : VR_DEVICE_AVAILABILITY.yes;\r\n\r\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\r\n  // browser. once we change this (ie when Chrome has VR support) then this check can be removed. Without this\r\n  // check if you have FF on Mac/Linux you'll get the confusing flow of having a VR button but then\r\n  // being asked to download FF.\r\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\r\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\r\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\r\n\r\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\r\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\r\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\r\n  //\r\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\r\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\r\n  if (isMaybeGearVRCompatibleDevice(ua)) {\r\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\r\n  }\r\n\r\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\r\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\r\n  let daydream =\r\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\r\n\r\n  cardboard =\r\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\r\n      ? VR_DEVICE_AVAILABILITY.yes\r\n      : VR_DEVICE_AVAILABILITY.no;\r\n\r\n  if (isWebVRCapableBrowser) {\r\n    // Generic is supported for non-blacklisted devices and presentable HMDs.\r\n    generic = displays.find(\r\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST.find(r => r.test(d.displayName))\r\n    )\r\n      ? VR_DEVICE_AVAILABILITY.yes\r\n      : VR_DEVICE_AVAILABILITY.no;\r\n\r\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\r\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\r\n\r\n    if (hasDaydreamWebVRDevice) {\r\n      // If we detected daydream via WebVR\r\n      daydream = VR_DEVICE_AVAILABILITY.yes;\r\n      generic = VR_DEVICE_AVAILABILITY.no;\r\n    } else if (isDaydreamCapableBrowser) {\r\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\r\n      daydream = VR_DEVICE_AVAILABILITY.no;\r\n    }\r\n  }\r\n\r\n  return { screen, generic, gearvr, daydream, cardboard, safari };\r\n}\r\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\nexport function canShare() {\r\n  // TODO, fix up when OB/FxR support sharing\r\n  return navigator.share && !isMobileVR;\r\n}\r\n\r\n/**\r\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\r\n */\r\nexport function share(opts) {\r\n  if (canShare()) {\r\n    return navigator.share(opts);\r\n  } else {\r\n    const { title, url } = opts;\r\n    const width = 550;\r\n    const height = 420;\r\n    const left = (screen.width - width) / 2;\r\n    const top = (screen.height - height) / 2;\r\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\r\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\r\n      title\r\n    )}`;\r\n    window.open(tweetLink, \"_blank\", params);\r\n    return Promise.resolve();\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Route } from \"react-router\";\r\n\r\n/**\r\n * A react-router Route that looks for a key/value pair in the state to render something.\r\n */\r\nclass StateRoute extends React.Component {\r\n  static propTypes = {\r\n    stateKey: PropTypes.string,\r\n    stateValue: PropTypes.string,\r\n    history: PropTypes.object\r\n  };\r\n\r\n  render() {\r\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\r\n\r\n    if (\r\n      (!history.location.state && !stateValue) ||\r\n      (history.location.state &&\r\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\r\n    ) {\r\n      return <Route path=\"/\" {...routeProps} />;\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default StateRoute;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport styles from \"../assets/stylesheets/promote-client-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container\";\r\n\r\nexport default class PromoteClientDialog extends Component {\r\n  static propTypes = {\r\n    displayName: PropTypes.string,\r\n    onConfirm: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Promote User\" {...this.props}>\r\n        <div className={styles.message}>\r\n          <FormattedMessage id=\"promote.message\" />\r\n        </div>\r\n        <button\r\n          className={styles.confirmButton}\r\n          onClick={() => {\r\n            this.props.onConfirm();\r\n            this.props.onClose();\r\n          }}\r\n        >\r\n          <FormattedMessage id=\"promote.confirm-prefix\" />\r\n          <span>{this.props.displayName}</span>\r\n        </button>\r\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\r\n          <FormattedMessage id=\"promote.cancel\" />\r\n        </button>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport PromoteClientDialog from \"./promote-client-dialog.js\";\r\nimport styles from \"../assets/stylesheets/client-info-dialog.scss\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { sluglessPath } from \"../utils/history\";\r\nimport { getAvatarThumbnailUrl } from \"../utils/avatar-utils\";\r\n\r\nexport function getClientInfoClientId(location) {\r\n  const { search } = location;\r\n  const urlParams = new URLSearchParams(search);\r\n  const pathname = sluglessPath(location);\r\n\r\n  if (!pathname.startsWith(\"/client\") && !urlParams.get(\"client_id\")) return null;\r\n  return urlParams.get(\"client_id\") || pathname.substring(9);\r\n}\r\n\r\nexport default class ClientInfoDialog extends Component {\r\n  static propTypes = {\r\n    clientId: PropTypes.string,\r\n    history: PropTypes.object,\r\n    hubChannel: PropTypes.object,\r\n    presences: PropTypes.object,\r\n    performConditionalSignIn: PropTypes.func,\r\n    onClose: PropTypes.func,\r\n    showNonHistoriedDialog: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    avatarThumbnailUrl: null\r\n  };\r\n\r\n  kick() {\r\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.can(\"kick_users\"),\r\n      async () => await hubChannel.kick(clientId),\r\n      \"kick-user\"\r\n    );\r\n\r\n    onClose();\r\n  }\r\n\r\n  hide() {\r\n    const { clientId, onClose, hubChannel } = this.props;\r\n    hubChannel.hide(clientId);\r\n    onClose();\r\n  }\r\n\r\n  mute() {\r\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.can(\"mute_users\"),\r\n      async () => await hubChannel.mute(clientId),\r\n      \"mute-user\"\r\n    );\r\n\r\n    onClose();\r\n  }\r\n\r\n  addOwner() {\r\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\r\n    const { profile } = this.getPresenceEntry();\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.can(\"update_roles\"),\r\n      async () => {\r\n        onClose();\r\n\r\n        this.props.showNonHistoriedDialog(PromoteClientDialog, {\r\n          displayName: profile.displayName,\r\n          onConfirm: () => hubChannel.addOwner(clientId)\r\n        });\r\n      },\r\n      \"add-owner\"\r\n    );\r\n  }\r\n\r\n  removeOwner() {\r\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.can(\"update_roles\"),\r\n      async () => await hubChannel.removeOwner(clientId),\r\n      \"remove-owner\"\r\n    );\r\n\r\n    onClose();\r\n  }\r\n\r\n  unhide() {\r\n    const { clientId, hubChannel, onClose } = this.props;\r\n    hubChannel.unhide(clientId);\r\n    onClose();\r\n  }\r\n\r\n  getPresenceEntry() {\r\n    if (!this.props.presences) return null;\r\n\r\n    const presence = Object.entries(this.props.presences).find(([k]) => k === this.props.clientId);\r\n    if (!presence) return { profile: {}, roles: {} };\r\n\r\n    const metas = presence[1].metas;\r\n    return metas[metas.length - 1];\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { profile } = this.getPresenceEntry();\r\n    if (profile.avatarId) {\r\n      getAvatarThumbnailUrl(profile.avatarId).then(avatarThumbnailUrl => this.setState({ avatarThumbnailUrl }));\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { profile, roles } = this.getPresenceEntry();\r\n\r\n    const { displayName, identityName } = profile;\r\n    const { hubChannel, clientId, onClose } = this.props;\r\n    const title = (\r\n      <div className={styles.title}>\r\n        {displayName}\r\n        <div className={styles.identityName}>{identityName}</div>\r\n      </div>\r\n    );\r\n    const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\r\n    const mayMute = hubChannel.canOrWillIfCreator(\"mute_users\");\r\n    const targetIsOwner = !!roles.owner;\r\n    const targetIsCreator = !!roles.creator;\r\n    const targetIsSignedIn = !!roles.signed_in;\r\n    const mayAddOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && !targetIsOwner && !targetIsCreator;\r\n    const mayRemoveOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && targetIsOwner && !targetIsCreator;\r\n    const isHidden = hubChannel.isHidden(clientId);\r\n\r\n    return (\r\n      <DialogContainer className={styles.clientInfoDialog} title={title} wide={true} {...this.props}>\r\n        <div className={styles.roomInfo}>\r\n          <div className={styles.clientProfileImage}>\r\n            <img src={this.state.avatarThumbnailUrl} />\r\n          </div>\r\n          <div className={styles.primaryActionButtons}>\r\n            {mayAddOwner && (\r\n              <button\r\n                onClick={() => this.addOwner()}\r\n                disabled={!targetIsSignedIn}\r\n                title={targetIsSignedIn ? \"Promote\" : `${profile.displayName} is signed out.`}\r\n              >\r\n                <img className={styles.buttonIcon} src=\"../assets/images/add-owner.png\" />\r\n                <FormattedMessage id=\"client-info.add-owner\" />\r\n              </button>\r\n            )}\r\n            {mayRemoveOwner && (\r\n              <button onClick={() => this.removeOwner()}>\r\n                <img className={styles.buttonIcon} src=\"../assets/images/remove-owner.png\" />\r\n                <FormattedMessage id=\"client-info.remove-owner\" />\r\n              </button>\r\n            )}\r\n            {!isHidden && (\r\n              <button onClick={() => this.hide()}>\r\n                <FormattedMessage id=\"client-info.hide-button\" />\r\n              </button>\r\n            )}\r\n            {isHidden && (\r\n              <button onClick={() => this.unhide()}>\r\n                <FormattedMessage id=\"client-info.unhide-button\" />\r\n              </button>\r\n            )}\r\n            {mayMute && (\r\n              <button onClick={() => this.mute()}>\r\n                <FormattedMessage id=\"client-info.mute-button\" />\r\n              </button>\r\n            )}\r\n            {mayKick && (\r\n              <button onClick={() => this.kick()}>\r\n                <FormattedMessage id=\"client-info.kick-button\" />\r\n              </button>\r\n            )}\r\n            <button className={styles.cancel} onClick={onClose}>\r\n              <FormattedMessage id=\"client-info.cancel\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { IntlProvider, FormattedMessage } from \"react-intl\";\r\nimport UnlessFeature from \"./unless-feature\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport { lang, messages } from \"../utils/i18n\";\r\nimport loaderStyles from \"../assets/stylesheets/loader.scss\";\r\n\r\nclass Loader extends Component {\r\n  static propTypes = {\r\n    scene: PropTypes.object,\r\n    finished: PropTypes.bool,\r\n    onLoaded: PropTypes.func\r\n  };\r\n\r\n  doneWithInitialLoad = false;\r\n  state = {\r\n    loadingNum: 0,\r\n    loadedNum: 0\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.props.scene.addEventListener(\"model-loading\", this.onObjectLoading);\r\n    this.props.scene.addEventListener(\"image-loading\", this.onObjectLoading);\r\n    this.props.scene.addEventListener(\"pdf-loading\", this.onObjectLoading);\r\n    this.props.scene.addEventListener(\"model-loaded\", this.onObjectLoaded);\r\n    this.props.scene.addEventListener(\"image-loaded\", this.onObjectLoaded);\r\n    this.props.scene.addEventListener(\"pdf-loaded\", this.onObjectLoaded);\r\n    this.props.scene.addEventListener(\"model-error\", this.onObjectLoaded);\r\n    this.props.scene.addEventListener(\r\n      \"environment-scene-loaded\",\r\n      () => {\r\n        this.environmentSceneLoaded = true;\r\n        this.tryFinishLoading();\r\n      },\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.scene.removeEventListener(\"model-loading\", this.onObjectLoading);\r\n    this.props.scene.removeEventListener(\"image-loading\", this.onObjectLoading);\r\n    this.props.scene.removeEventListener(\"pdf-loading\", this.onObjectLoading);\r\n    this.props.scene.removeEventListener(\"model-loaded\", this.onObjectLoaded);\r\n    this.props.scene.removeEventListener(\"image-loaded\", this.onObjectLoaded);\r\n    this.props.scene.removeEventListener(\"pdf-loaded\", this.onObjectLoaded);\r\n    this.props.scene.removeEventListener(\"model-error\", this.onObjectLoaded);\r\n  }\r\n\r\n  onObjectLoading = () => {\r\n    if (!this.doneWithInitialLoad && this.loadingTimeout) {\r\n      window.clearTimeout(this.loadingTimeout);\r\n      this.loadingTimeout = null;\r\n    }\r\n\r\n    this.setState(state => {\r\n      return { loadingNum: state.loadingNum + 1 };\r\n    });\r\n  };\r\n\r\n  onObjectLoaded = () => {\r\n    this.setState(state => {\r\n      return { loadedNum: state.loadedNum + 1 };\r\n    });\r\n\r\n    this.tryFinishLoading();\r\n  };\r\n\r\n  tryFinishLoading = () => {\r\n    if (!this.doneWithInitialLoad && this.loadingTimeout) window.clearTimeout(this.loadingTimeout);\r\n\r\n    if (this.environmentSceneLoaded) {\r\n      this.loadingTimeout = window.setTimeout(() => {\r\n        this.doneWithInitialLoad = true;\r\n        if (this.props.onLoaded) {\r\n          this.props.onLoaded();\r\n        }\r\n      }, 1500);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const nomore = (\r\n      <h4 className={loaderStyles.loadingText}>\r\n        <FormattedMessage id=\"loader.entering_lobby\" />\r\n      </h4>\r\n    );\r\n    const progress =\r\n      this.state.loadingNum === 0\r\n        ? \" \"\r\n        : `${Math.min(this.state.loadedNum, this.state.loadingNum)} / ${this.state.loadingNum} `;\r\n    const usual = (\r\n      <h4 className={loaderStyles.loadingText}>\r\n        <FormattedMessage id=\"loader.loading\" />\r\n        {progress}\r\n        <FormattedMessage id={this.state.loadingNum !== 1 ? \"loader.objects\" : \"loader.object\"} />\r\n        ...\r\n      </h4>\r\n    );\r\n    return (\r\n      <IntlProvider locale={lang} messages={messages}>\r\n        <div className=\"loading-panel\">\r\n          <img className=\"loading-panel__logo\" src={configs.image(\"logo\")} />\r\n          <UnlessFeature name=\"hide_powered_by\">\r\n            <div className=\"loading-panel__powered-by\">\r\n              <span className=\"loading-panel__powered-by__prefix\">\r\n                <FormattedMessage id=\"home.powered_by_prefix\" />\r\n              </span>\r\n              <a href=\"https://hubs.mozilla.com/cloud\">\r\n                <FormattedMessage id=\"home.powered_by_link\" />\r\n              </a>\r\n            </div>\r\n          </UnlessFeature>\r\n\r\n          {this.props.finished ? nomore : usual}\r\n\r\n          <div className=\"loader-wrap loader-bottom\">\r\n            <div className=\"loader\">\r\n              <div className=\"loader-center\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </IntlProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Loader;\r\n","import React from \"react\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nconst AutoExitWarning = props => (\r\n  <div className=\"autoexit-panel\">\r\n    <div className=\"autoexit-panel__title\">\r\n      <FormattedMessage id=\"autoexit.title\" />\r\n      <span>{props.secondsRemaining}</span>\r\n      <FormattedMessage id=\"autoexit.title_units\" />\r\n    </div>\r\n    <div className=\"autoexit-panel__subtitle\">\r\n      <FormattedMessage id={props.message} />\r\n    </div>\r\n    <WithHoverSound>\r\n      <div className=\"autoexit-panel__cancel-button\" onClick={props.onCancel}>\r\n        <FormattedMessage id=\"autoexit.cancel\" />\r\n      </div>\r\n    </WithHoverSound>\r\n  </div>\r\n);\r\n\r\nAutoExitWarning.propTypes = {\r\n  message: PropTypes.string,\r\n  secondsRemaining: PropTypes.number,\r\n  onCancel: PropTypes.func\r\n};\r\n\r\nexport default AutoExitWarning;\r\n","import PropTypes from \"prop-types\";\r\nimport React from \"react\";\r\n\r\nfunction InlineSVG(props) {\r\n  const filteredProps = { ...props };\r\n  delete filteredProps.src;\r\n  return <div {...filteredProps} dangerouslySetInnerHTML={{ __html: props.src }} />;\r\n}\r\n\r\nInlineSVG.propTypes = {\r\n  src: PropTypes.string\r\n};\r\n\r\nfunction InlineSVGButton(props) {\r\n  const filteredProps = { ...props };\r\n  delete filteredProps.src;\r\n  return <button {...filteredProps} dangerouslySetInnerHTML={{ __html: props.src }} />;\r\n}\r\n\r\nInlineSVGButton.propTypes = {\r\n  src: PropTypes.string\r\n};\r\n\r\nexport { InlineSVG, InlineSVGButton };\r\n","import React from \"react\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport MobileScreenEntryImg from \"../assets/images/mobile_screen_entry.svgi\";\r\nimport DesktopScreenEntryImg from \"../assets/images/desktop_screen_entry.svgi\";\r\nimport GenericVREntryImg from \"../assets/images/generic_vr_entry.svgi\";\r\nimport GearVREntryImg from \"../assets/images/gearvr_entry.svgi\";\r\nimport DaydreamEntryImg from \"../assets/images/daydream_entry.svgi\";\r\nimport styles from \"../assets/stylesheets/entry.scss\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\nimport cx from \"classnames\";\r\nimport { InlineSVG } from \"./svgi\";\r\n\r\nconst EntryButton = props => {\r\n  return (\r\n    <WithHoverSound>\r\n      <button\r\n        autoFocus={props.autoFocus}\r\n        className={cx([{ [styles.entryButton]: true, [styles.entryButtonSecondary]: props.secondary }])}\r\n        onClick={props.onClick}\r\n      >\r\n        <InlineSVG src={props.iconSrc} className={styles.icon} />\r\n        <div className={styles.label}>\r\n          <div className={styles.contents}>\r\n            <span>\r\n              <FormattedMessage id={props.prefixMessageId} />\r\n            </span>\r\n            <span className={styles.bolded}>\r\n              <FormattedMessage id={props.mediumMessageId} />\r\n            </span>\r\n            {props.subtitle && (\r\n              <div className={styles.subtitle}>\r\n                <FormattedMessage id={props.subtitle} />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </button>\r\n    </WithHoverSound>\r\n  );\r\n};\r\n\r\nEntryButton.propTypes = {\r\n  onClick: PropTypes.func,\r\n  autoFocus: PropTypes.bool,\r\n  iconSrc: PropTypes.string,\r\n  secondary: PropTypes.bool,\r\n  prefixMessageId: PropTypes.string,\r\n  mediumMessageId: PropTypes.string,\r\n  subtitle: PropTypes.string,\r\n  isInHMD: PropTypes.bool\r\n};\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\r\n\r\nexport const TwoDEntryButton = props => {\r\n  const entryButtonProps = {\r\n    ...props,\r\n    iconSrc: isMobile ? MobileScreenEntryImg : DesktopScreenEntryImg,\r\n    prefixMessageId: \"entry.screen-prefix\",\r\n    mediumMessageId: isMobile ? \"entry.mobile-screen\" : \"entry.desktop-screen\"\r\n  };\r\n\r\n  return <EntryButton {...entryButtonProps} />;\r\n};\r\n\r\nexport const GenericEntryButton = props => {\r\n  const entryButtonProps = {\r\n    ...props,\r\n    iconSrc: GenericVREntryImg,\r\n    prefixMessageId: \"entry.generic-prefix\",\r\n    mediumMessageId: \"entry.generic-medium\",\r\n    subtitle: isMobile ? null : \"entry.generic-subtitle-desktop\"\r\n  };\r\n\r\n  return <EntryButton {...entryButtonProps} />;\r\n};\r\n\r\nexport const GearVREntryButton = props => {\r\n  const entryButtonProps = {\r\n    ...props,\r\n    iconSrc: GearVREntryImg,\r\n    prefixMessageId: \"entry.gearvr-prefix\",\r\n    mediumMessageId: \"entry.gearvr-medium\"\r\n  };\r\n\r\n  return <EntryButton {...entryButtonProps} />;\r\n};\r\n\r\nexport const DaydreamEntryButton = props => {\r\n  const entryButtonProps = {\r\n    ...props,\r\n    iconSrc: DaydreamEntryImg,\r\n    prefixMessageId: \"entry.daydream-prefix\",\r\n    mediumMessageId: \"entry.daydream-medium\"\r\n  };\r\n\r\n  return <EntryButton {...entryButtonProps} />;\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { injectIntl, FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport { SCHEMA } from \"../storage/store\";\r\nimport styles from \"../assets/stylesheets/profile.scss\";\r\nimport { fetchAvatar } from \"../utils/avatar-utils\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport { replaceHistoryState } from \"../utils/history\";\r\nimport StateLink from \"./state-link\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\n\r\nimport AvatarPreview from \"./avatar-preview\";\r\n\r\nclass ProfileEntryPanel extends Component {\r\n  static propTypes = {\r\n    displayNameOverride: PropTypes.string,\r\n    store: PropTypes.object,\r\n    mediaSearchStore: PropTypes.object,\r\n    messages: PropTypes.object,\r\n    finished: PropTypes.func,\r\n    intl: PropTypes.object,\r\n    history: PropTypes.object,\r\n    avatarId: PropTypes.string,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    avatarId: null,\r\n    displayName: null,\r\n    avatar: null\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = this.getStateFromProfile();\r\n    if (props.avatarId) {\r\n      this.state.avatarId = props.avatarId;\r\n    }\r\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\r\n    this.scene = document.querySelector(\"a-scene\");\r\n  }\r\n\r\n  getStateFromProfile = () => {\r\n    const { displayName, avatarId } = this.props.store.state.profile;\r\n    return { displayName, avatarId };\r\n  };\r\n\r\n  storeUpdated = () => this.setState(this.getStateFromProfile());\r\n\r\n  saveStateAndFinish = e => {\r\n    e && e.preventDefault();\r\n\r\n    const { displayName } = this.props.store.state.profile;\r\n    const { hasChangedName } = this.props.store.state.activity;\r\n\r\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\r\n    this.props.store.update({\r\n      activity: {\r\n        hasChangedName: hasChangedNowOrPreviously,\r\n        hasAcceptedProfile: true\r\n      },\r\n      profile: {\r\n        displayName: this.state.displayName,\r\n        avatarId: this.state.avatarId\r\n      }\r\n    });\r\n    this.props.finished();\r\n    this.scene.emit(\"avatar_updated\");\r\n  };\r\n\r\n  stopPropagation = e => {\r\n    e.stopPropagation();\r\n  };\r\n\r\n  setAvatarFromMediaResult = ({ detail: { entry, selectAction } }) => {\r\n    if ((entry.type !== \"avatar\" && entry.type !== \"avatar_listing\") || selectAction !== \"use\") return;\r\n\r\n    this.setState({ avatarId: entry.id });\r\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\r\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\r\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\r\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.nameInput) {\r\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\r\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\r\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\r\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\r\n    }\r\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\r\n    // This handles editing avatars in the entry_step, since this component remains mounted with the same avatarId\r\n    this.scene.addEventListener(\"action_avatar_saved\", this.refetchAvatar);\r\n\r\n    this.refetchAvatar();\r\n  }\r\n\r\n  componentDidUpdate(_prevProps, prevState) {\r\n    if (prevState.avatarId !== this.state.avatarId) {\r\n      this.refetchAvatar();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\r\n    if (this.nameInput) {\r\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\r\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\r\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\r\n    }\r\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\r\n    this.scene.removeEventListener(\"action_avatar_saved\", this.refetchAvatar);\r\n  }\r\n\r\n  refetchAvatar = async () => {\r\n    const avatar = await fetchAvatar(this.state.avatarId);\r\n    if (this.state.avatarId !== avatar.avatar_id) return; // This is an old result, ignore it\r\n    this.setState({ avatar });\r\n  };\r\n\r\n  render() {\r\n    const { formatMessage } = this.props.intl;\r\n\r\n    return (\r\n      <div className={styles.profileEntry}>\r\n        <div className={styles.close}>\r\n          <button autoFocus onClick={() => this.props.onClose()}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </button>\r\n        </div>\r\n        <form onSubmit={this.saveStateAndFinish} className={styles.form}>\r\n          <div className={classNames([styles.box])}>\r\n            <label htmlFor=\"#profile-entry-display-name\" className={styles.title}>\r\n              <FormattedMessage id=\"profile.header\" />\r\n            </label>\r\n            {this.props.displayNameOverride ? (\r\n              <span className={styles.displayName}>{this.props.displayNameOverride}</span>\r\n            ) : (\r\n              <input\r\n                id=\"profile-entry-display-name\"\r\n                className={styles.formFieldText}\r\n                value={this.state.displayName}\r\n                onFocus={e => handleTextFieldFocus(e.target)}\r\n                onBlur={() => handleTextFieldBlur()}\r\n                onChange={e => this.setState({ displayName: e.target.value })}\r\n                required\r\n                spellCheck=\"false\"\r\n                pattern={SCHEMA.definitions.profile.properties.displayName.pattern}\r\n                title={formatMessage({ id: \"profile.display_name.validation_warning\" })}\r\n                ref={inp => (this.nameInput = inp)}\r\n              />\r\n            )}\r\n\r\n            {this.state.avatar ? (\r\n              <div className={styles.preview}>\r\n                <AvatarPreview avatarGltfUrl={this.state.avatar.gltf_url} />\r\n\r\n                {this.state.avatar.account_id === this.props.store.credentialsAccountId && (\r\n                  <StateLink\r\n                    stateKey=\"overlay\"\r\n                    stateValue=\"avatar-editor\"\r\n                    stateDetail={{ avatarId: this.state.avatarId, hideDelete: true, returnToProfile: true }}\r\n                    history={this.props.history}\r\n                    className={styles.editAvatar}\r\n                  >\r\n                    <FontAwesomeIcon icon={faPencilAlt} />\r\n                  </StateLink>\r\n                )}\r\n\r\n                <div className={styles.chooseAvatar}>\r\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\")}>\r\n                    <FormattedMessage id=\"profile.choose_avatar\" />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className={styles.preview}>\r\n                <AvatarPreview />\r\n                <div className={styles.chooseAvatar}>\r\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\")}>\r\n                    <FormattedMessage id=\"profile.choose_avatar\" />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <input className={styles.formSubmit} type=\"submit\" value={formatMessage({ id: \"profile.save\" })} />\r\n            <div className={styles.links}>\r\n              <IfFeature name=\"show_terms\">\r\n                <a\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  href={configs.link(\"terms_of_use\", \"https://github.com/mozilla/hubs/blob/master/TERMS.md\")}\r\n                >\r\n                  <FormattedMessage id=\"profile.terms_of_use\" />\r\n                </a>\r\n              </IfFeature>\r\n\r\n              <IfFeature name=\"show_privacy\">\r\n                <a\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  href={configs.link(\"privacy_notice\", \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\")}\r\n                >\r\n                  <FormattedMessage id=\"profile.privacy_notice\" />\r\n                </a>\r\n              </IfFeature>\r\n            </div>\r\n          </div>\r\n        </form>\r\n        <img className={styles.logo} src={configs.image(\"logo\")} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default injectIntl(ProfileEntryPanel);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { injectIntl, FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\r\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons/faSearch\";\r\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\r\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\r\nimport { faLink } from \"@fortawesome/free-solid-svg-icons/faLink\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport styles from \"../assets/stylesheets/media-browser.scss\";\r\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\r\nimport { SOURCES } from \"../storage/media-search-store\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\r\nimport MediaTiles from \"./media-tiles\";\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\nconst PRIVACY_POLICY_LINKS = {\r\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\r\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\r\n  gifs: \"https://tenor.com/legal-privacy\",\r\n  sketchfab: \"https://sketchfab.com/privacy\",\r\n  poly: \"https://policies.google.com/privacy\",\r\n  youtube: \"https://policies.google.com/privacy\",\r\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\r\n};\r\n\r\nconst DEFAULT_FACETS = {\r\n  sketchfab: [\r\n    { text: \"Featured\", params: { filter: \"featured\" } },\r\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\r\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\r\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\r\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\r\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\r\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\r\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\r\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\r\n    { text: \"Food\", params: { filter: \"food-drink\" } },\r\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\r\n    { text: \"Music\", params: { filter: \"music\" } },\r\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\r\n    { text: \"News\", params: { filter: \"news-politics\" } },\r\n    { text: \"People\", params: { filter: \"people\" } },\r\n    { text: \"Places\", params: { filter: \"places-travel\" } },\r\n    { text: \"Science\", params: { filter: \"science-technology\" } },\r\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\r\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\r\n  ],\r\n  poly: [\r\n    { text: \"Featured\", params: { filter: \"\" } },\r\n    { text: \"Animals\", params: { filter: \"animals\" } },\r\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\r\n    { text: \"Art\", params: { filter: \"art\" } },\r\n    { text: \"Food\", params: { filter: \"food\" } },\r\n    { text: \"Nature\", params: { filter: \"nature\" } },\r\n    { text: \"Objects\", params: { filter: \"objects\" } },\r\n    { text: \"People\", params: { filter: \"people\" } },\r\n    { text: \"Scenes\", params: { filter: \"scenes\" } },\r\n    { text: \"Transport\", params: { filter: \"transport\" } }\r\n  ],\r\n  avatars: [\r\n    { text: \"Featured\", params: { filter: \"featured\" } },\r\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } },\r\n    { text: \"Newest\", params: { filter: \"\" } }\r\n  ],\r\n  favorites: [],\r\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\r\n};\r\n\r\nclass MediaBrowser extends Component {\r\n  static propTypes = {\r\n    mediaSearchStore: PropTypes.object,\r\n    history: PropTypes.object,\r\n    intl: PropTypes.object,\r\n    hubChannel: PropTypes.object,\r\n    onMediaSearchResultEntrySelected: PropTypes.func,\r\n    performConditionalSignIn: PropTypes.func\r\n  };\r\n\r\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = this.getStoreAndHistoryState(props);\r\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\r\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  componentWillUnmount() {\r\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\r\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\r\n  }\r\n\r\n  storeUpdated = () => {\r\n    const newState = this.getStoreAndHistoryState(this.props);\r\n    this.setState(newState);\r\n\r\n    if (this.state.selectNextResult) {\r\n      if (newState.result && newState.result.entries.length > 0) {\r\n        this.selectEntry(newState.result.entries[0]);\r\n      } else {\r\n        this.close();\r\n      }\r\n    }\r\n  };\r\n\r\n  sourceChanged = () => {\r\n    if (this.inputRef && !isMobile && !isMobileVR) {\r\n      this.inputRef.focus();\r\n    }\r\n  };\r\n\r\n  getUrlSource = searchParams =>\r\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\r\n\r\n  getStoreAndHistoryState = props => {\r\n    const searchParams = new URLSearchParams(props.history.location.search);\r\n    const result = props.mediaSearchStore.result;\r\n\r\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\r\n    const urlSource = this.getUrlSource(searchParams);\r\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\r\n    newState.selectAction = searchParams.get(\"selectAction\") || \"spawn\";\r\n\r\n    if (result && result.suggestions && result.suggestions.length > 0) {\r\n      newState.facets = result.suggestions.map(s => {\r\n        return { text: s, params: { q: s } };\r\n      });\r\n    } else {\r\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\r\n    }\r\n\r\n    return newState;\r\n  };\r\n\r\n  handleQueryUpdated = (query, forceNow) => {\r\n    this.setState({ result: null });\r\n\r\n    if (this._sendQueryTimeout) {\r\n      clearTimeout(this._sendQueryTimeout);\r\n      this._sendQueryTimeout = null;\r\n    }\r\n\r\n    if (forceNow) {\r\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\r\n    } else {\r\n      // Don't update search on every keystroke, but buffer for some ms.\r\n      this._sendQueryTimeout = setTimeout(() => {\r\n        // Drop filter for now, so entering text drops into \"search all\" mode\r\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\r\n        this._sendQueryTimeout = null;\r\n      }, 500);\r\n    }\r\n\r\n    this.setState({ query });\r\n  };\r\n\r\n  handleEntryClicked = (evt, entry) => {\r\n    evt.preventDefault();\r\n\r\n    if (!entry.lucky_query) {\r\n      this.selectEntry(entry);\r\n    } else {\r\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\r\n      //\r\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\r\n      // query we are running to get the result we want.\r\n      this.setState({ clearStashedQueryOnClose: true });\r\n      this.handleQueryUpdated(entry.lucky_query, true);\r\n    }\r\n  };\r\n\r\n  onCopyAvatar = () => {\r\n    this.handleFacetClicked({ params: { filter: \"my-avatars\" } });\r\n  };\r\n\r\n  onCopyScene = () => {\r\n    this.handleFacetClicked({ params: { filter: \"my-scenes\" } });\r\n  };\r\n\r\n  onShowSimilar = (id, name) => {\r\n    this.handleFacetClicked({ params: { similar_to: id, similar_name: name } });\r\n  };\r\n\r\n  selectEntry = entry => {\r\n    if (!this.props.onMediaSearchResultEntrySelected) return;\r\n    this.props.onMediaSearchResultEntrySelected(entry, this.state.selectAction);\r\n    this.close();\r\n  };\r\n\r\n  handleSourceClicked = source => {\r\n    this.props.mediaSearchStore.sourceNavigate(source);\r\n  };\r\n\r\n  handleFacetClicked = facet => {\r\n    this.setState({ query: \"\" }, () => {\r\n      const searchParams = this.getSearchClearedSearchParams(true, true, true);\r\n\r\n      for (const [k, v] of Object.entries(facet.params)) {\r\n        searchParams.set(k, v);\r\n      }\r\n\r\n      pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\r\n    });\r\n  };\r\n\r\n  getSearchClearedSearchParams = (keepSource, keepNav, keepSelectAction) => {\r\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(\r\n      this.props.history.location,\r\n      keepSource,\r\n      keepNav,\r\n      keepSelectAction\r\n    );\r\n  };\r\n\r\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\r\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\r\n  };\r\n\r\n  showCustomMediaDialog = source => {\r\n    const isSceneApiType = source === \"scenes\";\r\n    const isAvatarApiType = source === \"avatars\";\r\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\r\n    const dialog = isSceneApiType ? \"change_scene\" : isAvatarApiType ? \"avatar_url\" : \"create\";\r\n    pushHistoryState(this.props.history, \"modal\", dialog);\r\n  };\r\n\r\n  close = () => {\r\n    showFullScreenIfWasFullScreen();\r\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\r\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\" && urlSource !== \"favorites\");\r\n    if (this.state.clearStashedQueryOnClose) {\r\n      this.props.mediaSearchStore.clearStashedQuery();\r\n    }\r\n  };\r\n\r\n  handlePager = delta => {\r\n    this.setState({ result: null });\r\n    this.props.mediaSearchStore.pageNavigate(delta);\r\n    this.browserDiv.scrollTop = 0;\r\n  };\r\n\r\n  render() {\r\n    const { formatMessage } = this.props.intl;\r\n    const searchParams = new URLSearchParams(this.props.history.location.search);\r\n    const urlSource = this.getUrlSource(searchParams);\r\n    const isSceneApiType = urlSource === \"scenes\";\r\n    const isFavorites = urlSource === \"favorites\";\r\n    const showCustomOption =\r\n      !isFavorites && (!isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\"));\r\n    const entries = (this.state.result && this.state.result.entries) || [];\r\n    const hideSearch = urlSource === \"favorites\";\r\n    const showEmptyStringOnNoResult = urlSource !== \"avatars\" && urlSource !== \"scenes\";\r\n\r\n    const facets = this.state.facets && this.state.facets.length > 0 && this.state.facets;\r\n\r\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\r\n    if (this.state.selectNextResult) return <div />;\r\n    const handleCustomClicked = urlSource => {\r\n      const isAvatarApiType = urlSource === \"avatars\";\r\n      if (isAvatarApiType) {\r\n        this.showCustomMediaDialog(urlSource);\r\n      } else {\r\n        this.props.performConditionalSignIn(\r\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\r\n          () => this.showCustomMediaDialog(urlSource),\r\n          \"change-scene\"\r\n        );\r\n      }\r\n    };\r\n\r\n    const activeFilter =\r\n      searchParams.get(\"filter\") || (searchParams.get(\"similar_to\") && \"similar\") || (!searchParams.get(\"q\") && \"\");\r\n\r\n    const meta = this.state.result && this.state.result.meta;\r\n    const hasNext = !!(meta && meta.next_cursor);\r\n    const hasPrevious = searchParams.get(\"cursor\");\r\n    const page = (meta && meta.page) || 0;\r\n    const apiSource = (meta && meta.source) || null;\r\n    const isVariableWidth = [\"bing_images\", \"tenor\"].includes(apiSource);\r\n\r\n    return (\r\n      <div className={styles.mediaBrowser} ref={browserDiv => (this.browserDiv = browserDiv)}>\r\n        <div className={classNames([styles.box, styles.darkened])}>\r\n          <div className={classNames(styles.header, { [styles.noSearch]: hideSearch })}>\r\n            <div className={styles.headerLeft}>\r\n              <button onClick={() => this.close()}>\r\n                <i>\r\n                  <FontAwesomeIcon icon={faTimes} />\r\n                </i>\r\n              </button>\r\n            </div>\r\n            <div className={styles.headerCenter}>\r\n              {urlSource === \"favorites\" && (\r\n                <div className={styles.favoritesHeader}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faStar} />\r\n                  </i>\r\n                  <FormattedMessage id=\"media-browser.favorites-header\" />\r\n                </div>\r\n              )}\r\n              {!hideSearch && (\r\n                <div className={styles.search}>\r\n                  <i className={styles.searchIcon}>\r\n                    <FontAwesomeIcon icon={faSearch} />\r\n                  </i>\r\n                  <input\r\n                    type=\"text\"\r\n                    autoFocus={!isMobile && !isMobileVR}\r\n                    ref={r => (this.inputRef = r)}\r\n                    placeholder={formatMessage({\r\n                      id: `media-browser.search-placeholder.${urlSource}`\r\n                    })}\r\n                    onFocus={e => handleTextFieldFocus(e.target)}\r\n                    onBlur={() => handleTextFieldBlur()}\r\n                    onKeyDown={e => {\r\n                      if (e.key === \"Enter\" && e.ctrlKey) {\r\n                        if (entries.length > 0 && !this._sendQueryTimeout) {\r\n                          this.handleEntryClicked(e, entries[0]);\r\n                        } else if (this.state.query.trim() !== \"\") {\r\n                          this.handleQueryUpdated(this.state.query, true);\r\n                          this.setState({ selectNextResult: true });\r\n                        } else {\r\n                          this.close();\r\n                        }\r\n                      } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\r\n                        e.target.blur();\r\n                      }\r\n                    }}\r\n                    value={this.state.query}\r\n                    onChange={e => this.handleQueryUpdated(e.target.value)}\r\n                  />\r\n                  <i className={styles.searchClear} onClick={() => this.handleQueryUpdated(\"\", true)}>\r\n                    <FontAwesomeIcon icon={faTimes} />\r\n                  </i>\r\n                </div>\r\n              )}\r\n              <div className={styles.engineAttribution}>\r\n                {!hideSearch &&\r\n                  urlSource !== \"scenes\" &&\r\n                  urlSource !== \"avatars\" &&\r\n                  urlSource !== \"favorites\" && (\r\n                    <div className={styles.engineAttributionContents}>\r\n                      <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\r\n                      {PRIVACY_POLICY_LINKS[urlSource] && (\r\n                        <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\r\n                          <FormattedMessage id=\"media-browser.privacy_policy\" />\r\n                        </a>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                {urlSource === \"scenes\" && (\r\n                  <div className={styles.engineAttributionContents}>\r\n                    <IfFeature name=\"enable_spoke\">\r\n                      <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\r\n                      <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\r\n                        <FormattedMessage id=\"editor-name\" />\r\n                      </a>\r\n                    </IfFeature>\r\n                    {configs.feature(\"enable_spoke\") && configs.feature(\"show_issue_report_link\") && \"|\"}\r\n                    <IfFeature name=\"show_issue_report_link\">\r\n                      <a target=\"_blank\" rel=\"noopener noreferrer\" href={configs.link(\"issue_report\", \"/#/report\")}>\r\n                        <FormattedMessage id=\"media-browser.report_issue\" />\r\n                      </a>\r\n                    </IfFeature>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className={styles.headerRight}>\r\n              {showCustomOption && (\r\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createButton}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={[\"scenes\", \"avatars\"].includes(urlSource) ? faLink : faCloudUploadAlt} />\r\n                  </i>\r\n                </a>\r\n              )}\r\n              {showCustomOption && (\r\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createLink}>\r\n                  <FormattedMessage\r\n                    id={`media-browser.add_custom_${\r\n                      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\"\r\n                    }`}\r\n                  />\r\n                </a>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {this.state.showNav && (\r\n            <div className={styles.nav}>\r\n              {SOURCES.map(s => (\r\n                <a\r\n                  onClick={() => this.handleSourceClicked(s)}\r\n                  key={s}\r\n                  className={classNames({ [styles.navSource]: true, [styles.navSourceSelected]: urlSource === s })}\r\n                >\r\n                  <FormattedMessage id={`media-browser.nav_title.${s}`} />\r\n                </a>\r\n              ))}\r\n              <div className={styles.navRightPad}>&nbsp;</div>\r\n              <div className={styles.navScrollArrow}>\r\n                <FontAwesomeIcon icon={faAngleRight} />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {(facets || activeFilter === \"similar\") && (\r\n            <div className={styles.facets}>\r\n              {facets &&\r\n                facets.map((s, i) => (\r\n                  <a\r\n                    onClick={() => this.handleFacetClicked(s)}\r\n                    key={i}\r\n                    className={classNames(styles.facet, { selected: s.params.filter === activeFilter })}\r\n                  >\r\n                    {s.text}\r\n                  </a>\r\n                ))}\r\n              {activeFilter === \"similar\" && (\r\n                <a className={classNames(styles.facet, \"selected\")}>\r\n                  <FormattedMessage\r\n                    id=\"media-browser.similar-to-facet\"\r\n                    values={{ name: searchParams.get(\"similar_name\") }}\r\n                  />\r\n                </a>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {this.props.mediaSearchStore.isFetching ||\r\n          this._sendQueryTimeout ||\r\n          entries.length > 0 ||\r\n          !showEmptyStringOnNoResult ? (\r\n            <MediaTiles\r\n              entries={entries}\r\n              hasNext={hasNext}\r\n              hasPrevious={hasPrevious}\r\n              page={page}\r\n              isVariableWidth={isVariableWidth}\r\n              history={this.props.history}\r\n              urlSource={urlSource}\r\n              handleEntryClicked={this.handleEntryClicked}\r\n              onCopyAvatar={this.onCopyAvatar}\r\n              onCopyScene={this.onCopyScene}\r\n              onShowSimilar={this.onShowSimilar}\r\n              handlePager={this.handlePager}\r\n            />\r\n          ) : (\r\n            <div className={styles.emptyString}>\r\n              <FormattedMessage id={`media-browser.empty.${urlSource}`} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default injectIntl(MediaBrowser);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cx from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faPaperclip } from \"@fortawesome/free-solid-svg-icons/faPaperclip\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport giphyLogo from \"../assets/images/giphy_logo.png\";\r\nimport styles from \"../assets/stylesheets/create-object-dialog.scss\";\r\nimport ducky from \"../assets/models/DuckyMesh.glb\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport { getAbsoluteHref } from \"../utils/media-url-utils\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nconst attributionHostnames = {\r\n  \"giphy.com\": giphyLogo,\r\n  \"media.giphy.com\": giphyLogo\r\n};\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\r\nconst instructions = \"Paste a URL to an image, video, model, scene, or upload.\";\r\nconst desktopTips = `Tip: You can paste URLs directly into ${messages[\"app-name\"]} with Ctrl+V`;\r\nconst references = (\r\n  <span>\r\n    For models, try{\" \"}\r\n    <a href=\"https://sketchfab.com/search?features=downloadable&type=models\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n      Sketchfab\r\n    </a>{\" \"}\r\n    and{\" \"}\r\n    <a href=\"http://poly.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n      Google Poly\r\n    </a>\r\n    <IfFeature name=\"show_model_collection_link\">\r\n      , or our{\" \"}\r\n      <a\r\n        href={configs.link(\"model_collection\", \"https://sketchfab.com/mozillareality\")}\r\n        target=\"_blank\"\r\n        rel=\"noopener noreferrer\"\r\n      >\r\n        collection\r\n      </a>\r\n    </IfFeature>.\r\n  </span>\r\n);\r\n\r\nconst mobileInstructions = (\r\n  <div>\r\n    <p>{instructions}</p>\r\n    <p>{references}</p>\r\n  </div>\r\n);\r\nconst desktopInstructions = (\r\n  <div>\r\n    <p>{instructions}</p>\r\n    <p>{references}</p>\r\n    <p>{desktopTips}</p>\r\n  </div>\r\n);\r\n\r\nlet lastUrl = \"\";\r\nconst fileInputId = \"file-input\";\r\n\r\nexport default class CreateObjectDialog extends Component {\r\n  state = {\r\n    url: \"\",\r\n    file: null,\r\n    fileName: \"\"\r\n  };\r\n\r\n  static propTypes = {\r\n    onCreate: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.setState({ url: lastUrl });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    lastUrl = this.state.url;\r\n  }\r\n\r\n  onUrlChange = e => {\r\n    let attributionImage = this.state.attributionImage;\r\n    if (e.target && e.target.value && e.target.validity.valid) {\r\n      const url = new URL(e.target.value);\r\n      attributionImage = attributionHostnames[url.hostname];\r\n    }\r\n    this.setState({\r\n      url: e.target && e.target.value,\r\n      attributionImage: attributionImage\r\n    });\r\n  };\r\n\r\n  onFileChange = e => {\r\n    this.setState({\r\n      file: e.target.files[0],\r\n      fileName: e.target.files[0].name\r\n    });\r\n  };\r\n\r\n  reset = e => {\r\n    e.preventDefault();\r\n    this.setState({\r\n      url: \"\",\r\n      file: null,\r\n      fileName: \"\"\r\n    });\r\n    this.fileInput.value = null;\r\n  };\r\n\r\n  onCreateClicked = e => {\r\n    e.preventDefault();\r\n    this.props.onCreate(this.state.file || this.state.url || getAbsoluteHref(location.href, ducky));\r\n    this.props.onClose();\r\n  };\r\n\r\n  render() {\r\n    const { onCreate, onClose, ...other } = this.props; // eslint-disable-line no-unused-vars\r\n\r\n    const cancelButton = (\r\n      <WithHoverSound>\r\n        <label className={cx(styles.smallButton, styles.cancelIcon)} onClick={this.reset}>\r\n          <FontAwesomeIcon icon={faTimes} />\r\n        </label>\r\n      </WithHoverSound>\r\n    );\r\n    const uploadButton = (\r\n      <WithHoverSound>\r\n        <label htmlFor={fileInputId} className={cx(styles.smallButton, styles.uploadIcon)}>\r\n          <FontAwesomeIcon icon={faPaperclip} />\r\n        </label>\r\n      </WithHoverSound>\r\n    );\r\n    const filenameLabel = <label className={cx(styles.leftSideOfInput)}>{this.state.fileName}</label>;\r\n    const urlInput = (\r\n      <input\r\n        className={cx(styles.leftSideOfInput)}\r\n        placeholder=\"Image/Video/glTF URL\"\r\n        onFocus={e => handleTextFieldFocus(e.target)}\r\n        onBlur={() => handleTextFieldBlur()}\r\n        onChange={this.onUrlChange}\r\n        type=\"url\"\r\n        value={this.state.url}\r\n      />\r\n    );\r\n\r\n    return (\r\n      <DialogContainer title=\"Create Object\" onClose={this.props.onClose} {...other}>\r\n        <div>\r\n          {isMobile ? mobileInstructions : desktopInstructions}\r\n          <form onSubmit={this.onCreateClicked}>\r\n            <div className={styles.addMediaForm}>\r\n              <input\r\n                id={fileInputId}\r\n                ref={f => (this.fileInput = f)}\r\n                className={styles.hideFileInput}\r\n                type=\"file\"\r\n                onChange={this.onFileChange}\r\n              />\r\n              <div className={styles.inputBorder}>\r\n                {this.state.file ? filenameLabel : urlInput}\r\n                {this.state.url || this.state.fileName ? cancelButton : uploadButton}\r\n              </div>\r\n              <div className={styles.buttons}>\r\n                <WithHoverSound>\r\n                  <button className={styles.actionButton}>\r\n                    <span>Create</span>\r\n                  </button>\r\n                </WithHoverSound>\r\n              </div>\r\n              {this.state.attributionImage ? (\r\n                <div>\r\n                  <img src={this.state.attributionImage} />\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport cx from \"classnames\";\r\n\r\nimport IfFeature from \"./if-feature\";\r\nimport styles from \"../assets/stylesheets/change-scene-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport { messages } from \"../utils/i18n\";\r\nimport { isValidSceneUrl } from \"../utils/scene-url-utils\";\r\n\r\nexport default class ChangeSceneDialog extends Component {\r\n  state = {\r\n    url: \"\",\r\n    submitting: false\r\n  };\r\n\r\n  static propTypes = {\r\n    onChange: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.urlValidationPromise = null;\r\n  }\r\n\r\n  onUrlChange = e => {\r\n    const urlInput = e.target;\r\n    const url = urlInput.value;\r\n    this.setState({ url });\r\n\r\n    urlInput.setCustomValidity(\"\");\r\n\r\n    this.urlValidationPromise = new Promise(async resolve => {\r\n      urlInput.setCustomValidity((await isValidSceneUrl(url.trim())) ? \"\" : messages[\"invalid-scene-url\"]);\r\n      resolve();\r\n    });\r\n  };\r\n\r\n  reset = e => {\r\n    e.preventDefault();\r\n    this.setState({ url: \"\" });\r\n  };\r\n\r\n  onSubmit = async e => {\r\n    e.preventDefault();\r\n\r\n    this.setState({ submitting: true });\r\n\r\n    const form = e.target;\r\n\r\n    if (this.state.url) {\r\n      await this.urlValidationPromise;\r\n      if (form.checkValidity()) {\r\n        this.props.onChange(this.state.url.trim());\r\n        this.props.onClose();\r\n      } else {\r\n        form.reportValidity();\r\n        this.setState({ submitting: false });\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { onChange, onClose } = this.props; // eslint-disable-line no-unused-vars\r\n\r\n    return (\r\n      <DialogContainer title=\"Custom Scene\" onClose={this.props.onClose}>\r\n        <div>\r\n          <div>\r\n            <p>\r\n              Paste a URL to a{\" \"}\r\n              <IfFeature name=\"enable_spoke\">\r\n                <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <FormattedMessage id=\"editor-name\" />\r\n                </a>{\" \"}\r\n              </IfFeature>\r\n              scene or a URL to a{\" \"}\r\n              <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                GLB\r\n              </a>.\r\n            </p>\r\n          </div>\r\n          <form onSubmit={this.onSubmit}>\r\n            <div className={styles.changeSceneForm}>\r\n              <div className={styles.inputBorder}>\r\n                <input\r\n                  className={cx(styles.leftSideOfInput)}\r\n                  placeholder=\"Scene URL\"\r\n                  onFocus={e => handleTextFieldFocus(e.target)}\r\n                  onBlur={() => handleTextFieldBlur()}\r\n                  onChange={this.onUrlChange}\r\n                  type=\"url\"\r\n                  value={this.state.url}\r\n                />\r\n              </div>\r\n              <div className={styles.buttons}>\r\n                <button className={styles.actionButton} disabled={this.state.submitting}>\r\n                  <FormattedMessage id=\"change-scene-dialog.change-scene\" />\r\n                </button>\r\n              </div>\r\n              <IfFeature name=\"enable_spoke\">\r\n                <div className={styles.spokeCreate}>\r\n                  <div>\r\n                    <FormattedMessage id=\"change-scene-dialog.create-in-spoke\" />\r\n                  </div>\r\n                  <a className={styles.spokeLaunch} href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                    <FormattedMessage id=\"change-scene-dialog.new-spoke-project\" />\r\n                  </a>\r\n                </div>\r\n              </IfFeature>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport styles from \"../assets/stylesheets/avatar-url-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\n\r\nexport default class AvatarUrlDialog extends Component {\r\n  state = {\r\n    url: \"\"\r\n  };\r\n\r\n  static propTypes = {\r\n    onChange: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  onUrlChange = e => {\r\n    this.setState({\r\n      url: e.target && e.target.value\r\n    });\r\n  };\r\n\r\n  onChangeClicked = e => {\r\n    e.preventDefault();\r\n\r\n    if (this.state.url) {\r\n      this.props.onChange(this.state.url);\r\n    }\r\n\r\n    this.props.onClose();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Custom Avatar URL\" className={styles.avatarUrlDialog} onClose={this.props.onClose}>\r\n        <p>\r\n          Paste a URL to a{\" \"}\r\n          <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            GLB\r\n          </a>.\r\n        </p>\r\n        <form className=\"form\" onSubmit={this.onChangeClicked}>\r\n          <input\r\n            className=\"url-field\"\r\n            placeholder=\"Avatar GLB URL\"\r\n            onFocus={e => handleTextFieldFocus(e.target)}\r\n            onBlur={() => handleTextFieldBlur()}\r\n            onChange={this.onUrlChange}\r\n            type=\"url\"\r\n            value={this.state.url}\r\n          />\r\n          <button className=\"submit\">\r\n            <FormattedMessage id=\"avatar-url-dialog.apply\" />\r\n          </button>\r\n        </form>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport classNames from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport configs from \"../utils/configs\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport { share, canShare } from \"../utils/share\";\r\n\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\nimport styles from \"../assets/stylesheets/invite-dialog.scss\";\r\n\r\nfunction pad(num, size) {\r\n  let s = `${num}`;\r\n  while (s.length < size) s = `0${s}`;\r\n  return s;\r\n}\r\n\r\nexport default class InviteDialog extends Component {\r\n  static propTypes = {\r\n    entryCode: PropTypes.number,\r\n    hubId: PropTypes.string,\r\n    allowShare: PropTypes.bool,\r\n    isModal: PropTypes.bool,\r\n    onClose: PropTypes.func,\r\n    hasPush: PropTypes.bool,\r\n    isSubscribed: PropTypes.bool,\r\n    onSubscribeChanged: PropTypes.func,\r\n    embedUrl: PropTypes.string\r\n  };\r\n\r\n  state = {\r\n    copyButtonActive: false,\r\n    shareButtonActive: false\r\n  };\r\n\r\n  shareClicked = url => {\r\n    this.setState({ shareButtonActive: true });\r\n    share({ url, title: `Join me now in ${messages[\"share-hashtag\"]}!` }).then(() => {\r\n      this.setState({ shareButtonActive: false });\r\n    });\r\n  };\r\n\r\n  copyClicked = link => {\r\n    this.setState({ copyButtonActive: true });\r\n    setTimeout(() => this.setState({ copyButtonActive: false }), 5000);\r\n\r\n    copy(link);\r\n  };\r\n\r\n  render() {\r\n    const { entryCode, embedUrl } = this.props;\r\n\r\n    const entryCodeString = pad(entryCode, 6);\r\n    const shortLinkText = `${configs.SHORTLINK_DOMAIN}/${this.props.hubId}`;\r\n    const shortLink = \"https://\" + shortLinkText;\r\n    const embedText = `<iframe src=\"${embedUrl}\" style=\"width: 1024px; height: 768px;\" allow=\"microphone; camera; vr; speaker;\"></iframe>`;\r\n\r\n    return (\r\n      <div className={classNames({ [styles.dialog]: true, [styles.modal]: this.props.isModal })}>\r\n        {!this.props.isModal && <div className={styles.attachPoint} />}\r\n        <div>\r\n          <FormattedMessage id={`invite.or_visit${this.props.isModal ? \"_modal\" : \"\"}`} />\r\n        </div>\r\n        <div className={styles.domain}>\r\n          <input type=\"text\" readOnly onFocus={e => e.target.select()} value={shortLinkText} />\r\n        </div>\r\n        <div className={styles.buttons}>\r\n          <WithHoverSound>\r\n            <button className={styles.linkButton} onClick={this.copyClicked.bind(this, shortLink)}>\r\n              <span>{this.state.copyButtonActive ? \"copied!\" : \"copy\"}</span>\r\n            </button>\r\n          </WithHoverSound>\r\n          {this.props.allowShare &&\r\n            canShare() && (\r\n              <WithHoverSound>\r\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\r\n                  <span>{this.state.shareButtonActive ? \"sharing...\" : \"share\"}</span>\r\n                </button>\r\n              </WithHoverSound>\r\n            )}\r\n          {this.props.allowShare &&\r\n            !canShare() && (\r\n              <WithHoverSound>\r\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\r\n                  <FormattedMessage id=\"invite.tweet\" />\r\n                </button>\r\n              </WithHoverSound>\r\n            )}\r\n        </div>\r\n        <WithHoverSound>\r\n          <button className={styles.close} onClick={() => this.props.onClose()}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </button>\r\n        </WithHoverSound>\r\n        <div className={styles.linkCode}>\r\n          <FormattedMessage id={`invite.enter_via${this.props.isModal ? \"_modal\" : \"\"}`} />\r\n          <a\r\n            href={`https://${configs.SHORTLINK_DOMAIN}`}\r\n            target=\"_blank\"\r\n            className={styles.hubLinkLink}\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            {configs.SHORTLINK_DOMAIN}\r\n          </a>\r\n          {/* <div className={styles.linkcode}> */}\r\n          <FormattedMessage id=\"invite.and_enter_code\" />\r\n          {/* </div> */}\r\n        </div>\r\n        <div className={styles.code}>\r\n          {entryCodeString.split(\"\").map((d, i) => (\r\n            <div className={classNames({ [styles.digit]: true, [styles[`digit_${i}`]]: true })} key={`link_code_${i}`}>\r\n              {d}\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div className={styles.codeDuration}>\r\n          <FormattedMessage id=\"invite.duration_of_code\" />\r\n        </div>\r\n        {embedUrl && (\r\n          <div className={styles.embed}>\r\n            <div>\r\n              <FormattedMessage id={`invite.embed`} />\r\n            </div>\r\n            <div className={styles.embedText}>\r\n              <input\r\n                type=\"text\"\r\n                readOnly\r\n                onFocus={e => {\r\n                  e.target.select();\r\n                  this.setState({ showEmbedTip: true });\r\n                }}\r\n                onBlur={() => this.setState({ showEmbedTip: false })}\r\n                value={embedText}\r\n              />\r\n            </div>\r\n            {this.state.showEmbedTip && (\r\n              <div className={styles.embedTipWrap}>\r\n                <div className={styles.embedTip}>\r\n                  <div className={styles.embedTipAttachPoint} />\r\n                  <FormattedMessage id=\"invite.embed-tip\" />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        {this.props.hasPush && (\r\n          <div className={styles.subscribe}>\r\n            <input\r\n              id=\"subscribe\"\r\n              type=\"checkbox\"\r\n              onChange={() => this.props.onSubscribeChanged()}\r\n              checked={this.props.isSubscribed}\r\n            />\r\n            <label htmlFor=\"subscribe\">\r\n              <FormattedMessage id=\"entry.notify_me\" />\r\n            </label>\r\n          </div>\r\n        )}\r\n\r\n        {this.props.isModal && (\r\n          <button className={styles.enterVrButton} onClick={() => this.props.onClose()}>\r\n            <FormattedMessage id=\"entry.return-to-vr\" />\r\n          </button>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport PropTypes from \"prop-types\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nexport default class InviteTeamDialog extends Component {\r\n  static propTypes = {\r\n    hubChannel: PropTypes.object\r\n  };\r\n\r\n  state = {\r\n    inviteButtonText: \"invite a hubs team member\"\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  inviteClicked = () => {\r\n    this.setState({ inviteButtonText: \"OK! We'll be there shortly.\" });\r\n    this.props.hubChannel.requestSupport();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Let's Chat!\" {...this.props}>\r\n        <div>\r\n          <div>\r\n            <p>Have an idea for Hubs? Having trouble?</p>\r\n            <p>We&apos;d love to chat. Someone from our team will join you in just a few minutes.</p>\r\n          </div>\r\n          <div className=\"invite-team-form\">\r\n            <div className=\"invite-team-form__buttons\">\r\n              <WithHoverSound>\r\n                <button className=\"invite-team-form__action-button\" onClick={this.inviteClicked}>\r\n                  <span>{this.state.inviteButtonText}</span>\r\n                </button>\r\n              </WithHoverSound>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport LinkDialogHeader from \"../assets/images/link_dialog_header.svg\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nimport styles from \"../assets/stylesheets/link-dialog.scss\";\r\n\r\nexport default class LinkDialog extends Component {\r\n  static propTypes = {\r\n    linkCode: PropTypes.string,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  render() {\r\n    const { linkCode } = this.props;\r\n\r\n    return (\r\n      <div className={styles.dialog}>\r\n        <WithHoverSound>\r\n          <div className={styles.close} onClick={() => this.props.onClose()}>\r\n            <span></span>\r\n          </div>\r\n        </WithHoverSound>\r\n        <div>\r\n          {!linkCode && (\r\n            <div>\r\n              <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\r\n                <div className=\"loader-wrap\">\r\n                  <div className=\"loader\">\r\n                    <div className=\"loader-center\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {linkCode && (\r\n            <div className={styles.contents}>\r\n              <img className={styles.imageHeader} src={LinkDialogHeader} />\r\n              <div className={styles.header}>\r\n                <FormattedMessage id=\"link.connect_headset\" />\r\n              </div>\r\n              <div>\r\n                <FormattedMessage id=\"link.in_your_browser\" />\r\n              </div>\r\n              <a\r\n                href={`https://${configs.SHORTLINK_DOMAIN}`}\r\n                className={styles.domain}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                {configs.SHORTLINK_DOMAIN}\r\n              </a>\r\n              <div>\r\n                <FormattedMessage id=\"link.enter_code\" />\r\n              </div>\r\n              {linkCode && (\r\n                <div className={styles.code}>\r\n                  {linkCode.split(\"\").map((d, i) => (\r\n                    <span className={styles.digit} key={`link_code_${i}`}>\r\n                      {d}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              )}\r\n              <div className={styles.keepOpen}>\r\n                <FormattedMessage id=\"link.do_not_close\" />\r\n              </div>\r\n              <WithHoverSound>\r\n                <button className={styles.closeButton} onClick={() => this.props.onClose()}>\r\n                  <FormattedMessage id=\"link.cancel\" />\r\n                </button>\r\n              </WithHoverSound>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport copy from \"copy-to-clipboard\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nexport default class SafariDialog extends Component {\r\n  state = {\r\n    copyLinkButtonText: \"copy\"\r\n  };\r\n\r\n  copyLinkClicked = link => {\r\n    copy(link);\r\n    this.setState({ copyLinkButtonText: \"copied!\" });\r\n  };\r\n\r\n  render() {\r\n    const onCopyClicked = this.copyLinkClicked.bind(this, document.location);\r\n    return (\r\n      <DialogContainer title=\"Open in Safari\" {...this.props}>\r\n        <div>\r\n          <div>\r\n            {messages[\"app-name\"]} does not support your current browser on iOS. Copy and paste this link directly in\r\n            Safari.\r\n          </div>\r\n          <div className=\"invite-form\">\r\n            <input\r\n              type=\"text\"\r\n              readOnly\r\n              onFocus={e => e.target.select()}\r\n              value={document.location}\r\n              className=\"invite-form__link_field\"\r\n            />\r\n            <div className=\"invite-form__buttons\">\r\n              <WithHoverSound>\r\n                <button className=\"invite-form__action-button\" onClick={onCopyClicked}>\r\n                  <span>{this.state.copyLinkButtonText}</span>\r\n                </button>\r\n              </WithHoverSound>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cx from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\n\r\nimport styles from \"../assets/stylesheets/room-settings-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container\";\r\nimport configs from \"../utils/configs\";\r\n\r\nexport default class RoomSettingsDialog extends Component {\r\n  static propTypes = {\r\n    initialSettings: PropTypes.object,\r\n    onChange: PropTypes.func,\r\n    onClose: PropTypes.func,\r\n    showRoomAccessSettings: PropTypes.bool\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = props.initialSettings;\r\n  }\r\n\r\n  onSubmit = e => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.props.onChange(this.state);\r\n    this.props.onClose();\r\n  };\r\n\r\n  onRoomAccessSettingsChange = e =>\r\n    this.setState({\r\n      allow_promotion: e.target.value === \"public\"\r\n    });\r\n\r\n  renderCheckbox(member_permission, disabled, onChange) {\r\n    return (\r\n      <label className={cx(styles.permission, { [styles.permissionDisabled]: disabled })} key={member_permission}>\r\n        <input\r\n          type=\"checkbox\"\r\n          checked={this.state.member_permissions[member_permission]}\r\n          disabled={disabled}\r\n          onChange={\r\n            onChange ||\r\n            (e =>\r\n              this.setState({\r\n                member_permissions: { ...this.state.member_permissions, [member_permission]: e.target.checked }\r\n              }))\r\n          }\r\n        />\r\n        <FormattedMessage id={`room-settings.${member_permission}`} />\r\n      </label>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { showRoomAccessSettings } = this.props;\r\n\r\n    const maxRoomSize = configs.feature(\"max_room_size\");\r\n\r\n    return (\r\n      <DialogContainer title=\"Room Settings\" {...this.props}>\r\n        <form onSubmit={this.onSubmit} className={styles.roomSettingsForm}>\r\n          <span className={styles.subtitle}>\r\n            <FormattedMessage id=\"room-settings.name-subtitle\" />\r\n          </span>\r\n          <input\r\n            name=\"name\"\r\n            type=\"text\"\r\n            required\r\n            autoComplete=\"off\"\r\n            placeholder=\"Room name\"\r\n            value={this.state.name}\r\n            onFocus={e => handleTextFieldFocus(e.target)}\r\n            onBlur={() => handleTextFieldBlur()}\r\n            onChange={e => this.setState({ name: e.target.value })}\r\n            className={styles.nameField}\r\n          />\r\n          <span className={styles.subtitle}>\r\n            <FormattedMessage id=\"room-settings.description-subtitle\" />\r\n          </span>\r\n          <textarea\r\n            name=\"description\"\r\n            rows=\"5\"\r\n            autoComplete=\"off\"\r\n            placeholder=\"Room description\"\r\n            value={this.state.description || \"\"}\r\n            onFocus={e => handleTextFieldFocus(e.target)}\r\n            onBlur={() => handleTextFieldBlur()}\r\n            onChange={e => this.setState({ description: e.target.value })}\r\n            className={styles.descriptionField}\r\n          />\r\n          <span className={styles.subtitle}>\r\n            <FormattedMessage id=\"room-settings.room-size-subtitle\" />\r\n          </span>\r\n          <div className={styles.memberCapContainer}>\r\n            <input\r\n              name=\"room_size\"\r\n              type=\"number\"\r\n              required\r\n              min={0}\r\n              max={maxRoomSize}\r\n              placeholder=\"Member Limit\"\r\n              value={this.state.room_size}\r\n              onFocus={e => handleTextFieldFocus(e.target)}\r\n              onBlur={() => handleTextFieldBlur()}\r\n              onChange={e => this.setState({ room_size: e.target.value })}\r\n              className={styles.nameField}\r\n            />\r\n          </div>\r\n          {showRoomAccessSettings && (\r\n            <>\r\n              <span className={styles.subtitle}>\r\n                <FormattedMessage id=\"room-settings.room-access-subtitle\" />\r\n              </span>\r\n              <div className={styles.selectContainer}>\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"private\"\r\n                    checked={!this.state.allow_promotion}\r\n                    onChange={this.onRoomAccessSettingsChange}\r\n                  />\r\n                  <div>\r\n                    <FormattedMessage id=\"room-settings.access-private\" />\r\n                    <span>\r\n                      <FormattedMessage id=\"room-settings.access-private-subtitle\" />\r\n                    </span>\r\n                  </div>\r\n                </label>\r\n                <label>\r\n                  <input\r\n                    type=\"radio\"\r\n                    value=\"public\"\r\n                    checked={this.state.allow_promotion}\r\n                    onChange={this.onRoomAccessSettingsChange}\r\n                  />\r\n                  <div>\r\n                    <FormattedMessage id=\"room-settings.access-public\" />\r\n                    <span>\r\n                      <FormattedMessage id=\"room-settings.access-public-subtitle\" />\r\n                    </span>\r\n                  </div>\r\n                </label>\r\n              </div>\r\n            </>\r\n          )}\r\n          <span className={styles.subtitle}>\r\n            <FormattedMessage id=\"room-settings.permissions-subtitle\" />\r\n          </span>\r\n          <div className={styles.permissions}>\r\n            {this.renderCheckbox(\"spawn_and_move_media\", false, e => {\r\n              const newMemberPermissions = {\r\n                spawn_and_move_media: e.target.checked\r\n              };\r\n              if (!e.target.checked) {\r\n                newMemberPermissions.spawn_camera = false;\r\n                newMemberPermissions.pin_objects = false;\r\n              }\r\n              this.setState({ member_permissions: { ...this.state.member_permissions, ...newMemberPermissions } });\r\n            })}\r\n            <div className={styles.permissionsGroup}>\r\n              {this.renderCheckbox(\"spawn_camera\", !this.state.member_permissions.spawn_and_move_media)}\r\n              {this.renderCheckbox(\"pin_objects\", !this.state.member_permissions.spawn_and_move_media)}\r\n            </div>\r\n            {this.renderCheckbox(\"spawn_drawing\")}\r\n            {this.renderCheckbox(\"spawn_emoji\")}\r\n          </div>\r\n          <button type=\"submit\" className={styles.nextButton}>\r\n            <FormattedMessage id=\"room-settings.apply\" />\r\n          </button>\r\n        </form>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport styles from \"../assets/stylesheets/close-room-dialog.scss\";\r\nimport DialogContainer from \"./dialog-container\";\r\n\r\nexport default class CloseRoomDialog extends Component {\r\n  static propTypes = {\r\n    onConfirm: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Close Room\" {...this.props}>\r\n        <div className={styles.message}>\r\n          <FormattedMessage id=\"close-room.message\" />\r\n        </div>\r\n        <button\r\n          className={styles.confirmButton}\r\n          onClick={() => {\r\n            this.props.onConfirm();\r\n            this.props.onClose();\r\n          }}\r\n        >\r\n          <FormattedMessage id=\"close-room.confirm\" />\r\n        </button>\r\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\r\n          <FormattedMessage id=\"close-room.cancel\" />\r\n        </button>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import { sets } from \"./userinput/sets\";\r\nimport { paths } from \"./userinput/paths\";\r\n\r\n// The output of this system is activeTips which shows, if any, the tips to show at the top\r\n// and bottom of the screen. There are named tips (eg locomotion) that each have validators.\r\n//\r\n// Each frame we run all the non-finished validators and take the first tip (by order)\r\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\r\n// a local storage reset.\r\n\r\n// Validators can return these values:\r\n//\r\n// INVALID - Tip is not valid to show\r\n// VALID - Tip is valid to show\r\n// FINISH - Tip should always be assumed INVALID going forward\r\n//\r\n//\r\n// Tips have \"scope\", which is a certain context within which the validators are run (right now,\r\n// just the top of bottom of the screen.) They are also platform-local.\r\nconst INVALID = 0;\r\nconst VALID = 1;\r\nconst FINISH = 2;\r\n\r\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\r\n\r\nconst TIPS = {\r\n  desktop: {\r\n    top: [\"pen_mode\", \"video_share_mode\", \"mute_mode\"],\r\n    bottom: [\r\n      \"look\",\r\n      \"locomotion\",\r\n      \"turning\",\r\n      \"spawn_menu\",\r\n      \"object_grab\",\r\n      \"object_zoom\",\r\n      \"object_scale\",\r\n      \"freeze_gesture\",\r\n      \"menu_hover\",\r\n      \"object_rotate_button\",\r\n      \"object_scale_button\",\r\n      \"object_pin\",\r\n      \"invite\",\r\n      \"pen_color\",\r\n      \"pen_size\",\r\n      \"feedback\"\r\n    ]\r\n  },\r\n  mobile: {\r\n    top: [\"pen_mode\", \"video_share_mode\", \"freeze_mode\", \"mute_mode\"],\r\n    bottom: [\r\n      \"look\",\r\n      \"locomotion\",\r\n      \"spawn_menu\",\r\n      \"object_grab\",\r\n      \"freeze_gesture\",\r\n      \"object_rotate_button\",\r\n      \"object_scale_button\",\r\n      \"object_pin\",\r\n      \"invite\",\r\n      \"feedback\"\r\n    ]\r\n  },\r\n  standalone: { top: [], bottom: [] }\r\n};\r\n\r\n// These tips, if closed, will only clear themselves, not all tips.\r\nconst LOCAL_CLOSE_TIPS = [\"feedback\", \"invite\", \"object_pin\"];\r\n\r\n// These tips will remain active even if the user closes the tips globally.\r\nconst KEEP_ACTIVE_AFTER_GLOBAL_CLOSE = [\"freeze_gesture\", \"menu_hover\", \"feedback\"];\r\n\r\nlet localStorageCache = null;\r\nlet finishedScopes = {}; // Optimization, lets system skip scopes altogether once finished.\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\nconst tipPlatform = () => {\r\n  if (isMobileVR) return \"standalone\";\r\n  return isMobile ? \"mobile\" : \"desktop\";\r\n};\r\n\r\nconst platformTips = TIPS[tipPlatform()];\r\n\r\nconst isTipFinished = tip => {\r\n  if (localStorageCache === null) {\r\n    localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\r\n  }\r\n\r\n  return !!(localStorageCache[tip] && localStorageCache[tip].finished);\r\n};\r\n\r\nexport const markTipFinished = tip => {\r\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\r\n  storeData[tip] = { finished: true };\r\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\r\n  localStorageCache = null;\r\n};\r\n\r\nexport const handleTipClose = (fullTip, scope) => {\r\n  const tip = fullTip.split(\".\")[1];\r\n\r\n  // Invite and pinning tips should be locally cleared, others should clear all remaining tips.\r\n  const tips = LOCAL_CLOSE_TIPS.includes(tip) ? [tip] : platformTips[scope];\r\n\r\n  for (let i = 0; i < tips.length; i++) {\r\n    const t = tips[i];\r\n\r\n    if (!KEEP_ACTIVE_AFTER_GLOBAL_CLOSE.includes(t) || t === tip) {\r\n      markTipFinished(t);\r\n    }\r\n  }\r\n};\r\n\r\nexport const resetTips = () => {\r\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\r\n  localStorageCache = null;\r\n  window.APP.store.resetTipActivityFlags();\r\n  window.APP.store.resetConfirmedBroadcastedRooms();\r\n  finishedScopes = {};\r\n};\r\n\r\nconst VALIDATORS = {\r\n  look: function(userinput) {\r\n    if (\r\n      userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n      userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n    )\r\n      return INVALID;\r\n    const cameraDelta = userinput.get(\r\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\r\n    );\r\n    return cameraDelta ? FINISH : VALID;\r\n  },\r\n  locomotion: function(userinput) {\r\n    if (\r\n      userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n      userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n    )\r\n      return INVALID;\r\n    const accel = userinput.get(paths.actions.characterAcceleration);\r\n\r\n    // User moved\r\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\r\n  },\r\n  turning: function(userinput) {\r\n    if (\r\n      userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n      userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n    )\r\n      return INVALID;\r\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\r\n    return VALID;\r\n  },\r\n  spawn_menu: function(userinput, scene, mediaCounter) {\r\n    if (\r\n      userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n      userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n    )\r\n      return INVALID;\r\n    if (mediaCounter.count() === 0) return VALID;\r\n    return FINISH;\r\n  },\r\n  freeze_gesture: function(userinput, scene, mediaCounter) {\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingInteractable)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingInteractable)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (\r\n      scene.is(\"frozen\") &&\r\n      (userinput.activeSets.includes(sets.rightCursorHoveringOnInteractable) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoveringOnInteractable))\r\n    )\r\n      return FINISH;\r\n    return scene.is(\"frozen\") ? INVALID : VALID;\r\n  },\r\n  menu_hover: function(userinput, scene, mediaCounter) {\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (!scene.is(\"frozen\")) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (\r\n      scene.is(\"frozen\") &&\r\n      (userinput.activeSets.includes(sets.rightCursorHoveringOnInteractable) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoveringOnInteractable))\r\n    )\r\n      return FINISH;\r\n    return VALID;\r\n  },\r\n  invite: function(userinput, scene) {\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingCamera)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingInteractable)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingCamera)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingInteractable)) return INVALID;\r\n    return scene.is(\"copresent\") ? FINISH : VALID;\r\n  },\r\n  object_grab: function(userinput, scene, mediaCounter) {\r\n    if (scene.is(\"frozen\")) return INVALID;\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingCamera)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingInteractable)) return FINISH;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingCamera)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingInteractable)) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_rotate_button: function(userinput, scene, mediaCounter, store) {\r\n    if (!scene.is(\"frozen\")) return INVALID;\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (store && store.state.activity.hasRotated) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_scale_button: function(userinput, scene, mediaCounter, store) {\r\n    if (!scene.is(\"frozen\")) return INVALID;\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (store && store.state.activity.hasScaled) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_recenter_button: function(userinput, scene, mediaCounter, store) {\r\n    if (!scene.is(\"frozen\")) return INVALID;\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (store && store.state.activity.hasRecentered) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_pin: function(userinput, scene, mediaCounter, store) {\r\n    if (!scene.is(\"frozen\")) return INVALID;\r\n    if (mediaCounter.count() === 0) return INVALID;\r\n    if (store && store.state.activity.hasPinned) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_zoom: function(userinput, scene) {\r\n    if (scene.is(\"frozen\")) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingCamera)) return INVALID;\r\n    if (\r\n      !(\r\n        userinput.activeSets.includes(sets.rightCursorHoldingInteractable) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoldingInteractable)\r\n      )\r\n    )\r\n      return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingCamera)) return INVALID;\r\n    if (userinput.get(paths.actions.cursor.right.modDelta)) return FINISH;\r\n    if (userinput.get(paths.actions.cursor.left.modDelta)) return FINISH;\r\n    return VALID;\r\n  },\r\n  object_scale: function(userinput, scene) {\r\n    if (scene.is(\"frozen\")) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.rightCursorHoldingCamera)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingPen)) return INVALID;\r\n    if (userinput.activeSets.includes(sets.leftCursorHoldingCamera)) return INVALID;\r\n    if (\r\n      !(\r\n        userinput.activeSets.includes(sets.rightCursorHoldingInteractable) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoldingInteractable)\r\n      )\r\n    )\r\n      return INVALID;\r\n    if (\r\n      userinput.get(paths.actions.cursor.right.scaleGrabbedGrabbable) ||\r\n      userinput.get(paths.actions.cursor.left.scaleGrabbedGrabbable)\r\n    )\r\n      return FINISH;\r\n    return VALID;\r\n  },\r\n  pen_color: function(userinput) {\r\n    if (\r\n      !(\r\n        userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n      )\r\n    )\r\n      return INVALID;\r\n    if (\r\n      userinput.get(paths.actions.cursor.right.penNextColor) ||\r\n      userinput.get(paths.actions.cursor.right.penPrevColor)\r\n    ) {\r\n      return FINISH;\r\n    }\r\n    if (\r\n      userinput.get(paths.actions.cursor.left.penNextColor) ||\r\n      userinput.get(paths.actions.cursor.left.penPrevColor)\r\n    ) {\r\n      return FINISH;\r\n    }\r\n    return VALID;\r\n  },\r\n  pen_size: function(userinput) {\r\n    if (\r\n      !(\r\n        userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n        userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n      )\r\n    )\r\n      return INVALID;\r\n    if (userinput.get(paths.actions.cursor.right.scalePenTip) || userinput.get(paths.actions.cursor.left.scalePenTip))\r\n      return FINISH;\r\n    return VALID;\r\n  },\r\n  pen_mode: function(userinput) {\r\n    if (\r\n      !userinput.activeSets.includes(sets.rightCursorHoldingPen) &&\r\n      !userinput.activeSets.includes(sets.leftCursorHoldingPen)\r\n    )\r\n      return INVALID;\r\n    return VALID;\r\n  },\r\n  freeze_mode: function(userinput, scene) {\r\n    return scene.is(\"frozen\") ? VALID : INVALID;\r\n  },\r\n  video_share_mode: function(userinput, scene) {\r\n    return scene.is(\"sharing_video\") ? VALID : INVALID;\r\n  },\r\n  mute_mode: function(userinput, scene) {\r\n    return scene.is(\"muted\") ? VALID : INVALID;\r\n  },\r\n  feedback: function(/*userinput, scene, mediaCounter, store*/) {\r\n    /*if (configs.feature(\"show_feedback_ui\") && store && store.state.activity.entryCount >= NUM_ENTRIES_FOR_FEEDBACK_TIP)\r\n      return VALID;*/\r\n    return INVALID;\r\n  }\r\n};\r\n\r\nAFRAME.registerSystem(\"tips\", {\r\n  init: function() {\r\n    this.activeTips = {};\r\n    this._finishedScopes = {};\r\n    this._performStep = this._performStep.bind(this);\r\n\r\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\r\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\r\n    }\r\n  },\r\n\r\n  tick: function() {\r\n    if (isMobileVR) return; // Optimization for now, don't bother with this on mobile VR until we have real tips\r\n\r\n    if (!this._userinput) {\r\n      this._userinput = this.el.systems.userinput;\r\n\r\n      if (!this._userinput) return;\r\n    }\r\n\r\n    if (!this._mediaCounter) {\r\n      this._mediaCounter =\r\n        document.querySelector(\"#media-counter\") &&\r\n        document.querySelector(\"#media-counter\").components[\"networked-counter\"];\r\n\r\n      if (!this._mediaCounter) return;\r\n    }\r\n\r\n    const tips = platformTips;\r\n\r\n    const prevTop = this.activeTips.top;\r\n    const prevBottom = this.activeTips.bottom;\r\n\r\n    this._performStep(tips.top, \"top\");\r\n    this._performStep(tips.bottom, \"bottom\");\r\n\r\n    if (prevTop !== this.activeTips.top || prevBottom !== this.activeTips.bottom) {\r\n      this.el.emit(\"tips_changed\", this.activeTips);\r\n    }\r\n  },\r\n\r\n  _performStep: function(tips, scope) {\r\n    if (finishedScopes[scope]) return;\r\n\r\n    let chosenTip = null;\r\n    let finishCount = 0;\r\n\r\n    for (let i = 0; i < tips.length; i++) {\r\n      const tip = tips[i];\r\n      if (isTipFinished(tip)) {\r\n        finishCount++;\r\n        continue;\r\n      }\r\n\r\n      switch (VALIDATORS[tip](this._userinput, this.el, this._mediaCounter, window.APP.store)) {\r\n        case FINISH:\r\n          markTipFinished(tip);\r\n          break;\r\n        case VALID:\r\n          chosenTip = `${tipPlatform()}.${tip}`;\r\n          break;\r\n      }\r\n\r\n      if (chosenTip) break;\r\n    }\r\n\r\n    this.activeTips[scope] = chosenTip;\r\n\r\n    if (finishCount === tips.length) {\r\n      // Optimization: Tips are completed for this scope, no need to re-walk.\r\n      finishedScopes[scope] = true;\r\n    }\r\n  }\r\n});\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport styles from \"../assets/stylesheets/tip.scss\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { handleTipClose } from \"../systems/tips.js\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nexport default class Tip extends Component {\r\n  static propTypes = {\r\n    history: PropTypes.object,\r\n    tip: PropTypes.string,\r\n    tipRegion: PropTypes.string,\r\n    broadcastTarget: PropTypes.string,\r\n    pushHistoryState: PropTypes.func,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  render() {\r\n    const { tip, tipRegion, broadcastTarget, pushHistoryState } = this.props;\r\n    const rootStyles = [styles.tipRoot];\r\n    let tipBody;\r\n\r\n    if ([\".spawn_menu\", \"_button\"].find(x => tip.endsWith(x))) {\r\n      rootStyles.push(styles.tourTipRoot);\r\n      tipBody = (\r\n        <div className={styles.splitTip}>\r\n          <FormattedMessage id={`tips.${tip}-pre`} />\r\n          <div\r\n            className={classNames({\r\n              [styles.splitTipIcon]: true,\r\n              [styles[tip.split(\".\")[1] + \"-icon\"]]: true\r\n            })}\r\n          />\r\n          <FormattedMessage id={`tips.${tip}-post`} />\r\n        </div>\r\n      );\r\n    } else if (tip === \"discord\") {\r\n      tipBody = (\r\n        <div className={styles.tip}>\r\n          <span>{`Chat in this room is being bridged to ${broadcastTarget} on Discord.`}</span>\r\n        </div>\r\n      );\r\n    } else if (tip === \"embed\") {\r\n      tipBody = (\r\n        <div className={styles.tip}>\r\n          <FormattedMessage id=\"embed.presence-warning\" />\r\n        </div>\r\n      );\r\n    } else if (tip.endsWith(\".feedback\")) {\r\n      tipBody = (\r\n        <div className={styles.tip}>\r\n          <FormattedMessage id={`tips.${tip}`} />\r\n          &nbsp;\r\n          <button\r\n            className={styles.tipLink}\r\n            onClick={() => {\r\n              handleTipClose(tip, tipRegion);\r\n              pushHistoryState(\"modal\", \"feedback\");\r\n            }}\r\n          >\r\n            <FormattedMessage id={`tips.${tip}-link`} />\r\n          </button>\r\n        </div>\r\n      );\r\n    } else {\r\n      rootStyles.push(styles.tourTipRoot);\r\n      tipBody = (\r\n        <div className={styles.tip}>\r\n          <FormattedMessage id={`tips.${tip}`} />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className={classNames(rootStyles)}>\r\n        <button\r\n          className={styles.tipCancel}\r\n          onClick={() => (this.props.onClose ? this.props.onClose(tip, tipRegion) : handleTipClose(tip, tipRegion))}\r\n        >\r\n          <i>\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </i>\r\n        </button>\r\n        {tipBody}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\n\r\nexport default class WebRTCScreenshareUnsupportedDialog extends Component {\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Share Screen\" {...this.props}>\r\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n          <p>\r\n            Your browser doesn&apos;t seem to support screen sharing.\r\n            <br />\r\n            To share your screen in ${messages[\"app-name\"]}, you can use Firefox.\r\n          </p>\r\n          <a\r\n            className=\"info-dialog--action-button\"\r\n            target=\"_blank\"\r\n            rel=\"noreferrer noopener\"\r\n            href=\"https://www.mozilla.org/firefox\"\r\n          >\r\n            Download Firefox\r\n          </a>\r\n          <p style={{ fontSize: \"0.8em\" }}>\r\n            You can try&nbsp;\r\n            <a\r\n              href=\"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              testing WebRTC screen sharing\r\n            </a>&nbsp;in your browser.\r\n          </p>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\n\r\nexport default class WebAssemblyUnsupportedDialog extends Component {\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"WebAssembly Unsupported\" {...this.props}>\r\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n          <p>\r\n            Your browser doesn&apos;t seem to support WebAssembly.\r\n            <br />\r\n            Please update or switch to a newer browser.\r\n          </p>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nexport default class WebVRRecommendDialog extends Component {\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Enter in VR\" {...this.props}>\r\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n          <p>To enter with Oculus or SteamVR, you can use Firefox.</p>\r\n          <WithHoverSound>\r\n            <a\r\n              className=\"info-dialog--action-button\"\r\n              href=\"https://www.mozilla.org/firefox\"\r\n              target=\"_blank\"\r\n              rel=\"noreferrer noopener\"\r\n            >\r\n              Download Firefox\r\n            </a>\r\n          </WithHoverSound>\r\n          <p style={{ fontSize: \"0.8em\" }}>\r\n            For a list of browsers with experimental VR support, visit{\" \"}\r\n            <WithHoverSound>\r\n              <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                WebVR Rocks\r\n              </a>\r\n            </WithHoverSound>\r\n          </p>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/feedback-dialog.scss\";\r\n\r\nexport default class FeedbackDialog extends Component {\r\n  render() {\r\n    return (\r\n      <DialogContainer wide={true} title=\"\" {...this.props}>\r\n        <iframe\r\n          className={styles.formFrame}\r\n          src=\"https://docs.google.com/forms/d/e/1FAIpQLSe1C-7hCA1XMT8IL8XBnjlxMAU1JXrwAW8YkbmbBJ4B3pDSsw/viewform?embedded=true\"\r\n          frameBorder=\"0\"\r\n          marginHeight=\"0\"\r\n          marginWidth=\"0\"\r\n        >\r\n          Loading...\r\n        </iframe>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/help-dialog.scss\";\r\nimport configs from \"../utils/configs\";\r\nimport { messages } from \"../utils/i18n\";\r\nimport { resetTips } from \"../systems/tips\";\r\n\r\nexport default class HelpDialog extends Component {\r\n  static propTypes = {\r\n    onClose: PropTypes.func\r\n  };\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Help\" {...this.props}>\r\n        <div className={styles.helpDialog}>\r\n          <div>To get started, you can take a tour.</div>\r\n          <div>\r\n            Or, you can{\" \"}\r\n            <a href={configs.link(\"features\", messages[\"help.docs_url\"])} rel=\"noreferrer noopener\" target=\"_blank\">\r\n              browse the documentation\r\n            </a>.\r\n          </div>\r\n          <button\r\n            className={styles.tourButton}\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              resetTips();\r\n              this.props.onClose();\r\n            }}\r\n          >\r\n            Start Tour\r\n          </button>\r\n          <a\r\n            className={styles.docsLink}\r\n            href={configs.link(\"features\", messages[\"help.docs_url\"])}\r\n            rel=\"noreferrer noopener\"\r\n            target=\"_blank\"\r\n          >\r\n            Browse Documentation\r\n          </a>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/leave-room-dialog.scss\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nexport default class LeaveRoomDialog extends Component {\r\n  static propTypes = {\r\n    messageType: PropTypes.string,\r\n    destinationUrl: PropTypes.string\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <DialogContainer title=\"Leave Room\" {...this.props}>\r\n        <div className={styles.leaveRoom}>\r\n          <div>\r\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.message`} />\r\n          </div>\r\n          <a href={this.props.destinationUrl} rel=\"noopener noreferrer\">\r\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.confirm`} />\r\n          </a>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","export const SORT_ORDER_VIDEO = 0;\r\nexport const SORT_ORDER_AUDIO = 1;\r\nexport const SORT_ORDER_IMAGE = 2;\r\nexport const SORT_ORDER_PDF = 3;\r\nexport const SORT_ORDER_MODEL = 4;\r\nexport const SORT_ORDER_UNIDENTIFIED = 5;\r\n\r\nexport function mediaSortOrder(el) {\r\n  if (el.components[\"media-video\"] && el.components[\"media-video\"].data.contentType.startsWith(\"audio/\")) {\r\n    return SORT_ORDER_AUDIO;\r\n  }\r\n  if (el.components[\"media-video\"]) return SORT_ORDER_VIDEO;\r\n  if (el.components[\"media-image\"]) return SORT_ORDER_IMAGE;\r\n  if (el.components[\"media-pdf\"]) return SORT_ORDER_PDF;\r\n  if (el.components[\"gltf-model-plus\"]) return SORT_ORDER_MODEL;\r\n  return SORT_ORDER_UNIDENTIFIED;\r\n}\r\n\r\nexport function mediaSort(el1, el2) {\r\n  return mediaSortOrder(el1) - mediaSortOrder(el2);\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { rotateInPlaceAroundWorldUp, affixToWorldUp } from \"../utils/three-utils\";\r\nimport PropTypes from \"prop-types\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/client-info-dialog.scss\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { faChevronLeft } from \"@fortawesome/free-solid-svg-icons/faChevronLeft\";\r\nimport { faChevronRight } from \"@fortawesome/free-solid-svg-icons/faChevronRight\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\r\nimport { mediaSort } from \"../utils/media-sorting.js\";\r\n\r\nexport default class ObjectInfoDialog extends Component {\r\n  static propTypes = {\r\n    scene: PropTypes.object,\r\n    el: PropTypes.object,\r\n    pinned: PropTypes.bool,\r\n    src: PropTypes.string,\r\n    onClose: PropTypes.func,\r\n    onPinChanged: PropTypes.func,\r\n    onNavigated: PropTypes.func,\r\n    hubChannel: PropTypes.object\r\n  };\r\n\r\n  state = {\r\n    enableLights: false,\r\n    mediaEntities: []\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.updateMediaEntities = this.updateMediaEntities.bind(this);\r\n    this.navigateNext = this.navigateNext.bind(this);\r\n    this.navigatePrev = this.navigatePrev.bind(this);\r\n    this.navigate = this.navigate.bind(this);\r\n    this.viewingCamera = document.getElementById(\"viewing-camera\");\r\n    this.pin = this.pin.bind(this);\r\n    this.unpin = this.unpin.bind(this);\r\n    this.props.scene.addEventListener(\"uninspect\", this.props.onClose);\r\n    const cameraSystem = this.props.scene.systems[\"hubs-systems\"].cameraSystem;\r\n    this.setState({ enableLights: cameraSystem.enableLights });\r\n    this.updateMediaEntities();\r\n    this.props.scene.addEventListener(\"listed_media_changed\", () => this.updateMediaEntities());\r\n  }\r\n\r\n  updateMediaEntities() {\r\n    const mediaEntities = [...this.props.scene.systems[\"listed-media\"].els];\r\n    mediaEntities.sort(mediaSort);\r\n    this.setState({ mediaEntities });\r\n  }\r\n\r\n  pin() {\r\n    if (!NAF.utils.isMine(this.props.el) && !NAF.utils.takeOwnership(this.props.el)) return;\r\n    this.props.el.setAttribute(\"pinnable\", \"pinned\", true);\r\n    this.props.el.emit(\"pinned\", { el: this.props.el });\r\n    this.props.onPinChanged && this.props.onPinChanged();\r\n  }\r\n\r\n  unpin() {\r\n    if (!NAF.utils.isMine(this.props.el) && !NAF.utils.takeOwnership(this.props.el)) return;\r\n    this.props.el.setAttribute(\"pinnable\", \"pinned\", false);\r\n    this.props.el.emit(\"unpinned\", { el: this.props.el });\r\n    this.props.onPinChanged && this.props.onPinChanged();\r\n  }\r\n\r\n  toggleLights() {\r\n    const cameraSystem = this.props.scene.systems[\"hubs-systems\"].cameraSystem;\r\n    cameraSystem.enableLights = !cameraSystem.enableLights;\r\n    localStorage.setItem(\"show-background-while-inspecting\", cameraSystem.enableLights.toString());\r\n    this.setState({ enableLights: cameraSystem.enableLights });\r\n    if (cameraSystem.enableLights) {\r\n      cameraSystem.showEverythingAsNormal();\r\n    } else {\r\n      cameraSystem.hideEverythingButThisObject(this.props.el.object3D);\r\n    }\r\n  }\r\n\r\n  enqueueWaypointTravel = (function() {\r\n    const targetMatrix = new THREE.Matrix4();\r\n    const translation = new THREE.Matrix4();\r\n    return function enqueueWaypointTravel() {\r\n      this.viewingCamera.object3D.updateMatrices();\r\n      targetMatrix.copy(this.viewingCamera.object3D.matrixWorld);\r\n      affixToWorldUp(targetMatrix, targetMatrix);\r\n      translation.makeTranslation(0, -1.6, 0.15);\r\n      targetMatrix.multiply(translation);\r\n      rotateInPlaceAroundWorldUp(targetMatrix, Math.PI, targetMatrix);\r\n\r\n      this.props.scene.systems[\"hubs-systems\"].characterController.enqueueWaypointTravelTo(targetMatrix, true, {\r\n        willDisableMotion: false,\r\n        willDisableTeleporting: false,\r\n        snapToNavMesh: false,\r\n        willMaintainInitialOrientation: false\r\n      });\r\n      this.props.onClose();\r\n    };\r\n  })().bind(this);\r\n\r\n  navigateNext() {\r\n    this.navigate(1);\r\n  }\r\n\r\n  navigatePrev() {\r\n    this.navigate(-1);\r\n  }\r\n\r\n  navigate(direction) {\r\n    const { mediaEntities } = this.state;\r\n    let targetIndex = (mediaEntities.indexOf(this.props.el) + direction) % mediaEntities.length;\r\n    targetIndex = targetIndex === -1 ? mediaEntities.length - 1 : targetIndex;\r\n    this.props.onNavigated && this.props.onNavigated(mediaEntities[targetIndex]);\r\n  }\r\n\r\n  remove() {\r\n    if (this._isRemoving) return;\r\n    this._isRemoving = true;\r\n\r\n    const targetEl = this.props.el;\r\n\r\n    if (!NAF.utils.isMine(targetEl) && !NAF.utils.takeOwnership(targetEl)) return;\r\n\r\n    targetEl.setAttribute(\"animation__remove\", {\r\n      property: \"scale\",\r\n      dur: 200,\r\n      to: { x: 0.01, y: 0.01, z: 0.01 },\r\n      easing: \"easeInQuad\"\r\n    });\r\n\r\n    targetEl.addEventListener(\"animationcomplete\", () => {\r\n      const exitAfterRemove = this.state.mediaEntities.length <= 1;\r\n      this.props.scene.systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n      NAF.utils.takeOwnership(targetEl);\r\n      targetEl.parentNode.removeChild(targetEl);\r\n\r\n      if (exitAfterRemove) {\r\n        this.props.onClose();\r\n      } else {\r\n        this.navigateNext();\r\n      }\r\n\r\n      this._isRemoving = false;\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { pinned, onClose } = this.props;\r\n    const isStatic = this.props.el.components.tags && this.props.el.components.tags.data.isStatic;\r\n\r\n    return (\r\n      <DialogContainer noOverlay={true} wide={true} {...this.props}>\r\n        <div className={styles.roomInfo}>\r\n          <div className={styles.titleAndClose}>\r\n            <button autoFocus className={entryStyles.collapseButton} onClick={onClose}>\r\n              <i>\r\n                <FontAwesomeIcon icon={faTimes} />\r\n              </i>\r\n            </button>\r\n            <a className={styles.objectDisplayString} href={this.props.src} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              <FormattedMessage id={`object-info.open-link`} />\r\n            </a>\r\n          </div>\r\n          <div className={styles.actionButtonSections}>\r\n            <div className={styles.leftActionButtons}>\r\n              {this.state.mediaEntities.length > 1 && (\r\n                <button className={styles.navigationButton} onClick={this.navigatePrev}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faChevronLeft} />\r\n                  </i>\r\n                </button>\r\n              )}\r\n            </div>\r\n            <div className={styles.primaryActionButtons}>\r\n              <button onClick={this.toggleLights.bind(this)}>\r\n                <FormattedMessage id={`object-info.${this.state.enableLights ? \"lower\" : \"raise\"}-lights`} />\r\n              </button>\r\n              {this.props.scene.is(\"entered\") && (\r\n                <button onClick={this.enqueueWaypointTravel}>\r\n                  <FormattedMessage id=\"object-info.waypoint\" />\r\n                </button>\r\n              )}\r\n              {this.props.scene.is(\"entered\") &&\r\n              !pinned &&\r\n              !isStatic &&\r\n              this.props.hubChannel &&\r\n              this.props.hubChannel.can(\"spawn_and_move_media\") ? (\r\n                <button onClick={this.remove.bind(this)}>\r\n                  <FormattedMessage id=\"object-info.remove-button\" />\r\n                </button>\r\n              ) : (\r\n                <div className={styles.actionButtonPlaceholder} />\r\n              )}\r\n              {this.props.scene.is(\"entered\") &&\r\n                !isStatic &&\r\n                this.props.hubChannel &&\r\n                this.props.hubChannel.can(\"pin_objects\") && (\r\n                  <button className={pinned ? \"\" : styles.primaryActionButton} onClick={pinned ? this.unpin : this.pin}>\r\n                    <FormattedMessage id={`object-info.${pinned ? \"unpin-button\" : \"pin-button\"}`} />\r\n                  </button>\r\n                )}\r\n              <a className={styles.cancelText} href=\"#\" onClick={onClose}>\r\n                <FormattedMessage id=\"client-info.cancel\" />\r\n              </a>\r\n            </div>\r\n            <div className={styles.rightActionButtons}>\r\n              {this.state.mediaEntities.length > 1 && (\r\n                <button className={styles.navigationButton} onClick={this.navigateNext}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faChevronRight} />\r\n                  </i>\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/oauth-dialog.scss\";\r\n\r\nexport default class OAuthDialog extends Component {\r\n  static propTypes = {\r\n    oauthInfo: PropTypes.array\r\n  };\r\n  renderSignInDisclaimer(type) {\r\n    return (\r\n      <div>\r\n        <div>\r\n          You&apos;ll need to sign in to <span className={styles.oauthTypeName}>{type}</span> to access this room.\r\n        </div>\r\n        <br />\r\n        <div>We&apos;ll ask for access to your e-mail address so you can skip signing in next time.</div>\r\n        <p className={styles.privacyNotice}>\r\n          By proceeding, you agree to the{\" \"}\r\n          <IfFeature name=\"show_terms\">\r\n            <a\r\n              rel=\"noopener noreferrer\"\r\n              target=\"_blank\"\r\n              href={configs.link(\"terms_of_use\", \"https://github.com/mozilla/hubs/blob/master/TERMS.md\")}\r\n            >\r\n              terms of use\r\n            </a>{\" \"}\r\n          </IfFeature>\r\n          {configs.feature(\"show_terms\") && configs.feature(\"show_privacy\") && \"and \"}\r\n          <IfFeature name=\"show_privacy\">\r\n            <a\r\n              rel=\"noopener noreferrer\"\r\n              target=\"_blank\"\r\n              href={configs.link(\"privacy_notice\", \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\")}\r\n            >\r\n              privacy notice\r\n            </a>\r\n          </IfFeature>.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderTweetDisclaimer() {\r\n    return (\r\n      <div className={styles.twitterMessage}>\r\n        <FormattedMessage id=\"oauth-dialog.message.twitter\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const info = this.props.oauthInfo && this.props.oauthInfo[0];\r\n    const closable = info && info.type === \"twitter\"; // NOTE: for now, allow closing dialog if doing Twitter sign in (currently just for sharing)\r\n\r\n    return (\r\n      <DialogContainer title=\"\" closable={closable} {...this.props}>\r\n        <div>\r\n          {info && (info.type === \"twitter\" ? this.renderTweetDisclaimer() : this.renderSignInDisclaimer(info.type))}\r\n          <div className=\"invite-form\">\r\n            <div className={`invite-form__buttons ${styles.oauthButtons}`}>\r\n              {info ? (\r\n                <a\r\n                  href={info.url}\r\n                  key={info.type}\r\n                  className={classNames({\r\n                    [styles.oauthButton]: true,\r\n                    [styles.oauthTwitterButton]: info.type === \"twitter\",\r\n                    [styles.oauthDiscordButton]: info.type === \"discord\"\r\n                  })}\r\n                >\r\n                  <FormattedMessage id={`oauth-dialog.sign-in.${info.type}`} />\r\n                </a>\r\n              ) : (\r\n                <div className=\"loader-wrap loader-mid\">\r\n                  <div className=\"loader\">\r\n                    <div className=\"loader-center\" />\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport DialogContainer from \"./dialog-container.js\";\r\nimport styles from \"../assets/stylesheets/tweet-dialog.scss\";\r\nimport Editor, { createEditorStateWithText } from \"draft-js-plugins-editor\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\r\nimport createEmojiPlugin from \"draft-js-emoji-plugin\";\r\nimport createHashtagPlugin from \"draft-js-hashtag-plugin\";\r\nimport createLinkifyPlugin from \"draft-js-linkify-plugin\";\r\nimport createCounterPlugin from \"draft-js-counter-plugin\";\r\nimport classNames from \"classnames\";\r\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\r\nimport { Modifier, EditorState } from \"draft-js\";\r\nimport \"draft-js-emoji-plugin/lib/plugin.css\";\r\nimport \"draft-js-hashtag-plugin/lib/plugin.css\";\r\nimport \"draft-js-linkify-plugin/lib/plugin.css\";\r\nimport \"draft-js-counter-plugin/lib/plugin.css\";\r\n\r\nconst emojiPlugin = createEmojiPlugin();\r\nconst hashtagPlugin = createHashtagPlugin();\r\nconst linkifyPlugin = createLinkifyPlugin();\r\nconst counterPlugin = createCounterPlugin();\r\n\r\n// Taken from draft-js-emoji\r\nconst addEmoji = (emoji, editorState) => {\r\n  const contentState = editorState.getCurrentContent();\r\n  const contentStateWithEntity = contentState.createEntity(\"emoji\", \"IMMUTABLE\", { emojiUnicode: emoji });\r\n  const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\r\n  const currentSelectionState = editorState.getSelection();\r\n\r\n  let emojiAddedContent;\r\n  let emojiEndPos = 0;\r\n  let blockSize = 0;\r\n\r\n  // in case text is selected it is removed and then the emoji is added\r\n  const afterRemovalContentState = Modifier.removeRange(contentState, currentSelectionState, \"backward\");\r\n\r\n  // deciding on the position to insert emoji\r\n  const targetSelection = afterRemovalContentState.getSelectionAfter();\r\n\r\n  emojiAddedContent = Modifier.insertText(afterRemovalContentState, targetSelection, emoji, null, entityKey);\r\n\r\n  emojiEndPos = targetSelection.getAnchorOffset();\r\n  const blockKey = targetSelection.getAnchorKey();\r\n  blockSize = contentState.getBlockForKey(blockKey).getLength();\r\n\r\n  // If the emoji is inserted at the end, a space is appended right after for\r\n  // a smooth writing experience.\r\n  if (emojiEndPos === blockSize) {\r\n    emojiAddedContent = Modifier.insertText(emojiAddedContent, emojiAddedContent.getSelectionAfter(), \" \");\r\n  }\r\n\r\n  const newEditorState = EditorState.push(editorState, emojiAddedContent, \"insert-emoji\");\r\n  return EditorState.forceSelection(newEditorState, emojiAddedContent.getSelectionAfter());\r\n};\r\n\r\nexport default class TweetDialog extends Component {\r\n  static propTypes = {\r\n    history: PropTypes.object,\r\n    onClose: PropTypes.func\r\n  };\r\n\r\n  constructor(props) {\r\n    super();\r\n\r\n    this.state = {\r\n      editorState: createEditorStateWithText(props.history.location.state.detail.text || \"\"),\r\n      suggestions: []\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Calling this immediately seems to break editor initialization\r\n    setTimeout(() => {\r\n      this.editorRef.focus();\r\n\r\n      // Other attempts at doing this resulted in no visible cursor or weird editor behavior:\r\n      this.setState({ editorState: addEmoji(\"\", this.state.editorState) });\r\n    });\r\n  }\r\n\r\n  async sendTweet() {\r\n    // For now assume url is a stored file media url\r\n    const media_stored_file_url = this.props.history.location.state.detail.url;\r\n    const body = this.state.editorState.getCurrentContent().getPlainText();\r\n\r\n    const payload = { media_stored_file_url, body };\r\n    this.setState({ posting: true });\r\n    await fetchReticulumAuthenticated(\"/api/v1/twitter/tweets\", \"POST\", payload);\r\n    this.setState({ posting: false, posted: true });\r\n  }\r\n\r\n  renderPostedDialog() {\r\n    return (\r\n      <DialogContainer wide={true} allowOverflow={true} closable={false} title=\"\" {...this.props}>\r\n        <div className={styles.posted}>\r\n          <div className={styles.message}>\r\n            <FormattedMessage id=\"tweet-dialog.posted\" />\r\n          </div>\r\n\r\n          <div className={styles.buttons}>\r\n            <button className={styles.tweetButton} onClick={() => this.props.onClose()}>\r\n              <FormattedMessage id=\"tweet-dialog.close\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n\r\n  renderTweetDialog() {\r\n    const { EmojiSuggestions, EmojiSelect } = emojiPlugin;\r\n    const { CharCounter } = counterPlugin;\r\n    const { url, contentSubtype } = this.props.history.location.state.detail;\r\n\r\n    return (\r\n      <DialogContainer\r\n        wide={true}\r\n        allowOverflow={true}\r\n        title=\"\"\r\n        additionalClass={styles.dialogBackground}\r\n        {...this.props}\r\n      >\r\n        <div className={styles.tweet}>\r\n          <div className={styles.editor} onClick={() => this.editorRef.focus()}>\r\n            <div className={styles.editorInner}>\r\n              <Editor\r\n                ref={r => (this.editorRef = r)}\r\n                editorState={this.state.editorState}\r\n                onChange={editorState => this.setState({ editorState })}\r\n                plugins={[emojiPlugin, hashtagPlugin, linkifyPlugin, counterPlugin]}\r\n              />\r\n            </div>\r\n\r\n            <div className={styles.emojiButton}>\r\n              <EmojiSelect />\r\n            </div>\r\n\r\n            <div className={styles.emojiSuggestions}>\r\n              <EmojiSuggestions />\r\n            </div>\r\n\r\n            {this.state.editorState.getCurrentContent().getPlainText().length > 200 && (\r\n              <div className={styles.counter}>\r\n                <CharCounter editorState={this.state.editorState} limit={280} /> / 280\r\n              </div>\r\n            )}\r\n\r\n            <div className={styles.media}>\r\n              {contentSubtype && contentSubtype.startsWith(\"video\") ? (\r\n                <video src={url} width={450} height={255} controls />\r\n              ) : (\r\n                <img src={scaledThumbnailUrlFor(url, 450, 255)} />\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {!this.state.posting ? (\r\n            <div className={styles.buttons}>\r\n              <button\r\n                className={styles.tweetButton}\r\n                onClick={() => this.sendTweet()}\r\n                disabled={this.state.editorState.getCurrentContent().getPlainText().length > 280}\r\n              >\r\n                <FormattedMessage id=\"tweet-dialog.tweet\" />\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div className={classNames([\"loader-wrap\", \"loader-mid\", styles.tweetLoader])}>\r\n              <div className=\"loader\">\r\n                <div className=\"loader-center\" />\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </DialogContainer>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    if (this.state.posted) {\r\n      return this.renderPostedDialog();\r\n    } else {\r\n      return this.renderTweetDialog();\r\n    }\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport styles from \"../assets/stylesheets/message-entry.scss\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport sendMessageIcon from \"../assets/images/send_message.svgi\";\r\nimport { InlineSVGButton } from \"./svgi\";\r\n\r\nclass LobbyChatBox extends Component {\r\n  static propTypes = {\r\n    discordBridges: PropTypes.array,\r\n    occupantCount: PropTypes.number,\r\n    onSendMessage: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    pendingMessage: \"\"\r\n  };\r\n\r\n  sendMessage = e => {\r\n    e.preventDefault();\r\n    if (this.props.onSendMessage) {\r\n      this.props.onSendMessage(this.state.pendingMessage);\r\n    }\r\n    this.setState({ pendingMessage: \"\" });\r\n  };\r\n\r\n  render() {\r\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\r\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\r\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\r\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\r\n    const occupantSnippet = `${this.props.occupantCount - 1} other${this.props.occupantCount > 2 ? \"s\" : \"\"}`;\r\n    const messageEntryPlaceholder =\r\n      this.props.occupantCount <= 1\r\n        ? \"Nobody is here yet...\"\r\n        : this.props.discordBridges.length\r\n          ? `Send message to ${occupantSnippet} and ${discordSnippet}...`\r\n          : `Send message to ${occupantSnippet}...`;\r\n\r\n    return (\r\n      <form onSubmit={this.sendMessage}>\r\n        <div\r\n          className={classNames({\r\n            [styles.messageEntry]: true,\r\n            [styles.messageEntryDisabled]: this.props.occupantCount <= 1\r\n          })}\r\n          style={{ height: pendingMessageFieldHeight }}\r\n        >\r\n          <textarea\r\n            className={classNames([styles.messageEntryInput, \"chat-focus-target\"])}\r\n            value={this.state.pendingMessage}\r\n            rows={textRows}\r\n            style={{ height: pendingMessageTextareaHeight }}\r\n            onFocus={e => handleTextFieldFocus(e.target)}\r\n            onBlur={() => handleTextFieldBlur()}\r\n            onChange={e => this.setState({ pendingMessage: e.target.value })}\r\n            disabled={this.props.occupantCount <= 1 ? true : false}\r\n            onKeyDown={e => {\r\n              if (e.key === \"Enter\" && !e.shiftKey) {\r\n                this.sendMessage(e);\r\n              } else if (e.key === \"Escape\") {\r\n                e.target.blur();\r\n              }\r\n            }}\r\n            placeholder={messageEntryPlaceholder}\r\n          />\r\n          <WithHoverSound>\r\n            <InlineSVGButton\r\n              className={classNames([styles.messageEntryButton, styles.messageEntrySubmit])}\r\n              disabled={this.props.occupantCount <= 1 ? true : false}\r\n              type=\"submit\"\r\n              src={sendMessageIcon}\r\n            />\r\n          </WithHoverSound>\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default LobbyChatBox;\r\n","import { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\n// this component is currently just being used for its componentDidMount\r\n// TODO migrate render from ui-root.js renderEntryStartPanel()\r\nexport default class EntryStartPanel extends Component {\r\n  static propTypes = {\r\n    entering: PropTypes.bool,\r\n    onEnteringCanceled: PropTypes.func\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.props.entering) {\r\n      this.props.onEnteringCanceled();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return null;\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/chat-command-help.scss\";\r\nimport classNames from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\nexport default class ChatCommandHelp extends Component {\r\n  static propTypes = {\r\n    matchingPrefix: PropTypes.string,\r\n    onTop: PropTypes.bool\r\n  };\r\n\r\n  render() {\r\n    const commands = [\r\n      \"leave\",\r\n      \"fly\",\r\n      \"grow\",\r\n      \"shrink\",\r\n      \"duck\",\r\n      \"debug\",\r\n      \"vrstats\",\r\n      \"scene <scene url>\",\r\n      \"rename <new name>\"\r\n    ];\r\n\r\n    if (qsTruthy(\"video_capture\")) {\r\n      commands.push(\"capture [stop]\");\r\n    }\r\n\r\n    return (\r\n      <div className={classNames({ [styles.commandHelp]: true, [styles.commandHelpOnTop]: this.props.onTop })}>\r\n        {commands.map(\r\n          c =>\r\n            (this.props.matchingPrefix === \"\" ||\r\n              c.split(\" \")[0].startsWith(this.props.matchingPrefix.split(\" \")[0])) && (\r\n              <div className={styles.entry} key={c}>\r\n                <div className={styles.command}>/{c}</div>\r\n                <div>\r\n                  <FormattedMessage id={`commands.${c.split(\" \")[0]}`} />\r\n                </div>\r\n              </div>\r\n            )\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","// https://stackoverflow.com/questions/6209161/extract-the-current-dom-and-print-it-as-a-string-with-styles-intact\r\n//\r\n// Mapping between tag names and css default values lookup tables. This allows to exclude default values in the result.\r\nconst defaultStylesByTagName = {};\r\n\r\n// Styles inherited from style sheets will not be rendered for elements with these tag names\r\nconst noStyleTags = {\r\n  BASE: true,\r\n  HEAD: true,\r\n  HTML: true,\r\n  META: true,\r\n  NOFRAME: true,\r\n  NOSCRIPT: true,\r\n  PARAM: true,\r\n  SCRIPT: true,\r\n  STYLE: true,\r\n  TITLE: true\r\n};\r\n\r\n// This list determines which css default values lookup tables are precomputed at load time\r\n// Lookup tables for other tag names will be automatically built at runtime if needed\r\nconst tagNames = [\r\n  \"A\",\r\n  \"ABBR\",\r\n  \"ADDRESS\",\r\n  \"AREA\",\r\n  \"ARTICLE\",\r\n  \"ASIDE\",\r\n  \"AUDIO\",\r\n  \"B\",\r\n  \"BASE\",\r\n  \"BDI\",\r\n  \"BDO\",\r\n  \"BLOCKQUOTE\",\r\n  \"BODY\",\r\n  \"BR\",\r\n  \"BUTTON\",\r\n  \"CANVAS\",\r\n  \"CAPTION\",\r\n  \"CENTER\",\r\n  \"CITE\",\r\n  \"CODE\",\r\n  \"COL\",\r\n  \"COLGROUP\",\r\n  \"COMMAND\",\r\n  \"DATALIST\",\r\n  \"DD\",\r\n  \"DEL\",\r\n  \"DETAILS\",\r\n  \"DFN\",\r\n  \"DIV\",\r\n  \"DL\",\r\n  \"DT\",\r\n  \"EM\",\r\n  \"EMBED\",\r\n  \"FIELDSET\",\r\n  \"FIGCAPTION\",\r\n  \"FIGURE\",\r\n  \"FONT\",\r\n  \"FOOTER\",\r\n  \"FORM\",\r\n  \"H1\",\r\n  \"H2\",\r\n  \"H3\",\r\n  \"H4\",\r\n  \"H5\",\r\n  \"H6\",\r\n  \"HEAD\",\r\n  \"HEADER\",\r\n  \"HGROUP\",\r\n  \"HR\",\r\n  \"HTML\",\r\n  \"I\",\r\n  \"IFRAME\",\r\n  \"IMG\",\r\n  \"INPUT\",\r\n  \"INS\",\r\n  \"KBD\",\r\n  \"KEYGEN\",\r\n  \"LABEL\",\r\n  \"LEGEND\",\r\n  \"LI\",\r\n  \"LINK\",\r\n  \"MAP\",\r\n  \"MARK\",\r\n  \"MATH\",\r\n  \"MENU\",\r\n  \"META\",\r\n  \"METER\",\r\n  \"NAV\",\r\n  \"NOBR\",\r\n  \"NOSCRIPT\",\r\n  \"OBJECT\",\r\n  \"OL\",\r\n  \"OPTION\",\r\n  \"OPTGROUP\",\r\n  \"OUTPUT\",\r\n  \"P\",\r\n  \"PARAM\",\r\n  \"PRE\",\r\n  \"PROGRESS\",\r\n  \"Q\",\r\n  \"RP\",\r\n  \"RT\",\r\n  \"RUBY\",\r\n  \"S\",\r\n  \"SAMP\",\r\n  \"SCRIPT\",\r\n  \"SECTION\",\r\n  \"SELECT\",\r\n  \"SMALL\",\r\n  \"SOURCE\",\r\n  \"SPAN\",\r\n  \"STRONG\",\r\n  \"STYLE\",\r\n  \"SUB\",\r\n  \"SUMMARY\",\r\n  \"SUP\",\r\n  \"SVG\",\r\n  \"TABLE\",\r\n  \"TBODY\",\r\n  \"TD\",\r\n  \"TEXTAREA\",\r\n  \"TFOOT\",\r\n  \"TH\",\r\n  \"THEAD\",\r\n  \"TIME\",\r\n  \"TITLE\",\r\n  \"TR\",\r\n  \"TRACK\",\r\n  \"U\",\r\n  \"UL\",\r\n  \"VAR\",\r\n  \"VIDEO\",\r\n  \"WBR\"\r\n];\r\n\r\nfunction computeDefaultStyleByTagName(tagName) {\r\n  const defaultStyle = {};\r\n  const element = document.body.appendChild(document.createElement(tagName));\r\n  const computedStyle = getComputedStyle(element);\r\n  for (let i = 0; i < computedStyle.length; i++) {\r\n    defaultStyle[computedStyle[i]] = computedStyle[computedStyle[i]];\r\n  }\r\n  document.body.removeChild(element);\r\n  return defaultStyle;\r\n}\r\n\r\nfunction getDefaultStyleByTagName(tagName) {\r\n  tagName = tagName.toUpperCase();\r\n  if (!defaultStylesByTagName[tagName]) {\r\n    defaultStylesByTagName[tagName] = computeDefaultStyleByTagName(tagName);\r\n  }\r\n  return defaultStylesByTagName[tagName];\r\n}\r\n\r\nexport function warmSerializeElement() {\r\n  for (let i = 0; i < tagNames.length; i++) {\r\n    if (!noStyleTags[tagNames[i]]) {\r\n      defaultStylesByTagName[tagNames[i]] = computeDefaultStyleByTagName(tagNames[i]);\r\n    }\r\n  }\r\n}\r\n\r\nexport default function serializeElement(el) {\r\n  if (Object.keys(defaultStylesByTagName).length === 0) {\r\n    // Precompute the lookup tables.\r\n    warmSerializeElement();\r\n  }\r\n\r\n  if (el.nodeType !== Node.ELEMENT_NODE) {\r\n    throw new TypeError();\r\n  }\r\n  const cssTexts = [];\r\n  const elements = el.querySelectorAll(\"*\");\r\n  for (let i = 0; i < elements.length; i++) {\r\n    const e = elements[i];\r\n    if (!noStyleTags[e.tagName]) {\r\n      const computedStyle = getComputedStyle(e);\r\n      const defaultStyle = getDefaultStyleByTagName(e.tagName);\r\n      cssTexts[i] = e.style.cssText;\r\n      for (let ii = 0; ii < computedStyle.length; ii++) {\r\n        const cssPropName = computedStyle[ii];\r\n\r\n        // Skip non-standard CSS for now, because it overwrites things like color\r\n        if (cssPropName.startsWith(\"-webkit\")) continue;\r\n\r\n        if (computedStyle[cssPropName] !== defaultStyle[cssPropName]) {\r\n          e.style[cssPropName] = computedStyle[cssPropName];\r\n        }\r\n      }\r\n    }\r\n  }\r\n  const result = el.outerHTML;\r\n  for (let i = 0; i < elements.length; i++) {\r\n    elements[i].style.cssText = cssTexts[i];\r\n  }\r\n  return result;\r\n}\r\n","import configs from \"../utils/configs\";\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\n\r\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\r\nimport styles from \"../assets/stylesheets/presence-list.scss\";\r\nimport maskEmail from \"../utils/mask-email\";\r\nimport StateLink from \"./state-link.js\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\r\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\r\nimport { faDesktop } from \"@fortawesome/free-solid-svg-icons/faDesktop\";\r\nimport { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\r\nimport discordIcon from \"../assets/images/discord.svgi\";\r\nimport hmdIcon from \"../assets/images/hmd-icon.svgi\";\r\nimport { faMobileAlt } from \"@fortawesome/free-solid-svg-icons/faMobileAlt\";\r\nimport { pushHistoryPath, withSlug } from \"../utils/history\";\r\nimport { hasReticulumServer } from \"../utils/phoenix-utils\";\r\nimport { InlineSVG } from \"./svgi\";\r\n\r\nfunction getPresenceIcon(ctx) {\r\n  if (ctx && ctx.hmd) {\r\n    return <InlineSVG src={hmdIcon} />;\r\n  } else if (ctx && ctx.mobile) {\r\n    return <FontAwesomeIcon icon={faMobileAlt} />;\r\n  } else if (ctx && ctx.discord) {\r\n    return <InlineSVG src={discordIcon} />;\r\n  } else {\r\n    return <FontAwesomeIcon icon={faDesktop} />;\r\n  }\r\n}\r\n\r\nexport function navigateToClientInfo(history, clientId) {\r\n  const currentParams = new URLSearchParams(history.location.search);\r\n\r\n  if (hasReticulumServer() && document.location.host !== configs.RETICULUM_SERVER) {\r\n    currentParams.set(\"client_id\", clientId);\r\n    pushHistoryPath(history, history.location.pathname, currentParams.toString());\r\n  } else {\r\n    pushHistoryPath(history, withSlug(history.location, `/clients/${clientId}`), currentParams.toString());\r\n  }\r\n}\r\n\r\nexport default class PresenceList extends Component {\r\n  static propTypes = {\r\n    presences: PropTypes.object,\r\n    history: PropTypes.object,\r\n    sessionId: PropTypes.string,\r\n    signedIn: PropTypes.bool,\r\n    email: PropTypes.string,\r\n    onSignIn: PropTypes.func,\r\n    onSignOut: PropTypes.func,\r\n    expanded: PropTypes.bool,\r\n    onExpand: PropTypes.func\r\n  };\r\n\r\n  navigateToClientInfo = clientId => {\r\n    navigateToClientInfo(this.props.history, clientId);\r\n  };\r\n\r\n  domForPresence = ([sessionId, data]) => {\r\n    const meta = data.metas[data.metas.length - 1];\r\n    const context = meta.context;\r\n    const profile = meta.profile;\r\n    const recording = meta.streaming || meta.recording;\r\n    const icon = recording ? <FontAwesomeIcon icon={faVideo} /> : getPresenceIcon(context);\r\n    const isBot = context && context.discord;\r\n    const isEntering = context && context.entering;\r\n    const isOwner = meta.roles && meta.roles.owner;\r\n    const messageId = isEntering ? \"presence.entering\" : `presence.in_${meta.presence}`;\r\n    const badge = isOwner && (\r\n      <span className={styles.moderatorBadge} title=\"Moderator\">\r\n        &#x2605;\r\n      </span>\r\n    );\r\n\r\n    return (\r\n      <WithHoverSound key={sessionId}>\r\n        <div className={styles.row}>\r\n          <div className={styles.icon}>\r\n            <i>{icon}</i>\r\n          </div>\r\n          <div\r\n            className={classNames({\r\n              [styles.listItem]: true\r\n            })}\r\n          >\r\n            {sessionId === this.props.sessionId ? (\r\n              <StateLink className={styles.self} stateKey=\"overlay\" stateValue=\"profile\" history={this.props.history}>\r\n                {profile && profile.displayName}\r\n                {badge}\r\n                <i>\r\n                  <FontAwesomeIcon icon={faPencilAlt} />\r\n                </i>\r\n              </StateLink>\r\n            ) : (\r\n              <div>\r\n                {!isBot ? (\r\n                  <button className={styles.clientLink} onClick={() => this.navigateToClientInfo(sessionId)}>\r\n                    {profile && profile.displayName}\r\n                  </button>\r\n                ) : (\r\n                  <span>{profile && profile.displayName}</span>\r\n                )}\r\n                {badge}\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div className={styles.presence}>\r\n            <FormattedMessage id={messageId} />\r\n          </div>\r\n        </div>\r\n      </WithHoverSound>\r\n    );\r\n  };\r\n\r\n  componentDidMount() {\r\n    document.querySelector(\".a-canvas\").addEventListener(\r\n      \"mouseup\",\r\n      () => {\r\n        this.props.onExpand(false);\r\n      },\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  renderExpandedList() {\r\n    return (\r\n      <div className={styles.presenceList}>\r\n        <div className={styles.attachPoint} />\r\n        <div className={styles.contents}>\r\n          <div className={styles.rows}>\r\n            {Object.entries(this.props.presences || {})\r\n              .filter(([k]) => k === this.props.sessionId)\r\n              .map(this.domForPresence)}\r\n            {Object.entries(this.props.presences || {})\r\n              .filter(([k]) => k !== this.props.sessionId)\r\n              .map(this.domForPresence)}\r\n          </div>\r\n          <div className={styles.signIn}>\r\n            {this.props.signedIn ? (\r\n              <div>\r\n                <span>\r\n                  <FormattedMessage id=\"sign-in.as\" /> {maskEmail(this.props.email)}\r\n                </span>{\" \"}\r\n                <a onClick={this.props.onSignOut}>\r\n                  <FormattedMessage id=\"sign-in.out\" />\r\n                </a>\r\n              </div>\r\n            ) : (\r\n              <a onClick={this.props.onSignIn}>\r\n                <FormattedMessage id=\"sign-in.in\" />\r\n              </a>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const occupantCount = this.props.presences ? Object.entries(this.props.presences).length : 0;\r\n    return (\r\n      <div>\r\n        <div\r\n          title={\"Members\"}\r\n          onClick={() => {\r\n            this.props.onExpand(!this.props.expanded);\r\n          }}\r\n          className={classNames({\r\n            [rootStyles.presenceInfo]: true,\r\n            [rootStyles.presenceInfoSelected]: this.props.expanded\r\n          })}\r\n        >\r\n          <FontAwesomeIcon icon={faUsers} />\r\n          <span className={rootStyles.occupantCount}>{occupantCount}</span>\r\n        </div>\r\n        {this.props.expanded && this.renderExpandedList()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/presence-log.scss\";\r\nimport classNames from \"classnames\";\r\nimport Linkify from \"react-linkify\";\r\nimport { toArray as toEmojis } from \"react-emoji-render\";\r\nimport serializeElement from \"../utils/serialize-element\";\r\nimport { navigateToClientInfo } from \"./presence-list\";\r\nimport { coerceToUrl } from \"../utils/media-utils\";\r\n\r\nconst messageCanvas = document.createElement(\"canvas\");\r\n\r\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\r\nconst textureLoader = new THREE.TextureLoader();\r\n\r\nconst CHAT_MESSAGE_TEXTURE_SIZE = 1024;\r\n\r\n// Hacky word wrapping, needed because the SVG conversion doesn't properly deal\r\n// with wrapping in Firefox for some reason. (The CSS white-space is set to pre)\r\nconst wordWrap = body => {\r\n  const maxCharsPerLine = 40;\r\n  const words = body.split(\" \");\r\n  const outWords = [];\r\n  let c = 0;\r\n\r\n  for (let i = 0; i < words.length; i++) {\r\n    const word = words[i];\r\n\r\n    if (word.startsWith(\":\") && word.endsWith(\":\")) {\r\n      c++;\r\n    } else {\r\n      c += word.length;\r\n    }\r\n\r\n    outWords.push(word);\r\n\r\n    if (c >= maxCharsPerLine) {\r\n      c = 0;\r\n      outWords.push(\"\\n\");\r\n    }\r\n  }\r\n\r\n  return outWords.join(\" \");\r\n};\r\n\r\nconst messageBodyDom = (body, from, fromSessionId, includeFromLink, history) => {\r\n  // Support wrapping text in ` to get monospace, and multiline.\r\n  const multiLine = body.split(\"\\n\").length > 1;\r\n  const wrapStyle = multiLine ? styles.messageWrapMulti : styles.messageWrap;\r\n  const mono = body.startsWith(\"`\") && body.endsWith(\"`\");\r\n  const messageBodyClasses = {\r\n    [styles.messageBody]: true,\r\n    [styles.messageBodyMulti]: multiLine,\r\n    [styles.messageBodyMono]: mono\r\n  };\r\n  const includeClientLink = includeFromLink && fromSessionId && history && NAF.clientId !== fromSessionId;\r\n  const onFromClick = includeClientLink ? () => navigateToClientInfo(history, fromSessionId) : () => {};\r\n\r\n  if (!multiLine) {\r\n    body = wordWrap(body);\r\n  }\r\n\r\n  const cleanedBody = (mono ? body.substring(1, body.length - 1) : body).trim();\r\n\r\n  return (\r\n    <div className={wrapStyle}>\r\n      {from && (\r\n        <div\r\n          onClick={onFromClick}\r\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\r\n        >\r\n          {from}:\r\n        </div>\r\n      )}\r\n      <div className={classNames(messageBodyClasses)}>\r\n        <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>{toEmojis(cleanedBody)}</Linkify>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nfunction renderChatMessage(body, from, allowEmojiRender) {\r\n  const isOneLine = body.split(\"\\n\").length === 1;\r\n  const context = messageCanvas.getContext(\"2d\");\r\n  const emoji = toEmojis(body);\r\n  const isEmoji =\r\n    allowEmojiRender &&\r\n    emoji.length === 1 &&\r\n    emoji[0].props &&\r\n    emoji[0].props.children.match &&\r\n    emoji[0].props.children.match(emojiRegex);\r\n\r\n  const el = document.createElement(\"div\");\r\n  el.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\r\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\r\n\r\n  // The element is added to the DOM in order to have layout compute the width & height,\r\n  // and then it is removed after being rendered.\r\n  document.body.appendChild(el);\r\n\r\n  const entryDom = (\r\n    <div\r\n      className={classNames({\r\n        [styles.presenceLogEntry]: !isEmoji,\r\n        [styles.presenceLogEntryOneLine]: !isEmoji && isOneLine,\r\n        [styles.presenceLogEmoji]: isEmoji\r\n      })}\r\n    >\r\n      {messageBodyDom(body, from)}\r\n    </div>\r\n  );\r\n\r\n  return new Promise(resolve => {\r\n    ReactDOM.render(entryDom, el, () => {\r\n      const width = el.offsetWidth;\r\n      const height = el.offsetHeight;\r\n      const ratio = height / width;\r\n      const scale = (CHAT_MESSAGE_TEXTURE_SIZE * Math.min(1.0, 1.0 / ratio)) / el.offsetWidth;\r\n      messageCanvas.width = width * scale;\r\n      messageCanvas.height = height * scale;\r\n\r\n      const xhtml = encodeURIComponent(`\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${messageCanvas.width}px\" height=\"${messageCanvas.height}px\">\r\n            <foreignObject width=\"100%\" height=\"100%\" style=\"transform: scale(${scale});\">\r\n              ${serializeElement(el)}\r\n            </foreignObject>\r\n          </svg>\r\n    `);\r\n      const img = new Image();\r\n\r\n      img.onload = () => {\r\n        context.drawImage(img, 0, 0);\r\n        ReactDOM.unmountComponentAtNode(el);\r\n        el.remove();\r\n        img.onload = null;\r\n        img.src = \"\";\r\n        messageCanvas.toBlob(blob => resolve([blob, width, height]));\r\n      };\r\n\r\n      img.src = \"data:image/svg+xml,\" + xhtml;\r\n    });\r\n  });\r\n}\r\n\r\nexport async function createInWorldLogMessage({ name, type, body }) {\r\n  if (type !== \"chat\") return;\r\n\r\n  const [blob, width, height] = await renderChatMessage(body, name, false);\r\n  const entity = document.createElement(\"a-entity\");\r\n  const meshEntity = document.createElement(\"a-entity\");\r\n\r\n  document.querySelector(\"a-scene\").appendChild(entity);\r\n\r\n  entity.appendChild(meshEntity);\r\n  entity.setAttribute(\"class\", \"ui\");\r\n  entity.setAttribute(\"is-remote-hover-target\", {});\r\n  entity.setAttribute(\"follow-in-fov\", {\r\n    target: \"#avatar-pov-node\",\r\n    offset: { x: 0, y: 0.0, z: -0.8 }\r\n  });\r\n\r\n  const blobUrl = URL.createObjectURL(blob);\r\n\r\n  meshEntity.setAttribute(\"animation__float\", {\r\n    property: \"position\",\r\n    dur: 10000,\r\n    from: { x: 0, y: 0, z: 0 },\r\n    to: { x: 0, y: 0.05, z: -0.05 },\r\n    easing: \"easeOutQuad\"\r\n  });\r\n\r\n  entity.setAttribute(\"animation__spawn\", {\r\n    property: \"scale\",\r\n    dur: 200,\r\n    from: { x: 0.1, y: 0.1, z: 0.1 },\r\n    to: { x: 1, y: 1, z: 1 },\r\n    easing: \"easeOutElastic\"\r\n  });\r\n\r\n  meshEntity.setAttribute(\"animation__opacity\", {\r\n    property: \"meshMaterial.opacity\",\r\n    isRawProperty: true,\r\n    delay: 3000,\r\n    dur: 8000,\r\n    from: 1.0,\r\n    to: 0.0,\r\n    easing: \"easeInQuad\"\r\n  });\r\n\r\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\r\n    entity.parentNode.removeChild(entity);\r\n  });\r\n\r\n  textureLoader.load(blobUrl, texture => {\r\n    const material = new THREE.MeshBasicMaterial();\r\n    material.transparent = true;\r\n    material.map = texture;\r\n    material.generateMipmaps = false;\r\n    material.needsUpdate = true;\r\n\r\n    const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\r\n    const mesh = new THREE.Mesh(geometry, material);\r\n    meshEntity.setObject3D(\"mesh\", mesh);\r\n    meshEntity.meshMaterial = material;\r\n    const scaleFactor = 400;\r\n    meshEntity.object3DMap.mesh.scale.set(width / scaleFactor, height / scaleFactor, 1);\r\n  });\r\n}\r\n\r\nexport async function spawnChatMessage(body, from) {\r\n  if (body.length === 0) return;\r\n\r\n  try {\r\n    const url = new URL(coerceToUrl(body));\r\n    if (url.host) {\r\n      document.querySelector(\"a-scene\").emit(\"add_media\", body);\r\n      return;\r\n    }\r\n  } catch (e) {\r\n    // Ignore parse error\r\n  }\r\n\r\n  // If not a URL, spawn as a text bubble\r\n\r\n  const [blob] = await renderChatMessage(body, from, true);\r\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\r\n}\r\n\r\nexport default function ChatMessage(props) {\r\n  return (\r\n    <div className={props.className}>\r\n      {props.maySpawn && (\r\n        <button\r\n          className={classNames(styles.iconButton, styles.spawnMessage)}\r\n          onClick={() => spawnChatMessage(props.body)}\r\n        />\r\n      )}\r\n      {messageBodyDom(props.body, props.name, props.sessionId, props.includeFromLink, props.history)}\r\n    </div>\r\n  );\r\n}\r\n\r\nChatMessage.propTypes = {\r\n  name: PropTypes.string,\r\n  maySpawn: PropTypes.bool,\r\n  body: PropTypes.string,\r\n  sessionId: PropTypes.string,\r\n  history: PropTypes.object,\r\n  className: PropTypes.string,\r\n  includeFromLink: PropTypes.bool\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport styles from \"../assets/stylesheets/message-entry.scss\";\r\nimport ChatCommandHelp from \"./chat-command-help\";\r\nimport sendMessageIcon from \"../assets/images/send_message.svgi\";\r\nimport spawnMessageIcon from \"../assets/images/spawn_message.svgi\";\r\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons/faCamera\";\r\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\r\nimport { spawnChatMessage } from \"./chat-message\";\r\nimport { pushHistoryState } from \"../utils/history\";\r\nimport { InlineSVGButton } from \"./svgi\";\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\n\r\nclass InWorldChatBox extends Component {\r\n  static propTypes = {\r\n    discordBridges: PropTypes.array,\r\n    onSendMessage: PropTypes.func,\r\n    onObjectCreated: PropTypes.func,\r\n    history: PropTypes.object,\r\n    enableSpawning: PropTypes.bool\r\n  };\r\n\r\n  state = {\r\n    pendingMessage: \"\"\r\n  };\r\n\r\n  sendMessage = e => {\r\n    e.preventDefault();\r\n    if (this.props.onSendMessage) {\r\n      this.props.onSendMessage(this.state.pendingMessage);\r\n    }\r\n    this.setState({ pendingMessage: \"\" });\r\n  };\r\n\r\n  render() {\r\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\r\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\r\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\r\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\r\n\r\n    return (\r\n      <form onSubmit={this.sendMessage}>\r\n        <div\r\n          className={classNames({ [styles.messageEntryInRoom]: true, [styles.messageEntryOnMobile]: isMobile })}\r\n          style={{ height: pendingMessageFieldHeight }}\r\n        >\r\n          {this.state.pendingMessage.startsWith(\"/\") && (\r\n            <ChatCommandHelp matchingPrefix={this.state.pendingMessage.substring(1)} />\r\n          )}\r\n          <input\r\n            id=\"message-entry-media-input\"\r\n            type=\"file\"\r\n            style={{ display: \"none\" }}\r\n            accept={isMobile ? \"image/*\" : \"*\"}\r\n            multiple\r\n            onChange={e => {\r\n              if (this.props.onObjectCreated) {\r\n                for (const file of e.target.files) {\r\n                  this.props.onObjectCreated(file);\r\n                }\r\n              }\r\n            }}\r\n          />\r\n          {this.props.enableSpawning && (\r\n            <label\r\n              htmlFor=\"message-entry-media-input\"\r\n              title={\"Upload\"}\r\n              className={classNames([\r\n                styles.messageEntryButton,\r\n                styles.messageEntryButtonInRoom,\r\n                styles.messageEntryUpload\r\n              ])}\r\n            >\r\n              <i>\r\n                <FontAwesomeIcon icon={isMobile ? faCamera : faPlus} />\r\n              </i>\r\n            </label>\r\n          )}\r\n          <textarea\r\n            style={{ height: pendingMessageTextareaHeight }}\r\n            className={classNames([\r\n              styles.messageEntryInput,\r\n              styles.messageEntryInputInRoom,\r\n              \"chat-focus-target\",\r\n              !this.props.enableSpawning && styles.messageEntryInputNoSpawn\r\n            ])}\r\n            value={this.state.pendingMessage}\r\n            rows={textRows}\r\n            onFocus={e => {\r\n              handleTextFieldFocus(e.target);\r\n            }}\r\n            onBlur={() => {\r\n              handleTextFieldBlur();\r\n            }}\r\n            onChange={e => {\r\n              e.stopPropagation();\r\n              this.setState({ pendingMessage: e.target.value });\r\n            }}\r\n            onKeyDown={e => {\r\n              if (e.key === \"Enter\" && !e.ctrlKey && !e.shiftKey) {\r\n                this.sendMessage(e);\r\n              } else if (e.key === \"Enter\" && e.ctrlKey) {\r\n                spawnChatMessage(e.target.value);\r\n                this.setState({ pendingMessage: \"\" });\r\n                e.target.blur();\r\n              } else if (e.key === \"Escape\") {\r\n                e.target.blur();\r\n              }\r\n            }}\r\n            placeholder={this.props.discordBridges.length ? `Send to room and ${discordSnippet}...` : \"Send to room...\"}\r\n          />\r\n          {this.props.enableSpawning && (\r\n            <InlineSVGButton\r\n              title={\"Create\"}\r\n              className={classNames([styles.messageEntrySpawn])}\r\n              src={spawnMessageIcon}\r\n              onClick={() => {\r\n                if (this.state.pendingMessage.length > 0) {\r\n                  spawnChatMessage(this.state.pendingMessage);\r\n                  this.setState({ pendingMessage: \"\" });\r\n                } else {\r\n                  pushHistoryState(this.props.history, \"modal\", \"create\");\r\n                }\r\n              }}\r\n            />\r\n          )}\r\n          <InlineSVGButton\r\n            type=\"submit\"\r\n            title={\"Submit\"}\r\n            className={classNames([\r\n              styles.messageEntryButton,\r\n              styles.messageEntryButtonInRoom,\r\n              styles.messageEntrySubmit\r\n            ])}\r\n            src={sendMessageIcon}\r\n          />\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default InWorldChatBox;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\r\nimport { upload } from \"../utils/media-utils\";\r\nimport { ensureAvatarMaterial } from \"../utils/avatar-utils\";\r\n\r\nimport AvatarPreview from \"./avatar-preview\";\r\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\r\n\r\nconst AVATARS_API = \"/api/v1/avatars\";\r\n\r\nconst defaultEditors = [\r\n  {\r\n    name: \"Quilt\",\r\n    url: \"https://tryquilt.io/?gltf=$AVATAR_GLTF\"\r\n  }\r\n];\r\nconst useEditorWhitelist = true;\r\nconst editorWhitelist = [\r\n  ...defaultEditors,\r\n  {\r\n    name: \"Skindex Editor\",\r\n    url: \"https://www.minecraftskins.com/skin-editor\"\r\n  },\r\n  {\r\n    name: \"MinecraftSkins.net Editor\",\r\n    url: \"https://www.minecraftskins.net/skineditor\"\r\n  }\r\n];\r\n\r\nconst fetchAvatar = async avatarId => {\r\n  const { avatars } = await fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`);\r\n  return avatars[0];\r\n};\r\n\r\nexport default class AvatarEditor extends Component {\r\n  static propTypes = {\r\n    avatarId: PropTypes.string,\r\n    onSignIn: PropTypes.func,\r\n    onSave: PropTypes.func,\r\n    onClose: PropTypes.func,\r\n    signedIn: PropTypes.bool,\r\n    hideDelete: PropTypes.bool,\r\n    debug: PropTypes.bool,\r\n    className: PropTypes.string\r\n  };\r\n\r\n  state = {\r\n    baseAvatarResults: [],\r\n    editorLinks: defaultEditors,\r\n    previewGltfUrl: null\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.inputFiles = {};\r\n  }\r\n\r\n  componentDidMount = async () => {\r\n    if (this.props.avatarId) {\r\n      const avatar = await fetchAvatar(this.props.avatarId);\r\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\r\n      Object.assign(this.inputFiles, avatar.files);\r\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\r\n    } else {\r\n      const { entries } = await fetchReticulumAuthenticated(`/api/v1/media/search?filter=base&source=avatar_listings`);\r\n      const baseAvatarResults = entries.map(e => ({ id: e.id, name: e.name, gltfs: e.gltfs, images: e.images }));\r\n      if (baseAvatarResults.length) {\r\n        const randomAvatarResult = baseAvatarResults[Math.floor(Math.random() * baseAvatarResults.length)];\r\n        this.setState({\r\n          baseAvatarResults,\r\n          avatar: {\r\n            name: \"My Avatar\",\r\n            files: {},\r\n            base_gltf_url: randomAvatarResult.gltfs.base,\r\n            parent_avatar_listing_id: randomAvatarResult.id\r\n          },\r\n          previewGltfUrl: randomAvatarResult.gltfs.avatar\r\n        });\r\n      } else {\r\n        this.setState({\r\n          avatar: {\r\n            name: \"My Avatar\",\r\n            files: {}\r\n          }\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  createOrUpdateAvatar = avatar => {\r\n    return fetchReticulumAuthenticated(\r\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\r\n      avatar.avatar_id ? \"PUT\" : \"POST\",\r\n      { avatar }\r\n    ).then(({ avatars }) => avatars[0]);\r\n  };\r\n\r\n  uploadAvatar = async e => {\r\n    e.preventDefault();\r\n\r\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\r\n      const gltfLoader = new THREE.GLTFLoader();\r\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\r\n      const onProgress = console.log;\r\n      const parser = await new Promise((resolve, reject) =>\r\n        gltfLoader.createParser(gltfUrl, resolve, onProgress, reject)\r\n      );\r\n      URL.revokeObjectURL(gltfUrl);\r\n\r\n      const { body } = parser.extensions.KHR_binary_glTF;\r\n      const content = JSON.stringify(ensureAvatarMaterial(parser.json));\r\n      // Inject hubs components on upload. Used to create base avatar\r\n      // const gltf = parser.json;\r\n      // Object.assign(gltf.scenes[0], {\r\n      //   extensions: {\r\n      //     MOZ_hubs_components: {\r\n      //       \"loop-animation\": {\r\n      //         clip: \"idle_eyes\"\r\n      //       }\r\n      //     }\r\n      //   }\r\n      // });\r\n      // Object.assign(gltf.nodes.find(n => n.name === \"Head\"), {\r\n      //   extensions: {\r\n      //     MOZ_hubs_components: {\r\n      //       \"scale-audio-feedback\": \"\"\r\n      //     }\r\n      //   }\r\n      // });\r\n      // content = JSON.stringify(gltf);\r\n\r\n      this.inputFiles.gltf = new File([content], \"file.gltf\", {\r\n        type: \"model/gltf\"\r\n      });\r\n      this.inputFiles.bin = new File([body], \"file.bin\", {\r\n        type: \"application/octet-stream\"\r\n      });\r\n    }\r\n\r\n    this.inputFiles.thumbnail = new File([await this.preview.getWrappedInstance().snapshot()], \"thumbnail.png\", {\r\n      type: \"image/png\"\r\n    });\r\n\r\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\r\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\r\n    );\r\n\r\n    this.setState({ uploading: true });\r\n\r\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\r\n    const avatar = {\r\n      ...this.state.avatar,\r\n      attributions: {\r\n        creator: this.state.avatar.creatorAttribution\r\n      },\r\n      files: fileUploads\r\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\r\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\r\n    };\r\n\r\n    await this.createOrUpdateAvatar(avatar);\r\n\r\n    this.setState({ uploading: false });\r\n\r\n    if (this.props.onSave) this.props.onSave();\r\n  };\r\n\r\n  deleteAvatar = async e => {\r\n    e.preventDefault();\r\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\r\n    if (this.props.onSave) this.props.onSave();\r\n  };\r\n\r\n  fileField = (name, label, accept, disabled = false, title) => (\r\n    <div className={classNames(\"file-input-row\", { disabled })} key={name} title={title}>\r\n      <label htmlFor={`avatar-file_${name}`}>\r\n        <div className=\"img-box\" />\r\n        <span>{label}</span>\r\n      </label>\r\n      <input\r\n        id={`avatar-file_${name}`}\r\n        type=\"file\"\r\n        accept={accept}\r\n        disabled={disabled}\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n          e.target.value = null;\r\n          this.inputFiles[name] = file;\r\n          URL.revokeObjectURL(this.state.previewGltfUrl);\r\n          const previewGltfUrl = URL.createObjectURL(this.inputFiles.glb);\r\n          this.setState({\r\n            previewGltfUrl,\r\n            avatar: {\r\n              ...this.state.avatar,\r\n              files: {\r\n                ...this.state.avatar.files,\r\n                [name]: URL.createObjectURL(file)\r\n              }\r\n            }\r\n          });\r\n        }}\r\n      />\r\n      {this.state.avatar.files[name] && (\r\n        <a\r\n          onClick={() => {\r\n            this.inputFiles[name] = null;\r\n            URL.revokeObjectURL(this.state.avatar.files[name]);\r\n            this.setState(\r\n              {\r\n                avatar: {\r\n                  ...this.state.avatar,\r\n                  files: {\r\n                    ...this.state.avatar.files,\r\n                    [name]: null\r\n                  }\r\n                }\r\n              },\r\n              () => this.setState({ previewGltfUrl: this.getPreviewUrl() })\r\n            );\r\n          }}\r\n        >\r\n          <i>\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </i>\r\n        </a>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  mapField = (name, label, accept, disabled = false, title) => (\r\n    <div className=\"file-input-row\" key={name} title={title}>\r\n      <label htmlFor={`avatar-file_${name}`}>\r\n        <div className=\"img-box\">\r\n          {this.state.avatar.files[name] ? (\r\n            <img src={this.state.avatar.files[name]} />\r\n          ) : (\r\n            <FontAwesomeIcon icon={faCloudUploadAlt} />\r\n          )}\r\n        </div>\r\n        <span>{label}</span>\r\n      </label>\r\n      <input\r\n        id={`avatar-file_${name}`}\r\n        type=\"file\"\r\n        accept={accept}\r\n        disabled={disabled}\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n          e.target.value = null;\r\n          this.inputFiles[name] = file;\r\n          URL.revokeObjectURL(this.state.avatar.files[name]);\r\n          this.setState({\r\n            avatar: {\r\n              ...this.state.avatar,\r\n              files: {\r\n                ...this.state.avatar.files,\r\n                [name]: URL.createObjectURL(file)\r\n              }\r\n            }\r\n          });\r\n        }}\r\n      />\r\n      {this.state.avatar.files[name] && (\r\n        <a\r\n          onClick={() => {\r\n            this.inputFiles[name] = null;\r\n            URL.revokeObjectURL(this.state.avatar.files[name]);\r\n            this.setState({\r\n              avatar: {\r\n                ...this.state.avatar,\r\n                files: {\r\n                  ...this.state.avatar.files,\r\n                  [name]: null\r\n                }\r\n              }\r\n            });\r\n          }}\r\n        >\r\n          <i>\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </i>\r\n        </a>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  textField = (name, placeholder, disabled, required) => (\r\n    <div className=\"text-field-container\">\r\n      <label htmlFor={`#avatar-${name}`}>{placeholder}</label>\r\n      <input\r\n        id={`avatar-${name}`}\r\n        type=\"text\"\r\n        disabled={disabled}\r\n        required={required}\r\n        placeholder={placeholder}\r\n        className=\"text-field\"\r\n        value={this.state.avatar[name] || \"\"}\r\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  // Return the gltf for the selected base avatar, the locally modified glb, or the avatar's base_gltf_url\r\n  getPreviewUrl = baseSid => {\r\n    if (baseSid) {\r\n      const avatarResult = this.state.baseAvatarResults.find(a => a.id === baseSid);\r\n      if (avatarResult) return avatarResult.gltfs.avatar;\r\n    }\r\n\r\n    return this.inputFiles.glb ? URL.createObjectURL(this.inputFiles.glb) : this.state.avatar.base_gltf_url;\r\n  };\r\n\r\n  selectListingField = (propName, placeholder) => (\r\n    <div className=\"select-container\">\r\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\r\n      <select\r\n        id={`avatar-${propName}`}\r\n        value={this.state.avatar[propName] || \"\"}\r\n        onChange={async e => {\r\n          const sid = e.target.value;\r\n          this.setState({ avatar: { ...this.state.avatar, [propName]: sid }, previewGltfUrl: this.getPreviewUrl(sid) });\r\n        }}\r\n        placeholder={placeholder}\r\n        className=\"select\"\r\n      >\r\n        {this.state.baseAvatarResults.map(a => (\r\n          <option key={a.id} value={a.id}>\r\n            {a.name}\r\n          </option>\r\n        ))}\r\n        <option value=\"\">Custom GLB...</option>\r\n      </select>\r\n      <img\r\n        className=\"arrow\"\r\n        src=\"../assets/images/dropdown_arrow.png\"\r\n        srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  selectListingGrid = (propName, placeholder) => (\r\n    <div className=\"select-grid-container\">\r\n      <label htmlFor={`#avatar-${propName}`}>{placeholder}</label>\r\n      <div className=\"select-grid\">\r\n        {this.state.baseAvatarResults.map(a => (\r\n          <div\r\n            onClick={() =>\r\n              this.setState({\r\n                avatar: { ...this.state.avatar, [propName]: a.id },\r\n                previewGltfUrl: this.getPreviewUrl(a.id)\r\n              })\r\n            }\r\n            key={a.id}\r\n            className={classNames(\"item\", { selected: a.id === this.state.avatar[propName] })}\r\n            style={{ paddingBottom: `${(a.images.preview.width / a.images.preview.height) * 100}%` }}\r\n          >\r\n            <img src={a.images.preview.url} />\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <input\r\n        id=\"avatar-file_glb\"\r\n        type=\"file\"\r\n        accept=\"model/gltf+binary,.glb\"\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n          e.target.value = null;\r\n          this.inputFiles[\"glb\"] = file;\r\n          URL.revokeObjectURL(this.state.avatar.files[\"glb\"]);\r\n          this.setState({\r\n            avatar: {\r\n              ...this.state.avatar,\r\n              [propName]: \"\",\r\n              files: {\r\n                ...this.state.avatar.files,\r\n                glb: URL.createObjectURL(file)\r\n              }\r\n            },\r\n            previewGltfUrl: this.getPreviewUrl(\"\")\r\n          });\r\n        }}\r\n      />\r\n      <label\r\n        htmlFor=\"avatar-file_glb\"\r\n        className={classNames(\"item\", \"custom\", { selected: \"\" === this.state.avatar[propName] })}\r\n      >\r\n        <FontAwesomeIcon icon={faCloudUploadAlt} />\r\n        &nbsp; Custom GLB\r\n      </label>\r\n    </div>\r\n  );\r\n\r\n  textarea = (name, placeholder, disabled) => (\r\n    <div>\r\n      <textarea\r\n        id={`avatar-${name}`}\r\n        disabled={disabled}\r\n        placeholder={placeholder}\r\n        className=\"textarea\"\r\n        value={this.state.avatar[name] || \"\"}\r\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  checkbox = (name, title, children, disabled) => (\r\n    <div className=\"checkbox-container\" title={title}>\r\n      <input\r\n        id={`avatar-${name}`}\r\n        type=\"checkbox\"\r\n        className=\"checkbox\"\r\n        disabled={disabled}\r\n        checked={!!this.state.avatar[name]}\r\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\r\n      />\r\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\r\n    </div>\r\n  );\r\n\r\n  handleGltfLoaded = gltf => {\r\n    const ext = gltf.parser.json.extensions && gltf.parser.json.extensions[\"MOZ_hubs_avatar\"];\r\n    let editorLinks = (ext && ext.editors) || defaultEditors;\r\n    if (useEditorWhitelist) {\r\n      editorLinks = editorLinks.filter(e => editorWhitelist.some(w => w.name === e.name && w.url === e.url));\r\n    }\r\n    this.setState({ editorLinks });\r\n  };\r\n\r\n  render() {\r\n    const { debug } = this.props;\r\n    const { avatar } = this.state;\r\n\r\n    return (\r\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\r\n        {this.props.onClose && (\r\n          <a className=\"close-button\" onClick={this.props.onClose}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </a>\r\n        )}\r\n        {!this.state.avatar ? (\r\n          <div className=\"loader\">\r\n            <div className=\"loader-center\" />\r\n          </div>\r\n        ) : this.props.signedIn ? (\r\n          <form onSubmit={this.uploadAvatar} className=\"center\">\r\n            {this.textField(\"name\", \"Name\", false, true)}\r\n            <div className=\"split\">\r\n              <div className=\"form-body\">\r\n                {debug && this.textField(\"avatar_id\", \"Avatar ID\", true)}\r\n                {debug && this.textField(\"parent_avatar_id\", \"Parent Avatar ID\")}\r\n                {debug && this.textField(\"parent_avatar_listing_id\", \"Parent Avatar Listing ID\")}\r\n                {debug && this.textarea(\"description\", \"Description\")}\r\n                {!!this.state.baseAvatarResults.length && this.selectListingGrid(\"parent_avatar_listing_id\", \"Model\")}\r\n\r\n                <label>Skin</label>\r\n                {this.mapField(\"base_map\", \"Base Map\", \"image/*\")}\r\n                <details>\r\n                  <summary>Advanced</summary>\r\n                  {this.mapField(\"emissive_map\", \"Emissive Map\", \"image/*\")}\r\n                  {this.mapField(\"normal_map\", \"Normal Map\", \"image/*\")}\r\n                  {this.mapField(\"orm_map\", \"ORM Map\", \"image/*\", false, \"Occlussion (r), Roughness (g), Metallic (b)\")}\r\n                </details>\r\n\r\n                <label>Share Settings</label>\r\n                {this.checkbox(\r\n                  \"allow_promotion\",\r\n                  `Allow ${messages[\"company-name\"]} to promote your avatar, and show it in search results.`,\r\n                  <span>\r\n                    Allow{\" \"}\r\n                    <a\r\n                      href={configs.link(\"promotion\", \"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\")}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    >\r\n                      Promotion\r\n                    </a>\r\n                  </span>\r\n                )}\r\n                {this.checkbox(\r\n                  \"allow_remixing\",\r\n                  \"Allow others to edit and re-publish your avatar as long as they give you credit.\",\r\n                  <span>\r\n                    Allow{\" \"}\r\n                    <a\r\n                      href={configs.link(\"remixing\", \"https://github.com/mozilla/hubs/blob/master/REMIXING.md\")}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                    >\r\n                      Remixing\r\n                    </a>{\" \"}\r\n                    <span className=\"license\">\r\n                      (under{\" \"}\r\n                      <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                        CC-BY 3.0\r\n                      </a>)\r\n                    </span>\r\n                  </span>\r\n                )}\r\n                {this.textField(\"creatorAttribution\", \"Attribution (optional)\", false, false)}\r\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\r\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\r\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\r\n              </div>\r\n              <AvatarPreview\r\n                className=\"preview\"\r\n                avatarGltfUrl={this.state.previewGltfUrl}\r\n                onGltfLoaded={this.handleGltfLoaded}\r\n                {...this.inputFiles}\r\n                ref={p => (this.preview = p)}\r\n              />\r\n            </div>\r\n            <div className=\"info\">\r\n              <IfFeature name=\"show_avatar_editor_link\">\r\n                <p>\r\n                  <FormattedMessage id=\"avatar-editor.external-editor-info\" />\r\n                  {this.state.editorLinks.map(({ name, url }) => (\r\n                    <a\r\n                      key={name}\r\n                      target=\"_blank\"\r\n                      rel=\"noopener noreferrer\"\r\n                      href={url.replace(\"$AVATAR_GLTF\", encodeURIComponent(this.state.previewGltfUrl))}\r\n                    >\r\n                      {name}\r\n                    </a>\r\n                  ))}\r\n                </p>\r\n              </IfFeature>\r\n              <IfFeature name=\"show_avatar_pipelines_link\">\r\n                <p>\r\n                  <FormattedMessage id=\"avatar-editor.info\" />\r\n                  <a\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    href=\"https://github.com/MozillaReality/hubs-avatar-pipelines\"\r\n                  >\r\n                    <FormattedMessage id=\"avatar-editor.info-link\" />\r\n                  </a>\r\n                </p>\r\n              </IfFeature>\r\n            </div>\r\n            <div>\r\n              <input\r\n                disabled={this.state.uploading}\r\n                className=\"form-submit\"\r\n                type=\"submit\"\r\n                value={this.state.uploading ? \"Uploading...\" : \"Save\"}\r\n              />\r\n            </div>\r\n            {!this.props.hideDelete && (\r\n              <div className=\"delete-avatar\">\r\n                {this.state.confirmDelete ? (\r\n                  <span>\r\n                    are you sure? <a onClick={this.deleteAvatar}>yes</a> /{\" \"}\r\n                    <a onClick={() => this.setState({ confirmDelete: false })}>no</a>\r\n                  </span>\r\n                ) : (\r\n                  <a\r\n                    onClick={() => this.setState({ confirmDelete: true })}\r\n                    title={\r\n                      avatar.has_listings\r\n                        ? \"Other users already using this avatar will still be able to use it, but it will be removed from 'My Avatars' and search results.\"\r\n                        : \"\"\r\n                    }\r\n                  >\r\n                    {avatar.has_listings ? \"delist\" : \"delete\"} avatar\r\n                  </a>\r\n                )}\r\n              </div>\r\n            )}\r\n          </form>\r\n        ) : (\r\n          <a onClick={this.props.onSignIn}>\r\n            <FormattedMessage id=\"sign-in.in\" />\r\n          </a>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport MovingAverage from \"moving-average\";\r\n\r\nexport default class MicLevelWidget extends Component {\r\n  static propTypes = {\r\n    hasAudioTrack: PropTypes.bool,\r\n    muteOnEntry: PropTypes.bool,\r\n    scene: PropTypes.object\r\n  };\r\n\r\n  state = {\r\n    volume: 0\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.startAnalyser();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.stopAnalyser();\r\n  }\r\n\r\n  stopAnalyser() {\r\n    if (this.micUpdateInterval != null) {\r\n      clearInterval(this.micUpdateInterval);\r\n    }\r\n  }\r\n\r\n  startAnalyser() {\r\n    if (this.micUpdateInterval) {\r\n      clearInterval(this.micUpdateInterval);\r\n    }\r\n    const micLevelMovingAverage = MovingAverage(100);\r\n    let max = 0;\r\n    this.micUpdateInterval = setInterval(() => {\r\n      const analyser = this.props.scene.systems[\"local-audio-analyser\"];\r\n      max = Math.max(analyser.volume, max);\r\n      // We use a moving average to smooth out the visual animation or else it would twitch too fast for\r\n      // the css renderer to keep up.\r\n      micLevelMovingAverage.push(Date.now(), analyser.volume);\r\n      const average = micLevelMovingAverage.movingAverage();\r\n      const volume = max === 0 ? 0 : average / max;\r\n      if (Math.abs(this.state.volume - volume) > 0.05) {\r\n        this.setState({ volume });\r\n      }\r\n    }, 50);\r\n  }\r\n\r\n  render() {\r\n    const maxLevelHeight = 111;\r\n\r\n    const micClip = {\r\n      clip: `rect(${maxLevelHeight - Math.floor(this.state.volume * maxLevelHeight)}px, 111px, 111px, 0px)`\r\n    };\r\n\r\n    return (\r\n      <div className=\"audio-setup-panel__levels__icon\">\r\n        {!this.props.muteOnEntry && (\r\n          <svg width=\"111\" height=\"111\" viewBox=\"0 0 111 111\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <circle cx=\"55.5\" cy=\"55.5\" r=\"55.5\" fill=\"currentColor\" fillOpacity=\"0.8\" />\r\n          </svg>\r\n        )}\r\n        {!this.props.muteOnEntry && (\r\n          <div className=\"audio-setup-panel__levels__icon__talking\" style={micClip}>\r\n            <svg width=\"111\" height=\"111\" viewBox=\"0 0 111 111\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <circle cx=\"55.5\" cy=\"55.5\" r=\"55.5\" fill=\"currentColor\" fillOpacity=\"0.8\" />\r\n            </svg>\r\n          </div>\r\n        )}\r\n        {this.props.hasAudioTrack && !this.props.muteOnEntry ? (\r\n          <img\r\n            src=\"../assets/images/mic_level.png\"\r\n            srcSet=\"../assets/images/mic_level@2x.png 2x\"\r\n            className=\"audio-setup-panel__levels__icon-part\"\r\n          />\r\n        ) : (\r\n          <img\r\n            src=\"../assets/images/mic_denied.png\"\r\n            srcSet=\"../assets/images/mic_denied@2x.png 2x\"\r\n            className=\"audio-setup-panel__levels__icon-part\"\r\n          />\r\n        )}\r\n        {this.props.hasAudioTrack &&\r\n          !this.props.muteOnEntry && (\r\n            <div className=\"audio-setup-panel__levels__test_label\">\r\n              <FormattedMessage id=\"audio.talk_to_test\" />\r\n            </div>\r\n          )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\n\r\nimport styles from \"../assets/stylesheets/preferences-screen.scss\";\r\n\r\nexport class NumberRangeSelector extends Component {\r\n  static propTypes = {\r\n    min: PropTypes.number,\r\n    max: PropTypes.number,\r\n    currentValue: PropTypes.number,\r\n    onChange: PropTypes.func\r\n  };\r\n  state = {\r\n    isDragging: false\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    this.myRoot = React.createRef();\r\n    this.stopDragging = this.stopDragging.bind(this);\r\n    this.drag = this.drag.bind(this);\r\n    window.addEventListener(\"mouseup\", this.stopDragging);\r\n    window.addEventListener(\"mousemove\", this.drag);\r\n  }\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"mouseup\", this.stopDragging);\r\n    window.removeEventListener(\"mousemove\", this.drag);\r\n  }\r\n\r\n  stopDragging() {\r\n    this.setState({ isDragging: false });\r\n  }\r\n\r\n  drag(e) {\r\n    if (!this.state.isDragging) return;\r\n    const t = Math.max(0, Math.min((e.clientX - this.myRoot.current.offsetLeft) / this.myRoot.current.clientWidth, 1));\r\n    this.props.onChange(this.props.min + t * (this.props.max - this.props.min));\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className={classNames(styles.numberWithRange)}>\r\n        <div className={classNames(styles.numberInNumberWithRange)}>\r\n          <input\r\n            type=\"text\"\r\n            value={this.props.currentValue.toFixed(2)}\r\n            onClick={e => {\r\n              e.preventDefault();\r\n              e.target.focus();\r\n              e.target.select();\r\n            }}\r\n            onChange={e => {\r\n              const num = parseInt(e.target.value);\r\n              this.props.onChange(num ? num : 0, true);\r\n            }}\r\n          />\r\n        </div>\r\n        <div\r\n          ref={this.myRoot}\r\n          className={classNames(styles.rangeSlider)}\r\n          onMouseDown={e => {\r\n            e.preventDefault();\r\n            this.setState({ isDragging: true });\r\n            const t = Math.max(\r\n              0,\r\n              Math.min((e.clientX - this.myRoot.current.offsetLeft) / this.myRoot.current.clientWidth, 1)\r\n            );\r\n            this.props.onChange(this.props.min + t * (this.props.max - this.props.min));\r\n          }}\r\n        >\r\n          <input\r\n            type=\"range\"\r\n            min={this.props.min}\r\n            max={this.props.max}\r\n            value={this.props.currentValue}\r\n            onChange={e => {\r\n              this.props.onChange(e.target.value);\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faUndo } from \"@fortawesome/free-solid-svg-icons/faUndo\";\r\n\r\nimport styles from \"../assets/stylesheets/preferences-screen.scss\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { SOUND_PREFERENCE_MENU_SELECT } from \"../systems/sound-effects-system\";\r\nimport { NumberRangeSelector } from \"./number-range-selector.js\";\r\n\r\nexport const PREFERENCE_LIST_ITEM_TYPE = {\r\n  CHECK_BOX: 1,\r\n  SELECT: 2,\r\n  NUMBER_WITH_RANGE: 3,\r\n  MAX_RESOLUTION: 4\r\n};\r\n\r\nexport class MaxResolutionPreferenceItem extends Component {\r\n  static propTypes = {\r\n    store: PropTypes.object\r\n  };\r\n  render() {\r\n    return (\r\n      <div className={classNames(styles.maxResolutionPreferenceItem)}>\r\n        <input\r\n          tabIndex=\"0\"\r\n          type=\"number\"\r\n          step=\"1\"\r\n          min=\"0\"\r\n          value={\r\n            this.props.store.state.preferences.maxResolutionWidth === undefined\r\n              ? 1920\r\n              : this.props.store.state.preferences.maxResolutionWidth\r\n          }\r\n          onClick={e => {\r\n            e.preventDefault();\r\n            e.target.focus();\r\n            e.target.select();\r\n          }}\r\n          onChange={e => {\r\n            const num = parseInt(e.target.value);\r\n            this.props.store.update({\r\n              preferences: { maxResolutionWidth: num ? num : 0 }\r\n            });\r\n          }}\r\n        />\r\n        &nbsp;x&nbsp;\r\n        <input\r\n          tabIndex=\"0\"\r\n          type=\"number\"\r\n          step=\"1\"\r\n          min=\"0\"\r\n          value={\r\n            this.props.store.state.preferences.maxResolutionHeight === undefined\r\n              ? 1920\r\n              : this.props.store.state.preferences.maxResolutionHeight\r\n          }\r\n          onClick={e => {\r\n            e.preventDefault();\r\n            e.target.focus();\r\n            e.target.select();\r\n          }}\r\n          onChange={e => {\r\n            const num = parseInt(e.target.value);\r\n            this.props.store.update({\r\n              preferences: { maxResolutionHeight: num ? num : 0 }\r\n            });\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport class PreferenceListItem extends Component {\r\n  static propTypes = {\r\n    store: PropTypes.object,\r\n    storeKey: PropTypes.string,\r\n    prefType: PropTypes.number,\r\n    min: PropTypes.number,\r\n    max: PropTypes.number,\r\n    onChange: PropTypes.func,\r\n    options: PropTypes.array,\r\n    defaultNumber: PropTypes.number,\r\n    defaultString: PropTypes.string,\r\n    defaultBool: PropTypes.bool\r\n  };\r\n  state = {\r\n    hovered: false,\r\n    selectHovered: false\r\n  };\r\n  UNSAFE_componentWillMount() {\r\n    this.renderControls = this.renderControls.bind(this);\r\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.sfx = AFRAME.scenes[0].systems[\"hubs-systems\"].soundEffectsSystem;\r\n    });\r\n  }\r\n  componentWillUnmount() {\r\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\r\n  }\r\n\r\n  storeUpdated = () => {\r\n    this.forceUpdate();\r\n  };\r\n\r\n  renderControls() {\r\n    let options;\r\n    let storedPref;\r\n    switch (this.props.prefType) {\r\n      case PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX:\r\n        storedPref = this.props.store.state.preferences[this.props.storeKey];\r\n        return (\r\n          <div className={classNames(styles.checkbox)}>\r\n            <input\r\n              tabIndex=\"0\"\r\n              type=\"checkbox\"\r\n              checked={storedPref === undefined ? this.props.defaultBool : storedPref}\r\n              onChange={() => {\r\n                this.props.store.update({\r\n                  preferences: { [this.props.storeKey]: !this.props.store.state.preferences[this.props.storeKey] }\r\n                });\r\n              }}\r\n            />\r\n          </div>\r\n        );\r\n      case PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION:\r\n        return <MaxResolutionPreferenceItem store={this.props.store} />;\r\n      case PREFERENCE_LIST_ITEM_TYPE.SELECT:\r\n        options = this.props.options.map((o, i) => {\r\n          const opts = {};\r\n          const storedPref = this.props.store.state.preferences[this.props.storeKey];\r\n          if (\r\n            o.value === storedPref ||\r\n            ((storedPref === undefined || storedPref === \"\") && o.value === this.props.defaultString)\r\n          ) {\r\n            opts.selected = \"selected\";\r\n          }\r\n\r\n          return (\r\n            <option key={`${this.props.storeKey}_${i}`} value={o.value} {...opts}>\r\n              {o.text}\r\n            </option>\r\n          );\r\n        });\r\n        return (\r\n          <div className={styles.dropdown}>\r\n            <select\r\n              tabIndex=\"0\"\r\n              className={classNames({\r\n                [styles.hovered]: this.state.hovered,\r\n                [styles.selectHovered]: this.state.selectHovered\r\n              })}\r\n              onMouseEnter={() => {\r\n                this.setState({ selectHovered: true });\r\n              }}\r\n              onMouseLeave={() => {\r\n                this.setState({ selectHovered: false });\r\n              }}\r\n              onChange={e => {\r\n                this.props.store.update({ preferences: { [this.props.storeKey]: e.target.value } });\r\n              }}\r\n            >\r\n              {options}\r\n            </select>\r\n            <img\r\n              className={styles.dropdownArrow}\r\n              src=\"../assets/images/dropdown_arrow.png\"\r\n              srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\r\n            />\r\n          </div>\r\n        );\r\n      case PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE:\r\n        return (\r\n          <NumberRangeSelector\r\n            min={this.props.min}\r\n            max={this.props.max}\r\n            currentValue={\r\n              this.props.store.state.preferences[this.props.storeKey] !== undefined\r\n                ? this.props.store.state.preferences[this.props.storeKey]\r\n                : this.props.defaultNumber\r\n            }\r\n            onChange={(value, playSound) => {\r\n              this.props.store.update({\r\n                preferences: { [this.props.storeKey]: Number.parseFloat(value) }\r\n              });\r\n              playSound && this.sfx && this.sfx.playSoundOneShot(SOUND_PREFERENCE_MENU_SELECT);\r\n            }}\r\n          />\r\n        );\r\n      default:\r\n        return <div />;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const isCheckbox = this.props.prefType === PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX;\r\n\r\n    return (\r\n      <div\r\n        className={classNames(\r\n          { [styles.hovered]: this.state.hovered },\r\n          styles.preferenceListItem,\r\n          !isCheckbox && styles.preferenceListNonCheckbox\r\n        )}\r\n        onMouseEnter={() => {\r\n          this.setState({ hovered: true });\r\n        }}\r\n        onMouseLeave={() => {\r\n          this.setState({ hovered: false });\r\n        }}\r\n      >\r\n        <div className={classNames(styles.checkboxMargin)}>\r\n          {isCheckbox ? this.renderControls() : <span>&nbsp;</span>}\r\n        </div>\r\n        <div className={classNames(styles.part, styles.left, styles.label)}>\r\n          <FormattedMessage id={`preferences.${this.props.storeKey}`} />\r\n        </div>\r\n        <div className={classNames(styles.part, styles.right)}>\r\n          {!isCheckbox && this.renderControls()}\r\n          <button\r\n            className={classNames(styles.resetToDefaultButton)}\r\n            onClick={() => {\r\n              switch (this.props.prefType) {\r\n                case PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION:\r\n                  this.props.store.update({\r\n                    preferences: {\r\n                      maxResolutionWidth: undefined,\r\n                      maxResolutionHeight: undefined\r\n                    }\r\n                  });\r\n                  break;\r\n                default:\r\n                  this.props.store.update({ preferences: { [this.props.storeKey]: undefined } });\r\n                  break;\r\n              }\r\n              this.forceUpdate();\r\n            }}\r\n          >\r\n            <i title=\"Reset to default\">\r\n              <FontAwesomeIcon icon={faUndo} />\r\n            </i>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { IntlProvider, addLocaleData } from \"react-intl\";\r\nimport en from \"react-intl/locale-data/en\";\r\n\r\nimport styles from \"../assets/stylesheets/preferences-screen.scss\";\r\nimport { lang, messages } from \"../utils/i18n\";\r\nimport { PreferenceListItem, PREFERENCE_LIST_ITEM_TYPE } from \"./preference-list-item\";\r\n\r\naddLocaleData([...en]);\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\r\n\r\nexport default class PreferencesScreen extends Component {\r\n  static propTypes = {\r\n    onClose: PropTypes.func,\r\n    store: PropTypes.object\r\n  };\r\n\r\n  UNSAFE_componentWillMount() {\r\n    window.APP.preferenceScreenIsVisible = true;\r\n  }\r\n  componentWillUnmount() {\r\n    window.APP.preferenceScreenIsVisible = false;\r\n  }\r\n\r\n  render() {\r\n    const preferenceListItem = props => {\r\n      return (\r\n        <PreferenceListItem\r\n          key={props.key}\r\n          store={this.props.store}\r\n          storeKey={props.key}\r\n          prefType={props.prefType}\r\n          min={props.min}\r\n          max={props.max}\r\n          currentValue={props.currentValue}\r\n          onChange={props.onChange}\r\n          options={props.options}\r\n          defaultNumber={props.defaultNumber}\r\n          defaultString={props.defaultString}\r\n          defaultBool={props.defaultBool}\r\n        />\r\n      );\r\n    };\r\n    // TODO: Add search text field and sort rows by fuzzy search\r\n    const general = [\r\n      { key: \"muteMicOnEntry\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"onlyShowNametagsInFreeze\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      {\r\n        key: \"globalVoiceVolume\",\r\n        prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\r\n        min: 0,\r\n        max: 200,\r\n        defaultNumber: 100\r\n      },\r\n      {\r\n        key: \"globalMediaVolume\",\r\n        prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\r\n        min: 0,\r\n        max: 200,\r\n        defaultNumber: 100\r\n      },\r\n      {\r\n        key: \"snapRotationDegrees\",\r\n        prefType: PREFERENCE_LIST_ITEM_TYPE.NUMBER_WITH_RANGE,\r\n        min: 0,\r\n        max: 90,\r\n        defaultNumber: 45\r\n      },\r\n      { key: \"disableMovement\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"disableBackwardsMovement\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"disableStrafing\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"disableTeleporter\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false }\r\n    ].map(preferenceListItem);\r\n\r\n    const touchscreen = [\r\n      { key: \"enableOnScreenJoystickLeft\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"enableOnScreenJoystickRight\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false }\r\n    ].map(preferenceListItem);\r\n\r\n    const advanced = [\r\n      { key: \"maxResolution\", prefType: PREFERENCE_LIST_ITEM_TYPE.MAX_RESOLUTION },\r\n      {\r\n        key: \"materialQualitySetting\",\r\n        prefType: PREFERENCE_LIST_ITEM_TYPE.SELECT,\r\n        options: [{ value: \"low\", text: \"Low\" }, { value: \"high\", text: \"High\" }],\r\n        defaultString: isMobile ? \"low\" : \"high\"\r\n      },\r\n      { key: \"disableAutoPixelRatio\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false },\r\n      { key: \"allowMultipleHubsInstances\", prefType: PREFERENCE_LIST_ITEM_TYPE.CHECK_BOX, defaultBool: false }\r\n    ].map(preferenceListItem);\r\n\r\n    return (\r\n      <IntlProvider locale={lang} messages={messages}>\r\n        <div className={classNames(styles.preferencesPanel)}>\r\n          <div className={classNames(styles.panelMargin)}>\r\n            <button autoFocus className={classNames(styles.closeButton)} onClick={e => this.props.onClose(e)}>\r\n              <i>\r\n                <FontAwesomeIcon icon={faTimes} />\r\n              </i>\r\n            </button>\r\n\r\n            <div className={classNames(styles.contentContainer)}>\r\n              <div className={classNames(styles.sectionBar)}>\r\n                <div className={classNames(styles.sectionTitle)}>\r\n                  <span>General</span>\r\n                </div>\r\n              </div>\r\n              <div className={classNames(styles.scrollingContent)}>{general}</div>\r\n              <div className={classNames(styles.sectionBar)}>\r\n                <div className={classNames(styles.sectionTitle)}>\r\n                  <span>Touchscreen</span>\r\n                </div>\r\n              </div>\r\n              <div className={classNames(styles.scrollingContent)}>{touchscreen}</div>\r\n              <div className={classNames(styles.sectionBar)}>\r\n                <div className={classNames(styles.sectionTitle)}>\r\n                  <span>Advanced</span>\r\n                </div>\r\n              </div>\r\n              <div className={classNames(styles.scrollingContent)}>{advanced}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </IntlProvider>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { WithHoverSound } from \"./wrap-with-audio\";\r\n\r\nimport webmTone from \"../assets/sfx/tone.webm\";\r\nimport mp3Tone from \"../assets/sfx/tone.mp3\";\r\nimport oggTone from \"../assets/sfx/tone.ogg\";\r\nimport wavTone from \"../assets/sfx/tone.wav\";\r\n\r\nexport default class OutputLevelWidget extends Component {\r\n  state = {\r\n    tonePlaying: false\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.playTestTone = this.playTestTone.bind(this);\r\n    this.toneClip = document.createElement(\"audio\");\r\n    if (this.toneClip.canPlayType(\"audio/webm\")) {\r\n      this.toneClip.src = webmTone;\r\n    } else if (this.toneClip.canPlayType(\"audio/mpeg\")) {\r\n      this.toneClip.src = mp3Tone;\r\n    } else if (this.toneClip.canPlayType(\"audio/ogg\")) {\r\n      this.toneClip.src = oggTone;\r\n    } else {\r\n      this.toneClip.src = wavTone;\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.toneClip.pause();\r\n    this.toneClip.currentTime = 0;\r\n    if (this.testToneTimeout != null) {\r\n      clearTimeout(this.testToneTimeout);\r\n    }\r\n  }\r\n\r\n  playTestTone() {\r\n    if (this.testToneTimeout != null) {\r\n      clearTimeout(this.testToneTimeout);\r\n    }\r\n    this.toneClip.currentTime = 0;\r\n    this.toneClip.play();\r\n    this.setState({ tonePlaying: true });\r\n    this.testToneTimeout = setTimeout(() => {\r\n      this.setState({ tonePlaying: false });\r\n    }, 1393);\r\n  }\r\n\r\n  render() {\r\n    const iconClass = `audio-setup-panel__levels__icon_clickable__${this.state.tonePlaying ? \"playing\" : \"pending\"}`;\r\n\r\n    return (\r\n      <WithHoverSound>\r\n        <div className=\"audio-setup-panel__levels__icon_clickable\" onClick={this.playTestTone}>\r\n          <img\r\n            src=\"../assets/images/speaker_level.png\"\r\n            srcSet=\"../assets/images/speaker_level@2x.png 2x\"\r\n            className=\"audio-setup-panel__levels__icon-part\"\r\n          />\r\n          <div className={iconClass}>\r\n            <svg width=\"111\" height=\"111\" viewBox=\"0 0 111 111\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n              <circle cx=\"55.5\" cy=\"55.5\" r=\"55.5\" fill=\"currentColor\" fillOpacity=\"0.8\" />\r\n            </svg>\r\n          </div>\r\n          <div className=\"audio-setup-panel__levels__test_label\">\r\n            <FormattedMessage id=\"audio.click_to_test\" />\r\n          </div>\r\n        </div>\r\n      </WithHoverSound>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport styles from \"../assets/stylesheets/presence-log.scss\";\r\nimport configs from \"../utils/configs\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { share } from \"../utils/share\";\r\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\r\n\r\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\r\n  const landingPageUrl = getLandingPageForPhoto(url);\r\n  const onShareClicked = share.bind(null, {\r\n    url: landingPageUrl,\r\n    title: `Taken in ${messages[\"share-hashtag\"]}, join me at https://${configs.SHORTLINK_DOMAIN}/${hubId}`\r\n  });\r\n  return (\r\n    <div className={className}>\r\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\r\n      <div className={styles.mediaBody}>\r\n        <span>\r\n          <b>{name}</b>\r\n        </span>\r\n        <span>\r\n          {\"took a \"}\r\n          <b>\r\n            <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              photo\r\n            </a>\r\n          </b>.\r\n        </span>\r\n      </div>\r\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        <img src={url} />\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\nPhotoMessage.propTypes = {\r\n  name: PropTypes.string,\r\n  maySpawn: PropTypes.bool,\r\n  body: PropTypes.object,\r\n  className: PropTypes.string,\r\n  hubId: PropTypes.string\r\n};\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport configs from \"../utils/configs\";\r\n\r\nimport { messages } from \"../utils/i18n\";\r\nimport styles from \"../assets/stylesheets/presence-log.scss\";\r\nimport classNames from \"classnames\";\r\n\r\nimport { share } from \"../utils/share\";\r\n\r\nexport default function VideoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\r\n  const onShareClicked = share.bind(null, {\r\n    url: url,\r\n    title: `Taken in ${messages[\"share-hashtag\"]}, join me at https://${configs.SHORTLINK_DOMAIN}/${hubId}`\r\n  });\r\n  return (\r\n    <div className={className}>\r\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\r\n      <div className={styles.mediaBody}>\r\n        <span>\r\n          <b>{name}</b>\r\n        </span>\r\n        <span>\r\n          {\"took a \"}\r\n          <b>\r\n            <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              video\r\n            </a>\r\n          </b>.\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nVideoMessage.propTypes = {\r\n  name: PropTypes.string,\r\n  maySpawn: PropTypes.bool,\r\n  body: PropTypes.object,\r\n  className: PropTypes.string,\r\n  hubId: PropTypes.string\r\n};\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/presence-log.scss\";\r\nimport classNames from \"classnames\";\r\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\r\n\r\nfunction spawnImage(url) {\r\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\r\n}\r\n\r\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\r\n  return (\r\n    <div className={className}>\r\n      {maySpawn && (\r\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\r\n      )}\r\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\r\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        <img src={proxiedUrlFor(url)} />\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nImageMessage.propTypes = {\r\n  name: PropTypes.string,\r\n  maySpawn: PropTypes.bool,\r\n  body: PropTypes.object,\r\n  className: PropTypes.string\r\n};\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/presence-log.scss\";\r\nimport classNames from \"classnames\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport ChatMessage from \"./chat-message\";\r\nimport PhotoMessage from \"./photo-message\";\r\nimport VideoMessage from \"./video-message\";\r\nimport ImageMessage from \"./image-message\";\r\nimport { getPresenceContextForSession } from \"../utils/phoenix-utils\";\r\n\r\nexport default class PresenceLog extends Component {\r\n  static propTypes = {\r\n    entries: PropTypes.array,\r\n    inRoom: PropTypes.bool,\r\n    hubId: PropTypes.string,\r\n    history: PropTypes.object,\r\n    presences: PropTypes.object\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  domForEntry = e => {\r\n    const entryClasses = {\r\n      [styles.presenceLogEntry]: true,\r\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\r\n      [styles.presenceLogChat]: e.type === \"chat\",\r\n      [styles.expired]: !!e.expired\r\n    };\r\n\r\n    const presenceContext = e.sessionId ? getPresenceContextForSession(this.props.presences, e.sessionId) : {};\r\n    const isBot = !!presenceContext.discord;\r\n\r\n    switch (e.type) {\r\n      case \"join\":\r\n      case \"entered\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}_${e.presence}`} />\r\n          </div>\r\n        );\r\n      case \"leave\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}`} />\r\n          </div>\r\n        );\r\n      case \"display_name_changed\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            <b>{e.oldName}</b>&nbsp;<FormattedMessage id=\"presence.name_change\" />&nbsp;<b>{e.newName}</b>.\r\n          </div>\r\n        );\r\n      case \"scene_changed\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.scene_change\" />&nbsp;<b>{e.sceneName}</b>.\r\n          </div>\r\n        );\r\n      case \"hub_name_changed\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.hub_name_change\" />&nbsp;<b>{e.hubName}</b>.\r\n          </div>\r\n        );\r\n      case \"chat\":\r\n        return (\r\n          <ChatMessage\r\n            key={e.key}\r\n            name={e.name}\r\n            className={classNames(entryClasses)}\r\n            body={e.body}\r\n            maySpawn={e.maySpawn}\r\n            sessionId={e.sessionId}\r\n            includeFromLink={this.props.inRoom && !isBot}\r\n            history={this.props.history}\r\n          />\r\n        );\r\n      case \"image\":\r\n        return (\r\n          <ImageMessage\r\n            key={e.key}\r\n            name={e.name}\r\n            className={classNames(entryClasses, styles.media)}\r\n            body={e.body}\r\n            maySpawn={e.maySpawn}\r\n          />\r\n        );\r\n      case \"photo\":\r\n        return (\r\n          <PhotoMessage\r\n            key={e.key}\r\n            name={e.name}\r\n            className={classNames(entryClasses, styles.media)}\r\n            body={e.body}\r\n            maySpawn={e.maySpawn}\r\n            hubId={this.props.hubId}\r\n          />\r\n        );\r\n      case \"video\":\r\n        return (\r\n          <VideoMessage\r\n            key={e.key}\r\n            name={e.name}\r\n            className={classNames(entryClasses, styles.media)}\r\n            body={e.body}\r\n            maySpawn={e.maySpawn}\r\n            hubId={this.props.hubId}\r\n          />\r\n        );\r\n      case \"log\":\r\n        return (\r\n          <div key={e.key} className={classNames(entryClasses)}>\r\n            {e.body}\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const presenceClasses = {\r\n      [styles.presenceLog]: true,\r\n      [styles.presenceLogInRoom]: this.props.inRoom\r\n    };\r\n\r\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\r\nimport styles from \"../assets/stylesheets/presence-list.scss\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faCubes } from \"@fortawesome/free-solid-svg-icons/faCubes\";\r\nimport { faCube } from \"@fortawesome/free-solid-svg-icons/faCube\";\r\nimport { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\r\nimport { faMusic } from \"@fortawesome/free-solid-svg-icons/faMusic\";\r\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\r\nimport { faNewspaper } from \"@fortawesome/free-solid-svg-icons/faNewspaper\";\r\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\r\nimport {\r\n  SORT_ORDER_VIDEO,\r\n  SORT_ORDER_AUDIO,\r\n  SORT_ORDER_IMAGE,\r\n  SORT_ORDER_PDF,\r\n  SORT_ORDER_MODEL,\r\n  SORT_ORDER_UNIDENTIFIED,\r\n  mediaSortOrder,\r\n  mediaSort\r\n} from \"../utils/media-sorting.js\";\r\n\r\nconst THUMBNAIL_TITLE = new Map([\r\n  [SORT_ORDER_VIDEO, \"Video\"],\r\n  [SORT_ORDER_AUDIO, \"Audio\"],\r\n  [SORT_ORDER_IMAGE, \"Image\"],\r\n  [SORT_ORDER_PDF, \"PDF\"],\r\n  [SORT_ORDER_UNIDENTIFIED, \"Unknown Media Type\"],\r\n  [SORT_ORDER_MODEL, \"Model\"]\r\n]);\r\n\r\nconst DISPLAY_IMAGE = new Map([\r\n  [SORT_ORDER_VIDEO, faVideo],\r\n  [SORT_ORDER_AUDIO, faMusic],\r\n  [SORT_ORDER_IMAGE, faImage],\r\n  [SORT_ORDER_PDF, faNewspaper],\r\n  [SORT_ORDER_UNIDENTIFIED, faQuestion],\r\n  [SORT_ORDER_MODEL, faCube]\r\n]);\r\n\r\nfunction getDisplayString(el) {\r\n  // Having a listed-media component does not guarantee the existence of a media-loader component,\r\n  // so don't crash if there isn't one.\r\n  const url = (el.components[\"media-loader\"] && el.components[\"media-loader\"].data.src) || \"\";\r\n  const split = url.split(\"/\");\r\n  const resourceName = split[split.length - 1].split(\"?\")[0];\r\n  let httpIndex = -1;\r\n  for (let i = 0; i < split.length; i++) {\r\n    if (split[i].indexOf(\"http\") !== -1) {\r\n      httpIndex = i;\r\n    }\r\n  }\r\n\r\n  let host = \"\";\r\n  let lessHost = \"\";\r\n  if (httpIndex !== -1 && split.length > httpIndex + 3) {\r\n    host = split[httpIndex + 2];\r\n    const hostSplit = host.split(\".\");\r\n    if (hostSplit.length > 1) {\r\n      lessHost = `${hostSplit[hostSplit.length - 2]}.${hostSplit[hostSplit.length - 1]}`;\r\n    }\r\n  }\r\n\r\n  const firstPart =\r\n    url.indexOf(\"poly.google\") !== -1\r\n      ? \"Google Poly\"\r\n      : url.indexOf(\"sketchfab.com\") !== -1\r\n        ? \"Sketchfab\"\r\n        : url.indexOf(\"youtube.com\") !== -1\r\n          ? \"YouTube\"\r\n          : lessHost;\r\n\r\n  return `${firstPart} ... ${resourceName.substr(0, 4)}`;\r\n}\r\n\r\nexport default class ObjectList extends Component {\r\n  static propTypes = {\r\n    onInspectObject: PropTypes.func,\r\n    onExpand: PropTypes.func,\r\n    scene: PropTypes.object,\r\n    expanded: PropTypes.bool\r\n  };\r\n\r\n  state = {\r\n    inspecting: false,\r\n    mediaEntities: []\r\n  };\r\n\r\n  componentDidMount() {\r\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\r\n      if (this.props.expanded) {\r\n        this.props.onExpand(false, true);\r\n      }\r\n    });\r\n    this.updateMediaEntities = this.updateMediaEntities.bind(this);\r\n    this.updateMediaEntities();\r\n    this.props.scene.addEventListener(\"listed_media_changed\", () => setTimeout(() => this.updateMediaEntities(), 0));\r\n    // HACK: The listed-media component exists before the media-loader component does, in cases where an entity is created from a network template because of an incoming message, so don't updateMediaEntities right away.\r\n    // Sorry in advance for the day this comment is out of date.\r\n  }\r\n\r\n  updateMediaEntities() {\r\n    const mediaEntities = [...this.props.scene.systems[\"listed-media\"].els];\r\n    mediaEntities.sort(mediaSort);\r\n    this.setState({ mediaEntities });\r\n  }\r\n\r\n  componentDidUpdate() {}\r\n\r\n  domForEntity(el, i) {\r\n    return (\r\n      <div\r\n        key={i}\r\n        className={styles.rowNoMargin}\r\n        onMouseDown={() => {\r\n          this.props.onExpand(false, false);\r\n          this.props.onInspectObject(el);\r\n        }}\r\n        onMouseOut={() => {\r\n          if (this.props.expanded && !AFRAME.utils.device.isMobileVR()) {\r\n            AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n          }\r\n        }}\r\n        onMouseOver={() => {\r\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.inspect(el.object3D, 1.5, true);\r\n        }}\r\n      >\r\n        <div title={THUMBNAIL_TITLE.get(mediaSortOrder(el))} className={styles.icon}>\r\n          <FontAwesomeIcon icon={DISPLAY_IMAGE.get(mediaSortOrder(el))} />\r\n        </div>\r\n        <div className={classNames({ [styles.listItem]: true })}>\r\n          <div className={styles.presence}>\r\n            <p>{getDisplayString(el)}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderExpandedList() {\r\n    return (\r\n      <div className={styles.presenceList}>\r\n        <div className={styles.contents}>\r\n          <div className={styles.rows}>{this.state.mediaEntities.map(this.domForEntity.bind(this))}</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div\r\n          title={\"Media\"}\r\n          onClick={() => {\r\n            this.props.onExpand(\r\n              !this.props.expanded && this.state.mediaEntities.length > 0,\r\n              !AFRAME.utils.device.isMobileVR()\r\n            );\r\n          }}\r\n          className={classNames({\r\n            [rootStyles.objectList]: true,\r\n            [rootStyles.presenceInfoSelected]: this.props.expanded\r\n          })}\r\n        >\r\n          <FontAwesomeIcon icon={faCubes} />\r\n          <span className={rootStyles.occupantCount}>{this.state.mediaEntities.length}</span>\r\n        </div>\r\n        {this.props.expanded && this.renderExpandedList()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport classNames from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\r\nimport { faUserAlt } from \"@fortawesome/free-solid-svg-icons/faUserAlt\";\r\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\r\nimport { faCog } from \"@fortawesome/free-solid-svg-icons/faCog\";\r\nimport { faDoorClosed } from \"@fortawesome/free-solid-svg-icons/faDoorClosed\";\r\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\r\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons/faInfoCircle\";\r\nimport { faBars } from \"@fortawesome/free-solid-svg-icons/faBars\";\r\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\r\nimport { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport { messages } from \"../utils/i18n\";\r\nimport IfFeature from \"./if-feature\";\r\nimport StateLink from \"./state-link.js\";\r\nimport { resetTips } from \"../systems/tips\";\r\nimport { showFullScreenIfAvailable } from \"../utils/fullscreen\";\r\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\r\n\r\nimport styles from \"../assets/stylesheets/settings-menu.scss\";\r\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\r\n\r\nexport default class SettingsMenu extends Component {\r\n  static propTypes = {\r\n    history: PropTypes.object,\r\n    isStreaming: PropTypes.bool,\r\n    toggleStreamerMode: PropTypes.func,\r\n    mediaSearchStore: PropTypes.object,\r\n    scene: PropTypes.object,\r\n    showAsOverlay: PropTypes.bool, // Shows the settings as an overlay menu, instead of a dropdown\r\n    onCloseOverlay: PropTypes.func,\r\n    hubScene: PropTypes.object,\r\n    hubChannel: PropTypes.object,\r\n    performConditionalSignIn: PropTypes.func,\r\n    showNonHistoriedDialog: PropTypes.func,\r\n    showPreferencesScreen: PropTypes.func,\r\n    pushHistoryState: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    expanded: false\r\n  };\r\n\r\n  unexpand() {\r\n    if (this.state.expanded && !this.props.showAsOverlay) {\r\n      this.setState({ expanded: false });\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onMouseUp = () => this.unexpand();\r\n    this.acanvas = document.querySelector(\".a-canvas\");\r\n    this.acanvas.addEventListener(\"mouseup\", this.onMouseUp);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.acanvas.removeEventListener(\"mouseup\", this.onMouseUp);\r\n  }\r\n\r\n  renderExpandedMenu() {\r\n    const rowClasses = classNames([styles.row, styles.settingsRow]);\r\n    const rowHeader = classNames([styles.row, styles.settingsRow, styles.rowHeader]);\r\n\r\n    // When showing as overlay, hide some menu items for now since the overlay mode is intended for immersive\r\n    // mode browsers which have limited vertical screen real estate.\r\n    //\r\n    // The reason I didn't do this with CSS is because this changes available functionality, so being more\r\n    // explicit in code seems like a wise idea.\r\n    const hideExtranousItems = this.props.showAsOverlay;\r\n\r\n    const showRoomSettings = !!this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\r\n    const showCloseRoom = !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\r\n    const showRoomInfo = !!this.props.hubScene && !hideExtranousItems;\r\n    const showRoomSection = showRoomSettings || showRoomInfo || showCloseRoom;\r\n    const showStreamerMode =\r\n      this.props.scene.is(\"entered\") && !!this.props.hubChannel.canOrWillIfCreator(\"kick_users\") && !hideExtranousItems;\r\n\r\n    // Draw self first\r\n    return (\r\n      <div\r\n        className={classNames({\r\n          [styles.settingsMenuDrop]: !this.props.showAsOverlay,\r\n          [styles.settingsMenuOverlay]: this.props.showAsOverlay\r\n        })}\r\n      >\r\n        {!this.props.showAsOverlay && <div className={styles.attachPoint} />}\r\n        <div className={styles.contents}>\r\n          {this.props.showAsOverlay && (\r\n            <button autoFocus className={styles.closeButton} onClick={() => this.props.onCloseOverlay()}>\r\n              <i>\r\n                <FontAwesomeIcon icon={faTimes} />\r\n              </i>\r\n            </button>\r\n          )}\r\n          <div className={styles.rows}>\r\n            {!hideExtranousItems && (\r\n              <div className={rowHeader}>\r\n                <FormattedMessage id=\"settings.row-profile\" />\r\n              </div>\r\n            )}\r\n            <div className={rowClasses}>\r\n              <div className={styles.icon}>\r\n                <i>\r\n                  <FontAwesomeIcon icon={faUserAlt} />\r\n                </i>\r\n              </div>\r\n              <div className={styles.listItem}>\r\n                <StateLink\r\n                  stateKey=\"overlay\"\r\n                  stateValue=\"profile\"\r\n                  history={this.props.history}\r\n                  onClick={() => this.unexpand()}\r\n                >\r\n                  <FormattedMessage id=\"settings.change-avatar\" />\r\n                </StateLink>\r\n              </div>\r\n            </div>\r\n            <div className={rowClasses}>\r\n              <div className={styles.icon}>\r\n                <i>\r\n                  <FontAwesomeIcon icon={faStar} />\r\n                </i>\r\n              </div>\r\n              <div className={styles.listItem}>\r\n                <div\r\n                  className={styles.listItemLink}\r\n                  onClick={() => {\r\n                    this.props.performConditionalSignIn(\r\n                      () => this.props.hubChannel.signedIn,\r\n                      () => {\r\n                        showFullScreenIfAvailable();\r\n                        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"favorites\", \"use\");\r\n                      },\r\n                      \"favorite-rooms\"\r\n                    );\r\n                  }}\r\n                >\r\n                  <FormattedMessage id=\"settings.favorites\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className={rowClasses}>\r\n              <div className={styles.icon}>\r\n                <i>\r\n                  <FontAwesomeIcon icon={faCog} />\r\n                </i>\r\n              </div>\r\n              <div className={styles.listItem}>\r\n                <div\r\n                  className={styles.listItemLink}\r\n                  onClick={() => {\r\n                    this.props.showPreferencesScreen();\r\n                  }}\r\n                >\r\n                  <FormattedMessage id=\"settings.preferences\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {showRoomSection &&\r\n              !hideExtranousItems && (\r\n                <div className={rowHeader}>\r\n                  <FormattedMessage id=\"settings.row-room\" />\r\n                </div>\r\n              )}\r\n            {showRoomSettings && (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faImage} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <div\r\n                    className={styles.listItemLink}\r\n                    onClick={() => {\r\n                      this.props.performConditionalSignIn(\r\n                        () => this.props.hubChannel.can(\"update_hub\"),\r\n                        () => {\r\n                          showFullScreenIfAvailable();\r\n                          this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\r\n                          this.unexpand();\r\n                        },\r\n                        \"change-scene\"\r\n                      );\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.change-scene\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {showRoomSettings && (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faPencilAlt} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <a\r\n                    href=\"#\"\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n\r\n                      this.props.performConditionalSignIn(\r\n                        () => this.props.hubChannel.can(\"update_hub\"),\r\n                        () => {\r\n                          this.props.pushHistoryState(\"modal\", \"room_settings\");\r\n                          this.unexpand();\r\n                        },\r\n                        \"room-settings\"\r\n                      );\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.room-settings\" />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {showCloseRoom && (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faDoorClosed} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <a\r\n                    href=\"#\"\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n\r\n                      this.props.performConditionalSignIn(\r\n                        () => this.props.hubChannel.can(\"update_hub\"),\r\n                        () => {\r\n                          this.props.pushHistoryState(\"modal\", \"close_room\");\r\n                          this.unexpand();\r\n                        },\r\n                        \"close-room\"\r\n                      );\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.close-room\" />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {showRoomInfo && (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faInfoCircle} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <StateLink\r\n                    stateKey=\"modal\"\r\n                    stateValue=\"room_info\"\r\n                    history={this.props.history}\r\n                    onClick={() => this.unexpand()}\r\n                  >\r\n                    <FormattedMessage id=\"settings.room-info\" />\r\n                  </StateLink>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {!hideExtranousItems && (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faPlus} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <a\r\n                    href=\"#\"\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.props.showNonHistoriedDialog(LeaveRoomDialog, {\r\n                        destinationUrl: \"/\",\r\n                        messageType: \"create-room\"\r\n                      });\r\n                      this.unexpand();\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.create-room\" />\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {showStreamerMode && !hideExtranousItems ? (\r\n              <div className={rowHeader}>\r\n                <FormattedMessage id=\"settings.row-tools\" />\r\n              </div>\r\n            ) : (\r\n              <div />\r\n            )}\r\n            {showStreamerMode ? (\r\n              <div className={rowClasses}>\r\n                <div className={styles.icon}>\r\n                  <i>\r\n                    <FontAwesomeIcon icon={faVideo} />\r\n                  </i>\r\n                </div>\r\n                <div className={styles.listItem}>\r\n                  <div\r\n                    className={styles.listItemLink}\r\n                    onClick={() => {\r\n                      this.props.toggleStreamerMode(true);\r\n                      this.unexpand();\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.enable-streamer-mode\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div />\r\n            )}\r\n            {this.props.showAsOverlay && (\r\n              <div className={rowClasses}>\r\n                <div className={classNames([styles.listItem, styles.secondaryLinkItem])}>\r\n                  <div className={styles.secondaryButton} onClick={() => this.props.onCloseOverlay()}>\r\n                    <FormattedMessage id=\"settings.return-to-vr\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {!hideExtranousItems && (\r\n              <div className={classNames([styles.bottomLinksMain])}>\r\n                <IfFeature name=\"show_whats_new_link\">\r\n                  <a href=\"/whats-new\" target=\"_blank\" rel=\"noreferrer noopener\">\r\n                    <FormattedMessage id=\"settings.whats-new\" />\r\n                  </a>\r\n                </IfFeature>\r\n                <button\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    resetTips();\r\n                    this.setState({ expanded: false });\r\n                  }}\r\n                >\r\n                  <FormattedMessage id=\"settings.tips\" />\r\n                </button>\r\n                <IfFeature name=\"show_controls_link\">\r\n                  <a\r\n                    href={configs.link(\"controls\", \"https://github.com/mozilla/hubs/wiki/Hubs-Controls\")}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.controls\" />\r\n                  </a>\r\n                </IfFeature>\r\n              </div>\r\n            )}\r\n            {!hideExtranousItems && (\r\n              <div className={classNames([styles.bottomLinks])}>\r\n                <IfFeature name=\"show_features_link\">\r\n                  <a\r\n                    href={configs.link(\"features\", messages[\"help.docs_url\"])}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.features\" />\r\n                  </a>\r\n                </IfFeature>\r\n                <IfFeature name=\"show_community_link\">\r\n                  <a\r\n                    href={configs.link(\"community\", \"https://discord.gg/wHmY4nd\")}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.community\" />\r\n                  </a>\r\n                </IfFeature>\r\n                <IfFeature name=\"show_feedback_ui\">\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.props.pushHistoryState(\"modal\", \"feedback\");\r\n                    }}\r\n                  >\r\n                    <FormattedMessage id=\"settings.send-feedback\" />\r\n                  </button>\r\n                </IfFeature>\r\n                <IfFeature name=\"show_issue_report_link\">\r\n                  <a\r\n                    className={styles.bottomLink}\r\n                    href={configs.link(\"issue_report\", \"/#/report\")}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.report\" />\r\n                  </a>\r\n                </IfFeature>\r\n                <IfFeature name=\"show_terms\">\r\n                  <a\r\n                    className={styles.bottomLink}\r\n                    href={configs.link(\"terms_of_use\", \"https://github.com/mozilla/hubs/blob/master/TERMS.md\")}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.terms\" />\r\n                  </a>\r\n                </IfFeature>\r\n                <IfFeature name=\"show_privacy\">\r\n                  <a\r\n                    className={styles.bottomLink}\r\n                    href={configs.link(\"privacy_notice\", \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\")}\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer noopener\"\r\n                  >\r\n                    <FormattedMessage id=\"settings.privacy\" />\r\n                  </a>\r\n                </IfFeature>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {!this.props.showAsOverlay && (\r\n          <FontAwesomeIcon\r\n            icon={faBars}\r\n            onClick={() => this.setState({ expanded: !this.state.expanded })}\r\n            className={classNames({\r\n              [rootStyles.cornerButton]: true,\r\n              [rootStyles.cornerButtonSelected]: this.state.expanded\r\n            })}\r\n          />\r\n        )}\r\n        {this.props.showAsOverlay ? (\r\n          <div className={styles.settingsMenuOverlayWrap}>{this.renderExpandedMenu()}</div>\r\n        ) : (\r\n          this.state.expanded && this.renderExpandedMenu()\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport styles from \"../assets/stylesheets/preload-overlay.scss\";\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\n\r\nexport default class PreloadOverlay extends Component {\r\n  static propTypes = {\r\n    hubName: PropTypes.string,\r\n    hubScene: PropTypes.object,\r\n    baseUrl: PropTypes.string,\r\n    onLoadClicked: PropTypes.func\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.treatment}>\r\n        <div className={styles.screenshot}>\r\n          {this.props.hubScene && <img className={styles.screenshot} src={this.props.hubScene.screenshot_url} />}\r\n        </div>\r\n        <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className={styles.logo}>\r\n          <img src={configs.image(\"logo\")} />\r\n        </a>\r\n        <div className={styles.mainPanel}>\r\n          <div className={styles.hubName}>{this.props.hubName}</div>\r\n          {this.props.onLoadClicked &&\r\n            (!isMobile ? (\r\n              <button className={styles.loadButton} onClick={this.props.onLoadClicked}>\r\n                <FormattedMessage id=\"embed.load-button\" />\r\n              </button>\r\n            ) : (\r\n              <a href={this.props.baseUrl} target=\"_blank\" className={styles.loadButton} rel=\"noreferrer noopener\">\r\n                <FormattedMessage id=\"embed.load-button\" />\r\n              </a>\r\n            ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cx from \"classnames\";\r\n\r\nimport styles from \"../assets/stylesheets/2d-hud.scss\";\r\nimport uiStyles from \"../assets/stylesheets/ui-root.scss\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { micLevelForVolume } from \"../components/audio-feedback\";\r\nimport SpawnIcon from \"../assets/images/spawn.svgi\";\r\nimport ShareScreenIconActive from \"../assets/images/share_screen_active.svgi\";\r\nimport ShareScreenIcon from \"../assets/images/share_screen.svgi\";\r\nimport ShareCameraIconActive from \"../assets/images/share_camera_active.svgi\";\r\nimport ShareCameraIcon from \"../assets/images/share_camera.svgi\";\r\nimport PenIcon from \"../assets/images/pen.svgi\";\r\nimport PenIconActive from \"../assets/images/pen_active.svgi\";\r\nimport CameraIcon from \"../assets/images/camera.svgi\";\r\nimport CameraIconActive from \"../assets/images/camera_active.svgi\";\r\nimport Mic0 from \"../assets/images/mic-0.svgi\";\r\nimport Mic1 from \"../assets/images/mic-1.svgi\";\r\nimport Mic2 from \"../assets/images/mic-2.svgi\";\r\nimport Mic3 from \"../assets/images/mic-3.svgi\";\r\nimport Mic4 from \"../assets/images/mic-4.svgi\";\r\nimport Mic5 from \"../assets/images/mic-5.svgi\";\r\nimport Mic6 from \"../assets/images/mic-6.svgi\";\r\nimport Mic7 from \"../assets/images/mic-7.svgi\";\r\nimport MicOff0 from \"../assets/images/mic-off-0.svgi\";\r\nimport MicOff1 from \"../assets/images/mic-off-1.svgi\";\r\nimport MicOff2 from \"../assets/images/mic-off-2.svgi\";\r\nimport MicOff3 from \"../assets/images/mic-off-3.svgi\";\r\nimport MicOff4 from \"../assets/images/mic-off-4.svgi\";\r\nimport MicOff5 from \"../assets/images/mic-off-5.svgi\";\r\nimport MicOff6 from \"../assets/images/mic-off-6.svgi\";\r\nimport MicOff7 from \"../assets/images/mic-off-7.svgi\";\r\n\r\nimport { InlineSVG } from \"./svgi\";\r\n\r\nconst MIC_ICONS = {\r\n  on: [Mic0, Mic1, Mic2, Mic3, Mic4, Mic5, Mic6, Mic7],\r\n  off: [MicOff0, MicOff1, MicOff2, MicOff3, MicOff4, MicOff5, MicOff6, MicOff7]\r\n};\r\n\r\nconst noop = () => {};\r\n\r\nclass TopHUD extends Component {\r\n  static propTypes = {\r\n    scene: PropTypes.object,\r\n    muted: PropTypes.bool,\r\n    isCursorHoldingPen: PropTypes.bool,\r\n    hasActiveCamera: PropTypes.bool,\r\n    frozen: PropTypes.bool,\r\n    watching: PropTypes.bool,\r\n    onWatchEnded: PropTypes.func,\r\n    videoShareMediaSource: PropTypes.string,\r\n    showVideoShareFailed: PropTypes.bool,\r\n    hideVideoShareFailedTip: PropTypes.func,\r\n    activeTip: PropTypes.string,\r\n    history: PropTypes.object,\r\n    onToggleMute: PropTypes.func,\r\n    onSpawnPen: PropTypes.func,\r\n    onSpawnCamera: PropTypes.func,\r\n    onShareVideo: PropTypes.func,\r\n    onEndShareVideo: PropTypes.func,\r\n    onShareVideoNotCapable: PropTypes.func,\r\n    mediaSearchStore: PropTypes.object,\r\n    isStreaming: PropTypes.bool,\r\n    showStreamingTip: PropTypes.bool,\r\n    hideStreamingTip: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    showVideoShareOptions: false,\r\n    lastActiveMediaSource: null,\r\n    micLevel: 0,\r\n    cameraDisabled: false,\r\n    penDisabled: false,\r\n    mediaDisabled: false\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.cameraDisabled = !window.APP.hubChannel.can(\"spawn_camera\");\r\n    this.state.penDisabled = !window.APP.hubChannel.can(\"spawn_drawing\");\r\n    this.state.mediaDisabled = !window.APP.hubChannel.can(\"spawn_and_move_media\");\r\n  }\r\n\r\n  onPermissionsUpdated = () => {\r\n    this.setState({\r\n      cameraDisabled: !window.APP.hubChannel.can(\"spawn_camera\"),\r\n      penDisabled: !window.APP.hubChannel.can(\"spawn_drawing\"),\r\n      mediaDisabled: !window.APP.hubChannel.can(\"spawn_and_move_media\")\r\n    });\r\n  };\r\n\r\n  componentDidMount = () => {\r\n    let max = 0;\r\n    if (this.micUpdateInterval) {\r\n      clearInterval(this.micUpdateInterval);\r\n    }\r\n    this.micUpdateInterval = setInterval(() => {\r\n      const volume = this.props.scene.systems[\"local-audio-analyser\"].volume;\r\n      max = Math.max(volume, max);\r\n      const micLevel = micLevelForVolume(volume, max);\r\n      if (micLevel !== this.state.micLevel) {\r\n        this.setState({ micLevel });\r\n      }\r\n    }, 50);\r\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.onPermissionsUpdated);\r\n    this.onPermissionsUpdated();\r\n  };\r\n\r\n  componentWillUnmount = () => {\r\n    if (this.micUpdateInterval) {\r\n      clearInterval(this.micUpdateInterval);\r\n    }\r\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.onPermissionsUpdated);\r\n  };\r\n\r\n  handleVideoShareClicked = source => {\r\n    if (source === \"screen\" && !navigator.mediaDevices.getDisplayMedia) {\r\n      this.props.onShareVideoNotCapable();\r\n      return;\r\n    }\r\n\r\n    if (this.props.videoShareMediaSource) {\r\n      this.props.onEndShareVideo();\r\n    } else {\r\n      this.props.onShareVideo(source);\r\n      this.setState({ lastActiveMediaSource: source });\r\n    }\r\n  };\r\n\r\n  buildVideoSharingButtons = () => {\r\n    const isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\r\n\r\n    const videoShareExtraOptionTypes = [];\r\n    const primaryVideoShareType =\r\n      this.props.videoShareMediaSource || this.state.lastActiveMediaSource || (isMobile ? \"camera\" : \"screen\");\r\n\r\n    if (this.state.showVideoShareOptions) {\r\n      videoShareExtraOptionTypes.push(primaryVideoShareType);\r\n\r\n      [\"screen\", \"camera\"].forEach(t => {\r\n        if (videoShareExtraOptionTypes.indexOf(t) === -1) {\r\n          videoShareExtraOptionTypes.push(t);\r\n        }\r\n      });\r\n    }\r\n\r\n    const showExtrasOnHover = () => {\r\n      if (isMobile) return;\r\n\r\n      clearTimeout(this.hideVideoSharingButtonTimeout);\r\n\r\n      if (!this.props.videoShareMediaSource) {\r\n        this.setState({ showVideoShareOptions: true });\r\n      }\r\n    };\r\n\r\n    const hideExtrasOnOut = () => {\r\n      this.hideVideoSharingButtonTimeout = setTimeout(() => {\r\n        this.setState({ showVideoShareOptions: false });\r\n      }, 250);\r\n    };\r\n\r\n    const maybeHandlePrimaryShare = () => {\r\n      if (!this.state.showVideoShareOptions) {\r\n        this.handleVideoShareClicked(primaryVideoShareType);\r\n      }\r\n    };\r\n\r\n    const capitalize = str => str[0].toUpperCase() + str.slice(1);\r\n    const iconForType = (type, active) => {\r\n      if (active) {\r\n        return type === \"screen\" ? ShareScreenIconActive : ShareCameraIconActive;\r\n      } else {\r\n        return type === \"screen\" ? ShareScreenIcon : ShareCameraIcon;\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        className={cx(styles.iconButton, {\r\n          [styles.disabled]: this.state.mediaDisabled,\r\n          [styles.videoShare]: true\r\n        })}\r\n        title={\r\n          this.props.videoShareMediaSource !== null\r\n            ? \"Stop sharing\"\r\n            : `Share ${capitalize(primaryVideoShareType)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\r\n        }\r\n        onClick={this.state.mediaDisabled ? noop : maybeHandlePrimaryShare}\r\n        onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\r\n      >\r\n        <InlineSVG\r\n          className={cx(styles.iconButtonIcon)}\r\n          src={iconForType(primaryVideoShareType, this.props.videoShareMediaSource === primaryVideoShareType)}\r\n        />\r\n        {videoShareExtraOptionTypes.length > 0 && (\r\n          <div className={cx(styles.videoShareExtraOptions)} onMouseOut={hideExtrasOnOut}>\r\n            {videoShareExtraOptionTypes.map(type => (\r\n              <div\r\n                key={type}\r\n                className={cx(styles.iconButton, {\r\n                  [styles.disabled]: this.state.mediaDisabled\r\n                })}\r\n                title={\r\n                  this.props.videoShareMediaSource === type\r\n                    ? \"Stop sharing\"\r\n                    : `Share ${capitalize(type)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\r\n                }\r\n                onClick={this.state.mediaDisabled ? noop : () => this.handleVideoShareClicked(type)}\r\n                onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\r\n              >\r\n                <InlineSVG\r\n                  className={cx(styles.iconButtonIcon)}\r\n                  src={iconForType(type, this.props.videoShareMediaSource === type)}\r\n                />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const videoSharingButtons = this.buildVideoSharingButtons();\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const tipDivForType = (type, cancelFunc) => (\r\n      <div className={cx(styles.topTip)}>\r\n        {cancelFunc && (\r\n          <button className={styles.tipCancel} onClick={cancelFunc}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </button>\r\n        )}\r\n        {!this.props.frozen && <div className={cx([styles.attachPoint, styles[`attach_${type.split(\".\")[1]}`]])} />}\r\n        <FormattedMessage id={`tips.${type}`} />\r\n      </div>\r\n    );\r\n\r\n    let tip;\r\n\r\n    if (this.props.watching) {\r\n      tip = (\r\n        <div className={cx([styles.topTip, styles.topTipNoHud])}>\r\n          <button className={styles.tipCancel} onClick={() => this.props.onWatchEnded()}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </button>\r\n          <FormattedMessage id={`tips.${isMobile ? \"mobile\" : \"desktop\"}.watching`} />\r\n          {!isMobile && (\r\n            <button className={styles.tipCancelText} onClick={() => this.props.onWatchEnded()}>\r\n              <FormattedMessage id=\"tips.watching.back\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n      );\r\n    } else if (this.props.showVideoShareFailed) {\r\n      tip = tipDivForType(`${isMobile ? \"mobile\" : \"desktop\"}.video_share_failed`, this.props.hideVideoShareFailedTip);\r\n    } else if (this.props.activeTip) {\r\n      tip = tipDivForType(this.props.activeTip);\r\n    }\r\n\r\n    const micLevel = this.state.micLevel;\r\n    const micIcon = MIC_ICONS[this.props.muted ? \"off\" : \"on\"][micLevel];\r\n    // Hide buttons when frozen.\r\n    return (\r\n      <div className={cx(styles.container, styles.top, styles.unselectable, uiStyles.uiInteractive)}>\r\n        {this.props.frozen || this.props.watching ? (\r\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>{tip}</div>\r\n        ) : (\r\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>\r\n            {tip}\r\n            {videoSharingButtons}\r\n            <div\r\n              className={cx(styles.iconButton)}\r\n              title={this.props.muted ? \"Unmute Mic\" : \"Mute Mic\"}\r\n              onClick={this.props.onToggleMute}\r\n            >\r\n              <InlineSVG className={cx(styles.iconButtonIcon)} src={micIcon} />\r\n            </div>\r\n            <div\r\n              className={cx(styles.iconButton, {\r\n                [styles.disabled]: this.state.mediaDisabled\r\n              })}\r\n              title={`Create${this.state.mediaDisabled ? \" Disabled\" : \"\"}`}\r\n              onClick={\r\n                this.state.mediaDisabled ? noop : () => this.props.mediaSearchStore.sourceNavigateToDefaultSource()\r\n              }\r\n            >\r\n              <InlineSVG className={cx(styles.iconButtonIcon, styles.spawn)} src={SpawnIcon} />\r\n            </div>\r\n            <div\r\n              className={cx(styles.iconButton, {\r\n                [styles.disabled]: this.state.penDisabled\r\n              })}\r\n              title={`Pen${this.state.penDisabled ? \" Disabled\" : \"\"}`}\r\n              onClick={this.state.penDisabled ? noop : this.props.onSpawnPen}\r\n            >\r\n              <InlineSVG\r\n                className={cx(styles.iconButtonIcon)}\r\n                src={this.props.isCursorHoldingPen ? PenIconActive : PenIcon}\r\n              />\r\n            </div>\r\n            <div\r\n              className={cx(styles.iconButton, {\r\n                [styles.disabled]: this.state.cameraDisabled\r\n              })}\r\n              title={`Camera${this.state.cameraDisabled ? \" Disabled\" : \"\"}`}\r\n              onClick={this.state.cameraDisabled ? noop : this.props.onSpawnCamera}\r\n            >\r\n              <InlineSVG\r\n                className={cx(styles.iconButtonIcon)}\r\n                src={this.props.hasActiveCamera ? CameraIconActive : CameraIcon}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default { TopHUD };\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport styles from \"../assets/stylesheets/spectating-label.scss\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nexport class SpectatingLabel extends Component {\r\n  static propTypes = {\r\n    name: PropTypes.string\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.label}>\r\n        <FormattedMessage id=\"lobby.watching\" />\r\n        <b>{this.props.name}</b>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport classNames from \"classnames\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\r\nimport en from \"react-intl/locale-data/en\";\r\nimport screenfull from \"screenfull\";\r\n\r\nimport configs from \"../utils/configs\";\r\nimport IfFeature from \"./if-feature\";\r\nimport UnlessFeature from \"./unless-feature\";\r\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\r\nimport { canShare } from \"../utils/share\";\r\nimport styles from \"../assets/stylesheets/ui-root.scss\";\r\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\r\nimport inviteStyles from \"../assets/stylesheets/invite-dialog.scss\";\r\nimport { ReactAudioContext } from \"./wrap-with-audio\";\r\nimport {\r\n  pushHistoryState,\r\n  clearHistoryState,\r\n  popToBeginningOfHubHistory,\r\n  navigateToPriorPage,\r\n  sluglessPath\r\n} from \"../utils/history\";\r\nimport StateRoute from \"./state-route.js\";\r\nimport { getPresenceProfileForSession, discordBridgesForPresences } from \"../utils/phoenix-utils\";\r\nimport { getClientInfoClientId } from \"./client-info-dialog\";\r\nimport { getCurrentStreamer } from \"../utils/component-utils\";\r\n\r\nimport { lang, messages } from \"../utils/i18n\";\r\nimport Loader from \"./loader\";\r\nimport AutoExitWarning from \"./auto-exit-warning\";\r\nimport { TwoDEntryButton, GenericEntryButton, DaydreamEntryButton } from \"./entry-buttons.js\";\r\nimport ProfileEntryPanel from \"./profile-entry-panel\";\r\nimport MediaBrowser from \"./media-browser\";\r\n\r\nimport CreateObjectDialog from \"./create-object-dialog.js\";\r\nimport ChangeSceneDialog from \"./change-scene-dialog.js\";\r\nimport AvatarUrlDialog from \"./avatar-url-dialog.js\";\r\nimport InviteDialog from \"./invite-dialog.js\";\r\nimport InviteTeamDialog from \"./invite-team-dialog.js\";\r\nimport LinkDialog from \"./link-dialog.js\";\r\nimport SafariDialog from \"./safari-dialog.js\";\r\nimport SignInDialog from \"./sign-in-dialog.js\";\r\nimport RoomSettingsDialog from \"./room-settings-dialog.js\";\r\nimport CloseRoomDialog from \"./close-room-dialog.js\";\r\nimport Tip from \"./tip.js\";\r\nimport WebRTCScreenshareUnsupportedDialog from \"./webrtc-screenshare-unsupported-dialog.js\";\r\nimport WebAssemblyUnsupportedDialog from \"./webassembly-unsupported-dialog.js\";\r\nimport WebVRRecommendDialog from \"./webvr-recommend-dialog.js\";\r\nimport FeedbackDialog from \"./feedback-dialog.js\";\r\nimport HelpDialog from \"./help-dialog.js\";\r\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\r\nimport RoomInfoDialog from \"./room-info-dialog.js\";\r\nimport ClientInfoDialog from \"./client-info-dialog.js\";\r\nimport ObjectInfoDialog from \"./object-info-dialog.js\";\r\nimport OAuthDialog from \"./oauth-dialog.js\";\r\nimport TweetDialog from \"./tweet-dialog.js\";\r\nimport LobbyChatBox from \"./lobby-chat-box.js\";\r\nimport EntryStartPanel from \"./entry-start-panel.js\";\r\nimport InWorldChatBox from \"./in-world-chat-box.js\";\r\nimport AvatarEditor from \"./avatar-editor\";\r\nimport MicLevelWidget from \"./mic-level-widget.js\";\r\nimport PreferencesScreen from \"./preferences-screen.js\";\r\nimport OutputLevelWidget from \"./output-level-widget.js\";\r\nimport PresenceLog from \"./presence-log.js\";\r\nimport PresenceList from \"./presence-list.js\";\r\nimport ObjectList from \"./object-list.js\";\r\nimport SettingsMenu from \"./settings-menu.js\";\r\nimport PreloadOverlay from \"./preload-overlay.js\";\r\nimport TwoDHUD from \"./2d-hud\";\r\nimport { SpectatingLabel } from \"./spectating-label\";\r\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\r\nimport { exit2DInterstitialAndEnterVR, isIn2DInterstitial } from \"../utils/vr-interstitial\";\r\n\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\r\nimport { faQuestion } from \"@fortawesome/free-solid-svg-icons/faQuestion\";\r\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\r\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons/faArrowLeft\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\nimport { CAMERA_MODE_INSPECT } from \"../systems/camera-system\";\r\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\r\n\r\naddLocaleData([...en]);\r\n\r\n// This is a list of regexes that match the microphone labels of HMDs.\r\n//\r\n// If entering VR mode, and if any of these regexes match an audio device,\r\n// the user will be prevented from entering VR until one of those devices is\r\n// selected as the microphone.\r\n//\r\n// Note that this doesn't have to be exhaustive: if no devices match any regex\r\n// then we rely upon the user to select the proper mic.\r\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\r\n\r\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\r\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\r\n\r\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\", \"/media/avatars\", \"/media/favorites\"];\r\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\r\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\", \"avatars\", \"favorites\"];\r\n\r\nasync function grantedMicLabels() {\r\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\r\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\r\n}\r\n\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\nconst isMobilePhoneOrVR = isMobile || isMobileVR;\r\n\r\nconst AUTO_EXIT_TIMER_SECONDS = 10;\r\n\r\nclass UIRoot extends Component {\r\n  willCompileAndUploadMaterials = false;\r\n\r\n  static propTypes = {\r\n    enterScene: PropTypes.func,\r\n    exitScene: PropTypes.func,\r\n    onSendMessage: PropTypes.func,\r\n    disableAutoExitOnIdle: PropTypes.bool,\r\n    forcedVREntryType: PropTypes.string,\r\n    isBotMode: PropTypes.bool,\r\n    store: PropTypes.object,\r\n    mediaSearchStore: PropTypes.object,\r\n    scene: PropTypes.object,\r\n    authChannel: PropTypes.object,\r\n    hubChannel: PropTypes.object,\r\n    linkChannel: PropTypes.object,\r\n    hub: PropTypes.object,\r\n    availableVREntryTypes: PropTypes.object,\r\n    environmentSceneLoaded: PropTypes.bool,\r\n    entryDisallowed: PropTypes.bool,\r\n    roomUnavailableReason: PropTypes.string,\r\n    platformUnsupportedReason: PropTypes.string,\r\n    hubIsBound: PropTypes.bool,\r\n    isSupportAvailable: PropTypes.bool,\r\n    presenceLogEntries: PropTypes.array,\r\n    presences: PropTypes.object,\r\n    sessionId: PropTypes.string,\r\n    subscriptions: PropTypes.object,\r\n    initialIsSubscribed: PropTypes.bool,\r\n    initialIsFavorited: PropTypes.bool,\r\n    showSignInDialog: PropTypes.bool,\r\n    signInMessageId: PropTypes.string,\r\n    signInCompleteMessageId: PropTypes.string,\r\n    signInContinueTextId: PropTypes.string,\r\n    onContinueAfterSignIn: PropTypes.func,\r\n    showSafariDialog: PropTypes.bool,\r\n    showWebAssemblyDialog: PropTypes.bool,\r\n    showOAuthDialog: PropTypes.bool,\r\n    onCloseOAuthDialog: PropTypes.func,\r\n    oauthInfo: PropTypes.array,\r\n    isCursorHoldingPen: PropTypes.bool,\r\n    hasActiveCamera: PropTypes.bool,\r\n    onMediaSearchResultEntrySelected: PropTypes.func,\r\n    onAvatarSaved: PropTypes.func,\r\n    activeTips: PropTypes.object,\r\n    location: PropTypes.object,\r\n    history: PropTypes.object,\r\n    showInterstitialPrompt: PropTypes.bool,\r\n    onInterstitialPromptClicked: PropTypes.func,\r\n    performConditionalSignIn: PropTypes.func,\r\n    hide: PropTypes.bool,\r\n    showPreload: PropTypes.bool,\r\n    onPreloadLoadClicked: PropTypes.func,\r\n    embed: PropTypes.bool,\r\n    embedToken: PropTypes.string,\r\n    onLoaded: PropTypes.func\r\n  };\r\n\r\n  state = {\r\n    enterInVR: false,\r\n    entered: false,\r\n    entering: false,\r\n    dialog: null,\r\n    showShareDialog: false,\r\n    broadcastTipDismissed: false,\r\n    linkCode: null,\r\n    linkCodeCancel: null,\r\n    miniInviteActivated: false,\r\n\r\n    didConnectToNetworkedScene: false,\r\n    noMoreLoadingUpdates: false,\r\n    hideLoader: false,\r\n    showPrefs: false,\r\n    watching: false,\r\n    isStreaming: false,\r\n    showStreamingTip: false,\r\n\r\n    waitingOnAudio: false,\r\n    mediaStream: null,\r\n    audioTrack: null,\r\n    audioTrackClone: null,\r\n    micDevices: [],\r\n\r\n    autoExitTimerStartedAt: null,\r\n    autoExitTimerInterval: null,\r\n    autoExitMessage: null,\r\n    secondsRemainingBeforeAutoExit: Infinity,\r\n\r\n    muted: false,\r\n    frozen: false,\r\n\r\n    exited: false,\r\n\r\n    signedIn: false,\r\n    videoShareMediaSource: null,\r\n    showVideoShareFailed: false,\r\n\r\n    objectInfo: null,\r\n    objectSrc: \"\",\r\n    isObjectListExpanded: false,\r\n    isPresenceListExpanded: false\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (props.showSafariDialog) {\r\n      this.state.dialog = <SafariDialog closable={false} />;\r\n    }\r\n    if (props.showWebAssemblyDialog) {\r\n      this.state.dialog = <WebAssemblyUnsupportedDialog closable={false} />;\r\n    }\r\n\r\n    props.mediaSearchStore.setHistory(props.history);\r\n\r\n    // An exit handler that discards event arguments and can be cleaned up.\r\n    this.exitEventHandler = () => this.exit();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const { hubChannel, showSignInDialog } = this.props;\r\n    if (hubChannel) {\r\n      const { signedIn } = hubChannel;\r\n      if (signedIn !== this.state.signedIn) {\r\n        this.setState({ signedIn });\r\n      }\r\n    }\r\n    if (prevProps.showSignInDialog !== showSignInDialog) {\r\n      if (showSignInDialog) {\r\n        this.showContextualSignInDialog();\r\n      } else {\r\n        this.closeDialog();\r\n      }\r\n    }\r\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\r\n      this.willCompileAndUploadMaterials = true;\r\n      // We want to ensure that react and the browser have had the chance to render / update.\r\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\r\n      window.requestAnimationFrame(() => {\r\n        window.setTimeout(() => {\r\n          if (!this.props.isBotMode) {\r\n            try {\r\n              this.props.scene.renderer.compileAndUploadMaterials(this.props.scene.object3D, this.props.scene.camera);\r\n            } catch {\r\n              this.exit(\"scene_error\"); // https://github.com/mozilla/hubs/issues/1950\r\n            }\r\n          }\r\n\r\n          if (!this.state.hideLoader) {\r\n            this.setState({ hideLoader: true });\r\n          }\r\n        }, 0);\r\n      });\r\n    }\r\n  }\r\n\r\n  onConcurrentLoad = () => {\r\n    if (qsTruthy(\"allow_multi\") || this.props.store.state.preferences[\"allowMultipleHubsInstances\"]) return;\r\n    this.startAutoExitTimer(\"autoexit.concurrent_subtitle\");\r\n  };\r\n\r\n  onIdleDetected = () => {\r\n    if (this.props.disableAutoExitOnIdle || this.state.isStreaming) return;\r\n    this.startAutoExitTimer(\"autoexit.idle_subtitle\");\r\n  };\r\n\r\n  onActivityDetected = () => {\r\n    if (this.state.autoExitTimerInterval) {\r\n      this.endAutoExitTimer();\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\r\n    window.addEventListener(\"idle_detected\", this.onIdleDetected);\r\n    window.addEventListener(\"activity_detected\", this.onActivityDetected);\r\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\r\n      if (this.state.showShareDialog) {\r\n        this.setState({ showShareDialog: false });\r\n      }\r\n    });\r\n\r\n    this.props.scene.addEventListener(\r\n      \"didConnectToNetworkedScene\",\r\n      () => {\r\n        this.setState({ didConnectToNetworkedScene: true });\r\n      },\r\n      { once: true }\r\n    );\r\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\r\n    this.props.scene.addEventListener(\"stateadded\", this.onAframeStateChanged);\r\n    this.props.scene.addEventListener(\"stateremoved\", this.onAframeStateChanged);\r\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\r\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\r\n    this.props.scene.addEventListener(\"share_video_failed\", this.onShareVideoFailed);\r\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\r\n    this.props.scene.addEventListener(\"action_exit_watch\", () => {\r\n      if (this.state.hide) {\r\n        this.setState({ hide: false });\r\n      } else {\r\n        this.setState({ watching: false });\r\n      }\r\n    });\r\n    this.props.scene.addEventListener(\"action_toggle_ui\", () => this.setState({ hide: !this.state.hide }));\r\n\r\n    const scene = this.props.scene;\r\n\r\n    this.props.store.addEventListener(\"statechanged\", this.onStoreChanged);\r\n\r\n    const unsubscribe = this.props.history.listen((location, action) => {\r\n      const state = location.state;\r\n\r\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\r\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\r\n        unsubscribe();\r\n        navigateToPriorPage(this.props.history);\r\n        return;\r\n      }\r\n    });\r\n\r\n    // If we refreshed the page with any state history (eg if we were in the entry flow\r\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\r\n    // erasing all history that was accumulated for this room (including across refreshes.)\r\n    //\r\n    // We don't do this for the media browser case, since we want to be able to share\r\n    // links to the browser pages\r\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\r\n      popToBeginningOfHubHistory(this.props.history);\r\n    }\r\n\r\n    this.setState({\r\n      audioContext: {\r\n        playSound: sound => {\r\n          scene.emit(sound);\r\n        },\r\n        onMouseLeave: () => {\r\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\r\n        }\r\n      }\r\n    });\r\n\r\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\r\n      this.props.scene.addEventListener(\r\n        \"loading_finished\",\r\n        () => {\r\n          setTimeout(() => this.handleForceEntry(), 1000);\r\n        },\r\n        { once: true }\r\n      );\r\n    }\r\n\r\n    this.playerRig = scene.querySelector(\"#avatar-rig\");\r\n  }\r\n\r\n  UNSAFE_componentWillMount() {\r\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\r\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\r\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\r\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\r\n    this.props.scene.removeEventListener(\"share_video_failed\", this.onShareVideoFailed);\r\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\r\n  }\r\n\r\n  storeUpdated = () => {\r\n    this.forceUpdate();\r\n  };\r\n\r\n  showContextualSignInDialog = () => {\r\n    const {\r\n      signInMessageId,\r\n      authChannel,\r\n      signInCompleteMessageId,\r\n      signInContinueTextId,\r\n      onContinueAfterSignIn\r\n    } = this.props;\r\n\r\n    this.showNonHistoriedDialog(SignInDialog, {\r\n      message: messages[signInMessageId],\r\n      onSignIn: async email => {\r\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\r\n\r\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true, onClose: onContinueAfterSignIn });\r\n\r\n        await authComplete;\r\n\r\n        this.setState({ signedIn: true });\r\n        this.showNonHistoriedDialog(SignInDialog, {\r\n          authComplete: true,\r\n          message: messages[signInCompleteMessageId],\r\n          continueText: messages[signInContinueTextId],\r\n          onClose: onContinueAfterSignIn,\r\n          onContinue: onContinueAfterSignIn\r\n        });\r\n      },\r\n      onClose: onContinueAfterSignIn\r\n    });\r\n  };\r\n\r\n  updateSubscribedState = () => {\r\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\r\n    this.setState({ isSubscribed });\r\n  };\r\n\r\n  toggleFavorited = () => {\r\n    this.props.performConditionalSignIn(\r\n      () => this.props.hubChannel.signedIn,\r\n      () => {\r\n        const isFavorited = this.isFavorited();\r\n\r\n        this.props.hubChannel[isFavorited ? \"unfavorite\" : \"favorite\"]();\r\n        this.setState({ isFavorited: !isFavorited });\r\n      },\r\n      \"favorite-room\"\r\n    );\r\n  };\r\n\r\n  isFavorited = () => {\r\n    return this.state.isFavorited !== undefined ? this.state.isFavorited : this.props.initialIsFavorited;\r\n  };\r\n\r\n  onLoadingFinished = () => {\r\n    this.setState({ noMoreLoadingUpdates: true });\r\n    this.props.scene.emit(\"loading_finished\");\r\n    this.props.scene.addState(\"loaded\");\r\n\r\n    if (this.props.onLoaded) {\r\n      this.props.onLoaded();\r\n    }\r\n  };\r\n\r\n  onSceneLoaded = () => {\r\n    this.setState({ sceneLoaded: true });\r\n  };\r\n\r\n  // TODO: we need to come up with a cleaner way to handle the shared state between aframe and react than emmitting events and setting state on the scene\r\n  onAframeStateChanged = e => {\r\n    if (!(e.detail === \"muted\" || e.detail === \"frozen\")) return;\r\n    this.setState({\r\n      [e.detail]: this.props.scene.is(e.detail)\r\n    });\r\n  };\r\n\r\n  onShareVideoEnabled = e => {\r\n    this.setState({ videoShareMediaSource: e.detail.source });\r\n  };\r\n\r\n  onShareVideoDisabled = () => {\r\n    this.setState({ videoShareMediaSource: null });\r\n  };\r\n\r\n  onShareVideoFailed = () => {\r\n    this.setState({ showVideoShareFailed: true });\r\n  };\r\n\r\n  toggleMute = () => {\r\n    this.props.scene.emit(\"action_mute\");\r\n  };\r\n\r\n  shareVideo = mediaSource => {\r\n    this.props.scene.emit(`action_share_${mediaSource}`);\r\n  };\r\n\r\n  endShareVideo = () => {\r\n    this.props.scene.emit(\"action_end_video_sharing\");\r\n  };\r\n\r\n  spawnPen = () => {\r\n    this.props.scene.emit(\"penButtonPressed\");\r\n  };\r\n\r\n  onSubscribeChanged = async () => {\r\n    if (!this.props.subscriptions) return;\r\n\r\n    await this.props.subscriptions.toggle();\r\n    this.updateSubscribedState();\r\n  };\r\n\r\n  handleForceEntry = () => {\r\n    if (!this.props.forcedVREntryType) return;\r\n\r\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\r\n      this.enterDaydream();\r\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\r\n      this.enterVR();\r\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\r\n      this.enter2D();\r\n    }\r\n  };\r\n\r\n  startAutoExitTimer = autoExitMessage => {\r\n    if (this.state.autoExitTimerInterval) return;\r\n\r\n    const autoExitTimerInterval = setInterval(() => {\r\n      let secondsRemainingBeforeAutoExit = Infinity;\r\n\r\n      if (this.state.autoExitTimerStartedAt) {\r\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\r\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\r\n      }\r\n\r\n      this.setState({ secondsRemainingBeforeAutoExit });\r\n      this.checkForAutoExit();\r\n    }, 500);\r\n\r\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval, autoExitMessage });\r\n  };\r\n\r\n  checkForAutoExit = () => {\r\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\r\n    this.endAutoExitTimer();\r\n    this.exit();\r\n  };\r\n\r\n  exit = reason => {\r\n    window.removeEventListener(\"concurrentload\", this.onConcurrentLoad);\r\n    window.removeEventListener(\"idle_detected\", this.onIdleDetected);\r\n    window.removeEventListener(\"activity_detected\", this.onActivityDetected);\r\n\r\n    if (this.props.exitScene) {\r\n      this.props.exitScene(reason);\r\n    }\r\n\r\n    this.setState({ exited: true });\r\n  };\r\n\r\n  isWaitingForAutoExit = () => {\r\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\r\n  };\r\n\r\n  endAutoExitTimer = () => {\r\n    clearInterval(this.state.autoExitTimerInterval);\r\n    this.setState({\r\n      autoExitTimerStartedAt: null,\r\n      autoExitTimerInterval: null,\r\n      autoExitMessage: null,\r\n      secondsRemainingBeforeAutoExit: Infinity\r\n    });\r\n  };\r\n\r\n  performDirectEntryFlow = async enterInVR => {\r\n    this.setState({ enterInVR, waitingOnAudio: true });\r\n\r\n    const hasGrantedMic = (await grantedMicLabels()).length > 0;\r\n\r\n    if (hasGrantedMic) {\r\n      await this.setMediaStreamToDefault();\r\n      this.beginOrSkipAudioSetup();\r\n    } else {\r\n      this.pushHistoryState(\"entry_step\", \"mic_grant\");\r\n    }\r\n\r\n    this.setState({ waitingOnAudio: false });\r\n  };\r\n\r\n  enter2D = async () => {\r\n    await this.performDirectEntryFlow(false);\r\n  };\r\n\r\n  enterVR = async () => {\r\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\r\n      await this.performDirectEntryFlow(true);\r\n    } else {\r\n      this.pushHistoryState(\"modal\", \"webvr\");\r\n    }\r\n  };\r\n\r\n  enterDaydream = async () => {\r\n    await this.performDirectEntryFlow(true);\r\n  };\r\n\r\n  micDeviceChanged = async ev => {\r\n    const constraints = { audio: { deviceId: { exact: [ev.target.value] } } };\r\n    await this.fetchAudioTrack(constraints);\r\n    await this.setupNewMediaStream();\r\n  };\r\n\r\n  setMediaStreamToDefault = async () => {\r\n    let hasAudio = false;\r\n    const { lastUsedMicDeviceId } = this.props.store.state.settings;\r\n\r\n    // Try to fetch last used mic, if there was one.\r\n    if (lastUsedMicDeviceId) {\r\n      hasAudio = await this.fetchAudioTrack({ audio: { deviceId: { ideal: lastUsedMicDeviceId } } });\r\n    } else {\r\n      hasAudio = await this.fetchAudioTrack({ audio: true });\r\n    }\r\n\r\n    await this.setupNewMediaStream();\r\n\r\n    return { hasAudio };\r\n  };\r\n\r\n  fetchAudioTrack = async constraints => {\r\n    if (this.state.audioTrack) {\r\n      this.state.audioTrack.stop();\r\n    }\r\n    if (this.state.audioTrackClone) {\r\n      this.state.audioTrackClone.stop();\r\n    }\r\n\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\r\n      const audioTrack = mediaStream.getAudioTracks()[0];\r\n      this.setState({ audioTrack });\r\n\r\n      if (/Oculus/.test(navigator.userAgent)) {\r\n        // HACK Oculus Browser 6 seems to randomly end the microphone audio stream. This re-creates it.\r\n        // Note the ended event will only fire if some external event ends the stream, not if we call stop().\r\n        const recreateAudioStream = async () => {\r\n          console.warn(\r\n            \"Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.\"\r\n          );\r\n\r\n          const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\r\n          const audioTrack = mediaStream.getAudioTracks()[0];\r\n          const audioTrackClone = audioTrack.clone();\r\n\r\n          await NAF.connection.adapter.setLocalMediaStream(mediaStream);\r\n\r\n          if (this.props.scene.is(\"muted\")) {\r\n            console.warn(\"re-muting microphone\");\r\n            NAF.connection.adapter.enableMicrophone(false);\r\n            audioTrack.enabled = false;\r\n          }\r\n\r\n          this.setState({ mediaStream, audioTrack, audioTrackClone });\r\n\r\n          const mediaStreamForMicAnalysis = new MediaStream();\r\n          mediaStreamForMicAnalysis.addTrack(audioTrackClone);\r\n          this.props.scene.emit(\"local-media-stream-created\", { mediaStream: mediaStreamForMicAnalysis });\r\n          audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\r\n        };\r\n\r\n        audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\r\n      }\r\n\r\n      return true;\r\n    } catch (e) {\r\n      // Error fetching audio track, most likely a permission denial.\r\n      this.setState({ audioTrack: null });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  setupNewMediaStream = async () => {\r\n    const mediaStream = new MediaStream();\r\n\r\n    await this.fetchMicDevices();\r\n\r\n    // we should definitely have an audioTrack at this point unless they denied mic access\r\n    if (this.state.audioTrack) {\r\n      mediaStream.addTrack(this.state.audioTrack);\r\n      const micDeviceId = this.micDeviceIdForMicLabel(this.micLabelForMediaStream(mediaStream));\r\n      if (micDeviceId) {\r\n        this.props.store.update({ settings: { lastUsedMicDeviceId: micDeviceId } });\r\n      }\r\n      const mediaStreamForMicAnalysis = new MediaStream();\r\n      const audioTrackClone = this.state.audioTrack.clone();\r\n      this.setState({ audioTrackClone });\r\n      mediaStreamForMicAnalysis.addTrack(audioTrackClone);\r\n      this.props.scene.emit(\"local-media-stream-created\", { mediaStream: mediaStreamForMicAnalysis });\r\n    }\r\n\r\n    this.setState({ mediaStream });\r\n  };\r\n\r\n  onMicGrantButton = async () => {\r\n    if (this.props.location.state && this.props.location.state.entry_step === \"mic_grant\") {\r\n      const { hasAudio } = await this.setMediaStreamToDefault();\r\n\r\n      if (hasAudio) {\r\n        this.pushHistoryState(\"entry_step\", \"mic_granted\");\r\n      } else {\r\n        this.beginOrSkipAudioSetup();\r\n      }\r\n    } else {\r\n      this.beginOrSkipAudioSetup();\r\n    }\r\n  };\r\n\r\n  beginOrSkipAudioSetup = () => {\r\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\r\n\r\n    if (skipAudioSetup) {\r\n      this.onAudioReadyButton();\r\n    } else {\r\n      this.pushHistoryState(\"entry_step\", \"audio\");\r\n    }\r\n  };\r\n\r\n  fetchMicDevices = () => {\r\n    return new Promise(resolve => {\r\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\r\n        this.setState(\r\n          {\r\n            micDevices: mediaDevices\r\n              .filter(d => d.kind === \"audioinput\")\r\n              .map(d => ({ deviceId: d.deviceId, label: d.label }))\r\n          },\r\n          resolve\r\n        );\r\n      });\r\n    });\r\n  };\r\n\r\n  shouldShowHmdMicWarning = () => {\r\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\r\n    if (!this.state.enterInVR) return false;\r\n    if (!this.hasHmdMicrophone()) return false;\r\n\r\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel().match(r));\r\n  };\r\n\r\n  hasHmdMicrophone = () => {\r\n    return !!this.state.micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\r\n  };\r\n\r\n  micLabelForMediaStream = mediaStream => {\r\n    return (mediaStream && mediaStream.getAudioTracks().length > 0 && mediaStream.getAudioTracks()[0].label) || \"\";\r\n  };\r\n\r\n  selectedMicLabel = () => {\r\n    return this.micLabelForMediaStream(this.state.mediaStream);\r\n  };\r\n\r\n  micDeviceIdForMicLabel = label => {\r\n    return this.state.micDevices.filter(d => d.label === label).map(d => d.deviceId)[0];\r\n  };\r\n\r\n  selectedMicDeviceId = () => {\r\n    return this.micDeviceIdForMicLabel(this.selectedMicLabel());\r\n  };\r\n\r\n  shouldShowFullScreen = () => {\r\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\r\n    return (\r\n      (isMobile || AFRAME.utils.device.isMobileVR()) &&\r\n      !AFRAME.utils.device.isIOS() &&\r\n      !this.state.enterInVR &&\r\n      screenfull.enabled\r\n    );\r\n  };\r\n\r\n  onAudioReadyButton = async () => {\r\n    if (!this.state.enterInVR) {\r\n      await showFullScreenIfAvailable();\r\n    }\r\n\r\n    // Push the new history state before going into VR, otherwise menu button will take us back\r\n    clearHistoryState(this.props.history);\r\n\r\n    const muteOnEntry = this.props.store.state.preferences[\"muteMicOnEntry\"] || false;\r\n    await this.props.enterScene(this.state.mediaStream, this.state.enterInVR, muteOnEntry);\r\n\r\n    this.setState({ entered: true, entering: false, showShareDialog: false });\r\n\r\n    const mediaStream = this.state.mediaStream;\r\n\r\n    if (mediaStream) {\r\n      if (mediaStream.getAudioTracks().length > 0) {\r\n        console.log(`Using microphone: ${mediaStream.getAudioTracks()[0].label}`);\r\n      }\r\n\r\n      if (mediaStream.getVideoTracks().length > 0) {\r\n        console.log(\"Screen sharing enabled.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  attemptLink = async () => {\r\n    this.pushHistoryState(\"overlay\", \"link\");\r\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\r\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\r\n    onFinished.then(() => {\r\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\r\n      this.exit();\r\n    });\r\n  };\r\n\r\n  showShareDialog = () => {\r\n    this.props.store.update({ activity: { hasOpenedShare: true } });\r\n    this.setState({ showShareDialog: true });\r\n  };\r\n\r\n  toggleShareDialog = async () => {\r\n    this.props.store.update({ activity: { hasOpenedShare: true } });\r\n    this.setState({ showShareDialog: !this.state.showShareDialog });\r\n  };\r\n\r\n  createObject = media => {\r\n    this.props.scene.emit(\"add_media\", media);\r\n  };\r\n\r\n  changeScene = url => {\r\n    this.props.hubChannel.updateScene(url);\r\n  };\r\n\r\n  setAvatarUrl = url => {\r\n    this.props.store.update({ profile: { ...this.props.store.state.profile, ...{ avatarId: url } } });\r\n    this.props.scene.emit(\"avatar_updated\");\r\n  };\r\n\r\n  closeDialog = () => {\r\n    if (this.state.dialog) {\r\n      this.setState({ dialog: null });\r\n    } else {\r\n      this.props.history.goBack();\r\n    }\r\n\r\n    if (isIn2DInterstitial()) {\r\n      exit2DInterstitialAndEnterVR();\r\n    } else {\r\n      showFullScreenIfWasFullScreen();\r\n    }\r\n  };\r\n\r\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\r\n    this.setState({\r\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\r\n    });\r\n  };\r\n\r\n  toggleStreamerMode = enable => {\r\n    this.props.scene.systems[\"hubs-systems\"].characterController.fly = enable;\r\n\r\n    if (enable) {\r\n      this.props.hubChannel.beginStreaming();\r\n      this.setState({ isStreaming: true, showStreamingTip: true });\r\n    } else {\r\n      this.props.hubChannel.endStreaming();\r\n      this.setState({ isStreaming: false });\r\n    }\r\n  };\r\n\r\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\r\n\r\n  showSignInDialog = () => {\r\n    this.showNonHistoriedDialog(SignInDialog, {\r\n      message: messages[\"sign-in.prompt\"],\r\n      onSignIn: async email => {\r\n        const { authComplete } = await this.props.authChannel.startAuthentication(email, this.props.hubChannel);\r\n\r\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true });\r\n\r\n        await authComplete;\r\n\r\n        this.setState({ signedIn: true });\r\n        this.closeDialog();\r\n      }\r\n    });\r\n  };\r\n\r\n  signOut = async () => {\r\n    await this.props.authChannel.signOut(this.props.hubChannel);\r\n    this.setState({ signedIn: false });\r\n  };\r\n\r\n  showWebRTCScreenshareUnsupportedDialog = () => {\r\n    this.pushHistoryState(\"modal\", \"webrtc-screenshare\");\r\n  };\r\n\r\n  onMiniInviteClicked = () => {\r\n    const link = `https://${configs.SHORTLINK_DOMAIN}/${this.props.hub.hub_id}`;\r\n\r\n    this.setState({ miniInviteActivated: true });\r\n    setTimeout(() => {\r\n      this.setState({ miniInviteActivated: false });\r\n    }, 5000);\r\n\r\n    if (canShare()) {\r\n      navigator.share({ title: document.title, url: link });\r\n    } else {\r\n      copy(link);\r\n    }\r\n  };\r\n\r\n  sendMessage = msg => {\r\n    this.props.onSendMessage(msg);\r\n  };\r\n\r\n  occupantCount = () => {\r\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\r\n  };\r\n\r\n  onStoreChanged = () => {\r\n    const broadcastedRoomConfirmed = this.props.store.state.confirmedBroadcastedRooms.includes(this.props.hub.hub_id);\r\n    if (broadcastedRoomConfirmed !== this.state.broadcastTipDismissed) {\r\n      this.setState({ broadcastTipDismissed: broadcastedRoomConfirmed });\r\n    }\r\n  };\r\n\r\n  confirmBroadcastedRoom = () => {\r\n    this.props.store.update({ confirmedBroadcastedRooms: [this.props.hub.hub_id] });\r\n  };\r\n\r\n  discordBridges = () => {\r\n    if (!this.props.presences) {\r\n      return [];\r\n    } else {\r\n      return discordBridgesForPresences(this.props.presences);\r\n    }\r\n  };\r\n\r\n  hasEmbedPresence = () => {\r\n    if (!this.props.presences) {\r\n      return false;\r\n    } else {\r\n      for (const p of Object.values(this.props.presences)) {\r\n        for (const m of p.metas) {\r\n          if (m.context && m.context.embed) {\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\r\n\r\n  renderInterstitialPrompt = () => {\r\n    return (\r\n      <IntlProvider locale={lang} messages={messages}>\r\n        <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\r\n          <div>\r\n            <FormattedMessage id=\"interstitial.prompt\" />\r\n          </div>\r\n        </div>\r\n      </IntlProvider>\r\n    );\r\n  };\r\n\r\n  renderExitedPane = () => {\r\n    let subtitle = null;\r\n    if (this.props.roomUnavailableReason === \"closed\") {\r\n      // TODO i18n, due to links and markup\r\n      subtitle = (\r\n        <div>\r\n          Sorry, this room is no longer available.\r\n          <p />\r\n          <IfFeature name=\"show_terms\">\r\n            A room may be closed if we receive reports that it violates our{\" \"}\r\n            <a\r\n              target=\"_blank\"\r\n              rel=\"noreferrer noopener\"\r\n              href={configs.link(\"terms_of_use\", \"https://github.com/mozilla/hubs/blob/master/TERMS.md\")}\r\n            >\r\n              Terms of Use\r\n            </a>\r\n            .<br />\r\n          </IfFeature>\r\n          If you have questions, contact us at{\" \"}\r\n          <a href={`mailto:${messages[\"contact-email\"]}`}>\r\n            <FormattedMessage id=\"contact-email\" />\r\n          </a>\r\n          .<p />\r\n          <IfFeature name=\"show_source_link\">\r\n            If you&apos;d like to run your own server, Hubs&apos;s source code is available on{\" \"}\r\n            <a href=\"https://github.com/mozilla/hubs\">GitHub</a>\r\n            .\r\n          </IfFeature>\r\n        </div>\r\n      );\r\n    } else if (this.props.platformUnsupportedReason === \"no_data_channels\") {\r\n      // TODO i18n, due to links and markup\r\n      subtitle = (\r\n        <div>\r\n          Your browser does not support{\" \"}\r\n          <a\r\n            href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility\"\r\n            rel=\"noreferrer noopener\"\r\n          >\r\n            WebRTC Data Channels\r\n          </a>\r\n          , which is required to use {messages[\"app-name\"]}.\r\n          <br />\r\n          If you&quot;d like to use {messages[\"app-name\"]} with Oculus or SteamVR, you can{\" \"}\r\n          <a href=\"https://www.mozilla.org/firefox\" rel=\"noreferrer noopener\">\r\n            Download Firefox\r\n          </a>\r\n          .\r\n        </div>\r\n      );\r\n    } else {\r\n      const reason = this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\r\n      const exitSubtitleId = `exit.subtitle.${reason || \"exited\"}`;\r\n      subtitle = (\r\n        <div>\r\n          <FormattedMessage id={exitSubtitleId} />\r\n          <p />\r\n          {![\"left\", \"disconnected\", \"scene_error\"].includes(this.props.roomUnavailableReason) && (\r\n            <div>\r\n              You can also <a href=\"/\">create a new room</a>\r\n              .\r\n            </div>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <IntlProvider locale={lang} messages={messages}>\r\n        <div className=\"exited-panel\">\r\n          <img className=\"exited-panel__logo\" src={configs.image(\"logo\")} />\r\n          <div className=\"exited-panel__subtitle\">{subtitle}</div>\r\n        </div>\r\n      </IntlProvider>\r\n    );\r\n  };\r\n\r\n  renderBotMode = () => {\r\n    return (\r\n      <div className=\"loading-panel\">\r\n        <img className=\"loading-panel__logo\" src={configs.image(\"logo\")} />\r\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\r\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  onEnteringCanceled = () => {\r\n    this.props.hubChannel.sendEnteringCancelledEvent();\r\n    this.setState({ entering: false });\r\n  };\r\n\r\n  renderEntryStartPanel = () => {\r\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\r\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\r\n\r\n    return (\r\n      <div className={entryStyles.entryPanel}>\r\n        <div className={entryStyles.name}>\r\n          {this.props.hubChannel.canOrWillIfCreator(\"update_hub\") ? (\r\n            <button\r\n              className={entryStyles.renameButton}\r\n              onClick={() =>\r\n                this.props.performConditionalSignIn(\r\n                  () => this.props.hubChannel.can(\"update_hub\"),\r\n                  () => this.pushHistoryState(\"modal\", \"room_settings\"),\r\n                  \"room-settings\"\r\n                )\r\n              }\r\n            >\r\n              {this.props.hub.name}\r\n            </button>\r\n          ) : (\r\n            <span>{this.props.hub.name}</span>\r\n          )}\r\n          <button onClick={() => this.setState({ watching: true })} className={entryStyles.collapseButton}>\r\n            <i>\r\n              <FontAwesomeIcon icon={faTimes} />\r\n            </i>\r\n          </button>\r\n\r\n          <button\r\n            onClick={() => this.toggleFavorited()}\r\n            className={classNames({\r\n              [entryStyles.entryFavoriteButton]: true,\r\n              [entryStyles.favoriteButton]: true,\r\n              [entryStyles.favorited]: this.isFavorited()\r\n            })}\r\n          >\r\n            <i title=\"Favorite\">\r\n              <FontAwesomeIcon icon={faStar} />\r\n            </i>\r\n          </button>\r\n        </div>\r\n\r\n        <div className={entryStyles.roomSubtitle}>\r\n          <FormattedMessage id=\"entry.lobby\" />\r\n        </div>\r\n\r\n        <div className={entryStyles.center}>\r\n          <LobbyChatBox\r\n            occupantCount={this.occupantCount()}\r\n            discordBridges={this.discordBridges()}\r\n            onSendMessage={this.sendMessage}\r\n          />\r\n        </div>\r\n\r\n        {!this.state.waitingOnAudio &&\r\n          !this.props.entryDisallowed && (\r\n            <div className={entryStyles.buttonContainer}>\r\n              {!isMobileVR && (\r\n                <button\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    this.attemptLink();\r\n                  }}\r\n                  className={classNames([entryStyles.secondaryActionButton, entryStyles.wideButton])}\r\n                >\r\n                  <FormattedMessage id=\"entry.device-medium\" />\r\n                  <div className={entryStyles.buttonSubtitle}>\r\n                    <FormattedMessage\r\n                      id={isMobile ? \"entry.device-subtitle-mobile\" : \"entry.device-subtitle-desktop\"}\r\n                    />\r\n                  </div>\r\n                </button>\r\n              )}\r\n              <button\r\n                autoFocus\r\n                onClick={e => {\r\n                  e.preventDefault();\r\n\r\n                  if (promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType) {\r\n                    this.setState({ entering: true });\r\n                    this.props.hubChannel.sendEnteringEvent();\r\n\r\n                    const stateValue = promptForNameAndAvatarBeforeEntry ? \"profile\" : \"device\";\r\n                    this.pushHistoryState(\"entry_step\", stateValue);\r\n                  } else {\r\n                    this.handleForceEntry();\r\n                  }\r\n                }}\r\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\r\n              >\r\n                <FormattedMessage id=\"entry.enter-room\" />\r\n              </button>\r\n\r\n              {configs.feature(\"enable_lobby_ghosts\") ? (\r\n                <a\r\n                  onClick={e => {\r\n                    e.preventDefault();\r\n                    this.setState({ watching: true });\r\n                  }}\r\n                  className={classNames([entryStyles.secondaryActionButton, entryStyles.wideButton])}\r\n                >\r\n                  <FormattedMessage id=\"entry.watch-from-lobby\" />\r\n                  <div className={entryStyles.buttonSubtitle}>\r\n                    <FormattedMessage id=\"entry.watch-from-lobby-subtitle\" />\r\n                  </div>\r\n                </a>\r\n              ) : (\r\n                <div />\r\n              )}\r\n            </div>\r\n          )}\r\n        {this.props.entryDisallowed &&\r\n          !this.state.waitingOnAudio && (\r\n            <div className={entryStyles.buttonContainer}>\r\n              <a\r\n                onClick={e => {\r\n                  e.preventDefault();\r\n                  this.setState({ watching: true });\r\n                }}\r\n                className={classNames([entryStyles.secondaryActionButton, entryStyles.wideButton])}\r\n              >\r\n                <FormattedMessage id=\"entry.entry-disallowed\" />\r\n                <div className={entryStyles.buttonSubtitle}>\r\n                  <FormattedMessage id=\"entry.entry-disallowed-subtitle\" />\r\n                </div>\r\n              </a>\r\n            </div>\r\n          )}\r\n        {this.state.waitingOnAudio && (\r\n          <div>\r\n            <div className=\"loader-wrap loader-mid\">\r\n              <div className=\"loader\">\r\n                <div className=\"loader-center\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {!this.state.waitingOnAudio && (\r\n          <EntryStartPanel\r\n            hubChannel={this.props.hubChannel}\r\n            entering={this.state.entering}\r\n            onEnteringCanceled={this.onEnteringCanceled}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  renderDevicePanel = () => {\r\n    return (\r\n      <div className={entryStyles.entryPanel}>\r\n        <div\r\n          onClick={() => {\r\n            this.props.history.goBack();\r\n          }}\r\n          className={entryStyles.back}\r\n        >\r\n          <i>\r\n            <FontAwesomeIcon icon={faArrowLeft} />\r\n          </i>\r\n          <FormattedMessage id=\"entry.back\" />\r\n        </div>\r\n\r\n        <div className={entryStyles.title}>\r\n          <FormattedMessage id=\"entry.choose-device\" />\r\n        </div>\r\n\r\n        {!this.state.waitingOnAudio ? (\r\n          <div className={entryStyles.buttonContainer}>\r\n            {this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no && (\r\n              <div className={entryStyles.secondary} onClick={this.enterVR}>\r\n                <FormattedMessage id=\"entry.cardboard\" />\r\n              </div>\r\n            )}\r\n            {this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no && (\r\n              <GenericEntryButton secondary={true} onClick={this.enterVR} />\r\n            )}\r\n            {this.props.availableVREntryTypes.daydream === VR_DEVICE_AVAILABILITY.yes && (\r\n              <DaydreamEntryButton secondary={true} onClick={this.enterDaydream} subtitle={null} />\r\n            )}\r\n            {this.props.availableVREntryTypes.screen === VR_DEVICE_AVAILABILITY.yes && (\r\n              <TwoDEntryButton autoFocus={true} onClick={this.enter2D} />\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className={entryStyles.audioLoader}>\r\n            <div className=\"loader-wrap loader-mid\">\r\n              <div className=\"loader\">\r\n                <div className=\"loader-center\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  renderMicPanel = granted => {\r\n    return (\r\n      <div className=\"mic-grant-panel\">\r\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\r\n          <i>\r\n            <FontAwesomeIcon icon={faArrowLeft} />\r\n          </i>\r\n          <FormattedMessage id=\"entry.back\" />\r\n        </div>\r\n\r\n        <div className=\"mic-grant-panel__grant-container\">\r\n          <div className=\"mic-grant-panel__title\">\r\n            <FormattedMessage id={granted ? \"audio.granted-title\" : \"audio.grant-title\"} />\r\n          </div>\r\n          <div className=\"mic-grant-panel__subtitle\">\r\n            <FormattedMessage id={granted ? \"audio.granted-subtitle\" : \"audio.grant-subtitle\"} />\r\n          </div>\r\n          <div className=\"mic-grant-panel__button-container\">\r\n            {granted ? (\r\n              <button autoFocus className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\r\n                <img src=\"../assets/images/mic_granted.png\" srcSet=\"../assets/images/mic_granted@2x.png 2x\" />\r\n              </button>\r\n            ) : (\r\n              <button autoFocus className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\r\n                <img src=\"../assets/images/mic_denied.png\" srcSet=\"../assets/images/mic_denied@2x.png 2x\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n          <div className=\"mic-grant-panel__next-container\">\r\n            <button autoFocus className={classNames(\"mic-grant-panel__next\")} onClick={this.onMicGrantButton}>\r\n              <FormattedMessage id=\"audio.granted-next\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  renderAudioSetupPanel = () => {\r\n    const subtitleId = isMobilePhoneOrVR ? \"audio.subtitle-mobile\" : \"audio.subtitle-desktop\";\r\n    const muteOnEntry = this.props.store.state.preferences[\"muteMicOnEntry\"] || false;\r\n    return (\r\n      <div className=\"audio-setup-panel\">\r\n        <div\r\n          onClick={() => {\r\n            this.props.history.goBack();\r\n          }}\r\n          className={entryStyles.back}\r\n        >\r\n          <i>\r\n            <FontAwesomeIcon icon={faArrowLeft} />\r\n          </i>\r\n          <FormattedMessage id=\"entry.back\" />\r\n        </div>\r\n\r\n        <div>\r\n          <div className=\"audio-setup-panel__title\">\r\n            <FormattedMessage id=\"audio.title\" />\r\n          </div>\r\n          <div className=\"audio-setup-panel__subtitle\">\r\n            {(isMobilePhoneOrVR || this.state.enterInVR) && <FormattedMessage id={subtitleId} />}\r\n          </div>\r\n          <div className=\"audio-setup-panel__levels\">\r\n            <MicLevelWidget\r\n              scene={this.props.scene}\r\n              hasAudioTrack={!!this.state.audioTrack}\r\n              muteOnEntry={muteOnEntry}\r\n            />\r\n            <OutputLevelWidget />\r\n          </div>\r\n          {this.state.audioTrack && this.state.micDevices.length > 1 ? (\r\n            <div className=\"audio-setup-panel__device-chooser\">\r\n              <select\r\n                className=\"audio-setup-panel__device-chooser__dropdown\"\r\n                value={this.selectedMicDeviceId()}\r\n                onChange={this.micDeviceChanged}\r\n              >\r\n                {this.state.micDevices.map(d => (\r\n                  <option key={d.deviceId} value={d.deviceId}>\r\n                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n                    {d.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n              <img\r\n                className=\"audio-setup-panel__device-chooser__mic-icon\"\r\n                src=\"../assets/images/mic_small.png\"\r\n                srcSet=\"../assets/images/mic_small@2x.png 2x\"\r\n              />\r\n              <img\r\n                className=\"audio-setup-panel__device-chooser__dropdown-arrow\"\r\n                src=\"../assets/images/dropdown_arrow.png\"\r\n                srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\r\n              />\r\n            </div>\r\n          ) : (\r\n            <div />\r\n          )}\r\n          {this.shouldShowHmdMicWarning() && (\r\n            <div className=\"audio-setup-panel__hmd-mic-warning\">\r\n              <img\r\n                src=\"../assets/images/warning_icon.png\"\r\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\r\n                className=\"audio-setup-panel__hmd-mic-warning__icon\"\r\n              />\r\n              <span className=\"audio-setup-panel__hmd-mic-warning__label\">\r\n                <FormattedMessage id=\"audio.hmd-mic-warning\" />\r\n              </span>\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"audio-setup-panel__mute-container\">\r\n          <input\r\n            id=\"mute-on-entry\"\r\n            type=\"checkbox\"\r\n            onChange={() =>\r\n              this.props.store.update({\r\n                preferences: { muteMicOnEntry: !this.props.store.state.preferences[\"muteMicOnEntry\"] }\r\n              })\r\n            }\r\n            checked={this.props.store.state.preferences[\"muteMicOnEntry\"] || false}\r\n          />\r\n          <label htmlFor=\"mute-on-entry\">\r\n            <FormattedMessage id=\"entry.mute-on-entry\" />\r\n          </label>\r\n        </div>\r\n        <div className=\"audio-setup-panel__enter-button-container\">\r\n          <button autoFocus className=\"audio-setup-panel__enter-button\" onClick={this.onAudioReadyButton}>\r\n            <FormattedMessage id=\"audio.enter-now\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  isInModalOrOverlay = () => {\r\n    if (\r\n      this.state.entered &&\r\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\r\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    if (\r\n      !this.state.entered &&\r\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\r\n        LOBBY_MODAL_QUERY_VARS.find(\r\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\r\n        ))\r\n    ) {\r\n      return true;\r\n    }\r\n\r\n    if (this.state.objectInfo && this.state.objectInfo.object3D) {\r\n      return true; // TODO: Get object info dialog to use history\r\n    }\r\n\r\n    return !!(\r\n      (this.props.history &&\r\n        this.props.history.location.state &&\r\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\r\n      this.state.dialog\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const rootStyles = {\r\n      [styles.ui]: true,\r\n      \"ui-root\": true,\r\n      \"in-modal-or-overlay\": this.isInModalOrOverlay(),\r\n      isGhost: configs.feature(\"enable_lobby_ghosts\") && (this.state.watching || (this.state.hide || this.props.hide)),\r\n      hide: this.state.hide || this.props.hide\r\n    };\r\n    if (this.props.hide || this.state.hide) return <div className={classNames(rootStyles)} />;\r\n\r\n    const isExited = this.state.exited || this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\r\n    const preload = this.props.showPreload;\r\n\r\n    const isLoading =\r\n      !preload &&\r\n      (!this.state.hideLoader || !this.state.didConnectToNetworkedScene) &&\r\n      !(this.props.showSafariDialog || this.props.showWebAssemblyDialog);\r\n\r\n    const hasPush = navigator.serviceWorker && \"PushManager\" in window;\r\n\r\n    if (this.props.showOAuthDialog && !this.props.showInterstitialPrompt)\r\n      return (\r\n        <IntlProvider locale={lang} messages={messages}>\r\n          <div className={classNames(rootStyles)}>\r\n            <OAuthDialog onClose={this.props.onCloseOAuthDialog} oauthInfo={this.props.oauthInfo} />\r\n          </div>\r\n        </IntlProvider>\r\n      );\r\n    if (isExited) return this.renderExitedPane();\r\n    if (isLoading && this.state.showPrefs) {\r\n      return (\r\n        <div>\r\n          <Loader\r\n            scene={this.props.scene}\r\n            finished={this.state.noMoreLoadingUpdates}\r\n            onLoaded={this.onLoadingFinished}\r\n          />\r\n          <PreferencesScreen\r\n            onClose={() => {\r\n              this.setState({ showPrefs: false });\r\n            }}\r\n            store={this.props.store}\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n    if (isLoading) {\r\n      return (\r\n        <Loader scene={this.props.scene} finished={this.state.noMoreLoadingUpdates} onLoaded={this.onLoadingFinished} />\r\n      );\r\n    }\r\n    if (this.state.showPrefs) {\r\n      return (\r\n        <PreferencesScreen\r\n          onClose={() => {\r\n            this.setState({ showPrefs: false });\r\n          }}\r\n          store={this.props.store}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\r\n    if (this.props.isBotMode) return this.renderBotMode();\r\n\r\n    const embed = this.props.embed;\r\n    const entered = this.state.entered;\r\n    const watching = this.state.watching;\r\n    const enteredOrWatching = entered || watching;\r\n    const enteredOrWatchingOrPreload = entered || watching || preload;\r\n    const baseUrl = `${location.protocol}//${location.host}${location.pathname}`;\r\n    const inEntryFlow = !!(\r\n      this.props.history &&\r\n      this.props.history.location.state &&\r\n      this.props.history.location.state.entry_step\r\n    );\r\n\r\n    const entryDialog =\r\n      this.props.availableVREntryTypes &&\r\n      !preload &&\r\n      (this.isWaitingForAutoExit() ? (\r\n        <AutoExitWarning\r\n          message={this.state.autoExitMessage}\r\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\r\n          onCancel={this.endAutoExitTimer}\r\n        />\r\n      ) : (\r\n        <div className={entryStyles.entryDialog}>\r\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\r\n            {this.renderDevicePanel()}\r\n          </StateRoute>\r\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_grant\" history={this.props.history}>\r\n            {this.renderMicPanel(false)}\r\n          </StateRoute>\r\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_granted\" history={this.props.history}>\r\n            {this.renderMicPanel(true)}\r\n          </StateRoute>\r\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\r\n            {this.renderAudioSetupPanel()}\r\n          </StateRoute>\r\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\r\n            {this.renderEntryStartPanel()}\r\n          </StateRoute>\r\n        </div>\r\n      ));\r\n\r\n    const dialogBoxContentsClassNames = classNames({\r\n      [styles.uiInteractive]: !this.isInModalOrOverlay(),\r\n      [styles.uiDialogBoxContents]: true,\r\n      [styles.backgrounded]: this.isInModalOrOverlay()\r\n    });\r\n\r\n    // MobileVR browsers always show settings panel as an overlay when exiting immersive mode.\r\n    const showSettingsAsOverlay = entered && isMobileVR;\r\n\r\n    const presenceLogEntries = this.props.presenceLogEntries || [];\r\n\r\n    const switchToInspectingObject = el => {\r\n      const src = el.components[\"media-loader\"].data.src;\r\n      this.setState({ objectInfo: el, objectSrc: src });\r\n      const cameraSystem = this.props.scene.systems[\"hubs-systems\"].cameraSystem;\r\n      cameraSystem.uninspect();\r\n      cameraSystem.inspect(el.object3D, 1.5, true);\r\n    };\r\n\r\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\r\n\r\n    // Allow scene picker pre-entry, otherwise wait until entry\r\n    const showMediaBrowser =\r\n      mediaSource && ([\"scenes\", \"avatars\", \"favorites\"].includes(mediaSource) || this.state.entered);\r\n    const hasTopTip = (this.props.activeTips && this.props.activeTips.top) || this.state.showVideoShareFailed;\r\n\r\n    const clientInfoClientId = getClientInfoClientId(this.props.history.location);\r\n    const showClientInfo = !!clientInfoClientId;\r\n    const showObjectInfo = !!(this.state.objectInfo && this.state.objectInfo.object3D);\r\n\r\n    const discordBridges = this.discordBridges();\r\n    const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\r\n    const hasEmbedPresence = this.hasEmbedPresence();\r\n    const hasDiscordBridges = discordBridges.length > 0;\r\n    const showBroadcastTip =\r\n      (hasDiscordBridges || (hasEmbedPresence && !this.props.embed)) && !this.state.broadcastTipDismissed;\r\n\r\n    const showInviteTip =\r\n      !hasTopTip &&\r\n      !entered &&\r\n      !embed &&\r\n      !preload &&\r\n      !watching &&\r\n      !hasTopTip &&\r\n      !inEntryFlow &&\r\n      !this.props.store.state.activity.hasOpenedShare &&\r\n      this.occupantCount() <= 1;\r\n\r\n    const showChooseSceneButton =\r\n      !entered &&\r\n      !embed &&\r\n      !preload &&\r\n      !watching &&\r\n      !showInviteTip &&\r\n      !this.state.showShareDialog &&\r\n      this.props.hubChannel &&\r\n      this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\r\n\r\n    const displayNameOverride = this.props.hubIsBound\r\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\r\n      : null;\r\n\r\n    const streaming = this.state.isStreaming;\r\n    const streamingTip = streaming &&\r\n      this.state.showStreamingTip && (\r\n        <div className={classNames([styles.streamingTip])}>\r\n          <div className={classNames([styles.streamingTipAttachPoint])} />\r\n          <button\r\n            title=\"Dismiss\"\r\n            className={styles.streamingTipClose}\r\n            onClick={() => this.setState({ showStreamingTip: false })}\r\n          >\r\n            <FontAwesomeIcon icon={faTimes} />\r\n          </button>\r\n\r\n          <div className={styles.streamingTipMessage}>\r\n            <FormattedMessage id=\"tips.streaming\" />\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n    const streamer = getCurrentStreamer();\r\n    const streamerName = streamer && streamer.displayName;\r\n\r\n    return (\r\n      <ReactAudioContext.Provider value={this.state.audioContext}>\r\n        <IntlProvider locale={lang} messages={messages}>\r\n          <div className={classNames(rootStyles)}>\r\n            {this.state.dialog}\r\n            {preload &&\r\n              this.props.hub && (\r\n                <PreloadOverlay\r\n                  hubName={this.props.hub.name}\r\n                  hubScene={this.props.hub.scene}\r\n                  baseUrl={baseUrl}\r\n                  onLoadClicked={this.props.onPreloadLoadClicked}\r\n                />\r\n              )}\r\n            <StateRoute\r\n              stateKey=\"overlay\"\r\n              stateValue=\"profile\"\r\n              history={this.props.history}\r\n              render={props => (\r\n                <ProfileEntryPanel\r\n                  {...props}\r\n                  displayNameOverride={displayNameOverride}\r\n                  finished={() => this.pushHistoryState()}\r\n                  onClose={() => this.pushHistoryState()}\r\n                  store={this.props.store}\r\n                  mediaSearchStore={this.props.mediaSearchStore}\r\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\r\n                />\r\n              )}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"overlay\"\r\n              stateValue=\"avatar-editor\"\r\n              history={this.props.history}\r\n              render={props => (\r\n                <AvatarEditor\r\n                  className={styles.avatarEditor}\r\n                  signedIn={this.state.signedIn}\r\n                  onSignIn={this.showSignInDialog}\r\n                  onSave={() => {\r\n                    if (props.location.state.detail && props.location.state.detail.returnToProfile) {\r\n                      this.props.history.goBack();\r\n                    } else {\r\n                      this.props.history.goBack();\r\n                      // We are returning to the media browser. Trigger an update so that the filter switches to\r\n                      // my-avatars, now that we've saved an avatar.\r\n                      this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\", \"use\");\r\n                    }\r\n                    this.props.onAvatarSaved();\r\n                  }}\r\n                  onClose={() => this.props.history.goBack()}\r\n                  store={this.props.store}\r\n                  debug={avatarEditorDebug}\r\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\r\n                  hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\r\n                />\r\n              )}\r\n            />\r\n            {showMediaBrowser && (\r\n              <MediaBrowser\r\n                history={this.props.history}\r\n                mediaSearchStore={this.props.mediaSearchStore}\r\n                hubChannel={this.props.hubChannel}\r\n                onMediaSearchResultEntrySelected={(entry, selectAction) => {\r\n                  if (entry.type === \"room\") {\r\n                    this.showNonHistoriedDialog(LeaveRoomDialog, {\r\n                      destinationUrl: entry.url,\r\n                      messageType: \"join-room\"\r\n                    });\r\n                  } else {\r\n                    this.props.onMediaSearchResultEntrySelected(entry, selectAction);\r\n                  }\r\n                }}\r\n                performConditionalSignIn={this.props.performConditionalSignIn}\r\n              />\r\n            )}\r\n            <StateRoute\r\n              stateKey=\"entry_step\"\r\n              stateValue=\"profile\"\r\n              history={this.props.history}\r\n              render={props => (\r\n                <ProfileEntryPanel\r\n                  {...props}\r\n                  displayNameOverride={displayNameOverride}\r\n                  finished={() => {\r\n                    if (this.props.forcedVREntryType) {\r\n                      this.pushHistoryState();\r\n                      this.handleForceEntry();\r\n                    } else {\r\n                      this.pushHistoryState(\"entry_step\", \"device\");\r\n                    }\r\n                  }}\r\n                  onClose={() => this.pushHistoryState()}\r\n                  store={this.props.store}\r\n                  mediaSearchStore={this.props.mediaSearchStore}\r\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\r\n                />\r\n              )}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"room_settings\"\r\n              history={this.props.history}\r\n              render={() =>\r\n                this.renderDialog(RoomSettingsDialog, {\r\n                  showRoomAccessSettings: this.props.hubChannel.can(\"update_hub_promotion\"),\r\n                  initialSettings: {\r\n                    name: this.props.hub.name,\r\n                    description: this.props.hub.description,\r\n                    member_permissions: this.props.hub.member_permissions,\r\n                    room_size: this.props.hub.room_size,\r\n                    allow_promotion: this.props.hub.allow_promotion\r\n                  },\r\n                  onChange: settings => this.props.hubChannel.updateHub(settings)\r\n                })\r\n              }\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"close_room\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(CloseRoomDialog, { onConfirm: () => this.props.hubChannel.closeHub() })}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"support\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(InviteTeamDialog, { hubChannel: this.props.hubChannel })}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"create\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(CreateObjectDialog, { onCreate: this.createObject })}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"change_scene\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(ChangeSceneDialog, { onChange: this.changeScene })}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"avatar_url\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(AvatarUrlDialog, { onChange: this.setAvatarUrl })}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"webvr\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(WebVRRecommendDialog)}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"webrtc-screenshare\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(WebRTCScreenshareUnsupportedDialog)}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"room_info\"\r\n              history={this.props.history}\r\n              render={() => {\r\n                return this.renderDialog(RoomInfoDialog, {\r\n                  store: this.props.store,\r\n                  scene: this.props.hub.scene,\r\n                  hubName: this.props.hub.name,\r\n                  hubDescription: this.props.hub.description\r\n                });\r\n              }}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"feedback\"\r\n              history={this.props.history}\r\n              render={() =>\r\n                this.renderDialog(FeedbackDialog, {\r\n                  history: this.props.history,\r\n                  onClose: () => this.pushHistoryState(\"modal\", null)\r\n                })\r\n              }\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"help\"\r\n              history={this.props.history}\r\n              render={() =>\r\n                this.renderDialog(HelpDialog, {\r\n                  history: this.props.history,\r\n                  onClose: () => this.pushHistoryState(\"modal\", null)\r\n                })\r\n              }\r\n            />\r\n            <StateRoute\r\n              stateKey=\"modal\"\r\n              stateValue=\"tweet\"\r\n              history={this.props.history}\r\n              render={() => this.renderDialog(TweetDialog, { history: this.props.history, onClose: this.closeDialog })}\r\n            />\r\n            {showClientInfo && (\r\n              <ClientInfoDialog\r\n                clientId={clientInfoClientId}\r\n                onClose={this.closeDialog}\r\n                history={this.props.history}\r\n                presences={this.props.presences}\r\n                hubChannel={this.props.hubChannel}\r\n                showNonHistoriedDialog={this.showNonHistoriedDialog}\r\n                performConditionalSignIn={this.props.performConditionalSignIn}\r\n              />\r\n            )}\r\n            {showObjectInfo && (\r\n              <ObjectInfoDialog\r\n                scene={this.props.scene}\r\n                el={this.state.objectInfo}\r\n                src={this.state.objectSrc}\r\n                pinned={this.state.objectInfo && this.state.objectInfo.components[\"networked\"].data.persistent}\r\n                hubChannel={this.props.hubChannel}\r\n                onPinChanged={() => switchToInspectingObject(this.state.objectInfo)}\r\n                onNavigated={el => switchToInspectingObject(el)}\r\n                onClose={() => {\r\n                  if (this.props.scene.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT) {\r\n                    this.props.scene.systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n                  }\r\n                  this.setState({ isObjectListExpanded: false, objectInfo: null });\r\n                }}\r\n              />\r\n            )}\r\n            {((!enteredOrWatching && !this.state.isObjectListExpanded && !showObjectInfo && this.props.hub) ||\r\n              this.isWaitingForAutoExit()) && (\r\n              <div className={styles.uiDialog}>\r\n                <PresenceLog\r\n                  entries={presenceLogEntries}\r\n                  presences={this.props.presences}\r\n                  hubId={this.props.hub.hub_id}\r\n                  history={this.props.history}\r\n                />\r\n                <div className={dialogBoxContentsClassNames}>{entryDialog}</div>\r\n              </div>\r\n            )}\r\n            {enteredOrWatchingOrPreload &&\r\n              this.props.hub && (\r\n                <PresenceLog\r\n                  inRoom={true}\r\n                  presences={this.props.presences}\r\n                  entries={presenceLogEntries}\r\n                  hubId={this.props.hub.hub_id}\r\n                  history={this.props.history}\r\n                />\r\n              )}\r\n            {entered &&\r\n              this.props.activeTips &&\r\n              this.props.activeTips.bottom &&\r\n              (!presenceLogEntries || presenceLogEntries.length === 0) &&\r\n              !showBroadcastTip && (\r\n                <Tip tip={this.props.activeTips.bottom} tipRegion=\"bottom\" pushHistoryState={this.pushHistoryState} />\r\n              )}\r\n            {enteredOrWatchingOrPreload &&\r\n              showBroadcastTip && (\r\n                <Tip\r\n                  tip={hasDiscordBridges ? \"discord\" : \"embed\"}\r\n                  broadcastTarget={discordSnippet}\r\n                  onClose={() => this.confirmBroadcastedRoom()}\r\n                />\r\n              )}\r\n            {enteredOrWatchingOrPreload &&\r\n              !this.state.objectInfo &&\r\n              !this.state.frozen && (\r\n                <InWorldChatBox\r\n                  discordBridges={discordBridges}\r\n                  onSendMessage={this.sendMessage}\r\n                  onObjectCreated={this.createObject}\r\n                  enableSpawning={entered}\r\n                  history={this.props.history}\r\n                />\r\n              )}\r\n            {this.state.frozen && (\r\n              <button className={styles.leaveButton} onClick={() => this.exit(\"left\")}>\r\n                <FormattedMessage id=\"entry.leave-room\" />\r\n              </button>\r\n            )}\r\n            {!this.state.frozen &&\r\n              !watching &&\r\n              !preload && (\r\n                <div\r\n                  className={classNames({\r\n                    [inviteStyles.inviteContainer]: true,\r\n                    [inviteStyles.inviteContainerBelowHud]: entered,\r\n                    [inviteStyles.inviteContainerInverted]: this.state.showShareDialog\r\n                  })}\r\n                >\r\n                  {!embed &&\r\n                    !streaming && (\r\n                      <button\r\n                        className={classNames({\r\n                          [inviteStyles.inviteButton]: true,\r\n                          [inviteStyles.hideSmallScreens]: this.occupantCount() > 1 && entered,\r\n                          [inviteStyles.inviteButtonLowered]: hasTopTip\r\n                        })}\r\n                        onClick={() => this.toggleShareDialog()}\r\n                      >\r\n                        <FormattedMessage id=\"entry.share-button\" />\r\n                      </button>\r\n                    )}\r\n                  {showChooseSceneButton && (\r\n                    <button\r\n                      className={classNames([styles.chooseSceneButton])}\r\n                      onClick={() => {\r\n                        this.props.performConditionalSignIn(\r\n                          () => this.props.hubChannel.can(\"update_hub\"),\r\n                          () => {\r\n                            showFullScreenIfAvailable();\r\n                            this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\r\n                          },\r\n                          \"change-scene\"\r\n                        );\r\n                      }}\r\n                    >\r\n                      <FormattedMessage id=\"entry.change-scene\" />\r\n                    </button>\r\n                  )}\r\n\r\n                  {showInviteTip && (\r\n                    <div className={styles.inviteTip}>\r\n                      <div className={styles.inviteTipAttachPoint} />\r\n                      <FormattedMessage id={`entry.${isMobile ? \"mobile\" : \"desktop\"}.invite-tip`} />\r\n                    </div>\r\n                  )}\r\n                  {!embed &&\r\n                    this.occupantCount() > 1 &&\r\n                    !hasTopTip &&\r\n                    entered &&\r\n                    !streaming && (\r\n                      <button onClick={this.onMiniInviteClicked} className={inviteStyles.inviteMiniButton}>\r\n                        <span>\r\n                          {this.state.miniInviteActivated\r\n                            ? navigator.share\r\n                              ? \"sharing...\"\r\n                              : \"copied!\"\r\n                            : `${configs.SHORTLINK_DOMAIN}/` + this.props.hub.hub_id}\r\n                        </span>\r\n                      </button>\r\n                    )}\r\n                  {embed && (\r\n                    <a href={baseUrl} className={inviteStyles.enterButton} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                      <FormattedMessage id=\"entry.open-in-window\" />\r\n                    </a>\r\n                  )}\r\n                  {this.state.showShareDialog && (\r\n                    <InviteDialog\r\n                      allowShare={!isMobileVR}\r\n                      entryCode={this.props.hub.entry_code}\r\n                      embedUrl={\r\n                        this.props.embedToken && !isMobilePhoneOrVR\r\n                          ? `${baseUrl}?embed_token=${this.props.embedToken}`\r\n                          : null\r\n                      }\r\n                      hasPush={hasPush}\r\n                      isSubscribed={\r\n                        this.state.isSubscribed === undefined ? this.props.initialIsSubscribed : this.state.isSubscribed\r\n                      }\r\n                      onSubscribeChanged={() => this.onSubscribeChanged()}\r\n                      hubId={this.props.hub.hub_id}\r\n                      onClose={() => this.setState({ showShareDialog: false })}\r\n                    />\r\n                  )}\r\n                </div>\r\n              )}\r\n            <StateRoute\r\n              stateKey=\"overlay\"\r\n              stateValue=\"invite\"\r\n              history={this.props.history}\r\n              render={() => (\r\n                <InviteDialog\r\n                  allowShare={!!navigator.share}\r\n                  entryCode={this.props.hub.entry_code}\r\n                  hubId={this.props.hub.hub_id}\r\n                  isModal={true}\r\n                  onClose={() => {\r\n                    this.props.history.goBack();\r\n                    exit2DInterstitialAndEnterVR();\r\n                  }}\r\n                />\r\n              )}\r\n            />\r\n            <StateRoute\r\n              stateKey=\"overlay\"\r\n              stateValue=\"link\"\r\n              history={this.props.history}\r\n              render={() => (\r\n                <LinkDialog\r\n                  linkCode={this.state.linkCode}\r\n                  onClose={() => {\r\n                    this.state.linkCodeCancel();\r\n                    this.setState({ linkCode: null, linkCodeCancel: null });\r\n                    this.props.history.goBack();\r\n                  }}\r\n                />\r\n              )}\r\n            />\r\n            {streaming && (\r\n              <button\r\n                title=\"Exit Camera Mode\"\r\n                onClick={() => this.toggleStreamerMode(false)}\r\n                className={classNames([styles.cornerButton, styles.cameraModeExitButton])}\r\n              >\r\n                <FontAwesomeIcon icon={faTimes} />\r\n              </button>\r\n            )}\r\n            {streamingTip}\r\n\r\n            <ObjectList\r\n              scene={this.props.scene}\r\n              onExpand={(expand, uninspect) => {\r\n                if (expand) {\r\n                  this.setState({ isPresenceListExpanded: false, isObjectListExpanded: expand });\r\n                } else {\r\n                  this.setState({ isObjectListExpanded: expand });\r\n                }\r\n\r\n                if (uninspect) {\r\n                  this.setState({ objectInfo: null });\r\n                  if (this.props.scene.systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT) {\r\n                    this.props.scene.systems[\"hubs-systems\"].cameraSystem.uninspect();\r\n                  }\r\n                }\r\n              }}\r\n              expanded={this.state.isObjectListExpanded && !this.state.isPresenceListExpanded}\r\n              onInspectObject={el => switchToInspectingObject(el)}\r\n            />\r\n\r\n            <PresenceList\r\n              history={this.props.history}\r\n              presences={this.props.presences}\r\n              sessionId={this.props.sessionId}\r\n              signedIn={this.state.signedIn}\r\n              email={this.props.store.state.credentials.email}\r\n              onSignIn={this.showSignInDialog}\r\n              onSignOut={this.signOut}\r\n              expanded={!this.state.isObjectListExpanded && this.state.isPresenceListExpanded}\r\n              onExpand={expand => {\r\n                if (expand) {\r\n                  this.setState({ isPresenceListExpanded: expand, isObjectListExpanded: false });\r\n                } else {\r\n                  this.setState({ isPresenceListExpanded: expand });\r\n                }\r\n              }}\r\n            />\r\n\r\n            {!streaming &&\r\n              !preload && (\r\n                <SettingsMenu\r\n                  history={this.props.history}\r\n                  mediaSearchStore={this.props.mediaSearchStore}\r\n                  isStreaming={streaming}\r\n                  toggleStreamerMode={this.toggleStreamerMode}\r\n                  hubChannel={this.props.hubChannel}\r\n                  hubScene={this.props.hub.scene}\r\n                  scene={this.props.scene}\r\n                  showAsOverlay={showSettingsAsOverlay}\r\n                  onCloseOverlay={() => exit2DInterstitialAndEnterVR(true)}\r\n                  performConditionalSignIn={this.props.performConditionalSignIn}\r\n                  showNonHistoriedDialog={this.showNonHistoriedDialog}\r\n                  showPreferencesScreen={() => {\r\n                    this.setState({ showPrefs: true });\r\n                  }}\r\n                  pushHistoryState={this.pushHistoryState}\r\n                />\r\n              )}\r\n            {!entered && !streaming && !isMobile && streamerName && <SpectatingLabel name={streamerName} />}\r\n            {enteredOrWatching && (\r\n              <div className={styles.topHud}>\r\n                <TwoDHUD.TopHUD\r\n                  scene={this.props.scene}\r\n                  history={this.props.history}\r\n                  mediaSearchStore={this.props.mediaSearchStore}\r\n                  muted={this.state.muted}\r\n                  frozen={this.state.frozen}\r\n                  watching={this.state.watching}\r\n                  onWatchEnded={() => this.setState({ watching: false })}\r\n                  videoShareMediaSource={this.state.videoShareMediaSource}\r\n                  showVideoShareFailed={this.state.showVideoShareFailed}\r\n                  hideVideoShareFailedTip={() => this.setState({ showVideoShareFailed: false })}\r\n                  activeTip={this.props.activeTips && this.props.activeTips.top}\r\n                  isCursorHoldingPen={this.props.isCursorHoldingPen}\r\n                  hasActiveCamera={this.props.hasActiveCamera}\r\n                  onToggleMute={this.toggleMute}\r\n                  onSpawnPen={this.spawnPen}\r\n                  onSpawnCamera={() => this.props.scene.emit(\"action_toggle_camera\")}\r\n                  onShareVideo={this.shareVideo}\r\n                  onEndShareVideo={this.endShareVideo}\r\n                  onShareVideoNotCapable={() => this.showWebRTCScreenshareUnsupportedDialog()}\r\n                  isStreaming={streaming}\r\n                  showStreamingTip={this.state.showStreamingTip}\r\n                  hideStreamingTip={() => {\r\n                    this.setState({ showStreamingTip: false });\r\n                  }}\r\n                />\r\n                {!watching && !streaming ? (\r\n                  <UnlessFeature name=\"show_feedback_ui\">\r\n                    <div className={styles.nagCornerButton}>\r\n                      <button onClick={() => this.pushHistoryState(\"modal\", \"help\")} className={styles.helpButton}>\r\n                        <i>\r\n                          <FontAwesomeIcon icon={faQuestion} />\r\n                        </i>\r\n                      </button>\r\n                    </div>\r\n                  </UnlessFeature>\r\n                ) : (\r\n                  <div className={styles.nagCornerButton}>\r\n                    <button onClick={() => this.setState({ hide: true })}>\r\n                      <FormattedMessage id=\"hide-ui.prompt\" />\r\n                    </button>\r\n                  </div>\r\n                )}\r\n                {!watching &&\r\n                  !streaming && (\r\n                    <IfFeature name=\"show_feedback_ui\">\r\n                      <div className={styles.nagCornerButton}>\r\n                        <button onClick={() => this.pushHistoryState(\"modal\", \"feedback\")}>\r\n                          <FormattedMessage id=\"feedback.prompt\" />\r\n                        </button>\r\n                      </div>\r\n                    </IfFeature>\r\n                  )}\r\n\r\n                {!streaming && (\r\n                  <button\r\n                    onClick={() => this.toggleFavorited()}\r\n                    className={classNames({\r\n                      [entryStyles.favorited]: this.isFavorited(),\r\n                      [styles.inRoomFavoriteButton]: true\r\n                    })}\r\n                  >\r\n                    <i title=\"Favorite\">\r\n                      <FontAwesomeIcon icon={faStar} />\r\n                    </i>\r\n                  </button>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </IntlProvider>\r\n      </ReactAudioContext.Provider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UIRoot;\r\n","import jwtDecode from \"jwt-decode\";\r\nimport { EventTarget } from \"event-target-shim\";\r\nimport { Presence } from \"phoenix\";\r\nimport { migrateChannelToSocket, discordBridgesForPresences } from \"./phoenix-utils\";\r\nimport configs from \"./configs\";\r\n\r\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\r\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\r\n\r\nfunction isSameMonth(da, db) {\r\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\r\n}\r\n\r\nfunction isSameDay(da, db) {\r\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\r\n}\r\n\r\n// Permissions that will be assumed if the user becomes the creator.\r\nconst HUB_CREATOR_PERMISSIONS = [\r\n  \"update_hub\",\r\n  \"update_hub_promotion\",\r\n  \"update_roles\",\r\n  \"close_hub\",\r\n  \"mute_users\",\r\n  \"kick_users\"\r\n];\r\nconst VALID_PERMISSIONS =\r\n  HUB_CREATOR_PERMISSIONS +\r\n  [\"tweet\", \"spawn_camera\", \"spawn_drawing\", \"spawn_and_move_media\", \"pin_objects\", \"spawn_emoji\"];\r\n\r\nexport default class HubChannel extends EventTarget {\r\n  constructor(store, hubId) {\r\n    super();\r\n    this.store = store;\r\n    this.hubId = hubId;\r\n    this._signedIn = !!this.store.state.credentials.token;\r\n    this._permissions = {};\r\n    this._blockedSessionIds = new Set();\r\n  }\r\n\r\n  get signedIn() {\r\n    return this._signedIn;\r\n  }\r\n\r\n  // Returns true if this current session has the given permission.\r\n  can(permission) {\r\n    if (!VALID_PERMISSIONS.includes(permission)) throw new Error(`Invalid permission name: ${permission}`);\r\n    return this._permissions && this._permissions[permission];\r\n  }\r\n\r\n  // Returns true if the current session has the given permission, *or* will get the permission\r\n  // if they sign in and become the creator.\r\n  canOrWillIfCreator(permission) {\r\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\r\n    return this.can(permission);\r\n  }\r\n\r\n  canEnterRoom(hub) {\r\n    if (!hub) return false;\r\n    if (this.canOrWillIfCreator(\"update_hub\")) return true;\r\n\r\n    const roomEntrySlotCount = Object.values(this.presence.state).reduce((acc, { metas }) => {\r\n      const meta = metas[metas.length - 1];\r\n      const usingSlot = meta.presence === \"room\" || (meta.context && meta.context.entering);\r\n      return acc + (usingSlot ? 1 : 0);\r\n    }, 0);\r\n\r\n    // This now exists in room settings but a default is left here to support old reticulum servers\r\n    const DEFAULT_ROOM_SIZE = 24;\r\n    return roomEntrySlotCount < (hub.room_size !== undefined ? hub.room_size : DEFAULT_ROOM_SIZE);\r\n  }\r\n\r\n  // Migrates this hub channel to a new phoenix channel and presence\r\n  async migrateToSocket(socket, params) {\r\n    let presenceBindings;\r\n\r\n    // Unbind presence, and then set up bindings after reconnect\r\n    if (this.presence) {\r\n      presenceBindings = {\r\n        onJoin: this.presence.caller.onJoin,\r\n        onLeave: this.presence.caller.onLeave,\r\n        onSync: this.presence.caller.onSync\r\n      };\r\n\r\n      this.presence.onJoin(function() {});\r\n      this.presence.onLeave(function() {});\r\n      this.presence.onSync(function() {});\r\n    }\r\n\r\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\r\n    this.presence = new Presence(this.channel);\r\n\r\n    if (presenceBindings) {\r\n      this.presence.onJoin(presenceBindings.onJoin);\r\n      this.presence.onLeave(presenceBindings.onLeave);\r\n      this.presence.onSync(presenceBindings.onSync);\r\n    }\r\n  }\r\n\r\n  setPhoenixChannel = channel => {\r\n    this.channel = channel;\r\n    this.presence = new Presence(channel);\r\n  };\r\n\r\n  setPermissionsFromToken = token => {\r\n    // Note: token is not verified.\r\n    this._permissions = jwtDecode(token);\r\n    configs.setIsAdmin(this._permissions.postgrest_role === \"ret_admin\");\r\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\r\n\r\n    // Refresh the token 1 minute before it expires.\r\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\r\n    setTimeout(async () => {\r\n      const result = await this.fetchPermissions();\r\n      this.dispatchEvent(new CustomEvent(\"permissions-refreshed\", { detail: result }));\r\n    }, nextRefresh);\r\n  };\r\n\r\n  sendEnteringEvent = async () => {\r\n    this.channel.push(\"events:entering\", {});\r\n  };\r\n\r\n  sendEnteringCancelledEvent = async () => {\r\n    this.channel.push(\"events:entering_cancelled\", {});\r\n  };\r\n\r\n  sendEnteredEvent = async () => {\r\n    if (!this.channel) {\r\n      console.warn(\"No phoenix channel initialized before room entry.\");\r\n      return;\r\n    }\r\n\r\n    let entryDisplayType = \"Screen\";\r\n\r\n    if (navigator.getVRDisplays) {\r\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\r\n\r\n      if (vrDisplay) {\r\n        entryDisplayType = vrDisplay.displayName;\r\n      }\r\n    }\r\n\r\n    // This is fairly hacky, but gets the # of initial occupants\r\n    let initialOccupantCount = 0;\r\n\r\n    if (NAF.connection.adapter && NAF.connection.adapter.publisher) {\r\n      initialOccupantCount = NAF.connection.adapter.publisher.initialOccupants.length;\r\n    }\r\n\r\n    const entryTimingFlags = this.getEntryTimingFlags();\r\n\r\n    const entryEvent = {\r\n      ...entryTimingFlags,\r\n      initialOccupantCount,\r\n      entryDisplayType,\r\n      userAgent: navigator.userAgent\r\n    };\r\n\r\n    this.channel.push(\"events:entered\", entryEvent);\r\n  };\r\n\r\n  beginStreaming() {\r\n    this.channel.push(\"events:begin_streaming\", {});\r\n  }\r\n\r\n  endStreaming() {\r\n    this.channel.push(\"events:end_streaming\", {});\r\n  }\r\n\r\n  beginRecording() {\r\n    this.channel.push(\"events:begin_recording\", {});\r\n  }\r\n\r\n  endRecording() {\r\n    this.channel.push(\"events:end_recording\", {});\r\n  }\r\n\r\n  getEntryTimingFlags = () => {\r\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\r\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\r\n\r\n    if (!storedLastEnteredAt) {\r\n      return entryTimingFlags;\r\n    }\r\n\r\n    const now = new Date();\r\n    const lastEntered = new Date(storedLastEnteredAt);\r\n    const msSinceLastEntered = now - lastEntered;\r\n\r\n    // note that new daily and new monthly is based on client local time\r\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\r\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\r\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\r\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\r\n\r\n    return entryTimingFlags;\r\n  };\r\n\r\n  sendObjectSpawnedEvent = objectType => {\r\n    if (!this.channel) {\r\n      console.warn(\"No phoenix channel initialized before object spawn.\");\r\n      return;\r\n    }\r\n\r\n    const spawnEvent = {\r\n      object_type: objectType\r\n    };\r\n\r\n    this.channel.push(\"events:object_spawned\", spawnEvent);\r\n  };\r\n\r\n  sendProfileUpdate = () => {\r\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\r\n  };\r\n\r\n  updateScene = url => {\r\n    if (!this._permissions.update_hub) return \"unauthorized\";\r\n    this.channel.push(\"update_scene\", { url });\r\n  };\r\n\r\n  updateHub = settings => {\r\n    if (!this._permissions.update_hub) return \"unauthorized\";\r\n    this.channel.push(\"update_hub\", settings);\r\n  };\r\n\r\n  closeHub = () => {\r\n    if (!this._permissions.close_hub) return \"unauthorized\";\r\n    this.channel.push(\"close_hub\", {});\r\n  };\r\n\r\n  subscribe = subscription => {\r\n    this.channel.push(\"subscribe\", { subscription });\r\n  };\r\n\r\n  // If true, will tell the server to not send us any NAF traffic\r\n  allowNAFTraffic = allow => {\r\n    this.channel.push(allow ? \"unblock_naf\" : \"block_naf\", {});\r\n  };\r\n\r\n  unsubscribe = subscription => {\r\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\r\n  };\r\n\r\n  sendMessage = (body, type = \"chat\") => {\r\n    if (!body) return;\r\n    this.channel.push(\"message\", { body, type });\r\n  };\r\n\r\n  _getCreatorAssignmentToken = () => {\r\n    const creatorAssignmentTokenEntry =\r\n      this.store.state.creatorAssignmentTokens &&\r\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\r\n\r\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\r\n  };\r\n\r\n  signIn = token => {\r\n    return new Promise((resolve, reject) => {\r\n      const creator_assignment_token = this._getCreatorAssignmentToken();\r\n\r\n      this.channel\r\n        .push(\"sign_in\", { token, creator_assignment_token })\r\n        .receive(\"ok\", ({ perms_token }) => {\r\n          this.setPermissionsFromToken(perms_token);\r\n          this._signedIn = true;\r\n          resolve();\r\n        })\r\n        .receive(\"error\", err => {\r\n          if (err.reason === \"invalid_token\") {\r\n            console.warn(\"sign in failed\", err);\r\n            // Token expired or invalid TODO purge from storage if possible\r\n            resolve();\r\n          } else {\r\n            console.error(\"sign in failed\", err);\r\n            reject();\r\n          }\r\n        });\r\n    });\r\n  };\r\n\r\n  signOut = () => {\r\n    return new Promise((resolve, reject) => {\r\n      this.channel\r\n        .push(\"sign_out\")\r\n        .receive(\"ok\", async () => {\r\n          this._signedIn = false;\r\n          const params = this.channel.params();\r\n          delete params.auth_token;\r\n          delete params.perms_token;\r\n          await this.fetchPermissions();\r\n          resolve();\r\n        })\r\n        .receive(\"error\", reject);\r\n    });\r\n  };\r\n\r\n  getHost = () => {\r\n    return new Promise((resolve, reject) => {\r\n      this.channel\r\n        .push(\"get_host\")\r\n        .receive(\"ok\", res => {\r\n          resolve(res.host);\r\n        })\r\n        .receive(\"error\", reject);\r\n    });\r\n  };\r\n\r\n  getTwitterOAuthURL = () => {\r\n    return new Promise((resolve, reject) => {\r\n      this.channel\r\n        .push(\"oauth\", { type: \"twitter\" })\r\n        .receive(\"ok\", res => {\r\n          resolve(res.oauth_url);\r\n        })\r\n        .receive(\"error\", reject);\r\n    });\r\n  };\r\n\r\n  discordBridges = () => {\r\n    if (!this.presence || !this.presence.state) return [];\r\n    return discordBridgesForPresences(this.presence.state);\r\n  };\r\n\r\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\r\n    const payload = { id, gltf_node: gltfNode };\r\n    if (fileId && promotionToken) {\r\n      payload.file_id = fileId;\r\n      payload.file_access_token = fileAccessToken;\r\n      payload.promotion_token = promotionToken;\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      this.channel\r\n        .push(\"pin\", payload)\r\n        .receive(\"ok\", resolve)\r\n        .receive(\"error\", reject);\r\n    });\r\n  };\r\n\r\n  unpin = (id, fileId) => {\r\n    const payload = { id };\r\n    if (fileId) {\r\n      payload.file_id = fileId;\r\n    }\r\n    this.channel.push(\"unpin\", payload);\r\n  };\r\n\r\n  fetchPermissions = () => {\r\n    return new Promise((resolve, reject) => {\r\n      this.channel\r\n        .push(\"refresh_perms_token\")\r\n        .receive(\"ok\", res => {\r\n          this.setPermissionsFromToken(res.perms_token);\r\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\r\n        })\r\n        .receive(\"error\", reject);\r\n    });\r\n  };\r\n\r\n  mute = sessionId => this.channel.push(\"mute\", { session_id: sessionId });\r\n  addOwner = sessionId => this.channel.push(\"add_owner\", { session_id: sessionId });\r\n  removeOwner = sessionId => this.channel.push(\"remove_owner\", { session_id: sessionId });\r\n\r\n  hide = sessionId => {\r\n    NAF.connection.adapter.block(sessionId);\r\n    this.channel.push(\"block\", { session_id: sessionId });\r\n    this._blockedSessionIds.add(sessionId);\r\n  };\r\n\r\n  unhide = sessionId => {\r\n    if (!this._blockedSessionIds.has(sessionId)) return;\r\n    NAF.connection.adapter.unblock(sessionId);\r\n    NAF.connection.entities.completeSync(sessionId);\r\n    this.channel.push(\"unblock\", { session_id: sessionId });\r\n    this._blockedSessionIds.delete(sessionId);\r\n  };\r\n\r\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\r\n\r\n  kick = async sessionId => {\r\n    const permsToken = await this.fetchPermissions();\r\n    NAF.connection.adapter.kick(sessionId, permsToken);\r\n    this.channel.push(\"kick\", { session_id: sessionId });\r\n  };\r\n\r\n  requestSupport = () => this.channel.push(\"events:request_support\", {});\r\n  favorite = () => this.channel.push(\"favorite\", {});\r\n  unfavorite = () => this.channel.push(\"unfavorite\", {});\r\n\r\n  disconnect = () => {\r\n    if (this.channel) {\r\n      this.channel.socket.disconnect();\r\n    }\r\n  };\r\n}\r\n","import { SHAPE, FIT } from \"three-ammo/constants\";\r\n\r\nfunction exceedsDensityThreshold(count, subtree) {\r\n  const bounds = subtree.boundingData;\r\n  const triangleThreshold = 1000;\r\n  const minimumVolume = 0.1;\r\n  const minimumTriangles = 100;\r\n  const dx = bounds[3] - bounds[0];\r\n  const dy = bounds[4] - bounds[1];\r\n  const dz = bounds[5] - bounds[2];\r\n  const volume = dx * dy * dz;\r\n\r\n  if (volume < minimumVolume) {\r\n    return false;\r\n  }\r\n\r\n  if (count < minimumTriangles) {\r\n    return false;\r\n  }\r\n\r\n  return count / volume > triangleThreshold;\r\n}\r\n\r\nfunction isHighDensity(subtree) {\r\n  if (subtree.count) {\r\n    const result = exceedsDensityThreshold(subtree.count, subtree);\r\n    return result === true ? true : subtree.count;\r\n  } else {\r\n    const leftResult = isHighDensity(subtree.left);\r\n    if (leftResult === true) return true;\r\n    const rightResult = isHighDensity(subtree.right);\r\n    if (rightResult === true) return true;\r\n\r\n    const count = leftResult + rightResult;\r\n    const result = exceedsDensityThreshold(count, subtree);\r\n    return result === true ? true : count;\r\n  }\r\n}\r\n\r\nfunction isGeometryHighDensity(geo) {\r\n  const bvh = geo.boundsTree;\r\n  const roots = bvh._roots;\r\n  for (let i = 0; i < roots.length; ++i) {\r\n    return isHighDensity(roots[i]) === true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport const traverseMeshesAndAddShapes = (function() {\r\n  const shapePrefix = \"shape-helper__\";\r\n  const shapes = [];\r\n  return function(el) {\r\n    const meshRoot = el.object3DMap.mesh;\r\n    while (shapes.length > 0) {\r\n      const { id, entity } = shapes.pop();\r\n      entity.removeAttribute(id);\r\n    }\r\n\r\n    console.group(\"traverseMeshesAndAddShapes\");\r\n\r\n    if (document.querySelector([\"[shape-helper__trimesh]\", \"[shape-helper__heightfield]\"])) {\r\n      console.log(\"heightfield or trimesh found on scene\");\r\n    } else {\r\n      console.log(\"collision not found in scene\");\r\n\r\n      let isHighDensity = false;\r\n      meshRoot.traverse(o => {\r\n        if (\r\n          o.isMesh &&\r\n          (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\r\n          !o.name.startsWith(\"Floor_Plan\") &&\r\n          !o.name.startsWith(\"Ground_Plane\") &&\r\n          o.geometry.boundsTree\r\n        ) {\r\n          if (isGeometryHighDensity(o.geometry)) {\r\n            isHighDensity = true;\r\n            return;\r\n          }\r\n        }\r\n      });\r\n\r\n      let navMesh = null;\r\n\r\n      if (isHighDensity) {\r\n        console.log(\"mesh contains high triangle density region\");\r\n        navMesh = document.querySelector(\"[nav-mesh]\");\r\n      }\r\n\r\n      if (navMesh) {\r\n        console.log(`mesh density exceeded, using floor plan only`);\r\n        navMesh.setAttribute(shapePrefix + \"floorPlan\", {\r\n          type: SHAPE.MESH,\r\n          margin: 0.01,\r\n          fit: FIT.ALL,\r\n          includeInvisible: true\r\n        });\r\n        shapes.push({ id: shapePrefix + \"floorPlan\", entity: navMesh });\r\n      } else if (!isHighDensity) {\r\n        el.setAttribute(shapePrefix + \"environment\", {\r\n          type: SHAPE.MESH,\r\n          margin: 0.01,\r\n          fit: FIT.ALL\r\n        });\r\n        shapes.push({ id: shapePrefix + \"environment\", entity: el });\r\n        console.log(\"adding mesh shape for all visible meshes\");\r\n      } else {\r\n        el.setAttribute(shapePrefix + \"defaultFloor\", {\r\n          type: SHAPE.BOX,\r\n          margin: 0.01,\r\n          halfExtents: { x: 4000, y: 0.5, z: 4000 },\r\n          offset: { x: 0, y: -0.5, z: 0 },\r\n          fit: FIT.MANUAL\r\n        });\r\n        shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\r\n        console.log(\"adding default floor collision\");\r\n      }\r\n    }\r\n    console.groupEnd();\r\n  };\r\n})();\r\n","import \"./utils/configs\";\r\nimport { getAbsoluteHref } from \"./utils/media-url-utils\";\r\nimport { isValidSceneUrl } from \"./utils/scene-url-utils\";\r\nimport { messages } from \"./utils/i18n\";\r\nimport { spawnChatMessage } from \"./react-components/chat-message\";\r\nimport { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\r\nimport ducky from \"./assets/models/DuckyMesh.glb\";\r\n\r\nlet uiRoot;\r\n// Handles user-entered messages\r\nexport default class MessageDispatch {\r\n  constructor(scene, entryManager, hubChannel, addToPresenceLog, remountUI, mediaSearchStore) {\r\n    this.scene = scene;\r\n    this.entryManager = entryManager;\r\n    this.hubChannel = hubChannel;\r\n    this.addToPresenceLog = addToPresenceLog;\r\n    this.remountUI = remountUI;\r\n    this.mediaSearchStore = mediaSearchStore;\r\n  }\r\n\r\n  log = body => {\r\n    this.addToPresenceLog({ type: \"log\", body });\r\n  };\r\n\r\n  dispatch = message => {\r\n    if (message.startsWith(\"/\")) {\r\n      const commandParts = message.substring(1).split(/\\s+/);\r\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\r\n      document.activeElement.blur(); // Commands should blur\r\n    } else {\r\n      this.hubChannel.sendMessage(message);\r\n    }\r\n  };\r\n\r\n  dispatchCommand = async (command, ...args) => {\r\n    const entered = this.scene.is(\"entered\");\r\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n    const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n\r\n    if (!entered && (!isGhost || command === \"duck\")) {\r\n      this.addToPresenceLog({ type: \"log\", body: \"You must enter the room to use this command.\" });\r\n      return;\r\n    }\r\n\r\n    const avatarRig = document.querySelector(\"#avatar-rig\");\r\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\r\n    const curScale = avatarRig.object3D.scale;\r\n    let err;\r\n    let physicsSystem;\r\n    const captureSystem = this.scene.systems[\"capture-system\"];\r\n\r\n    switch (command) {\r\n      case \"fly\":\r\n        if (this.scene.systems[\"hubs-systems\"].characterController.fly) {\r\n          this.scene.systems[\"hubs-systems\"].characterController.fly = false;\r\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode disabled.\" });\r\n        } else {\r\n          this.scene.systems[\"hubs-systems\"].characterController.fly = true;\r\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode enabled.\" });\r\n        }\r\n        break;\r\n      case \"grow\":\r\n        for (let i = 0; i < scales.length; i++) {\r\n          if (scales[i] > curScale.x) {\r\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\r\n            avatarRig.object3D.matrixNeedsUpdate = true;\r\n            break;\r\n          }\r\n        }\r\n\r\n        break;\r\n      case \"shrink\":\r\n        for (let i = scales.length - 1; i >= 0; i--) {\r\n          if (curScale.x > scales[i]) {\r\n            avatarRig.object3D.scale.set(scales[i], scales[i], scales[i]);\r\n            break;\r\n          }\r\n        }\r\n\r\n        break;\r\n      case \"leave\":\r\n        this.entryManager.exitScene();\r\n        this.remountUI({ roomUnavailableReason: \"left\" });\r\n        break;\r\n      case \"duck\":\r\n        spawnChatMessage(getAbsoluteHref(location.href, ducky));\r\n        if (Math.random() < 0.01) {\r\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\r\n        } else {\r\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\r\n        }\r\n        break;\r\n      case \"debug\":\r\n        physicsSystem = document.querySelector(\"a-scene\").systems[\"hubs-systems\"].physicsSystem;\r\n        physicsSystem.setDebug(!physicsSystem.debugEnabled);\r\n        break;\r\n      case \"vrstats\":\r\n        document.getElementById(\"stats\").components[\"stats-plus\"].toggleVRStats();\r\n        break;\r\n      case \"scene\":\r\n        if (args[0]) {\r\n          if (await isValidSceneUrl(args[0])) {\r\n            err = this.hubChannel.updateScene(args[0]);\r\n            if (err === \"unauthorized\") {\r\n              this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to change the scene.\" });\r\n            }\r\n          } else {\r\n            this.addToPresenceLog({ type: \"log\", body: messages[\"invalid-scene-url\"] });\r\n          }\r\n        } else if (this.hubChannel.canOrWillIfCreator(\"update_hub\")) {\r\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\", \"use\");\r\n        }\r\n\r\n        break;\r\n      case \"rename\":\r\n        err = this.hubChannel.rename(args.join(\" \"));\r\n        if (err === \"unauthorized\") {\r\n          this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to rename this room.\" });\r\n        }\r\n        break;\r\n      case \"capture\":\r\n        if (!captureSystem.available()) {\r\n          this.log(\"Capture unavailable.\");\r\n          break;\r\n        }\r\n        if (args[0] === \"stop\") {\r\n          if (captureSystem.started()) {\r\n            captureSystem.stop();\r\n            this.log(\"Capture stopped.\");\r\n          } else {\r\n            this.log(\"Capture already stopped.\");\r\n          }\r\n        } else {\r\n          if (captureSystem.started()) {\r\n            this.log(\"Capture already running.\");\r\n          } else {\r\n            captureSystem.start();\r\n            this.log(\"Capture started.\");\r\n          }\r\n        }\r\n        break;\r\n    }\r\n  };\r\n}\r\n","import qsTruthy from \"./utils/qs_truthy\";\r\nimport nextTick from \"./utils/next-tick\";\r\nimport pinnedEntityToGltf from \"./utils/pinned-entity-to-gltf\";\r\nimport { hackyMobileSafariTest } from \"./utils/detect-touchscreen\";\r\n\r\nconst isBotMode = qsTruthy(\"bot\");\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst forceEnableTouchscreen = hackyMobileSafariTest();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\nconst isDebug = qsTruthy(\"debug\");\r\nconst qs = new URLSearchParams(location.search);\r\n\r\nimport { addMedia, getPromotionTokenForFile } from \"./utils/media-utils\";\r\nimport {\r\n  isIn2DInterstitial,\r\n  handleExitTo2DInterstitial,\r\n  exit2DInterstitialAndEnterVR,\r\n  forceExitFrom2DInterstitial\r\n} from \"./utils/vr-interstitial\";\r\nimport { ObjectContentOrigins } from \"./object-types\";\r\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\r\nimport { pushHistoryState } from \"./utils/history\";\r\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\r\n\r\nconst isIOS = AFRAME.utils.device.isIOS();\r\n\r\nexport default class SceneEntryManager {\r\n  constructor(hubChannel, authChannel, availableVREntryTypes, history) {\r\n    this.hubChannel = hubChannel;\r\n    this.authChannel = authChannel;\r\n    this.availableVREntryTypes = availableVREntryTypes;\r\n    this.store = window.APP.store;\r\n    this.mediaSearchStore = window.APP.mediaSearchStore;\r\n    this.scene = document.querySelector(\"a-scene\");\r\n    this.rightCursorController = document.getElementById(\"right-cursor-controller\");\r\n    this.leftCursorController = document.getElementById(\"left-cursor-controller\");\r\n    this.avatarRig = document.getElementById(\"avatar-rig\");\r\n    this._entered = false;\r\n    this.performConditionalSignIn = () => {};\r\n    this.history = history;\r\n  }\r\n\r\n  init = () => {\r\n    this.whenSceneLoaded(() => {\r\n      this.rightCursorController.components[\"cursor-controller\"].enabled = false;\r\n      this.leftCursorController.components[\"cursor-controller\"].enabled = false;\r\n    });\r\n  };\r\n\r\n  hasEntered = () => {\r\n    return this._entered;\r\n  };\r\n\r\n  enterScene = async (mediaStream, enterInVR, muteOnEntry) => {\r\n    document.getElementById(\"viewing-camera\").removeAttribute(\"scene-preview-camera\");\r\n    const waypointSystem = this.scene.systems[\"hubs-systems\"].waypointSystem;\r\n    waypointSystem.moveToSpawnPoint();\r\n\r\n    if (isDebug) {\r\n      NAF.connection.adapter.session.options.verbose = true;\r\n    }\r\n\r\n    if (enterInVR) {\r\n      // This specific scene state var is used to check if the user went through the\r\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\r\n      this.scene.addState(\"vr-entered\");\r\n\r\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\r\n      // force gamepads to become live.\r\n      navigator.getVRDisplays();\r\n\r\n      await exit2DInterstitialAndEnterVR(true);\r\n    }\r\n\r\n    if (isMobile || forceEnableTouchscreen || qsTruthy(\"mobile\")) {\r\n      this.avatarRig.setAttribute(\"virtual-gamepad-controls\", {});\r\n    }\r\n\r\n    this._setupPlayerRig();\r\n    this._setupBlocking();\r\n    this._setupKicking();\r\n    this._setupMedia(mediaStream);\r\n    this._setupCamera();\r\n\r\n    if (qsTruthy(\"offline\")) return;\r\n\r\n    this._spawnAvatar();\r\n\r\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\r\n\r\n    if (isBotMode) {\r\n      this._runBot(mediaStream);\r\n      this.scene.addState(\"entered\");\r\n      return;\r\n    }\r\n\r\n    if (mediaStream) {\r\n      await NAF.connection.adapter.setLocalMediaStream(mediaStream);\r\n    }\r\n\r\n    this.scene.classList.remove(\"hand-cursor\");\r\n    this.scene.classList.add(\"no-cursor\");\r\n\r\n    this.rightCursorController.components[\"cursor-controller\"].enabled = true;\r\n    this.leftCursorController.components[\"cursor-controller\"].enabled = true;\r\n    this._entered = true;\r\n\r\n    // Delay sending entry event telemetry until VR display is presenting.\r\n    (async () => {\r\n      while (enterInVR && !(await navigator.getVRDisplays()).find(d => d.isPresenting)) {\r\n        await nextTick();\r\n      }\r\n\r\n      this.hubChannel.sendEnteredEvent().then(() => {\r\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\r\n      });\r\n    })();\r\n\r\n    // Bump stored entry count after 30s\r\n    setTimeout(() => this.store.bumpEntryCount(), 30000);\r\n\r\n    this.scene.addState(\"entered\");\r\n\r\n    if (muteOnEntry) {\r\n      this.scene.emit(\"action_mute\");\r\n    }\r\n  };\r\n\r\n  whenSceneLoaded = callback => {\r\n    if (this.scene.hasLoaded) {\r\n      callback();\r\n    } else {\r\n      this.scene.addEventListener(\"loaded\", callback);\r\n    }\r\n  };\r\n\r\n  enterSceneWhenLoaded = (mediaStream, enterInVR) => {\r\n    this.whenSceneLoaded(() => this.enterScene(mediaStream, enterInVR));\r\n  };\r\n\r\n  exitScene = () => {\r\n    this.scene.exitVR();\r\n    if (NAF.connection.adapter && NAF.connection.adapter.localMediaStream) {\r\n      NAF.connection.adapter.localMediaStream.getTracks().forEach(t => t.stop());\r\n    }\r\n    if (this.hubChannel) {\r\n      this.hubChannel.disconnect();\r\n    }\r\n    if (this.scene.renderer) {\r\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\r\n    }\r\n    this.scene.parentNode.removeChild(this.scene);\r\n  };\r\n\r\n  _setupPlayerRig = () => {\r\n    this._setPlayerInfoFromProfile();\r\n\r\n    // Explict user action changed avatar or updated existing avatar.\r\n    this.scene.addEventListener(\"avatar_updated\", () => this._setPlayerInfoFromProfile(true));\r\n\r\n    // Store updates can occur to avatar id in cases like error, auth reset, etc.\r\n    this.store.addEventListener(\"statechanged\", () => this._setPlayerInfoFromProfile());\r\n\r\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\r\n    if (avatarScale) {\r\n      this.avatarRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\r\n    }\r\n  };\r\n\r\n  _setPlayerInfoFromProfile = async (force = false) => {\r\n    const avatarId = this.store.state.profile.avatarId;\r\n    if (!force && this._lastFetchedAvatarId === avatarId) return; // Avoid continually refetching based upon state changing\r\n\r\n    this._lastFetchedAvatarId = avatarId;\r\n    const avatarSrc = await getAvatarSrc(avatarId);\r\n\r\n    this.avatarRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\r\n  };\r\n\r\n  _setupKicking = () => {\r\n    // This event is only received by the kicker\r\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\r\n      const { clientId: kickedClientId } = detail;\r\n      const { entities } = NAF.connection.entities;\r\n      for (const id in entities) {\r\n        const entity = entities[id];\r\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\r\n\r\n        if (entity.components.networked.data.persistent) {\r\n          NAF.utils.takeOwnership(entity);\r\n          this._unpinElement(entity);\r\n          entity.parentNode.removeChild(entity);\r\n        } else {\r\n          NAF.entities.removeEntity(id);\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  _setupBlocking = () => {\r\n    document.body.addEventListener(\"blocked\", ev => {\r\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\r\n    });\r\n\r\n    document.body.addEventListener(\"unblocked\", ev => {\r\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\r\n    });\r\n  };\r\n\r\n  _pinElement = async el => {\r\n    const { networkId } = el.components.networked.data;\r\n\r\n    const { fileId, src } = el.components[\"media-loader\"].data;\r\n\r\n    let fileAccessToken, promotionToken;\r\n    if (fileId) {\r\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\r\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\r\n      if (storedPromotionToken) {\r\n        promotionToken = storedPromotionToken.promotionToken;\r\n      }\r\n    }\r\n\r\n    const gltfNode = pinnedEntityToGltf(el);\r\n    if (!gltfNode) return;\r\n    el.setAttribute(\"networked\", { persistent: true });\r\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\r\n\r\n    try {\r\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\r\n      this.store.update({ activity: { hasPinned: true } });\r\n    } catch (e) {\r\n      if (e.reason === \"invalid_token\") {\r\n        await this.authChannel.signOut(this.hubChannel);\r\n        this._signInAndPinOrUnpinElement(el);\r\n      } else {\r\n        console.warn(\"Pin failed for unknown reason\", e);\r\n      }\r\n    }\r\n  };\r\n\r\n  _signInAndPinOrUnpinElement = (el, pin) => {\r\n    const action = pin\r\n      ? () => this._pinElement(el)\r\n      : async () => {\r\n          await this._unpinElement(el);\r\n        };\r\n\r\n    this.performConditionalSignIn(() => this.hubChannel.signedIn, action, pin ? \"pin\" : \"unpin\", () => {\r\n      // UI pins/un-pins the entity optimistically, so we undo that here.\r\n      // Note we have to disable the sign in flow here otherwise this will recurse.\r\n      this._disableSignInOnPinAction = true;\r\n      el.setAttribute(\"pinnable\", \"pinned\", !pin);\r\n      this._disableSignInOnPinAction = false;\r\n    });\r\n  };\r\n\r\n  _unpinElement = el => {\r\n    const components = el.components;\r\n    const networked = components.networked;\r\n\r\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) return;\r\n\r\n    const networkId = components.networked.data.networkId;\r\n    el.setAttribute(\"networked\", { persistent: false });\r\n\r\n    const mediaLoader = components[\"media-loader\"];\r\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\r\n\r\n    this.hubChannel.unpin(networkId, fileId);\r\n  };\r\n\r\n  _setupMedia = mediaStream => {\r\n    const offset = { x: 0, y: 0, z: -1.5 };\r\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\r\n      if (!this.hubChannel.can(\"spawn_and_move_media\")) return;\r\n      const { entity, orientation } = addMedia(\r\n        src,\r\n        \"#interactable-media\",\r\n        contentOrigin,\r\n        null,\r\n        !(src instanceof MediaStream),\r\n        true\r\n      );\r\n      orientation.then(or => {\r\n        entity.setAttribute(\"offset-relative-to\", {\r\n          target: \"#avatar-pov-node\",\r\n          offset,\r\n          orientation: or\r\n        });\r\n      });\r\n\r\n      return entity;\r\n    };\r\n\r\n    this.scene.addEventListener(\"add_media\", e => {\r\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\r\n\r\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\r\n    });\r\n\r\n    const handlePinEvent = (e, pinned) => {\r\n      if (this._disableSignInOnPinAction) return;\r\n      const el = e.detail.el;\r\n\r\n      if (NAF.utils.isMine(el)) {\r\n        this._signInAndPinOrUnpinElement(e.detail.el, pinned);\r\n      }\r\n    };\r\n\r\n    this.scene.addEventListener(\"pinned\", e => handlePinEvent(e, true));\r\n    this.scene.addEventListener(\"unpinned\", e => handlePinEvent(e, false));\r\n\r\n    this.scene.addEventListener(\"object_spawned\", e => {\r\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_spawn\", () => {\r\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\r\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_invite\", () => {\r\n      handleExitTo2DInterstitial(false, () => this.history.goBack());\r\n      pushHistoryState(this.history, \"overlay\", \"invite\");\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\r\n      this.performConditionalSignIn(\r\n        () => this.hubChannel.can(\"kick_users\"),\r\n        async () => await window.APP.hubChannel.kick(clientId),\r\n        \"kick-user\"\r\n      );\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\r\n      this.performConditionalSignIn(\r\n        () => this.hubChannel.can(\"mute_users\"),\r\n        () => window.APP.hubChannel.mute(clientId),\r\n        \"mute-user\"\r\n      );\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\r\n\r\n    document.addEventListener(\"paste\", e => {\r\n      if (\r\n        (e.target.matches(\"input, textarea\") || e.target.contentEditable === \"true\") &&\r\n        document.activeElement === e.target\r\n      )\r\n        return;\r\n\r\n      // Never paste into scene if dialog is open\r\n      const uiRoot = document.querySelector(\".ui-root\");\r\n      if (uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\")) return;\r\n\r\n      const url = e.clipboardData.getData(\"text\");\r\n      const files = e.clipboardData.files && e.clipboardData.files;\r\n      if (url) {\r\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\r\n      } else {\r\n        for (const file of files) {\r\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\r\n        }\r\n      }\r\n    });\r\n\r\n    document.addEventListener(\"dragover\", e => e.preventDefault());\r\n\r\n    document.addEventListener(\"drop\", e => {\r\n      e.preventDefault();\r\n\r\n      let url = e.dataTransfer.getData(\"url\");\r\n\r\n      if (!url) {\r\n        // Sometimes dataTransfer text contains a valid URL, so try for that.\r\n        try {\r\n          url = new URL(e.dataTransfer.getData(\"text\")).href;\r\n        } catch (e) {\r\n          // Nope, not this time.\r\n        }\r\n      }\r\n\r\n      const files = e.dataTransfer.files;\r\n\r\n      if (url) {\r\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\r\n      } else {\r\n        for (const file of files) {\r\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\r\n        }\r\n      }\r\n    });\r\n\r\n    let currentVideoShareEntity;\r\n    let isHandlingVideoShare = false;\r\n\r\n    const shareVideoMediaStream = async (constraints, isDisplayMedia) => {\r\n      if (isHandlingVideoShare) return;\r\n      isHandlingVideoShare = true;\r\n\r\n      let newStream;\r\n\r\n      try {\r\n        if (isDisplayMedia) {\r\n          newStream = await navigator.mediaDevices.getDisplayMedia(constraints);\r\n        } else {\r\n          newStream = await navigator.mediaDevices.getUserMedia(constraints);\r\n        }\r\n      } catch (e) {\r\n        isHandlingVideoShare = false;\r\n        this.scene.emit(\"share_video_failed\");\r\n        return;\r\n      }\r\n\r\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\r\n\r\n      if (videoTracks.length > 0) {\r\n        newStream.getVideoTracks().forEach(track => mediaStream.addTrack(track));\r\n        await NAF.connection.adapter.setLocalMediaStream(mediaStream);\r\n        currentVideoShareEntity = spawnMediaInfrontOfPlayer(mediaStream, undefined);\r\n\r\n        // Wire up custom removal event which will stop the stream.\r\n        currentVideoShareEntity.setAttribute(\"emit-scene-event-on-remove\", \"event:action_end_video_sharing\");\r\n      }\r\n\r\n      this.scene.emit(\"share_video_enabled\", { source: isDisplayMedia ? \"screen\" : \"camera\" });\r\n      this.scene.addState(\"sharing_video\");\r\n      isHandlingVideoShare = false;\r\n    };\r\n\r\n    this.scene.addEventListener(\"action_share_camera\", () => {\r\n      shareVideoMediaStream({\r\n        video: {\r\n          mediaSource: \"camera\",\r\n          width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\r\n          frameRate: 30\r\n        }\r\n      });\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_share_screen\", () => {\r\n      shareVideoMediaStream(\r\n        {\r\n          video: {\r\n            // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\r\n            // other than your current monitor that has a different aspect ratio.\r\n            width: 720 * (screen.width / screen.height),\r\n            height: 720,\r\n            frameRate: 30\r\n          },\r\n          audio: true\r\n        },\r\n        true\r\n      );\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_end_video_sharing\", async () => {\r\n      if (isHandlingVideoShare) return;\r\n      isHandlingVideoShare = true;\r\n\r\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\r\n        NAF.utils.takeOwnership(currentVideoShareEntity);\r\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\r\n      }\r\n\r\n      for (const track of mediaStream.getVideoTracks()) {\r\n        mediaStream.removeTrack(track);\r\n      }\r\n\r\n      await NAF.connection.adapter.setLocalMediaStream(mediaStream);\r\n      currentVideoShareEntity = null;\r\n\r\n      this.scene.emit(\"share_video_disabled\");\r\n      this.scene.removeState(\"sharing_video\");\r\n      isHandlingVideoShare = false;\r\n    });\r\n\r\n    this.scene.addEventListener(\"action_selected_media_result_entry\", async e => {\r\n      // TODO spawn in space when no rights\r\n      const { entry, selectAction } = e.detail;\r\n      if (selectAction !== \"spawn\") return;\r\n\r\n      const delaySpawn = isIn2DInterstitial() && !isMobileVR;\r\n      await exit2DInterstitialAndEnterVR();\r\n\r\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\r\n      if (delaySpawn) {\r\n        setTimeout(() => {\r\n          spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\r\n        }, 3000);\r\n      } else {\r\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\r\n      }\r\n    });\r\n\r\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\r\n      exit2DInterstitialAndEnterVR();\r\n    });\r\n  };\r\n\r\n  _setupCamera = () => {\r\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\r\n      if (!this.hubChannel.can(\"spawn_camera\")) return;\r\n      const myCamera = this.scene.systems[\"camera-tools\"].getMyCamera();\r\n\r\n      if (myCamera) {\r\n        myCamera.parentNode.removeChild(myCamera);\r\n        this.scene.removeState(\"camera\");\r\n      } else {\r\n        const entity = document.createElement(\"a-entity\");\r\n        entity.setAttribute(\"networked\", { template: \"#interactable-camera\" });\r\n        entity.setAttribute(\"offset-relative-to\", {\r\n          target: \"#avatar-pov-node\",\r\n          offset: { x: 0, y: 0, z: -1.5 }\r\n        });\r\n        this.scene.appendChild(entity);\r\n        this.scene.addState(\"camera\");\r\n      }\r\n\r\n      // Need to wait a frame so camera is registered with system.\r\n      setTimeout(() => this.scene.emit(\"camera_toggled\"));\r\n    });\r\n\r\n    this.scene.addEventListener(\"photo_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"photo\"));\r\n    this.scene.addEventListener(\"video_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"video\"));\r\n  };\r\n\r\n  _spawnAvatar = () => {\r\n    this.avatarRig.setAttribute(\"networked\", \"template: #remote-avatar; attachTemplateToLocal: false;\");\r\n    this.avatarRig.setAttribute(\"networked-avatar\", \"\");\r\n    this.avatarRig.emit(\"entered\");\r\n  };\r\n\r\n  _runBot = async mediaStream => {\r\n    const audioEl = document.createElement(\"audio\");\r\n    let audioInput;\r\n    let dataInput;\r\n\r\n    // Wait for startup to render form\r\n    do {\r\n      audioInput = document.querySelector(\"#bot-audio-input\");\r\n      dataInput = document.querySelector(\"#bot-data-input\");\r\n      await nextTick();\r\n    } while (!audioInput || !dataInput);\r\n\r\n    const getAudio = () => {\r\n      audioEl.loop = true;\r\n      audioEl.muted = true;\r\n      audioEl.crossorigin = \"anonymous\";\r\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\r\n      document.body.appendChild(audioEl);\r\n    };\r\n\r\n    if (audioInput.files && audioInput.files.length > 0) {\r\n      getAudio();\r\n    } else {\r\n      audioInput.onchange = getAudio;\r\n    }\r\n\r\n    const camera = document.querySelector(\"#avatar-pov-node\");\r\n    const leftController = document.querySelector(\"#player-left-controller\");\r\n    const rightController = document.querySelector(\"#player-right-controller\");\r\n    const getRecording = () => {\r\n      fetch(URL.createObjectURL(dataInput.files[0]))\r\n        .then(resp => resp.json())\r\n        .then(recording => {\r\n          camera.setAttribute(\"replay\", \"\");\r\n          camera.components[\"replay\"].poses = recording.camera.poses;\r\n\r\n          leftController.setAttribute(\"replay\", \"\");\r\n          leftController.components[\"replay\"].poses = recording.left.poses;\r\n          leftController.removeAttribute(\"visibility-by-path\");\r\n          leftController.removeAttribute(\"track-pose\");\r\n          leftController.setAttribute(\"visible\", true);\r\n\r\n          rightController.setAttribute(\"replay\", \"\");\r\n          rightController.components[\"replay\"].poses = recording.right.poses;\r\n          rightController.removeAttribute(\"visibility-by-path\");\r\n          rightController.removeAttribute(\"track-pose\");\r\n          rightController.setAttribute(\"visible\", true);\r\n        });\r\n    };\r\n\r\n    if (dataInput.files && dataInput.files.length > 0) {\r\n      getRecording();\r\n    } else {\r\n      dataInput.onchange = getRecording;\r\n    }\r\n\r\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\r\n    mediaStream.addTrack(\r\n      audioEl.captureStream\r\n        ? audioEl.captureStream().getAudioTracks()[0]\r\n        : audioEl.mozCaptureStream\r\n          ? audioEl.mozCaptureStream().getAudioTracks()[0]\r\n          : null\r\n    );\r\n    await NAF.connection.adapter.setLocalMediaStream(mediaStream);\r\n    audioEl.play();\r\n  };\r\n}\r\n","export default function pinnedEntityToGltf(el) {\r\n  if (!NAF.utils.isMine(el)) return;\r\n\r\n  // Construct a GLTF node from this entity\r\n  const object3D = el.object3D;\r\n  const components = el.components;\r\n  const networkId = components.networked.data.networkId;\r\n\r\n  const gltfComponents = {};\r\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\r\n  // Please do this before making a breaking change to the data stored here.\r\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\r\n\r\n  // Adapted from three.js GLTFExporter\r\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\r\n  const rotation = object3D.quaternion.toArray();\r\n  const position = object3D.position.toArray();\r\n  const scale = object3D.scale.toArray();\r\n\r\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\r\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\r\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\r\n\r\n  if (components[\"media-loader\"]) {\r\n    const mediaSrc = components[\"media-loader\"].data.src;\r\n    const mediaVersion = components[\"media-loader\"].data.version;\r\n    const mediaContentSubtype = components[\"media-loader\"].data.contentSubtype;\r\n\r\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\r\n      // Do not persist hubs client video urls\r\n      return null;\r\n    }\r\n\r\n    gltfComponents.media = { src: mediaSrc, version: mediaVersion, contentSubtype: mediaContentSubtype, id: networkId };\r\n\r\n    if (components[\"media-pdf\"]) {\r\n      gltfComponents.media.pageIndex = components[\"media-pdf\"].data.index;\r\n    }\r\n\r\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\r\n      gltfComponents.media.paused = true;\r\n      gltfComponents.media.time = components[\"media-video\"].data.time;\r\n    }\r\n  }\r\n\r\n  gltfComponents.pinnable = { pinned: true };\r\n\r\n  return gltfNode;\r\n}\r\n","import nextTick from \"./utils/next-tick.js\";\r\nconst INIT_TIMEOUT_MS = 5000;\r\n\r\n// Manages web push subscriptions\r\n//\r\nfunction urlBase64ToUint8Array(base64String) {\r\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\r\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\r\n\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n\r\n  for (let i = 0; i < rawData.length; ++i) {\r\n    outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}\r\n\r\nexport default class Subscriptions {\r\n  constructor(hubId) {\r\n    this.hubId = hubId;\r\n  }\r\n\r\n  setHubChannel = hubChannel => {\r\n    this.hubChannel = hubChannel;\r\n  };\r\n\r\n  setRegistration = registration => {\r\n    this.registration = registration;\r\n  };\r\n\r\n  setRegistrationFailed = () => {\r\n    this.registration = null;\r\n  };\r\n\r\n  setVapidPublicKey = vapidPublicKey => {\r\n    this.vapidPublicKey = vapidPublicKey;\r\n  };\r\n\r\n  setSubscribed = isSubscribed => {\r\n    this._isSubscribed = isSubscribed;\r\n  };\r\n\r\n  isSubscribed = () => {\r\n    return this._isSubscribed;\r\n  };\r\n\r\n  getCurrentEndpoint = async () => {\r\n    if (!navigator.serviceWorker) return null;\r\n    const startedAt = performance.now();\r\n\r\n    // registration becomes null if failed, non null if registered\r\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\r\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\r\n    if (!this.registration || !this.registration.pushManager) return null;\r\n\r\n    while (this.vapidPublicKey === undefined) await nextTick();\r\n    if (this.vapidPublicKey === null) return null;\r\n\r\n    try {\r\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\r\n\r\n      if (\r\n        (await this.registration.pushManager.permissionState({\r\n          userVisibleOnly: true,\r\n          applicationServerKey: convertedVapidKey\r\n        })) !== \"granted\"\r\n      )\r\n        return null;\r\n    } catch (e) {\r\n      return null; // Chrome can throw here complaining about userVisible if push is not right\r\n    }\r\n    const sub = await this.registration.pushManager.getSubscription();\r\n    if (!sub) return null;\r\n\r\n    return sub.endpoint;\r\n  };\r\n\r\n  toggle = async () => {\r\n    if (!this.registration) return;\r\n\r\n    if (this._isSubscribed) {\r\n      const pushSubscription = await this.registration.pushManager.getSubscription();\r\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\r\n\r\n      if (res && res.has_remaining_subscriptions === false) {\r\n        pushSubscription.unsubscribe();\r\n      }\r\n    } else {\r\n      let pushSubscription = await this.registration.pushManager.getSubscription();\r\n\r\n      if (!pushSubscription) {\r\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\r\n\r\n        pushSubscription = await this.registration.pushManager.subscribe({\r\n          userVisibleOnly: true,\r\n          applicationServerKey: convertedVapidKey\r\n        });\r\n      }\r\n\r\n      this.hubChannel.subscribe(pushSubscription);\r\n    }\r\n\r\n    this._isSubscribed = !this._isSubscribed;\r\n  };\r\n}\r\n","import { forEachMaterial } from \"../utils/material-utils\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\nconst invaderPos = new AFRAME.THREE.Vector3();\r\nconst bubblePos = new AFRAME.THREE.Vector3();\r\nconst isDebug = qsTruthy(\"debug\");\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\n\r\n/**\r\n * Updates invaders every tick, doing one per frame on mobile VR.\r\n * testing multiline things\r\n * @namespace avatar/personal-space-bubble\r\n * @system personal-space-bubble\r\n */\r\nAFRAME.registerSystem(\"personal-space-bubble\", {\r\n  schema: {\r\n    debug: { default: false },\r\n    enabled: { default: true }\r\n  },\r\n\r\n  init() {\r\n    this.invaders = [];\r\n    this.bubbles = [];\r\n    this.tickCount = 0;\r\n    this._updateInvaders = this._updateInvaders.bind(this);\r\n  },\r\n\r\n  registerBubble(bubble) {\r\n    this.bubbles.push(bubble);\r\n  },\r\n\r\n  unregisterBubble(bubble) {\r\n    const index = this.bubbles.indexOf(bubble);\r\n\r\n    if (index !== -1) {\r\n      this.bubbles.splice(index, 1);\r\n    }\r\n  },\r\n\r\n  registerInvader(invader) {\r\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\r\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\r\n\r\n      if (owner !== NAF.clientId) {\r\n        this.invaders.push(invader);\r\n      }\r\n    });\r\n  },\r\n\r\n  unregisterInvader(invader) {\r\n    const index = this.invaders.indexOf(invader);\r\n\r\n    if (index !== -1) {\r\n      this.invaders.splice(index, 1);\r\n    }\r\n  },\r\n\r\n  update() {\r\n    for (let i = 0; i < this.bubbles.length; i++) {\r\n      this.bubbles[i].updateDebug();\r\n    }\r\n\r\n    for (let i = 0; i < this.invaders.length; i++) {\r\n      this.invaders[i].updateDebug();\r\n      if (!this.data.enabled) {\r\n        this.invaders[i].setInvading(false);\r\n      }\r\n    }\r\n\r\n    if (this.data.enabled) {\r\n      this.el.addState(\"spacebubble\");\r\n    } else {\r\n      this.el.removeState(\"spacebubble\");\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    this._updateInvaders();\r\n    this.tickCount++;\r\n  },\r\n\r\n  _updateInvaders: (function() {\r\n    const tempInvasionFlags = [];\r\n\r\n    const setInvaderFlag = (i, invaders, bubble) => {\r\n      // Hide the invader if inside the bubble\r\n      const invader = invaders[i];\r\n      invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\r\n\r\n      const distanceSquared = bubblePos.distanceToSquared(invaderPos);\r\n      const radiusSum = bubble.data.radius + invader.data.radius;\r\n\r\n      if (distanceSquared < radiusSum * radiusSum) {\r\n        tempInvasionFlags[i] = true;\r\n      }\r\n    };\r\n\r\n    const flushInvadingFlagsForIndex = (i, invaders) => {\r\n      if (invaders[i].invading !== tempInvasionFlags[i]) {\r\n        invaders[i].setInvading(tempInvasionFlags[i]);\r\n      }\r\n    };\r\n\r\n    return function() {\r\n      if (!this.data.enabled) return;\r\n      if (this.invaders.length === 0) return;\r\n\r\n      tempInvasionFlags.length = 0;\r\n\r\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\r\n      // right now this is satisfied because we update the world matrices in the character controller\r\n      for (let i = 0; i < this.invaders.length; i++) {\r\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\r\n        tempInvasionFlags[i] = false;\r\n      }\r\n\r\n      // Loop through all of the space bubbles (usually one)\r\n      for (let i = 0; i < this.bubbles.length; i++) {\r\n        const bubble = this.bubbles[i];\r\n\r\n        bubble.el.object3D.updateMatrices();\r\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\r\n\r\n        if (!isMobileVR) {\r\n          for (let j = 0; j < this.invaders.length; j++) {\r\n            setInvaderFlag(j, this.invaders, bubble);\r\n          }\r\n        } else {\r\n          // Optimization: update one invader per frame on mobile VR\r\n          setInvaderFlag(this.tickCount % this.invaders.length, this.invaders, bubble);\r\n        }\r\n      }\r\n\r\n      if (!isMobileVR) {\r\n        for (let i = 0; i < this.invaders.length; i++) {\r\n          flushInvadingFlagsForIndex(i, this.invaders);\r\n        }\r\n      } else {\r\n        flushInvadingFlagsForIndex(this.tickCount % this.invaders.length, this.invaders);\r\n      }\r\n    };\r\n  })()\r\n});\r\n\r\nfunction createSphereGizmo(radius) {\r\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\r\n  const wireframe = new THREE.WireframeGeometry(geometry);\r\n  const line = new THREE.LineSegments(wireframe);\r\n  line.material.opacity = 0.5;\r\n  line.material.transparent = true;\r\n  return line;\r\n}\r\n\r\n// TODO: we need to come up with a more generic way of doing this as this is very specific to our avatars.\r\n/**\r\n * Specifies a mesh associated with an invader.\r\n * @namespace avatar/personal-space-bubble\r\n * @component space-invader-mesh\r\n */\r\nAFRAME.registerComponent(\"space-invader-mesh\", {\r\n  schema: {\r\n    meshName: { type: \"string\" }\r\n  },\r\n  update() {\r\n    this.targetMesh = this.el.object3D.getObjectByName(this.data.meshName);\r\n  }\r\n});\r\n\r\nfunction findInvaderMesh(entity) {\r\n  while (entity && !(entity.components && entity.components[\"space-invader-mesh\"])) {\r\n    entity = entity.parentNode;\r\n  }\r\n  return entity && entity.components[\"space-invader-mesh\"].targetMesh;\r\n}\r\n\r\nconst DEBUG_OBJ = \"psb-debug\";\r\n\r\n/**\r\n * Represents an entity that can invade a personal space bubble\r\n * @namespace avatar/personal-space-bubble\r\n * @component personal-space-invader\r\n */\r\nAFRAME.registerComponent(\"personal-space-invader\", {\r\n  schema: {\r\n    radius: { type: \"number\", default: 0.1 },\r\n    useMaterial: { default: false },\r\n    debug: { default: false },\r\n    invadingOpacity: { default: 0.3 }\r\n  },\r\n\r\n  init() {\r\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\r\n    system.registerInvader(this);\r\n    if (this.data.useMaterial) {\r\n      const mesh = findInvaderMesh(this.el);\r\n      if (mesh) {\r\n        this.targetMesh = mesh;\r\n      }\r\n    }\r\n    this.invading = false;\r\n    this.alwaysHidden = false;\r\n  },\r\n\r\n  update() {\r\n    this.radiusSquared = this.data.radius * this.data.radius;\r\n    this.updateDebug();\r\n  },\r\n\r\n  // Allow external callers to tell this invader to always hide this element, regardless of invasion state\r\n  setAlwaysHidden(alwaysHidden) {\r\n    this.alwaysHidden = alwaysHidden;\r\n    this.applyInvasionToMesh(this.invading);\r\n  },\r\n\r\n  updateDebug() {\r\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\r\n    if (system.data.debug || this.data.debug) {\r\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\r\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\r\n      this.el.removeObject3D(DEBUG_OBJ);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\r\n  },\r\n\r\n  setInvading(invading) {\r\n    if (this.invading === invading) return;\r\n\r\n    this.applyInvasionToMesh(invading);\r\n    this.invading = invading;\r\n  },\r\n\r\n  disable() {\r\n    if (this.invading) {\r\n      this.applyInvasionToMesh(false);\r\n    }\r\n\r\n    this.disabled = true;\r\n    this.updateBoneVisibility();\r\n  },\r\n\r\n  enable() {\r\n    this.disabled = false;\r\n    this.applyInvasionToMesh(this.invading);\r\n    this.updateBoneVisibility();\r\n  },\r\n\r\n  updateBoneVisibility() {\r\n    // HACK, bone visibility typically takes a tick to update, but since we want to be able\r\n    // to have enable() and disable() be reflected this frame, we need to do it immediately.\r\n    this.el.components[\"bone-visibility\"] && this.el.components[\"bone-visibility\"].tick();\r\n  },\r\n\r\n  applyInvasionToMesh(invading) {\r\n    if (this.disabled) return;\r\n\r\n    if (this.targetMesh && this.targetMesh.material && !this.alwaysHidden) {\r\n      forEachMaterial(this.targetMesh, material => {\r\n        material.opacity = invading ? this.data.invadingOpacity : 1;\r\n        material.transparent = invading;\r\n      });\r\n    } else {\r\n      this.el.object3D.visible = !invading && !this.alwaysHidden;\r\n    }\r\n  }\r\n});\r\n\r\n/**\r\n * Represents a personal space bubble on an entity.\r\n * @namespace avatar/personal-space-bubble\r\n * @component personal-space-bubble\r\n */\r\nAFRAME.registerComponent(\"personal-space-bubble\", {\r\n  schema: {\r\n    radius: { type: \"number\", default: 0.8 },\r\n    debug: { default: false }\r\n  },\r\n  init() {\r\n    this.system.registerBubble(this);\r\n  },\r\n\r\n  update() {\r\n    this.radiusSquared = this.data.radius * this.data.radius;\r\n    this.updateDebug();\r\n  },\r\n\r\n  updateDebug() {\r\n    if (!isDebug) return;\r\n\r\n    if (this.system.data.debug || this.data.debug) {\r\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\r\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\r\n      this.el.removeObject3D(DEBUG_OBJ);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.system.unregisterBubble(this);\r\n  }\r\n});\r\n","import { paths } from \"./userinput/paths\";\r\nconst qs = new URLSearchParams(location.search);\r\nconst IDLE_TIMEOUT_MS = (parseInt(qs.get(\"idle_timeout\"), 10) || 2 * 60 * 60) * 1000;\r\nconst INPUT_CHECK_INTERVAL_MS = 1000;\r\n\r\nconst CHARACTER_ACCELERATION_PATH = paths.actions.characterAcceleration;\r\nconst BASIC_ACTIVITY_PATHS = [\r\n  paths.actions.startGazeTeleport,\r\n  paths.actions.rightHand.startTeleport,\r\n  paths.actions.leftHand.startTeleport,\r\n  paths.actions.snapRotateRight,\r\n  paths.actions.snapRotateLeft,\r\n  paths.actions.cursor.right.grab,\r\n  paths.actions.cursor.left.grab,\r\n  paths.actions.rightHand.grab,\r\n  paths.actions.leftHand.grab,\r\n  paths.actions.angularVelocity\r\n];\r\n\r\nAFRAME.registerSystem(\"idle-detector\", {\r\n  init() {\r\n    this.resetTimeout = this.resetTimeout.bind(this);\r\n    this.idleTimeout = null;\r\n    this.lastInputCheck = 0;\r\n\r\n    const events = [\"click\", \"pointerdown\", \"touchstart\", \"keyup\"];\r\n\r\n    for (const event of events) {\r\n      window.addEventListener(event, this.resetTimeout);\r\n    }\r\n\r\n    this.resetTimeout();\r\n  },\r\n  resetTimeout() {\r\n    if (this.idleTimeout) clearTimeout(this.idleTimeout);\r\n    this.idleTimeout = setTimeout(this.onIdleTimeout, IDLE_TIMEOUT_MS);\r\n    window.dispatchEvent(new CustomEvent(\"activity_detected\"));\r\n  },\r\n  onIdleTimeout() {\r\n    window.dispatchEvent(new CustomEvent(\"idle_detected\"));\r\n  },\r\n  tick(time) {\r\n    if (time - this.lastInputCheck < INPUT_CHECK_INTERVAL_MS) return;\r\n\r\n    const userinput = this.el.systems.userinput;\r\n\r\n    let basicActivity = false;\r\n    for (const activityPath of BASIC_ACTIVITY_PATHS) {\r\n      basicActivity = basicActivity || !!userinput.get(activityPath);\r\n    }\r\n\r\n    const characterAcceleration = userinput.get(CHARACTER_ACCELERATION_PATH);\r\n\r\n    const active =\r\n      basicActivity ||\r\n      !!(characterAcceleration && characterAcceleration[0]) ||\r\n      !!(characterAcceleration && characterAcceleration[1]);\r\n\r\n    if (active) {\r\n      this.resetTimeout();\r\n    }\r\n  },\r\n  remove() {}\r\n});\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nconst CAMERA_UPDATE_FRAME_DELAY = 10; // Update one camera every N'th frame\r\n\r\n// Used for tracking and managing camera tools in the scene\r\nAFRAME.registerSystem(\"camera-tools\", {\r\n  init() {\r\n    this.cameraEls = [];\r\n    this.cameraUpdateCount = 0;\r\n    this.ticks = 0;\r\n    this.updateMyCamera = this.updateMyCamera.bind(this);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      const playerModelEl = document.querySelector(\"#avatar-rig .model\");\r\n      playerModelEl.addEventListener(\"model-loading\", () => (this.playerHead = null));\r\n      playerModelEl.addEventListener(\"model-loaded\", this.updatePlayerHead.bind(this));\r\n      this.updatePlayerHead();\r\n      this.updateMyCamera();\r\n    });\r\n  },\r\n\r\n  updatePlayerHead() {\r\n    const headEl = document.getElementById(\"avatar-head\");\r\n    this.playerHead = headEl && headEl.object3D;\r\n  },\r\n\r\n  register(el) {\r\n    this.cameraEls.push(el);\r\n    el.addEventListener(\"ownership-changed\", this.updateMyCamera);\r\n    this.updateMyCamera();\r\n  },\r\n\r\n  deregister(el) {\r\n    this.cameraEls = this.cameraEls.filter(c => c !== el);\r\n    el.removeEventListener(\"ownership-changed\", this.updateMyCamera);\r\n    this.updateMyCamera();\r\n  },\r\n\r\n  getMyCamera() {\r\n    return this.myCamera;\r\n  },\r\n\r\n  ifMyCameraRenderingViewfinder(f) {\r\n    if (!this.myCamera) return;\r\n\r\n    const myCameraTool = this.myCamera.components[\"camera-tool\"];\r\n\r\n    if (myCameraTool && myCameraTool.showCameraViewfinder && myCameraTool.camera) {\r\n      f(myCameraTool);\r\n    }\r\n  },\r\n\r\n  updateMyCamera() {\r\n    if (!this.cameraEls) {\r\n      this.myCamera = null;\r\n    } else {\r\n      this.myCamera = this.cameraEls.find(NAF.utils.isMine);\r\n    }\r\n  },\r\n\r\n  tick() {\r\n    this.ticks++;\r\n\r\n    // We update at most one camera viewfinder per frame.\r\n    if (this.ticks % CAMERA_UPDATE_FRAME_DELAY === 0) {\r\n      if (this.cameraEls.length == 0) return;\r\n\r\n      this.cameraUpdateCount++;\r\n      this.cameraEls[this.cameraUpdateCount % this.cameraEls.length].components[\"camera-tool\"].updateViewfinder();\r\n    }\r\n  }\r\n});\r\n","import { paths } from \"../paths\";\r\n\r\n// TODO: Where do these values (500, 10, 2) come from?\r\nconst modeMod = {\r\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\r\n  [WheelEvent.DOM_DELTA_LINE]: 10,\r\n  [WheelEvent.DOM_DELTA_PAGE]: 2\r\n};\r\n\r\nconst isInModal = (() => {\r\n  let uiRoot = null;\r\n\r\n  return function() {\r\n    if (!uiRoot) {\r\n      uiRoot = document.querySelector(\".ui-root\");\r\n    }\r\n\r\n    return uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\");\r\n  };\r\n})();\r\n\r\nexport class MouseDevice {\r\n  constructor() {\r\n    this.events = [];\r\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\r\n    this.movementXY = [0, 0]; // deltas\r\n    this.buttonLeft = false;\r\n    this.buttonRight = false;\r\n    this.buttonMiddle = false;\r\n    this.wheel = 0; // delta\r\n\r\n    const queueEvent = this.events.push.bind(this.events);\r\n    const canvas = document.querySelector(\"canvas\");\r\n    canvas.addEventListener(\"contextmenu\", e => {\r\n      if (e.button === 2) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        return false;\r\n      }\r\n    });\r\n    [\"mousedown\", \"wheel\"].map(x => canvas.addEventListener(x, queueEvent, { passive: false }));\r\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent, { passive: false }));\r\n\r\n    document.addEventListener(\r\n      \"wheel\",\r\n      e => {\r\n        // Do not capture wheel events if they are being sent to an modal/overlay\r\n        if (!isInModal() && !window.APP.preferenceScreenIsVisible) {\r\n          e.preventDefault();\r\n        }\r\n      },\r\n      { passive: false }\r\n    );\r\n  }\r\n\r\n  process(event) {\r\n    if (event.type === \"wheel\") {\r\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\r\n      return true;\r\n    }\r\n\r\n    const left = event.button === 0;\r\n    const middle = event.button === 1;\r\n    const right = event.button === 2;\r\n    this.coords[0] = (event.clientX / window.innerWidth) * 2 - 1;\r\n    this.coords[1] = -(event.clientY / window.innerHeight) * 2 + 1;\r\n    this.movementXY[0] += event.movementX;\r\n    this.movementXY[1] += event.movementY;\r\n    if (event.type === \"mousedown\" && left) {\r\n      this.mouseDownLeftThisFrame = true;\r\n      this.buttonLeft = true;\r\n    } else if (event.type === \"mousedown\" && right) {\r\n      this.mouseDownRightThisFrame = true;\r\n      this.buttonRight = true;\r\n    } else if (event.type === \"mousedown\" && middle) {\r\n      this.mouseDownMiddleThisFrame = true;\r\n      this.buttonMiddle = true;\r\n    } else if (event.type === \"mouseup\" && left) {\r\n      if (this.mouseDownLeftThisFrame) {\r\n        return false;\r\n      }\r\n      this.buttonLeft = false;\r\n    } else if (event.type === \"mouseup\" && right) {\r\n      if (this.mouseDownRightThisFrame) {\r\n        return false;\r\n      }\r\n      this.buttonRight = false;\r\n    } else if (event.type === \"mouseup\" && middle) {\r\n      if (this.mouseDownMiddleThisFrame) {\r\n        return false;\r\n      }\r\n      this.buttonMiddle = false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  write(frame) {\r\n    this.movementXY[0] = 0; // deltas\r\n    this.movementXY[1] = 0; // deltas\r\n    this.wheel = 0; // delta\r\n\r\n    this.didStopProcessingEarly = false;\r\n    this.mouseDownLeftThisFrame = false;\r\n    this.mouseDownRightThisFrame = false;\r\n    this.mouseDownMiddleThisFrame = false;\r\n\r\n    for (let i = 0; i < this.events.length; i++) {\r\n      const event = this.events[i];\r\n      if (!this.process(event)) {\r\n        this.didStopProcessingEarly = true;\r\n        this.events.splice(0, i);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!this.didStopProcessingEarly) {\r\n      this.events.length = 0;\r\n    }\r\n\r\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\r\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\r\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\r\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\r\n    frame.setValueType(paths.device.mouse.buttonMiddle, this.buttonMiddle);\r\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\r\n  }\r\n}\r\n\r\nwindow.oncontextmenu = e => {\r\n  if (!isInModal()) {\r\n    e.preventDefault();\r\n  }\r\n};\r\n","// You might prefer to use this over a Set because iterating over a set allocates memory\r\nexport function ArrayBackedSet(initialItems) {\r\n  return {\r\n    items: initialItems || [],\r\n    has(item) {\r\n      return this.items.indexOf(item) !== -1;\r\n    },\r\n    add(item) {\r\n      if (!this.has(item)) {\r\n        this.items.push(item);\r\n      }\r\n    },\r\n    delete(item) {\r\n      const index = this.items.indexOf(item);\r\n      if (index !== -1) {\r\n        this.items[index] = this.items[this.items.length - 1];\r\n        this.items.pop();\r\n      }\r\n    },\r\n    clear() {\r\n      this.items.length = 0;\r\n    }\r\n  };\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { ArrayBackedSet } from \"../array-backed-set\";\r\nexport class KeyboardDevice {\r\n  constructor() {\r\n    this.seenKeys = new ArrayBackedSet();\r\n    this.keys = {};\r\n    this.events = [];\r\n\r\n    [\"keydown\", \"keyup\"].map(x =>\r\n      document.addEventListener(x, e => {\r\n        if (!e.key) return;\r\n        this.events.push(e);\r\n\r\n        // Block browser hotkeys for chat command, media browser and freeze\r\n        if (\r\n          (e.type === \"keydown\" &&\r\n            e.key === \"/\" &&\r\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName) &&\r\n            !(document.activeElement && document.activeElement.contentEditable === \"true\")) ||\r\n          (e.ctrlKey &&\r\n            (e.key === \"1\" ||\r\n              e.key === \"2\" ||\r\n              e.key === \"3\" ||\r\n              e.key === \"4\" ||\r\n              e.key === \"5\" ||\r\n              e.key === \"6\" ||\r\n              e.key === \"7\" ||\r\n              e.key === \"8\" ||\r\n              e.key === \"9\" ||\r\n              e.key === \"0\")) ||\r\n          (e.key === \"Tab\" && !(window.APP && window.APP.preferenceScreenIsVisible))\r\n        ) {\r\n          e.preventDefault();\r\n          return false;\r\n        }\r\n      })\r\n    );\r\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\r\n  }\r\n\r\n  write(frame) {\r\n    for (let i = 0; i < this.events.length; i++) {\r\n      const event = this.events[i];\r\n      if (event.type === \"blur\") {\r\n        this.keys = {};\r\n        this.seenKeys.clear();\r\n      } else {\r\n        const key = event.key.toLowerCase();\r\n        this.keys[key] = event.type === \"keydown\";\r\n        this.seenKeys.add(key);\r\n      }\r\n    }\r\n\r\n    this.events.length = 0;\r\n\r\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\r\n      const key = this.seenKeys.items[i];\r\n      const path = paths.device.keyboard.key(key);\r\n      frame.setValueType(path, this.keys[key]);\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\n\r\nexport class HudDevice {\r\n  constructor() {\r\n    this.events = [];\r\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\r\n  }\r\n\r\n  write(frame) {\r\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\r\n    while (this.events.length) {\r\n      this.events.pop();\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\n\r\nexport class XboxControllerDevice {\r\n  constructor(gamepad) {\r\n    this.gamepad = gamepad;\r\n    this.buttonMap = [\r\n      { name: \"a\", buttonId: 0 },\r\n      { name: \"b\", buttonId: 1 },\r\n      { name: \"x\", buttonId: 2 },\r\n      { name: \"y\", buttonId: 3 },\r\n      { name: \"leftBumper\", buttonId: 4 },\r\n      { name: \"rightBumper\", buttonId: 5 },\r\n      { name: \"leftTrigger\", buttonId: 6 },\r\n      { name: \"rightTrigger\", buttonId: 7 },\r\n      { name: \"back\", buttonId: 8 },\r\n      { name: \"start\", buttonId: 9 },\r\n      { name: \"leftJoystick\", buttonId: 10 },\r\n      { name: \"rightJoystick\", buttonId: 11 },\r\n      { name: \"dpadUp\", buttonId: 12 },\r\n      { name: \"dpadDown\", buttonId: 13 },\r\n      { name: \"dpadLeft\", buttonId: 14 },\r\n      { name: \"dpadRight\", buttonId: 15 }\r\n    ];\r\n    this.axisMap = [\r\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\r\n      { name: \"leftJoystickVertical\", axisId: 1 },\r\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\r\n      { name: \"rightJoystickVertical\", axisId: 3 }\r\n    ];\r\n  }\r\n\r\n  write(frame) {\r\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\r\n    if (this.gamepad.connected) {\r\n      const xboxPaths = paths.device.xbox;\r\n      this.buttonMap.forEach(b => {\r\n        const path = xboxPaths.button(b.name);\r\n        const button = this.gamepad.buttons[b.buttonId];\r\n        frame.setValueType(path.pressed, !!button.pressed);\r\n        frame.setValueType(path.touched, !!button.touched);\r\n        frame.setValueType(path.value, button.value);\r\n      });\r\n      frame.setValueType(xboxPaths.axesSum, 0);\r\n      this.axisMap.forEach(axis => {\r\n        frame.setValueType(xboxPaths.axis(axis.name), this.gamepad.axes[axis.axisId]);\r\n        frame.setValueType(xboxPaths.axesSum, frame.get(xboxPaths.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\r\n      });\r\n\r\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\r\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\r\n      }\r\n    }\r\n  }\r\n}\r\n","const THREE = typeof window !== \"undefined\" && window.THREE;\r\nconst Vector3 = (THREE && THREE.Vector3) || function() {};\r\nconst Quaternion = (THREE && THREE.Quaternion) || function() {};\r\nconst forward = typeof window !== \"undefined\" && window.THREE && new THREE.Vector3(0, 0, -1);\r\nexport function Pose() {\r\n  return {\r\n    position: new Vector3(),\r\n    direction: new Vector3(),\r\n    orientation: new Quaternion(),\r\n    fromOriginAndDirection: function(origin, direction) {\r\n      this.position = origin;\r\n      this.direction = direction;\r\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\r\n      return this;\r\n    },\r\n    fromCameraProjection: function(camera, normalizedX, normalizedY) {\r\n      this.position.setFromMatrixPosition(camera.matrixWorld);\r\n      this.direction\r\n        .set(normalizedX, normalizedY, 0.5)\r\n        .unproject(camera)\r\n        .sub(this.position)\r\n        .normalize();\r\n      this.fromOriginAndDirection(this.position, this.direction);\r\n      return this;\r\n    },\r\n    copy: function(pose) {\r\n      this.position.copy(pose.position);\r\n      this.direction.copy(pose.direction);\r\n      this.orientation.copy(pose.orientation);\r\n    }\r\n  };\r\n}\r\n","// Vector from eyes to elbow (divided by user height).\r\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\r\n// Vector from eyes to elbow (divided by user height).\r\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\r\n\r\nexport const applyArmModel = (function() {\r\n  const controllerEuler = new THREE.Euler();\r\n  const deltaControllerPosition = new THREE.Vector3();\r\n  const controllerQuaternion = new THREE.Quaternion();\r\n  const controllerPosition = new THREE.Vector3();\r\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\r\n    headObject3D.updateMatrices();\r\n    controllerPosition.copy(headObject3D.position);\r\n    controllerPosition.y = controllerPosition.y - userHeight;\r\n    deltaControllerPosition.set(\r\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\r\n      EYES_TO_ELBOW.y,\r\n      EYES_TO_ELBOW.z\r\n    );\r\n    deltaControllerPosition.multiplyScalar(userHeight);\r\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\r\n    controllerPosition.add(deltaControllerPosition);\r\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\r\n    deltaControllerPosition.multiplyScalar(userHeight);\r\n    controllerQuaternion.fromArray(gamepadPose.orientation);\r\n    controllerEuler.setFromQuaternion(controllerQuaternion);\r\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\r\n    deltaControllerPosition.applyEuler(controllerEuler);\r\n    controllerPosition.add(deltaControllerPosition);\r\n    return controllerPosition;\r\n  };\r\n})();\r\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\r\n  navigator.getVRDisplays &&\r\n    navigator.getVRDisplays().then(displays => {\r\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\r\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\r\n      } else {\r\n        setTimeout(() => {\r\n          copySittingToStandingTransform(matrix);\r\n        }, 1000); // Try again when the display is ready\r\n      }\r\n    });\r\n};\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { applyArmModel } from \"../arm-model.js\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\nimport { waitForDOMContentLoaded } from \"../../../utils/async-utils\";\r\n\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\nconst m = new THREE.Matrix4();\r\n\r\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\r\nconst TRIGGER = paths.device.oculusgo.trigger;\r\n\r\nexport class OculusGoControllerDevice {\r\n  constructor(gamepad) {\r\n    this.gamepad = gamepad;\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n    this.pose = new Pose();\r\n    this.q = new THREE.Quaternion();\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n    this.matrix = new THREE.Matrix4();\r\n    this.orientation = new THREE.Quaternion();\r\n\r\n    // TODO ideally we should just be getting pose from the gamepad\r\n    // TODO if controller is set to left hand, we still use right hand query here\r\n    // because otherwise things break.\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\r\n      this.headObject3D = document.querySelector(\"#avatar-pov-node\").object3D;\r\n    });\r\n\r\n    navigator.getGamepads();\r\n  }\r\n\r\n  write(frame) {\r\n    if (!this.rayObject || !this.headObject3D) return;\r\n\r\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\r\n    navigator.getGamepads();\r\n    if (this.gamepad.connected) {\r\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\r\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\r\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\r\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\r\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\r\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\r\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\r\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\r\n\r\n      this.rayObject.updateMatrices();\r\n      this.rayObject.getWorldQuaternion(this.q);\r\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\r\n      const rayMatrixWorld = this.rayObject.matrixWorld;\r\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\r\n\r\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\r\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\r\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\r\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\r\n\r\n      if (this.gamepad.pose.orientation) {\r\n        // TODO if controller is set to left hand, we still draw right hand until\r\n        // bindings are overhauled to handle primary/secondary hands.\r\n        frame.setMatrix4(\r\n          paths.device.oculusgo.matrix,\r\n          this.matrix\r\n            .compose(\r\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\r\n              this.orientation.fromArray(this.gamepad.pose.orientation),\r\n              ONES\r\n            )\r\n            .premultiply(this.sittingToStandingMatrix)\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { applyArmModel } from \"../arm-model.js\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\n\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\n\r\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\r\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\r\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\r\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\r\n\r\nconst m = new THREE.Matrix4();\r\n\r\nexport class GearVRControllerDevice {\r\n  constructor(gamepad) {\r\n    this.gamepad = gamepad;\r\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\r\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\r\n\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n    this.selector = `#player-${gamepad.hand}-controller`;\r\n    this.pose = new Pose();\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n\r\n    this.matrix = new THREE.Matrix4();\r\n    this.orientation = new THREE.Quaternion();\r\n  }\r\n\r\n  write(frame) {\r\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\r\n    navigator.getGamepads();\r\n    if (this.gamepad.connected) {\r\n      const touchpad = this.gamepad.buttons[0];\r\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\r\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\r\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\r\n\r\n      const trigger = this.gamepad.buttons[1];\r\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\r\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\r\n      frame.setValueType(TRIGGER.value, !!trigger.value);\r\n\r\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\r\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\r\n\r\n      // TODO we should just be getting pose from the gamepad\r\n      if (!this.rayObject) {\r\n        this.rayObject = document.querySelector(this.selector).object3D;\r\n      }\r\n      this.rayObject.updateMatrixWorld();\r\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\r\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\r\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\r\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\r\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\r\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\r\n      if (this.gamepad.pose.orientation) {\r\n        frame.setMatrix4(\r\n          paths.device.gearVRController.matrix,\r\n          this.matrix\r\n            .compose(\r\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\r\n              this.orientation.fromArray(this.gamepad.pose.orientation),\r\n              ONES\r\n            )\r\n            .premultiply(this.sittingToStandingMatrix)\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\n\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\n\r\nexport const leftOculusTouchButtonMap = [\r\n  { name: \"thumbStick\", buttonId: 0 },\r\n  { name: \"trigger\", buttonId: 1 },\r\n  { name: \"grip\", buttonId: 2 },\r\n  { name: \"x\", buttonId: 3 },\r\n  { name: \"y\", buttonId: 4 }\r\n];\r\nexport const rightOculusTouchButtonMap = [\r\n  { name: \"thumbStick\", buttonId: 0 },\r\n  { name: \"trigger\", buttonId: 1 },\r\n  { name: \"grip\", buttonId: 2 },\r\n  { name: \"a\", buttonId: 3 },\r\n  { name: \"b\", buttonId: 4 }\r\n];\r\n\r\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\r\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\r\n\r\nconst m = new THREE.Matrix4();\r\n\r\nexport class OculusTouchControllerDevice {\r\n  constructor(gamepad) {\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n\r\n    // wake the gamepad api up. otherwise it does not report touch controllers.\r\n    // in chrome it still won't unless you enter vr.\r\n    navigator.getVRDisplays();\r\n\r\n    const buttonMaps = {\r\n      left: leftOculusTouchButtonMap,\r\n      right: rightOculusTouchButtonMap\r\n    };\r\n\r\n    const devicePaths = {\r\n      left: paths.device.leftOculusTouch,\r\n      right: paths.device.rightOculusTouch\r\n    };\r\n\r\n    this.gamepad = gamepad;\r\n    this.pose = new Pose();\r\n    this.buttonMap = buttonMaps[gamepad.hand];\r\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n    this.matrix = new THREE.Matrix4();\r\n    this.path = devicePaths[gamepad.hand];\r\n    this.selector = `#player-${gamepad.hand}-controller`;\r\n\r\n    this.position = new THREE.Vector3();\r\n    this.orientation = new THREE.Quaternion();\r\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\r\n  }\r\n\r\n  write(frame) {\r\n    if (!this.gamepad) return;\r\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\r\n    if (!this.gamepad || !this.gamepad.connected) return;\r\n\r\n    this.buttonMap.forEach(b => {\r\n      const path = this.path.button(b.name);\r\n      const button = this.gamepad.buttons[b.buttonId];\r\n      frame.setValueType(path.pressed, !!button.pressed);\r\n      frame.setValueType(path.touched, !!button.touched);\r\n      frame.setValueType(path.value, button.value);\r\n    });\r\n    frame.setValueType(this.path.axesSum, 0);\r\n    this.axisMap.forEach(axis => {\r\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\r\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\r\n    });\r\n\r\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\r\n    this.rayObject.updateMatrixWorld();\r\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\r\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\r\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\r\n    this.pose.orientation.copy(this.rayObjectRotation);\r\n\r\n    frame.setPose(this.path.pose, this.pose);\r\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\r\n      frame.setMatrix4(\r\n        this.path.matrix,\r\n        this.matrix\r\n          .compose(\r\n            this.position.fromArray(this.gamepad.pose.position),\r\n            this.orientation.fromArray(this.gamepad.pose.orientation),\r\n            ONES\r\n          )\r\n          .premultiply(this.sittingToStandingMatrix)\r\n          .multiply(this.handOffset)\r\n      );\r\n    }\r\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\r\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { applyArmModel } from \"../arm-model\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\n\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\r\nconst m = new THREE.Matrix4();\r\n\r\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\r\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\r\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\r\nconst POSE = paths.device.daydream.pose;\r\nconst MATRIX = paths.device.daydream.matrix;\r\n\r\nexport class DaydreamControllerDevice {\r\n  constructor(gamepad) {\r\n    this.gamepad = gamepad;\r\n\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\r\n    this.pose = new Pose();\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n    this.matrix = new THREE.Matrix4();\r\n    this.orientation = new THREE.Quaternion();\r\n  }\r\n\r\n  write(frame) {\r\n    this.gamepad = navigator.getGamepads()[0];\r\n    if (this.gamepad && this.gamepad.connected) {\r\n      const button = this.gamepad.buttons[0];\r\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\r\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\r\n      frame.setValueType(TOUCHPAD.value, !!button.value);\r\n\r\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\r\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\r\n\r\n      // TODO ideally we should just be getting pose from the gamepad\r\n      if (!this.rayObject) {\r\n        this.rayObject = document.querySelector(this.selector).object3D;\r\n      }\r\n      this.rayObject.updateMatrixWorld();\r\n      this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\r\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\r\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\r\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\r\n      frame.setPose(POSE, this.pose);\r\n\r\n      this.headObject3D = this.headObject3D || document.querySelector(\"#avatar-pov-node\").object3D;\r\n\r\n      if (this.gamepad.pose.orientation) {\r\n        frame.setMatrix4(\r\n          MATRIX,\r\n          this.matrix\r\n            .compose(\r\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\r\n              this.orientation.fromArray(this.gamepad.pose.orientation),\r\n              ONES\r\n            )\r\n            .premultiply(this.sittingToStandingMatrix)\r\n            .multiply(HAND_OFFSET)\r\n        );\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\n\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\nconst HAND_OFFSET = new THREE.Matrix4().compose(\r\n  new THREE.Vector3(0, 0, 0.13),\r\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\r\n  new THREE.Vector3(1, 1, 1)\r\n);\r\nconst RAY_ROTATION = new THREE.Quaternion();\r\nconst m = new THREE.Matrix4();\r\n\r\nexport class ViveControllerDevice {\r\n  constructor(gamepad) {\r\n    // wake the gamepad api up. otherwise it does not report touch controllers.\r\n    // in chrome it still won't unless you enter vr.\r\n    navigator.getVRDisplays();\r\n    this.gamepad = gamepad;\r\n\r\n    if (this.gamepad.id === \"OpenVR Cosmos\") {\r\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\r\n      this.buttonMap = [\r\n        { name: \"trigger\", buttonId: 0 },\r\n        { name: \"grip\", buttonId: 1 },\r\n        { name: \"primary\", buttonId: 2 },\r\n        { name: \"secondary\", buttonId: 3 },\r\n        { name: \"joystick\", buttonId: 4 },\r\n        { name: \"bumper\", buttonId: 5 }\r\n      ];\r\n      this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\r\n    } else if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\r\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), Math.PI / 15);\r\n      this.buttonMap = [\r\n        { name: \"touchpad\", buttonId: 0 },\r\n        { name: \"trigger\", buttonId: 1 },\r\n        { name: \"grip\", buttonId: 2 }\r\n      ];\r\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\r\n    } else if (this.gamepad.axes.length === 4) {\r\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\r\n      this.buttonMap = [\r\n        { name: \"touchpad\", buttonId: 0 },\r\n        { name: \"trigger\", buttonId: 1 },\r\n        { name: \"grip\", buttonId: 2 },\r\n        { name: \"primary\", buttonId: 3 },\r\n        { name: \"secondary\", buttonId: 4 },\r\n        { name: \"joystick\", buttonId: 5 },\r\n        { name: \"index\", buttonId: 6 },\r\n        { name: \"middle\", buttonId: 7 },\r\n        { name: \"ring\", buttonId: 8 },\r\n        { name: \"pinky\", buttonId: 9 }\r\n      ];\r\n      this.axisMap = [\r\n        { name: \"touchX\", axisId: 0 },\r\n        { name: \"touchY\", axisId: 1 },\r\n        { name: \"joyX\", axisId: 2 },\r\n        { name: \"joyY\", axisId: 3 }\r\n      ];\r\n    } else {\r\n      RAY_ROTATION.setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\r\n      this.buttonMap = [\r\n        { name: \"touchpad\", buttonId: 0 },\r\n        { name: \"trigger\", buttonId: 1 },\r\n        { name: \"grip\", buttonId: 2 },\r\n        { name: \"primary\", buttonId: 3 }\r\n      ];\r\n      this.axisMap = [{ name: \"touchX\", axisId: 0 }, { name: \"touchY\", axisId: 1 }];\r\n    }\r\n\r\n    this.pose = new Pose();\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n\r\n    this.matrix = new THREE.Matrix4();\r\n    this.position = new THREE.Vector3();\r\n    this.orientation = new THREE.Quaternion();\r\n  }\r\n\r\n  write(frame) {\r\n    const gamepads = navigator.getGamepads();\r\n    if (gamepads.length < this.gamepad.index + 1) {\r\n      //workaround for: https://bugzilla.mozilla.org/show_bug.cgi?id=1568076\r\n      return;\r\n    }\r\n    this.gamepad = gamepads[this.gamepad.index];\r\n    if (!this.gamepad.connected) return;\r\n\r\n    this.buttonMap.forEach(b => {\r\n      const path = this.path.button(b.name);\r\n      const button = this.gamepad.buttons[b.buttonId];\r\n      frame.setValueType(path.pressed, !!button.pressed);\r\n      frame.setValueType(path.touched, !!button.touched);\r\n      frame.setValueType(path.value, button.value);\r\n    });\r\n    frame.setValueType(this.path.axesSum, 0);\r\n    this.axisMap.forEach(axis => {\r\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\r\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\r\n    });\r\n\r\n    if (!this.selector) {\r\n      if (this.gamepad.hand) {\r\n        this.path = paths.device.vive[this.gamepad.hand];\r\n        this.selector = `#player-${this.gamepad.hand}-controller`;\r\n        console.warn(\"gamepad hand eventually specified\");\r\n      } else {\r\n        return;\r\n      }\r\n    }\r\n    const el = document.querySelector(this.selector);\r\n    const rayObject = el.object3D;\r\n    rayObject.updateMatrixWorld();\r\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(rayObject.matrixWorld));\r\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\r\n    this.pose.direction\r\n      .set(0, 0, -1)\r\n      .applyQuaternion(RAY_ROTATION)\r\n      .applyQuaternion(this.rayObjectRotation);\r\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\r\n    frame.setPose(this.path.pose, this.pose);\r\n\r\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\r\n      frame.setMatrix4(\r\n        this.path.matrix,\r\n        this.matrix\r\n          .compose(\r\n            this.position.fromArray(this.gamepad.pose.position),\r\n            this.orientation.fromArray(this.gamepad.pose.orientation),\r\n            ONES\r\n          )\r\n          .premultiply(this.sittingToStandingMatrix)\r\n          .multiply(HAND_OFFSET)\r\n      );\r\n    }\r\n\r\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\r\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\r\nconst ONES = new THREE.Vector3(1, 1, 1);\r\nconst HAND_OFFSET = new THREE.Matrix4().compose(\r\n  new THREE.Vector3(0, -0.017, 0.13),\r\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\r\n  new THREE.Vector3(1, 1, 1)\r\n);\r\nconst m = new THREE.Matrix4();\r\n\r\nexport class WindowsMixedRealityControllerDevice {\r\n  constructor(gamepad) {\r\n    this.rayObject = null;\r\n    this.rayObjectRotation = new THREE.Quaternion();\r\n\r\n    // wake the gamepad api up. otherwise it does not report touch controllers.\r\n    // in chrome it still won't unless you enter vr.\r\n    navigator.getVRDisplays();\r\n\r\n    this.gamepad = gamepad;\r\n    this.pose = new Pose();\r\n\r\n    if (gamepad.hand) {\r\n      this.selector = `#player-${gamepad.hand}-controller`;\r\n    }\r\n\r\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\r\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\r\n    this.matrix = new THREE.Matrix4();\r\n    this.position = new THREE.Vector3();\r\n    this.orientation = new THREE.Quaternion();\r\n  }\r\n  write(frame) {\r\n    if (!this.gamepad) return;\r\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\r\n    if (!this.gamepad || !this.gamepad.connected) return;\r\n\r\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\r\n\r\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\r\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\r\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\r\n\r\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\r\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\r\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\r\n\r\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\r\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\r\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\r\n\r\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\r\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\r\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\r\n\r\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\r\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\r\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\r\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\r\n\r\n    if (!this.selector) {\r\n      if (!this.gamepad.hand) return;\r\n      this.selector = `#player-${this.gamepad.hand}-controller`;\r\n    }\r\n\r\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\r\n    this.rayObject.updateMatrixWorld();\r\n    this.rayObjectRotation.setFromRotationMatrix(m.extractRotation(this.rayObject.matrixWorld));\r\n\r\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\r\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\r\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\r\n    frame.setPose(path.pose, this.pose);\r\n\r\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\r\n      frame.setMatrix4(\r\n        path.matrix,\r\n        this.matrix\r\n          .compose(\r\n            this.position.fromArray(this.gamepad.pose.position),\r\n            this.orientation.fromArray(this.gamepad.pose.orientation),\r\n            ONES\r\n          )\r\n          .premultiply(this.sittingToStandingMatrix)\r\n          .multiply(HAND_OFFSET)\r\n      );\r\n    }\r\n\r\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\r\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\r\n    }\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\n\r\nconst TWOPI = Math.PI * 2;\r\n\r\nclass CircularBuffer {\r\n  constructor(length) {\r\n    this.items = new Array(length).fill(0);\r\n    this.writePtr = 0;\r\n  }\r\n\r\n  push(item) {\r\n    this.items[this.writePtr] = item;\r\n    this.writePtr = (this.writePtr + 1) % this.items.length;\r\n  }\r\n}\r\n\r\nconst abs = Math.abs;\r\n// Input: two numbers between [-Math.PI, Math.PI]\r\n// Output: difference between them, where -Math.PI === Math.PI\r\nconst difference = (curr, prev) => {\r\n  const a = curr - prev;\r\n  const b = curr + TWOPI - prev;\r\n  const c = curr - (prev + TWOPI);\r\n  if (abs(a) < abs(b)) {\r\n    if (abs(a) < abs(c)) {\r\n      return a;\r\n    }\r\n  }\r\n  if (abs(b) < abs(c)) {\r\n    return b;\r\n  }\r\n\r\n  return c;\r\n};\r\n\r\nconst average = a => {\r\n  let sum = 0;\r\n  for (let i = 0; i < a.length; i++) {\r\n    const n = a[i];\r\n    sum += n;\r\n  }\r\n  return sum / a.length;\r\n};\r\n\r\nexport class GyroDevice {\r\n  constructor() {\r\n    this.hmdEuler = new THREE.Euler();\r\n    this.hmdQuaternion = new THREE.Quaternion();\r\n    this.prevX = this.hmdEuler.x;\r\n    this.prevY = this.hmdEuler.y;\r\n    this.dXBuffer = new CircularBuffer(6);\r\n    this.dYBuffer = new CircularBuffer(6);\r\n    this.hasPolyfill = window.webvrpolyfill;\r\n    if (this.hasPolyfill) {\r\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\r\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\r\n    }\r\n  }\r\n\r\n  write(frame) {\r\n    if (!this.hasPolyfill || !this.vrDisplay || !this.frameData) {\r\n      return;\r\n    }\r\n    const hmdEuler = this.hmdEuler;\r\n    this.vrDisplay.getFrameData(this.frameData);\r\n    if (this.frameData.pose.orientation !== null) {\r\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\r\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\r\n    }\r\n\r\n    // Don't use gyro values when device is lying flat\r\n    if (hmdEuler.x < -Math.PI * 0.475) return;\r\n\r\n    const dX = difference(hmdEuler.x, this.prevX);\r\n    const dY = difference(hmdEuler.y, this.prevY);\r\n\r\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\r\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\r\n\r\n    this.averageDeltaX = average(this.dXBuffer.items);\r\n    this.averageDeltaY = average(this.dYBuffer.items);\r\n\r\n    this.prevX = hmdEuler.x;\r\n    this.prevY = hmdEuler.y;\r\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\r\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\r\n  }\r\n}\r\n","/* global AFRAME NAF */\r\nimport { paths } from \"./userinput/paths\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { canMove } from \"../utils/permissions-utils\";\r\nimport { isTagged } from \"../components/tags\";\r\n\r\nfunction findHandCollisionTargetForHand(bodyHelper) {\r\n  const physicsSystem = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n\r\n  const handCollisions = physicsSystem.getCollisions(bodyHelper.uuid);\r\n  if (handCollisions) {\r\n    for (let i = 0; i < handCollisions.length; i++) {\r\n      const object3D = physicsSystem.bodyUuidToData.get(handCollisions[i]).object3D;\r\n      if (isTagged(object3D.el, \"isHandCollisionTarget\")) {\r\n        return object3D.el;\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nconst notRemoteHoverTargets = new Map();\r\nconst remoteHoverTargets = new Map();\r\nexport function findRemoteHoverTarget(object3D) {\r\n  if (!object3D) return null;\r\n  if (notRemoteHoverTargets.get(object3D)) return null;\r\n  const target = remoteHoverTargets.get(object3D);\r\n  return target || findRemoteHoverTarget(object3D.parent);\r\n}\r\nAFRAME.registerComponent(\"is-remote-hover-target\", {\r\n  init: function() {\r\n    remoteHoverTargets.set(this.el.object3D, this.el);\r\n  },\r\n  remove: function() {\r\n    remoteHoverTargets.delete(this.el.object3D);\r\n  }\r\n});\r\nAFRAME.registerComponent(\"is-not-remote-hover-target\", {\r\n  init: function() {\r\n    notRemoteHoverTargets.set(this.el.object3D, this.el);\r\n  },\r\n  remove: function() {\r\n    notRemoteHoverTargets.delete(this.el.object3D);\r\n  }\r\n});\r\n\r\nexport function isUI(el) {\r\n  return isTagged(el, \"singleActionButton\") || isTagged(el, \"holdableButton\");\r\n}\r\n\r\nAFRAME.registerSystem(\"interaction\", {\r\n  updateCursorIntersection: function(intersection, left) {\r\n    if (!left) {\r\n      this.rightRemoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\r\n      return this.rightRemoteHoverTarget;\r\n    }\r\n\r\n    this.leftRemoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\r\n    return this.leftRemoteHoverTarget;\r\n  },\r\n\r\n  isHeld(el) {\r\n    return (\r\n      this.state.leftHand.held === el ||\r\n      this.state.rightHand.held === el ||\r\n      this.state.rightRemote.held === el ||\r\n      this.state.leftRemote.held === el\r\n    );\r\n  },\r\n\r\n  release(el) {\r\n    if (this.state.leftHand.held === el) {\r\n      this.state.leftHand.held = null;\r\n    }\r\n    if (this.state.leftHand.hovered === el) {\r\n      this.state.leftHand.hovered = null;\r\n    }\r\n    if (this.state.leftHand.held === el) {\r\n      this.state.leftHand.held = null;\r\n    }\r\n    if (this.state.rightHand.hovered === el) {\r\n      this.state.rightHand.hovered = null;\r\n    }\r\n    if (this.state.rightRemote.held === el) {\r\n      this.state.rightRemote.held = null;\r\n    }\r\n    if (this.state.rightRemote.hovered === el) {\r\n      this.state.rightRemote.hovered = null;\r\n    }\r\n    if (this.state.leftRemote.held === el) {\r\n      this.state.leftRemote.held = null;\r\n    }\r\n    if (this.state.leftRemote.hovered === el) {\r\n      this.state.leftRemote.hovered = null;\r\n    }\r\n  },\r\n\r\n  getRightRemoteHoverTarget() {\r\n    return this.rightRemoteHoverTarget;\r\n  },\r\n\r\n  getLeftRemoteHoverTarget() {\r\n    return this.leftRemoteHoverTarget;\r\n  },\r\n\r\n  init: function() {\r\n    this.options = {\r\n      leftHand: {\r\n        entity: null,\r\n        grabPath: paths.actions.leftHand.grab,\r\n        dropPath: paths.actions.leftHand.drop,\r\n        hoverFn: findHandCollisionTargetForHand\r\n      },\r\n      rightHand: {\r\n        entity: null,\r\n        grabPath: paths.actions.rightHand.grab,\r\n        dropPath: paths.actions.rightHand.drop,\r\n        hoverFn: findHandCollisionTargetForHand\r\n      },\r\n      rightRemote: {\r\n        entity: null,\r\n        grabPath: paths.actions.cursor.right.grab,\r\n        dropPath: paths.actions.cursor.right.drop,\r\n        hoverFn: this.getRightRemoteHoverTarget\r\n      },\r\n      leftRemote: {\r\n        entity: null,\r\n        grabPath: paths.actions.cursor.left.grab,\r\n        dropPath: paths.actions.cursor.left.drop,\r\n        hoverFn: this.getLeftRemoteHoverTarget\r\n      }\r\n    };\r\n    this.state = {\r\n      leftHand: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      rightHand: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      rightRemote: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      leftRemote: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      }\r\n    };\r\n    this.previousState = {\r\n      leftHand: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      rightHand: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      rightRemote: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      },\r\n      leftRemote: {\r\n        hovered: null,\r\n        held: null,\r\n        spawning: null\r\n      }\r\n    };\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.options.leftHand.entity = document.getElementById(\"player-left-controller\");\r\n      this.options.rightHand.entity = document.getElementById(\"player-right-controller\");\r\n      this.options.rightRemote.entity = document.getElementById(\"right-cursor\");\r\n      this.options.leftRemote.entity = document.getElementById(\"left-cursor\");\r\n      this.ready = true;\r\n    });\r\n  },\r\n\r\n  tickInteractor(options, state) {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    if (state.held) {\r\n      const networked = state.held.components[\"networked\"];\r\n      const lostOwnership = networked && networked.data && networked.data.owner !== NAF.clientId;\r\n      if (userinput.get(options.dropPath) || lostOwnership) {\r\n        state.held = null;\r\n      }\r\n    } else {\r\n      state.hovered = options.hoverFn.call(\r\n        this,\r\n        options.entity.components[\"body-helper\"] && options.entity.components[\"body-helper\"]\r\n          ? options.entity.components[\"body-helper\"]\r\n          : null\r\n      );\r\n      if (state.hovered) {\r\n        const entity = state.hovered;\r\n        const isFrozen = this.el.is(\"frozen\");\r\n        const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\r\n        if (\r\n          isTagged(entity, \"isHoldable\") &&\r\n          userinput.get(options.grabPath) &&\r\n          (isFrozen || !isPinned) &&\r\n          canMove(entity)\r\n        ) {\r\n          state.held = entity;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  tick2() {\r\n    if (!this.el.is(\"entered\")) {\r\n      return;\r\n    }\r\n\r\n    Object.assign(this.previousState.rightHand, this.state.rightHand);\r\n    Object.assign(this.previousState.rightRemote, this.state.rightRemote);\r\n    Object.assign(this.previousState.leftHand, this.state.leftHand);\r\n    Object.assign(this.previousState.leftRemote, this.state.leftRemote);\r\n\r\n    if (this.options.leftHand.entity.object3D.visible && !this.state.leftRemote.held) {\r\n      this.tickInteractor(this.options.leftHand, this.state.leftHand);\r\n    }\r\n    if (this.options.rightHand.entity.object3D.visible && !this.state.rightRemote.held) {\r\n      this.tickInteractor(this.options.rightHand, this.state.rightHand);\r\n    }\r\n    if (!this.state.rightHand.held && !this.state.rightHand.hovered) {\r\n      this.tickInteractor(this.options.rightRemote, this.state.rightRemote);\r\n    }\r\n    if (!this.state.leftHand.held && !this.state.leftHand.hovered) {\r\n      this.tickInteractor(this.options.leftRemote, this.state.leftRemote);\r\n    }\r\n  }\r\n});\r\n","import { sets } from \"../sets\";\r\nimport { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { findRemoteHoverTarget } from \"../../interactions\";\r\nimport { canMove } from \"../../../utils/permissions-utils\";\r\n\r\nconst calculateCursorPose = function(camera, coords, origin, direction, cursorPose) {\r\n  origin.setFromMatrixPosition(camera.matrixWorld);\r\n  direction\r\n    .set(coords[0], coords[1], 0.5)\r\n    .unproject(camera)\r\n    .sub(origin)\r\n    .normalize();\r\n  cursorPose.fromOriginAndDirection(origin, direction);\r\n  return cursorPose;\r\n};\r\n\r\nexport class AppAwareMouseDevice {\r\n  constructor() {\r\n    this.prevButtonLeft = false;\r\n    this.clickedOnAnything = false;\r\n    this.cursorPose = new Pose();\r\n    this.prevCursorPose = new Pose();\r\n    this.origin = new THREE.Vector3();\r\n    this.prevOrigin = new THREE.Vector3();\r\n    this.direction = new THREE.Vector3();\r\n    this.prevDirection = new THREE.Vector3();\r\n  }\r\n\r\n  write(frame) {\r\n    this.prevCursorPose.copy(this.cursorPose);\r\n    this.prevOrigin.copy(this.origin);\r\n    this.prevDirection.copy(this.prevDirection);\r\n\r\n    if (!this.cursorController) {\r\n      const rightCursorController = document.getElementById(\"right-cursor-controller\");\r\n\r\n      if (rightCursorController && rightCursorController.components) {\r\n        this.cursorController = rightCursorController.components[\"cursor-controller\"];\r\n      }\r\n    }\r\n\r\n    if (!this.camera) {\r\n      const viewingCamera = document.getElementById(\"viewing-camera\");\r\n\r\n      if (viewingCamera && viewingCamera.components) {\r\n        this.camera = viewingCamera.components.camera.camera;\r\n      }\r\n    }\r\n\r\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\r\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\r\n    if (buttonLeft && !this.prevButtonLeft && this.cursorController) {\r\n      const rawIntersections = [];\r\n      this.cursorController.raycaster.intersectObjects(\r\n        AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\r\n        true,\r\n        rawIntersections\r\n      );\r\n      const intersection = rawIntersections.find(x => x.object.el);\r\n      const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\r\n      const userinput = AFRAME.scenes[0].systems.userinput;\r\n      const isInteractable =\r\n        intersection &&\r\n        intersection.object.el.matches(\r\n          \".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon\"\r\n        );\r\n      const isPinned =\r\n        remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\r\n      const isFrozen = AFRAME.scenes[0].is(\"frozen\");\r\n      const template =\r\n        remoteHoverTarget &&\r\n        remoteHoverTarget.components.networked &&\r\n        remoteHoverTarget.components.networked.data.template;\r\n      const isStaticControlledMedia = template && template === \"#static-controlled-media\";\r\n      const isStaticMedia = template && template === \"#static-media\";\r\n      this.clickedOnAnything =\r\n        (isInteractable &&\r\n          (isFrozen || !isPinned) &&\r\n          (remoteHoverTarget && canMove(remoteHoverTarget)) &&\r\n          !isStaticControlledMedia &&\r\n          !isStaticMedia) ||\r\n        userinput.activeSets.includes(sets.rightCursorHoldingPen) ||\r\n        userinput.activeSets.includes(sets.rightCursorHoldingInteractable) ||\r\n        userinput.activeSets.includes(sets.rightCursorHoldingCamera);\r\n    }\r\n    this.prevButtonLeft = buttonLeft;\r\n\r\n    if (!buttonLeft) {\r\n      this.clickedOnAnything = false;\r\n    }\r\n\r\n    if ((!this.clickedOnAnything && buttonLeft) || buttonRight) {\r\n      const movementXY = frame.get(paths.device.mouse.movementXY);\r\n      if (movementXY) {\r\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\r\n      }\r\n      frame.setValueType(paths.device.smartMouse.shouldMoveCamera, true);\r\n    }\r\n\r\n    if (this.camera) {\r\n      const coords = frame.get(paths.device.mouse.coords);\r\n      frame.setPose(\r\n        paths.device.smartMouse.cursorPose,\r\n        calculateCursorPose(this.camera, coords, this.origin, this.direction, this.cursorPose)\r\n      );\r\n    }\r\n  }\r\n}\r\n","export function touchIsAssigned(touch, assignments) {\r\n  return (\r\n    assignments.find(assignment => {\r\n      return assignment.touch.identifier === touch.identifier;\r\n    }) !== undefined\r\n  );\r\n}\r\n\r\nexport function jobIsAssigned(job, assignments) {\r\n  return (\r\n    assignments.find(assignment => {\r\n      return assignment.job === job;\r\n    }) !== undefined\r\n  );\r\n}\r\n\r\nexport function assign(touch, job, assignments) {\r\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\r\n    console.error(\"cannot reassign touches or jobs. unassign first\");\r\n    return undefined;\r\n  }\r\n  const assignment = { job, touch };\r\n  assignments.push(assignment);\r\n  return assignment;\r\n}\r\n\r\nexport function unassign(touch, job, assignments) {\r\n  function match(assignment) {\r\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\r\n  }\r\n  assignments.splice(assignments.findIndex(match), 1);\r\n}\r\n\r\nexport function findByJob(job, assignments) {\r\n  return assignments.find(assignment => {\r\n    return assignment.job === job;\r\n  });\r\n}\r\n\r\nexport function findByTouch(touch, assignments) {\r\n  return assignments.find(assignment => {\r\n    return assignment.touch.identifier === touch.identifier;\r\n  });\r\n}\r\n","import { paths } from \"../paths\";\r\nimport { Pose } from \"../pose\";\r\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\r\nimport { findRemoteHoverTarget } from \"../../interactions\";\r\nimport { canMove } from \"../../../utils/permissions-utils\";\r\n\r\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\r\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\r\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\r\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\r\n\r\nconst TAP_PATHS = [\r\n  paths.device.touchscreen.tap1,\r\n  paths.device.touchscreen.tap2,\r\n  paths.device.touchscreen.tap3,\r\n  paths.device.touchscreen.tap4,\r\n  paths.device.touchscreen.tap5\r\n];\r\n\r\nfunction distance(x1, y1, x2, y2) {\r\n  const dx = x1 - x2;\r\n  const dy = y1 - y2;\r\n  return Math.sqrt(dx * dx + dy * dy);\r\n}\r\n\r\nconst getPlayerCamera = (() => {\r\n  let playerCamera;\r\n\r\n  return function() {\r\n    if (!playerCamera) {\r\n      playerCamera = document.getElementById(\"viewing-camera\").components.camera.camera;\r\n    }\r\n\r\n    return playerCamera;\r\n  };\r\n})();\r\n\r\nfunction shouldMoveCursor(touch, raycaster) {\r\n  const isCursorGrabbing = !!AFRAME.scenes[0].systems.interaction.state.rightRemote.held;\r\n  if (isCursorGrabbing) {\r\n    return true;\r\n  }\r\n  const rawIntersections = [];\r\n  raycaster.setFromCamera(\r\n    {\r\n      x: (touch.clientX / window.innerWidth) * 2 - 1,\r\n      y: -(touch.clientY / window.innerHeight) * 2 + 1\r\n    },\r\n    getPlayerCamera()\r\n  );\r\n  raycaster.intersectObjects(\r\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\r\n    true,\r\n    rawIntersections\r\n  );\r\n  const intersection = rawIntersections.find(x => x.object.el);\r\n  const isInteractable =\r\n    intersection &&\r\n    intersection.object.el.matches(\r\n      \".interactable, .interactable *, .occupiable-waypoint-icon, .teleport-waypoint-icon\"\r\n    );\r\n  const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\r\n  const isPinned =\r\n    remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\r\n  const isFrozen = AFRAME.scenes[0].is(\"frozen\");\r\n\r\n  const template =\r\n    remoteHoverTarget && remoteHoverTarget.components.networked && remoteHoverTarget.components.networked.data.template;\r\n  const isStaticControlledMedia = template && template === \"#static-controlled-media\";\r\n  const isStaticMedia = template && template === \"#static-media\";\r\n  return (\r\n    isInteractable &&\r\n    (isFrozen || !isPinned) &&\r\n    !isStaticControlledMedia &&\r\n    !isStaticMedia &&\r\n    (remoteHoverTarget && canMove(remoteHoverTarget))\r\n  );\r\n}\r\n\r\nexport class AppAwareTouchscreenDevice {\r\n  constructor() {\r\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 100);\r\n    this.assignments = [];\r\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\r\n\r\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\r\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\r\n    this.tapIndexToWriteNextFrame = 0;\r\n\r\n    this.events = [];\r\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\r\n      document.querySelector(\"canvas\").addEventListener(x, this.events.push.bind(this.events))\r\n    );\r\n  }\r\n\r\n  end(touch) {\r\n    if (!touchIsAssigned(touch, this.assignments)) {\r\n      console.warn(\"touch does not have a job\", touch);\r\n    } else {\r\n      const assignment = findByTouch(touch, this.assignments);\r\n      switch (assignment.job) {\r\n        case MOVE_CURSOR_JOB:\r\n        case MOVE_CAMERA_JOB:\r\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\r\n          // to ensure we write at least two frames with the grab down (since the action set will change)\r\n          // and otherwise we'd not see the falling xform.\r\n          if (assignment.framesUntilGrab >= 0) {\r\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\r\n          } else {\r\n            unassign(assignment.touch, assignment.job, this.assignments);\r\n          }\r\n\r\n          break;\r\n        case FIRST_PINCHER_JOB:\r\n          unassign(assignment.touch, assignment.job, this.assignments);\r\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\r\n\r\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\r\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\r\n            unassign(second.touch, second.job, this.assignments);\r\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\r\n              // reassign secondPincher to firstPincher\r\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\r\n              first.clientX = second.clientX;\r\n              first.clientY = second.clientY;\r\n            } else {\r\n              // reassign secondPincher to moveCamera\r\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\r\n              cameraMover.clientX = second.clientX;\r\n              cameraMover.clientY = second.clientY;\r\n              cameraMover.delta = [0, 0];\r\n            }\r\n          }\r\n          break;\r\n        case SECOND_PINCHER_JOB:\r\n          unassign(assignment.touch, assignment.job, this.assignments);\r\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\r\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\r\n            //reassign firstPincher to moveCamera\r\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\r\n            unassign(first.touch, first.job, this.assignments);\r\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\r\n            cameraMover.clientX = first.clientX;\r\n            cameraMover.clientY = first.clientY;\r\n            cameraMover.delta = [0, 0];\r\n          }\r\n          break;\r\n      }\r\n    }\r\n\r\n    // Touches cleared, determine what to do with pending tap\r\n    if (this.assignments.length === 0) {\r\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\r\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\r\n      }\r\n\r\n      this.pendingTap = { maxTouchCount: 0 };\r\n    }\r\n  }\r\n\r\n  move(touch) {\r\n    if (!touchIsAssigned(touch, this.assignments)) {\r\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\r\n        console.warn(\"touch does not have job\", touch);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const assignment = findByTouch(touch, this.assignments);\r\n    switch (assignment.job) {\r\n      case MOVE_CURSOR_JOB:\r\n        assignment.cursorPose.fromCameraProjection(\r\n          getPlayerCamera(),\r\n          (touch.clientX / window.innerWidth) * 2 - 1,\r\n          -(touch.clientY / window.innerHeight) * 2 + 1\r\n        );\r\n        break;\r\n      case MOVE_CAMERA_JOB:\r\n        assignment.delta[0] += touch.clientX - assignment.clientX;\r\n        assignment.delta[1] += touch.clientY - assignment.clientY;\r\n        assignment.clientX = touch.clientX;\r\n        assignment.clientY = touch.clientY;\r\n        break;\r\n      case FIRST_PINCHER_JOB:\r\n      case SECOND_PINCHER_JOB:\r\n        assignment.clientX = touch.clientX;\r\n        assignment.clientY = touch.clientY;\r\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\r\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\r\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\r\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\r\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\r\n          this.pinch.currentDistance = currentDistance;\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  start(touch) {\r\n    if (touchIsAssigned(touch, this.assignments)) {\r\n      console.error(\"touch already has a job\");\r\n      return;\r\n    }\r\n\r\n    const isFirstTouch = this.assignments.length === 0;\r\n    const isSecondTouch = this.assignments.length === 1;\r\n    const isThirdTouch = this.assignments.length === 2;\r\n\r\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\r\n\r\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\r\n      let assignment;\r\n\r\n      // First touch or third touch and other two fingers were pinching\r\n      if (shouldMoveCursor(touch, this.raycaster)) {\r\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\r\n\r\n        // Grabbing objects is delayed by several frames:\r\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\r\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\r\n        assignment.framesUntilGrab = 2;\r\n      } else {\r\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\r\n        assignment.delta = [0, 0];\r\n      }\r\n\r\n      assignment.clientX = touch.clientX;\r\n      assignment.clientY = touch.clientY;\r\n\r\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\r\n      // the touch will then track the cursor (instead of the camera)\r\n      assignment.cursorPose = new Pose().fromCameraProjection(\r\n        getPlayerCamera(),\r\n        (touch.clientX / window.innerWidth) * 2 - 1,\r\n        -(touch.clientY / window.innerHeight) * 2 + 1\r\n      );\r\n    } else if (isSecondTouch || isThirdTouch) {\r\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\r\n\r\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\r\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\r\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\r\n        first.clientX = touch.clientX;\r\n        first.clientY = touch.clientY;\r\n      } else {\r\n        // Second or third touch, but third touch only if not pinching\r\n        if (isSecondTouch) {\r\n          // The second touch is happening before the grab activated, so re-assign the first\r\n          // to the first pinch, and effectively cancel the grab.\r\n          const previousAssignment = this.assignments[0];\r\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\r\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\r\n          first.clientX = previousAssignment.clientX;\r\n          first.clientY = previousAssignment.clientY;\r\n        }\r\n\r\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\r\n\r\n        if (!first) {\r\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\r\n          first.clientX = touch.clientX;\r\n          first.clientY = touch.clientY;\r\n          return;\r\n        } else {\r\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\r\n          second.clientX = touch.clientX;\r\n          second.clientY = touch.clientY;\r\n\r\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\r\n\r\n          this.pinch = {\r\n            initialDistance,\r\n            currentDistance: initialDistance,\r\n            delta: 0\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\r\n      this.pendingTap.startedAt = performance.now();\r\n    }\r\n\r\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\r\n  }\r\n\r\n  process(event) {\r\n    switch (event.type) {\r\n      case \"touchstart\":\r\n        for (const touch of event.changedTouches) {\r\n          this.start(touch);\r\n        }\r\n        break;\r\n      case \"touchmove\":\r\n        for (const touch of event.touches) {\r\n          this.move(touch);\r\n        }\r\n        break;\r\n      case \"touchend\":\r\n      case \"touchcancel\":\r\n        for (const touch of event.changedTouches) {\r\n          this.end(touch);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  write(frame) {\r\n    if (this.pinch) {\r\n      this.pinch.delta = 0;\r\n    }\r\n    const cameraMover =\r\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\r\n    if (cameraMover) {\r\n      cameraMover.delta[0] = 0;\r\n      cameraMover.delta[1] = 0;\r\n    }\r\n\r\n    this.events.forEach(event => {\r\n      this.process(event);\r\n    });\r\n    while (this.events.length) {\r\n      this.events.pop();\r\n    }\r\n\r\n    const path = paths.device.touchscreen;\r\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\r\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\r\n\r\n    if (hasCursorJob || hasCameraJob) {\r\n      frame.setValueType(path.isTouching, true);\r\n\r\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\r\n      frame.setPose(path.cursorPose, assignment.cursorPose);\r\n    }\r\n\r\n    frame.setValueType(path.isTouchingGrabbable, false);\r\n\r\n    if (hasCursorJob) {\r\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\r\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\r\n      assignment.framesUntilGrab--;\r\n\r\n      if (assignment.framesUntilUnassign >= 0) {\r\n        if (assignment.framesUntilUnassign === 0) {\r\n          unassign(assignment.touch, assignment.job, this.assignments);\r\n        }\r\n\r\n        assignment.framesUntilUnassign--;\r\n      }\r\n    }\r\n\r\n    if (hasCameraJob) {\r\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\r\n      frame.setVector2(path.touchCameraDelta, delta[0] / window.innerWidth, delta[1] / window.innerHeight);\r\n    }\r\n\r\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\r\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\r\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\r\n\r\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\r\n      // write to tap-X path if we had an X-fingered tap\r\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\r\n    }\r\n\r\n    this.tapIndexToWriteNextFrame = 0;\r\n\r\n    frame.setValueType(path.anything, this.assignments.length !== 0);\r\n  }\r\n}\r\n","import { Pose } from \"../pose\";\r\nimport { angleTo4Direction } from \"../../../utils/dpad\";\r\n\r\nexport const xforms = {\r\n  noop: function() {},\r\n  copy: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, frame.get(src.value));\r\n  },\r\n  scale: function(scalar) {\r\n    return function scale(frame, src, dest) {\r\n      if (frame.get(src.value) !== undefined) {\r\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\r\n      }\r\n    };\r\n  },\r\n  scaleExp: function(scalar, exp = 1) {\r\n    return function scale(frame, src, dest) {\r\n      if (frame.get(src.value) !== undefined) {\r\n        if (exp === 1) {\r\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\r\n        } else {\r\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\r\n        }\r\n      }\r\n    };\r\n  },\r\n  deadzone: function(deadzoneSize) {\r\n    return function deadzone(frame, src, dest) {\r\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\r\n    };\r\n  },\r\n  split_vec2: function(frame, src, dest) {\r\n    const value = frame.get(src.value);\r\n    if (value !== undefined) {\r\n      frame.setValueType(dest.x, value[0]);\r\n      frame.setValueType(dest.y, value[1]);\r\n    }\r\n  },\r\n  compose_vec2: function(frame, src, dest) {\r\n    const x = frame.get(src.x);\r\n    const y = frame.get(src.y);\r\n    if (x !== undefined && y !== undefined) {\r\n      frame.setVector2(dest.value, x, y);\r\n    }\r\n  },\r\n  negate: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, -frame.get(src.value));\r\n  },\r\n  copyIfFalse: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\r\n  },\r\n  copyIfTrue: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\r\n  },\r\n  copyVec2IfTrue: function(frame, src, dest) {\r\n    if (frame.get(src.bool)) {\r\n      const v2 = frame.get(src.value);\r\n      frame.setVector2(dest.value, v2[0], v2[1]);\r\n    }\r\n  },\r\n  zeroIfDefined: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\r\n  },\r\n  true: function(frame, src, dest) {\r\n    frame.setValueType(dest.value, true);\r\n  },\r\n  rising: function rising(frame, src, dest, prevState) {\r\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\r\n    return !!frame.get(src.value);\r\n  },\r\n  risingWithFrameDelay: function(n) {\r\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\r\n      frame.setValueType(dest.value, state.values.shift());\r\n      state.values.push(frame.get(src.value) && !state.prev);\r\n      state.prev = frame.get(src.value);\r\n      return state;\r\n    };\r\n  },\r\n  falling: function falling(frame, src, dest, prevState) {\r\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\r\n    return !!frame.get(src.value);\r\n  },\r\n  vec2Zero: function(frame, _, dest) {\r\n    frame.setVector2(dest.value, 0, 0);\r\n  },\r\n  poseFromCameraProjection: function() {\r\n    let camera;\r\n    const pose = new Pose();\r\n    return function poseFromCameraProjection(frame, src, dest) {\r\n      if (!camera) {\r\n        camera = document.getElementById(\"viewing-camera\").components.camera.camera;\r\n      }\r\n      const value = frame.get(src.value);\r\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\r\n    };\r\n  },\r\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\r\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\r\n\r\n    return function vec2dpad(frame, src, dest) {\r\n      if (!frame.get(src.value)) return;\r\n      const [x, y] = frame.get(src.value);\r\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\r\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\r\n      if (!dest[direction]) return;\r\n      frame.setValueType(dest[direction], true);\r\n    };\r\n  },\r\n  always: function(constValue) {\r\n    return function always(frame, _, dest) {\r\n      frame.setValueType(dest.value, constValue);\r\n    };\r\n  },\r\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\r\n    let x = 0;\r\n    let y = 0;\r\n    if (frame.get(a)) x -= 1;\r\n    if (frame.get(d)) x += 1;\r\n    if (frame.get(w)) y += 1;\r\n    if (frame.get(s)) y -= 1;\r\n    frame.setVector2(vec2, x, y);\r\n  },\r\n  add_vec2: function(frame, src, dest) {\r\n    const first = frame.get(src.first);\r\n    const second = frame.get(src.second);\r\n    if (first && second) {\r\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\r\n    } else if (second) {\r\n      frame.setVector2(dest.value, second[0], second[1]);\r\n    } else if (first) {\r\n      frame.setVector2(dest.value, first[0], first[1]);\r\n    }\r\n  },\r\n  max_vec2: function(frame, src, dest) {\r\n    const first = frame.get(src.first);\r\n    const second = frame.get(src.second);\r\n    if (first && second) {\r\n      const max =\r\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\r\n      frame.setVector2(dest.value, max[0], max[1]);\r\n    } else if (second) {\r\n      frame.setVector2(dest.value, second[0], second[1]);\r\n    } else if (first) {\r\n      frame.setVector2(dest.value, first[0], first[1]);\r\n    }\r\n  },\r\n  normalize_vec2: function(frame, src, dest) {\r\n    const vec2 = frame.get(src.value);\r\n    if (vec2) {\r\n      if (vec2[0] === 0 && vec2[0] === 0) {\r\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\r\n      } else {\r\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\r\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\r\n      }\r\n    }\r\n  },\r\n  all: function(frame, src, dest) {\r\n    for (let i = 0, l = src.length; i < l; i++) {\r\n      const path = src[i];\r\n      if (!frame.get(path)) {\r\n        frame.setValueType(dest.value, false);\r\n        return;\r\n      }\r\n    }\r\n    frame.setValueType(dest.value, true);\r\n  },\r\n  any: function(frame, src, dest) {\r\n    for (let i = 0, l = src.length; i < l; i++) {\r\n      const path = src[i];\r\n      if (frame.get(path)) {\r\n        frame.setValueType(dest.value, true);\r\n        return;\r\n      }\r\n    }\r\n    frame.setValueType(dest.value, false);\r\n  },\r\n  touch_axis_scroll(scale = 1, snap_to) {\r\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\r\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\r\n        frame.setValueType(\r\n          dest.value,\r\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\r\n        );\r\n      }\r\n\r\n      state.value = frame.get(src.value);\r\n      state.touching = frame.get(src.touching);\r\n\r\n      return state;\r\n    };\r\n  },\r\n  diff_vec2: function diff_vec2(frame, src, dest, state = [0, 0]) {\r\n    const v2 = frame.get(src.value);\r\n    if (v2) {\r\n      frame.setVector2(dest.value, v2[0] - state[0], v2[1] - state[1]);\r\n      state[0] = v2[0];\r\n      state[1] = v2[1];\r\n    }\r\n    return state;\r\n  }\r\n};\r\n","export function angleTo4Direction(angle) {\r\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\r\n  if (angle > 0 && angle < 90) {\r\n    return \"north\";\r\n  } else if (angle >= 90 && angle < 180) {\r\n    return \"west\";\r\n  } else if (angle >= 180 && angle < 270) {\r\n    return \"south\";\r\n  } else {\r\n    return \"east\";\r\n  }\r\n}\r\n\r\nexport function angleTo8Direction(angle) {\r\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\r\n  let direction = \"\";\r\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\r\n    direction += \"north\";\r\n  }\r\n  if (angle >= 150 && angle < 300) {\r\n    direction += \"south\";\r\n  }\r\n  if (angle >= 60 && angle < 210) {\r\n    direction += \"west\";\r\n  }\r\n  if ((angle >= 240 && angle < 360) || angle < 30) {\r\n    direction += \"east\";\r\n  }\r\n  return direction;\r\n}\r\n","export const addSetsToBindings = mapping => {\r\n  for (const setName in mapping) {\r\n    for (const binding of mapping[setName]) {\r\n      if (!binding.sets) {\r\n        binding.sets = [];\r\n      }\r\n      binding.sets.push(setName);\r\n    }\r\n  }\r\n  return mapping;\r\n};\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\n// import { Pose } from \"../pose\";\r\n\r\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\r\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\r\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\r\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\r\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\r\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\r\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\r\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\r\nconst startInspectingViaMouse = \"/vars/mouse-and-keyboard/startInspectingViaMouse\";\r\nconst startInspectingViaKeyboard = \"/vars/mouse-and-keyboard/startInspectingViaKeyboard\";\r\nconst stopInspectingViaMouse = \"/vars/mouse-and-keyboard/stopInspectingViaMouse\";\r\nconst stopInspectingViaKeyboardEscape = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboardEscape\";\r\nconst stopInspectingViaKeyboardFocusRelease = \"/vars/mouse-and-keyboard/stopInspectingViaKeyboardFocusRelease\";\r\n\r\nconst qs = new URLSearchParams(location.search);\r\nconst inspectZoomSpeed = parseFloat(qs.get(\"izs\")) || -10.0;\r\n\r\nconst k = name => {\r\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\r\n};\r\n\r\nexport const keyboardMouseUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {},\r\n      dest: { value: paths.actions.cursor.right.hideLine },\r\n      xform: xforms.always(true)\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: paths.actions.cursor.right.wake },\r\n      xform: xforms.always(true)\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: paths.actions.cursor.left.wake },\r\n      xform: xforms.always(false)\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"arrowup\"),\r\n        a: paths.device.keyboard.key(\"arrowleft\"),\r\n        s: paths.device.keyboard.key(\"arrowdown\"),\r\n        d: paths.device.keyboard.key(\"arrowright\")\r\n      },\r\n      dest: { vec2: arrows_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"w\"),\r\n        a: paths.device.keyboard.key(\"a\"),\r\n        s: paths.device.keyboard.key(\"s\"),\r\n        d: paths.device.keyboard.key(\"d\")\r\n      },\r\n      dest: { vec2: wasd_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: wasd_vec2,\r\n        second: arrows_vec2\r\n      },\r\n      dest: { value: keyboardCharacterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: { value: keyboardCharacterAcceleration },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.normalize_vec2\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.wheel },\r\n      dest: { value: paths.actions.dCharSpeed },\r\n      xform: xforms.scale(-0.3)\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"shift\") },\r\n      dest: { value: paths.actions.boost },\r\n      xform: xforms.copy,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: paths.actions.camera.exitMirror },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"q\") },\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"g\") },\r\n      dest: { value: paths.actions.toggleFly },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"`\") },\r\n      dest: { value: paths.actions.toggleUI },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"e\") },\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Tab\") },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: paths.actions.ensureFrozen },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: paths.actions.thaw },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"p\") },\r\n      dest: { value: togglePenWithP },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.hud.penButton },\r\n      dest: { value: togglePenWithHud },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [togglePenWithHud, togglePenWithP],\r\n      dest: { value: togglePen },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.spawnPen },\r\n      xform: xforms.rising,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"c\") },\r\n      dest: { value: paths.actions.toggleCamera },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"x\") },\r\n      dest: { value: paths.actions.takeSnapshot },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.smartMouse.cursorPose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.coords },\r\n      dest: { value: \"/var/mouseCoordsDelta\" },\r\n      xform: xforms.diff_vec2\r\n    },\r\n    {\r\n      src: { value: \"/var/mouseCoordsDelta\" },\r\n      dest: { x: \"/var/mouseCoordsX\", y: \"/var/mouseCoordsY\" },\r\n      xform: xforms.split_vec2\r\n    },\r\n    {\r\n      src: { value: \"/var/mouseCoordsX\" },\r\n      dest: { value: \"/var/mouseCoordsXScaled\" },\r\n      xform: xforms.scale(-Math.PI)\r\n    },\r\n    {\r\n      src: { value: \"/var/mouseCoordsY\" },\r\n      dest: { value: \"/var/mouseCoordsYScaled\" },\r\n      xform: xforms.scale((2 * Math.PI) / 3)\r\n    },\r\n    {\r\n      src: { x: \"/var/mouseCoordsXScaled\", y: \"/var/mouseCoordsYScaled\" },\r\n      dest: { value: \"/var/actions/cameraDelta\" },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: \"/var/actions/cameraDelta\",\r\n        bool: paths.device.smartMouse.shouldMoveCamera\r\n      },\r\n      dest: { value: paths.actions.cameraDelta },\r\n      xform: xforms.copyVec2IfTrue\r\n    },\r\n    {\r\n      src: { value: paths.actions.cameraDelta },\r\n      dest: { value: paths.actions.lobbyCameraDelta },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"m\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.muteMic\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"t\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChat\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"/\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChatCommand\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: paths.actions.mediaExit },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"1\")\r\n      },\r\n      dest: { value: \"/var/shift+1\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+1\" },\r\n      dest: { value: paths.actions.mediaSearch1 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"2\")\r\n      },\r\n      dest: { value: \"/var/shift+2\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+2\" },\r\n      dest: { value: paths.actions.mediaSearch2 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"3\")\r\n      },\r\n      dest: { value: \"/var/shift+3\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+3\" },\r\n      dest: { value: paths.actions.mediaSearch3 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"4\")\r\n      },\r\n      dest: { value: \"/var/shift+4\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+4\" },\r\n      dest: { value: paths.actions.mediaSearch4 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"5\")\r\n      },\r\n      dest: { value: \"/var/shift+5\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+5\" },\r\n      dest: { value: paths.actions.mediaSearch5 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"6\")\r\n      },\r\n      dest: { value: \"/var/shift+6\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+6\" },\r\n      dest: { value: paths.actions.mediaSearch6 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"7\")\r\n      },\r\n      dest: { value: \"/var/shift+7\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+7\" },\r\n      dest: { value: paths.actions.mediaSearch7 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"8\")\r\n      },\r\n      dest: { value: \"/var/shift+8\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+8\" },\r\n      dest: { value: paths.actions.mediaSearch8 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"l\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logDebugFrame\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"k\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logInteractionState\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.mouse.buttonRight\r\n      },\r\n      dest: {\r\n        value: paths.actions.startGazeTeleport\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.mouse.buttonRight\r\n      },\r\n      dest: {\r\n        value: paths.actions.stopGazeTeleport\r\n      },\r\n      xform: xforms.falling,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"o\") },\r\n      dest: { value: paths.actions.nextCameraMode },\r\n      xform: xforms.rising\r\n    }\r\n\r\n    // Helpful bindings for debugging hands in 2D\r\n    // {\r\n    //   src: {},\r\n    //   dest: { value: paths.actions.rightHand.matrix },\r\n    //   xform: xforms.always(\r\n    //     new THREE.Matrix4().compose(\r\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\r\n    //       new THREE.Quaternion(0, 0, 0, 0),\r\n    //       new THREE.Vector3(1, 1, 1)\r\n    //     )\r\n    //   )\r\n    // },\r\n    // {\r\n    //   src: {},\r\n    //   dest: { value: paths.actions.leftHand.matrix },\r\n    //   xform: xforms.always(\r\n    //     new THREE.Matrix4().compose(\r\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\r\n    //       new THREE.Quaternion(0, 0, 0, 0),\r\n    //       new THREE.Vector3(1, 1, 1)\r\n    //     )\r\n    //   )\r\n    // }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.keyboard.key(\"q\")\r\n      },\r\n      dest: { value: \"/var/shift+q\" },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+q\" },\r\n      dest: { value: paths.actions.cursor.right.penPrevColor },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.keyboard.key(\"e\")\r\n      },\r\n      dest: { value: \"/var/shift+e\" },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+e\" },\r\n      dest: { value: paths.actions.cursor.right.penNextColor },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.keyboard.key(\"q\")\r\n      },\r\n      dest: { value: \"/var/notshift+q\" },\r\n      xform: xforms.copyIfFalse,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: \"/var/notshift+q\" },\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.keyboard.key(\"e\")\r\n      },\r\n      dest: { value: \"/var/notshift+e\" },\r\n      xform: xforms.copyIfFalse,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: \"/var/notshift+e\" },\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        value: k(\"wheelWithShift\")\r\n      },\r\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\r\n      xform: xforms.copy,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: \"/var/cursorScalePenTipWheel\" },\r\n      dest: { value: paths.actions.cursor.right.scalePenTip },\r\n      xform: xforms.scale(0.03)\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonRight },\r\n      dest: { value: togglePenWithRMB },\r\n      xform: xforms.falling,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: togglePenWithEsc },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\r\n      dest: { value: togglePen },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"z\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.undoDrawing },\r\n      priority: 1001,\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.pen.remove },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingCamera]: [\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.falling,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: k(\"wheelWithShift\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\r\n      xform: xforms.noop,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.mouse.wheel\r\n      },\r\n      dest: {\r\n        value: k(\"wheelWithShift\")\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"shift\"),\r\n        value: paths.device.mouse.wheel\r\n      },\r\n      dest: {\r\n        value: k(\"wheelWithoutShift\")\r\n      },\r\n      xform: xforms.copyIfFalse,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        value: k(\"wheelWithoutShift\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: k(\"wheelWithShift\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.scaleGrabbedGrabbable },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.falling,\r\n      priority: 2\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingUI]: [\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"shift\") },\r\n      dest: { value: paths.actions.transformModifier },\r\n      xform: xforms.copy,\r\n      priority: 1\r\n    }\r\n  ],\r\n  [sets.rightCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonRight },\r\n      dest: { value: startInspectingViaMouse },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"f\") },\r\n      dest: { value: startInspectingViaKeyboard },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: [startInspectingViaMouse, startInspectingViaKeyboard],\r\n      dest: { value: paths.actions.startInspecting },\r\n      xform: xforms.any,\r\n      priority: 201\r\n    }\r\n  ],\r\n  [sets.rightCursorHoveringOnVideo]: [\r\n    {\r\n      src: { value: paths.device.mouse.wheel },\r\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n      xform: xforms.scale(-0.3),\r\n      priority: 1\r\n    }\r\n  ],\r\n  [sets.inputFocused]: [\r\n    {\r\n      src: { value: \"/device/keyboard\" },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.noop,\r\n      priority: 1000\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: paths.device.mouse.buttonLeft },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n  [sets.inspecting]: [\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"space\") },\r\n      dest: { value: k(\"space-rising\") },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [\r\n        paths.device.keyboard.key(\"w\"),\r\n        paths.device.keyboard.key(\"a\"),\r\n        paths.device.keyboard.key(\"s\"),\r\n        paths.device.keyboard.key(\"d\"),\r\n        paths.device.keyboard.key(\"q\"),\r\n        paths.device.keyboard.key(\"e\"),\r\n        k(\"space-rising\")\r\n      ],\r\n      dest: { value: stopInspectingViaKeyboardEscape },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.wheel },\r\n      dest: { value: paths.actions.inspectZoom },\r\n      xform: xforms.scale(inspectZoomSpeed),\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.movementXY },\r\n      dest: { x: \"/var/movementX\", y: \"/var/movementY\" },\r\n      xform: xforms.split_vec2\r\n    },\r\n    {\r\n      src: { bool: paths.device.mouse.buttonMiddle, value: \"/var/movementY\" },\r\n      dest: { value: \"/var/middle-mouse-move-y\" },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/middle-mouse-move-y\" },\r\n      dest: { value: paths.actions.inspectPanY },\r\n      xform: xforms.scale(0.001)\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"f\") },\r\n      dest: { value: stopInspectingViaKeyboardFocusRelease },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.mouse.buttonRight },\r\n      dest: { value: stopInspectingViaMouse },\r\n      xform: xforms.falling,\r\n      priority: 101\r\n    },\r\n    {\r\n      src: [stopInspectingViaMouse, stopInspectingViaKeyboardEscape, stopInspectingViaKeyboardFocusRelease],\r\n      dest: { value: paths.actions.stopInspecting },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n  [sets.debugUserInput]: [\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"m\") },\r\n      dest: { value: paths.actions.debugUserInput.describeCurrentMasks },\r\n      xform: xforms.rising,\r\n      priority: 10\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nconst zero = \"/vars/touchscreen/zero\";\r\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\r\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\r\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\r\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\r\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\r\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\r\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\r\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\r\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\r\nconst togglePen = \"/vars/touchscreen/togglePen\";\r\n\r\nexport const touchscreenUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {},\r\n      dest: { value: paths.actions.cursor.right.hideLine },\r\n      xform: xforms.always(true)\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.pinch.delta },\r\n      dest: { value: forward },\r\n      xform: xforms.scale(0.25)\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.tap2 },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: zero },\r\n      xform: xforms.always(0)\r\n    },\r\n    {\r\n      src: { x: zero, y: forward },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.cursorPose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.touchCameraDelta },\r\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\r\n      xform: xforms.split_vec2\r\n    },\r\n    {\r\n      src: { value: touchCamDeltaX },\r\n      dest: { value: touchCamDeltaXScaled },\r\n      xform: xforms.scale(Math.PI)\r\n    },\r\n    {\r\n      src: { value: touchCamDeltaY },\r\n      dest: { value: touchCamDeltaYScaled },\r\n      xform: xforms.scale(Math.PI / 2)\r\n    },\r\n    {\r\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\r\n      dest: { value: touchCamDelta },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: { value: paths.device.gyro.averageDeltaX },\r\n      dest: { value: gyroCamDeltaXScaled },\r\n      xform: xforms.scale(1.0)\r\n    },\r\n    {\r\n      src: { value: paths.device.gyro.averageDeltaY },\r\n      dest: { value: gyroCamDeltaYScaled },\r\n      xform: xforms.scale(1.0)\r\n    },\r\n    {\r\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\r\n      dest: { value: gyroCamDelta },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: touchCamDelta,\r\n        second: gyroCamDelta\r\n      },\r\n      dest: { value: paths.actions.cameraDelta },\r\n      xform: xforms.add_vec2\r\n    },\r\n    {\r\n      src: { value: touchCamDelta },\r\n      dest: { value: paths.actions.lobbyCameraDelta },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.hud.penButton },\r\n      dest: { value: togglePen },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.spawnPen },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnPen]: [],\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.risingWithFrameDelay(5),\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: togglePen },\r\n      dest: { value: paths.actions.pen.remove },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    }\r\n  ],\r\n\r\n  [sets.inspecting]: [\r\n    {\r\n      src: { value: paths.device.touchscreen.anything },\r\n      dest: { value: paths.actions.stopInspecting },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.pinch.delta },\r\n      dest: { value: paths.actions.inspectZoom },\r\n      xform: xforms.scale(0.025),\r\n      priority: 1\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nexport const keyboardDebuggingBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"l\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logDebugFrame\r\n      },\r\n      xform: xforms.rising\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nconst name = \"/touch/var/\";\r\n\r\nconst leftButton = paths.device.leftOculusTouch.button;\r\nconst leftAxis = paths.device.leftOculusTouch.axis;\r\nconst leftPose = paths.device.leftOculusTouch.pose;\r\nconst rightButton = paths.device.rightOculusTouch.button;\r\nconst rightAxis = paths.device.rightOculusTouch.axis;\r\nconst rightPose = paths.device.rightOculusTouch.pose;\r\n\r\nconst wakeLeft = `${name}left/wake`;\r\nconst wakeRight = `${name}right/wake`;\r\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\r\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\r\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\r\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\r\nconst cursorDrop2 = `${name}right/cursorDrop2`;\r\nconst cursorDrop1 = `${name}right/cursorDrop1`;\r\nconst leftCursorDrop2 = `${name}left/cursorDrop2`;\r\nconst leftCursorDrop1 = `${name}left/cursorDrop1`;\r\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\r\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\r\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\r\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\r\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\r\nconst rightDpadNorth = `${name}rightDpad/north`;\r\nconst rightDpadSouth = `${name}rightDpad/south`;\r\nconst rightDpadEast = `${name}rightDpad/east`;\r\nconst rightDpadWest = `${name}rightDpad/west`;\r\nconst rightDpadCenter = `${name}rightDpad/center`;\r\nconst rightJoy = `${name}right/joy`;\r\nconst rightJoyY1 = `${name}right/joyY1`;\r\nconst rightJoyY2 = `${name}right/joyY2`;\r\nconst rightJoyYDeadzoned = `${name}right/joy/y/deadzoned`;\r\nconst leftDpadNorth = `${name}leftDpad/north`;\r\nconst leftDpadSouth = `${name}leftDpad/south`;\r\nconst leftDpadEast = `${name}leftDpad/east`;\r\nconst leftDpadWest = `${name}leftDpad/west`;\r\nconst leftDpadCenter = `${name}leftDpad/center`;\r\nconst leftJoy = `${name}left/joy`;\r\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\r\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\r\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\r\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\r\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\r\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\r\nconst rightBoost = \"/var/right-oculus/boost\";\r\nconst leftBoost = \"/var/left-oculus/boost\";\r\nconst rightTouchSnapRight = `${name}/right/snap-right`;\r\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\r\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\r\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\r\n\r\nconst lowerButtons = `${name}buttons/lower`;\r\nconst upperButtons = `${name}buttons/upper`;\r\n\r\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\r\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\r\n\r\nconst thawViaButtons = `${name}buttons/thaw`;\r\nconst thawViaKeyboard = `${name}keyboard/thaw`;\r\n\r\nconst v = s => {\r\n  return \"/oculus-touch-user-vars/\" + s;\r\n};\r\nconst leftGripPressed1 = v(\"leftGripPressed1\");\r\nconst leftGripPressed2 = v(\"leftGripPressed2\");\r\nconst rightGripPressed1 = v(\"rightGripPressed1\");\r\nconst rightGripPressed2 = v(\"rightGripPressed2\");\r\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\r\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\r\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\r\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\r\n\r\nexport const oculusTouchUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: paths.device.leftOculusTouch.matrix\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.matrix\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.rightOculusTouch.matrix\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.matrix\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\r\n      dest: { value: paths.actions.ensureFrozen },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [thawViaButtons, thawViaKeyboard],\r\n      dest: { value: paths.actions.thaw },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: leftButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: leftGripPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: leftButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: leftGripPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: leftGripPressed1\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.middleRingPinky\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\r\n      dest: {\r\n        value: paths.actions.leftHand.thumb\r\n      },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: leftButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: leftTriggerPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: leftButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: leftTriggerPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed1 },\r\n      dest: {\r\n        value: paths.actions.leftHand.index\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: rightGripPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: rightGripPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightGripPressed1\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.middleRingPinky\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\r\n      dest: {\r\n        value: paths.actions.rightHand.thumb\r\n      },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: rightButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: rightTriggerPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: rightTriggerPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed1 },\r\n      dest: {\r\n        value: paths.actions.rightHand.index\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: leftAxis(\"joyX\"),\r\n        y: leftAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: leftJoy\r\n      },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: leftJoy\r\n      },\r\n      dest: {\r\n        north: leftDpadNorth,\r\n        south: leftDpadSouth,\r\n        east: leftDpadEast,\r\n        west: leftDpadWest,\r\n        center: leftDpadCenter\r\n      },\r\n      xform: xforms.vec2dpad(0.2, false, true)\r\n    },\r\n    {\r\n      src: {\r\n        value: rightAxis(\"joyY\")\r\n      },\r\n      dest: { value: rightJoyY1 },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightAxis(\"joyY\")\r\n      },\r\n      dest: { value: rightJoyY2 },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: rightAxis(\"joyX\"),\r\n        y: rightJoyY1\r\n      },\r\n      dest: {\r\n        value: rightJoy\r\n      },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: rightJoy\r\n      },\r\n      dest: {\r\n        north: rightDpadNorth,\r\n        south: rightDpadSouth,\r\n        east: rightDpadEast,\r\n        west: rightDpadWest,\r\n        center: rightDpadCenter\r\n      },\r\n      xform: xforms.vec2dpad(0.2, false, true)\r\n    },\r\n    {\r\n      src: {\r\n        value: rightDpadEast\r\n      },\r\n      dest: {\r\n        value: rightTouchSnapRight\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"e\") },\r\n      dest: { value: keyboardSnapRight },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rightTouchSnapRight, keyboardSnapRight],\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Tab\") },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: ensureFrozenViaKeyboard },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\r\n      dest: { value: lowerButtons },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [leftButton(\"y\").pressed, rightButton(\"b\").pressed],\r\n      dest: { value: upperButtons },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: lowerButtons },\r\n      dest: { value: ensureFrozenViaButtons },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: lowerButtons },\r\n      dest: { value: thawViaButtons },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: thawViaKeyboard },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: {\r\n        value: rightDpadWest\r\n      },\r\n      dest: {\r\n        value: rightTouchSnapLeft\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"q\") },\r\n      dest: { value: keyboardSnapLeft },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: leftAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: leftJoyYDeadzoned\r\n      },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: leftJoyYDeadzoned\r\n      },\r\n      dest: {\r\n        value: scaledLeftJoyY\r\n      },\r\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        value: leftAxis(\"joyX\")\r\n      },\r\n      dest: {\r\n        value: leftJoyXDeadzoned\r\n      },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: leftJoyXDeadzoned\r\n      },\r\n      dest: {\r\n        value: scaledLeftJoyX\r\n      },\r\n      xform: xforms.scale(1.5) // horizontal character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        x: scaledLeftJoyX,\r\n        y: scaledLeftJoyY\r\n      },\r\n      dest: { value: oculusTouchCharacterAcceleration },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"arrowup\"),\r\n        a: paths.device.keyboard.key(\"arrowleft\"),\r\n        s: paths.device.keyboard.key(\"arrowdown\"),\r\n        d: paths.device.keyboard.key(\"arrowright\")\r\n      },\r\n      dest: { vec2: arrows_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"w\"),\r\n        a: paths.device.keyboard.key(\"a\"),\r\n        s: paths.device.keyboard.key(\"s\"),\r\n        d: paths.device.keyboard.key(\"d\")\r\n      },\r\n      dest: { vec2: wasd_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: wasd_vec2,\r\n        second: arrows_vec2\r\n      },\r\n      dest: { value: keyboardCharacterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: oculusTouchCharacterAcceleration,\r\n        second: keyboardCharacterAcceleration\r\n      },\r\n      dest: {\r\n        value: characterAcceleration\r\n      },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: characterAcceleration,\r\n        override: \"/device/overrides/foo\"\r\n      },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"shift\") },\r\n      dest: { value: keyboardBoost },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: leftButton(\"y\").pressed\r\n      },\r\n      dest: {\r\n        value: leftBoost\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightButton(\"b\").pressed\r\n      },\r\n      dest: {\r\n        value: rightBoost\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: leftButton(\"thumbStick\").pressed\r\n      },\r\n      dest: {\r\n        value: paths.actions.nextCameraMode\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: rightButton(\"thumbStick\").pressed\r\n      },\r\n      dest: {\r\n        value: paths.actions.toggleFly\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [keyboardBoost, leftBoost, rightBoost],\r\n      dest: { value: paths.actions.boost },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"t\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChat\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"/\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChatCommand\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: paths.actions.mediaExit },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"p\") },\r\n      dest: { value: paths.actions.spawnPen },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"c\") },\r\n      dest: { value: paths.actions.toggleCamera },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"x\") },\r\n      dest: { value: paths.actions.takeSnapshot },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"1\")\r\n      },\r\n      dest: { value: \"/var/shift+1\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+1\" },\r\n      dest: { value: paths.actions.mediaSearch1 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"2\")\r\n      },\r\n      dest: { value: \"/var/shift+2\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+2\" },\r\n      dest: { value: paths.actions.mediaSearch2 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"3\")\r\n      },\r\n      dest: { value: \"/var/shift+3\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+3\" },\r\n      dest: { value: paths.actions.mediaSearch3 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"4\")\r\n      },\r\n      dest: { value: \"/var/shift+4\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+4\" },\r\n      dest: { value: paths.actions.mediaSearch4 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"5\")\r\n      },\r\n      dest: { value: \"/var/shift+5\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+5\" },\r\n      dest: { value: paths.actions.mediaSearch5 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"6\")\r\n      },\r\n      dest: { value: \"/var/shift+6\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+6\" },\r\n      dest: { value: paths.actions.mediaSearch6 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"7\")\r\n      },\r\n      dest: { value: \"/var/shift+7\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+7\" },\r\n      dest: { value: paths.actions.mediaSearch7 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"8\")\r\n      },\r\n      dest: { value: \"/var/shift+8\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+8\" },\r\n      dest: { value: paths.actions.mediaSearch8 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"l\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logDebugFrame\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"k\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logInteractionState\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"m\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.muteMic\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: leftPose },\r\n      dest: { value: paths.actions.cursor.left.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightPose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightPose },\r\n      dest: { value: paths.actions.rightHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: leftPose },\r\n      dest: { value: paths.actions.leftHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.stopTeleport },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.stopTeleport },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [\r\n        leftButton(\"y\").pressed,\r\n        leftButton(\"x\").pressed,\r\n        leftButton(\"trigger\").pressed,\r\n        leftButton(\"grip\").pressed\r\n      ],\r\n      dest: { value: wakeLeft },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: wakeLeft },\r\n      dest: { value: paths.actions.cursor.left.wake },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [\r\n        rightButton(\"b\").pressed,\r\n        rightButton(\"a\").pressed,\r\n        rightButton(\"trigger\").pressed,\r\n        rightButton(\"grip\").pressed\r\n      ],\r\n      dest: { value: wakeRight },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: wakeRight },\r\n      dest: { value: paths.actions.cursor.right.wake },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnNothing]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.startTeleport },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.grab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnVideo]: [\r\n    {\r\n      src: { value: rightAxis(\"joyY\") },\r\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n      xform: xforms.scale(-0.01)\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnVideo]: [\r\n    {\r\n      src: { value: leftAxis(\"joyY\") },\r\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\r\n      xform: xforms.scale(-0.01)\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnNothing]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnNothing]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.startTeleport },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: leftGripRisingGrab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: leftTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: [leftGripRisingGrab],\r\n      dest: { value: paths.actions.leftHand.grab },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.inspecting]: [\r\n    {\r\n      src: { value: upperButtons },\r\n      dest: { value: paths.actions.stopInspecting },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoldingInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnPen]: [],\r\n  [sets.leftHandHoldingPen]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        value: leftDpadEast,\r\n        override: \"/device/overrides/foo\"\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.penNextColor\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: leftDpadWest,\r\n        override: \"/device/overrides/foo\"\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.penPrevColor\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: leftJoyYDeadzoned },\r\n      dest: { value: paths.actions.leftHand.scalePenTip },\r\n      xform: xforms.scaleExp(-0.005, 5),\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftButton(\"y\").pressed },\r\n      dest: { value: paths.actions.leftHand.switchDrawMode },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftButton(\"x\").pressed },\r\n      dest: { value: paths.actions.leftHand.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: rightGripRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: rightTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: [rightGripRisingGrab],\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: upperButtons },\r\n      dest: { value: paths.actions.startInspecting },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: leftGripRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: leftTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: [leftGripRisingGrab],\r\n      dest: { value: paths.actions.cursor.left.grab },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: upperButtons },\r\n      dest: { value: paths.actions.startInspecting },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingUI]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: cursorDrop2 },\r\n      xform: xforms.falling,\r\n      priority: 5\r\n    }\r\n  ],\r\n  [sets.leftCursorHoldingUI]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: leftCursorDrop2 },\r\n      xform: xforms.falling,\r\n      priority: 5\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    {\r\n      src: { value: rightAxis(\"joyY\") },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.scale(0.1)\r\n    },\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: cursorDrop1 },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: [cursorDrop1, cursorDrop2],\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoldingInteractable]: [\r\n    {\r\n      src: { value: leftAxis(\"joyY\") },\r\n      dest: { value: paths.actions.cursor.left.modDelta },\r\n      xform: xforms.scale(0.1)\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: leftCursorDrop1 },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: [leftCursorDrop1, leftCursorDrop2],\r\n      dest: { value: paths.actions.cursor.left.drop },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnPen]: [],\r\n\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightButton(\"b\").pressed },\r\n      dest: { value: paths.actions.cursor.right.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n  [sets.leftCursorHoldingPen]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: leftButton(\"y\").pressed },\r\n      dest: { value: paths.actions.cursor.left.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: rightGripRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: rightTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: [rightGripRisingGrab],\r\n      dest: { value: paths.actions.rightHand.grab },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoldingInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: {\r\n        value: rightHandDrop2\r\n      },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: [rightHandDrop2],\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.any,\r\n      priority: 2\r\n    }\r\n  ],\r\n  [sets.rightHandHoveringOnPen]: [],\r\n  [sets.rightHandHoldingPen]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        value: rightDpadEast\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.penNextColor\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: rightDpadWest\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.penPrevColor\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: rightAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: rightJoyYDeadzoned\r\n      },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: rightJoyYDeadzoned },\r\n      dest: { value: paths.actions.rightHand.scalePenTip },\r\n      xform: xforms.scaleExp(-0.005, 5),\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightButton(\"b\").pressed },\r\n      dest: { value: paths.actions.rightHand.switchDrawMode },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: rightButton(\"a\").pressed },\r\n      dest: { value: paths.actions.rightHand.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnCamera]: [],\r\n  [sets.rightHandHoveringOnCamera]: [],\r\n  [sets.leftHandHoveringOnCamera]: [],\r\n\r\n  [sets.rightHandHoldingCamera]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 4\r\n    }\r\n  ],\r\n  [sets.leftHandHoldingCamera]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 4\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingCamera]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 4\r\n    }\r\n  ],\r\n  [sets.leftCursorHoldingCamera]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 4\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoveringOnNothing]: [],\r\n  [sets.inputFocused]: [\r\n    {\r\n      src: { value: \"/device/keyboard\" },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.noop,\r\n      priority: 1000\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nconst v = name => {\r\n  return `/vive-user/vive-var/${name}`;\r\n};\r\n\r\nconst wakeLeft = `${name}left/wake`;\r\nconst wakeRight = `${name}right/wake`;\r\n\r\nconst lButton = paths.device.vive.left.button;\r\nconst lAxis = paths.device.vive.left.axis;\r\nconst lPose = paths.device.vive.left.pose;\r\nconst lJoy = v(\"left/joy\");\r\nconst lJoyScaled = v(\"left/joy/scaled\");\r\nconst lJoyXScaled = v(\"left/joyX/scaled\");\r\nconst lJoyYScaled = v(\"left/joyY/scaled\");\r\nconst lJoyYDeadzoned = v(\"left/joyY/deadzoned\");\r\nconst lTouch = v(\"left/touch\");\r\nconst lTouchScaled = v(\"left/touch/scaled\");\r\nconst lTouchXScaled = v(\"left/touchX/scaled\");\r\nconst lTouchY = v(\"left/touchY\");\r\nconst lTouchYScaled = v(\"left/touchY/scaled\");\r\nconst lDpadNorth1 = v(\"left/dpad/north1\");\r\nconst lDpadSouth1 = v(\"left/dpad/south1\");\r\nconst lDpadEast1 = v(\"left/dpad/east1\");\r\nconst lDpadWest1 = v(\"left/dpad/west1\");\r\nconst lDpadCenter1 = v(\"left/dpad/center1\");\r\nconst lDpadNorth2 = v(\"left/dpad/north2\");\r\nconst lDpadSouth2 = v(\"left/dpad/south2\");\r\nconst lDpadEast2 = v(\"left/dpad/east2\");\r\nconst lDpadWest2 = v(\"left/dpad/west2\");\r\nconst lDpadCenter2 = v(\"left/dpad/center2\");\r\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\r\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\r\nconst lTriggerRisingGrab = v(\"left/trigger/rising/grab\");\r\nconst lGripRisingGrab = v(\"left/grab/rising/grab\");\r\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\r\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\r\nconst touchCharacterAcceleration = v(\"left/touch/characterAcceleration\");\r\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\r\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\r\nconst leftBoost = v(\"left/boost\");\r\nconst leftUndoDrawing = v(\"left/drawing/undo\");\r\n\r\nconst rButton = paths.device.vive.right.button;\r\nconst rAxis = paths.device.vive.right.axis;\r\nconst rPose = paths.device.vive.right.pose;\r\nconst rTouch = v(\"right/touch\");\r\nconst rJoy = v(\"right/joy\");\r\nconst rJoyYDeadzoned = v(\"right/joyY/deadzoned\");\r\nconst rDpadNorth1 = v(\"right/dpad/north1\");\r\nconst rDpadSouth1 = v(\"right/dpad/south1\");\r\nconst rDpadEast1 = v(\"right/dpad/east1\");\r\nconst rDpadWest1 = v(\"right/dpad/west1\");\r\nconst rDpadCenter1 = v(\"right/dpad/center\");\r\nconst rDpadNorth2 = v(\"right/dpad/north2\");\r\nconst rDpadSouth2 = v(\"right/dpad/south2\");\r\nconst rDpadEast2 = v(\"right/dpad/east2\");\r\nconst rDpadWest2 = v(\"right/dpad/west2\");\r\nconst rDpadCenter2 = v(\"right/dpad/center2\");\r\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\r\nconst rTouchpadRising = v(\"right/touchpad/rising\");\r\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\r\nconst rightBoost = v(\"right/boost\");\r\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\r\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\r\nconst rightCursorDrop1 = v(\"right/cursorDrop1\");\r\nconst rightCursorDrop2 = v(\"right/cursorDrop2\");\r\nconst leftCursorDrop1 = v(\"left/cursorDrop1\");\r\nconst leftCursorDrop2 = v(\"left/cursorDrop2\");\r\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\r\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\r\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\r\nconst rightUndoDrawing = v(\"right/drawing/undo\");\r\n\r\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\r\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\r\nconst ensureFrozenViaButtons = v(\"buttons/ensureFrozen\");\r\n\r\nconst thawViaDpad = v(\"dpad/thaw\");\r\nconst thawViaKeyboard = v(\"keyboard/thaw\");\r\nconst thawViaButtons = v(\"buttons/thaw\");\r\n\r\nconst freezeButtons = v(\"buttons/freeze\");\r\nconst inspectButtons = v(\"buttons/inspect\");\r\n\r\nconst rSnapRight1 = v(\"right/snap-right\");\r\nconst rSnapLeft1 = v(\"right/snap-left\");\r\nconst rSnapRight2 = v(\"right/snap-right2\");\r\nconst rSnapLeft2 = v(\"right/snap-left2\");\r\n\r\nconst k = name => {\r\n  return `/vive-user/keyboard-var/${name}`;\r\n};\r\nconst keyboardSnapRight = k(\"snap-right\");\r\nconst keyboardSnapLeft = k(\"snap-left\");\r\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\r\nconst wasd_vec2 = k(\"wasd_vec2\");\r\nconst arrows_vec2 = k(\"arrows_vec2\");\r\nconst keyboardBoost = k(\"boost\");\r\n\r\nconst leftGripPressed1 = v(\"leftGripPressed1\");\r\nconst leftGripPressed2 = v(\"leftGripPressed2\");\r\nconst rightGripPressed1 = v(\"rightGripPressed1\");\r\nconst rightGripPressed2 = v(\"rightGripPressed2\");\r\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\r\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\r\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\r\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\r\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\r\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\r\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\r\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\r\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\r\n\r\nexport const viveUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: paths.device.vive.left.matrix\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.matrix\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.vive.right.matrix\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.matrix\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard, ensureFrozenViaButtons],\r\n      dest: { value: paths.actions.ensureFrozen },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [thawViaDpad, thawViaKeyboard, thawViaButtons],\r\n      dest: { value: paths.actions.thaw },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: lButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: leftGripPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: leftGripPressed1\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.middleRingPinky\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: lButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: leftGripPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [lButton(\"touchpad\").touched, lButton(\"primary\").touched],\r\n      dest: {\r\n        value: paths.actions.leftHand.thumb\r\n      },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed1 },\r\n      dest: {\r\n        value: paths.actions.leftHand.index\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: lButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: leftTriggerPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: lButton(\"trigger\").pressed },\r\n      dest: {\r\n        value: leftTriggerPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: rightGripPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"grip\").pressed\r\n      },\r\n      dest: {\r\n        value: rightGripPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rightGripPressed1\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.middleRingPinky\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [rButton(\"touchpad\").touched, rButton(\"primary\").touched],\r\n      dest: {\r\n        value: paths.actions.rightHand.thumb\r\n      },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"trigger\").pressed\r\n      },\r\n      dest: { value: rightTriggerPressed1 },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"trigger\").pressed\r\n      },\r\n      dest: { value: rightTriggerPressed2 },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed1 },\r\n      dest: {\r\n        value: paths.actions.rightHand.index\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: lAxis(\"touchX\"),\r\n        y: lAxis(\"touchY\")\r\n      },\r\n      dest: {\r\n        value: lTouch\r\n      },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: lTouch\r\n      },\r\n      dest: {\r\n        north: lDpadNorth1,\r\n        south: lDpadSouth1,\r\n        east: lDpadEast1,\r\n        west: lDpadWest1,\r\n        center: lDpadCenter1\r\n      },\r\n      xform: xforms.vec2dpad(0.35)\r\n    },\r\n    {\r\n      src: {\r\n        value: lButton(\"touchpad\").pressed\r\n      },\r\n      dest: {\r\n        value: leftTouchpadPressed1\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: lButton(\"touchpad\").pressed\r\n      },\r\n      dest: {\r\n        value: leftTouchpadPressed2\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: rAxis(\"touchX\"),\r\n        y: rAxis(\"touchY\")\r\n      },\r\n      dest: {\r\n        value: rTouch\r\n      },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: rTouch\r\n      },\r\n      dest: {\r\n        north: rDpadNorth1,\r\n        south: rDpadSouth1,\r\n        east: rDpadEast1,\r\n        west: rDpadWest1,\r\n        center: rDpadCenter1\r\n      },\r\n      xform: xforms.vec2dpad(0.35, false, true)\r\n    },\r\n    {\r\n      src: {\r\n        x: rAxis(\"joyX\"),\r\n        y: rAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: rJoy\r\n      },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: rJoy\r\n      },\r\n      dest: {\r\n        north: rDpadNorth2,\r\n        south: rDpadSouth2,\r\n        east: rDpadEast2,\r\n        west: rDpadWest2,\r\n        center: rDpadCenter2\r\n      },\r\n      xform: xforms.vec2dpad(0.35, false, true)\r\n    },\r\n    {\r\n      src: [rDpadNorth1, rDpadSouth1, rDpadCenter1],\r\n      dest: { value: rDpadCenterStrip },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"touchpad\").pressed\r\n      },\r\n      dest: {\r\n        value: rTouchpadRising\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"touchpad\").pressed\r\n      },\r\n      dest: {\r\n        value: rTouchpadFalling\r\n      },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadEast1\r\n      },\r\n      dest: {\r\n        value: rSnapRight1\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        value: rDpadEast2\r\n      },\r\n      dest: {\r\n        value: rSnapRight2\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"e\") },\r\n      dest: { value: keyboardSnapRight },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rSnapRight1, rSnapRight2, keyboardSnapRight],\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Tab\") },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: ensureFrozenViaKeyboard },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: thawViaKeyboard },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"p\") },\r\n      dest: { value: paths.actions.spawnPen },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"c\") },\r\n      dest: { value: paths.actions.toggleCamera },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"x\") },\r\n      dest: { value: paths.actions.takeSnapshot },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\r\n      dest: { value: ensureFrozenViaDpad },\r\n      root: rootForFrozenOverrideWhenHolding,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: rTouchpadFalling },\r\n      dest: { value: thawViaDpad },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadWest1\r\n      },\r\n      dest: {\r\n        value: rSnapLeft1\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        value: rDpadWest2\r\n      },\r\n      dest: {\r\n        value: rSnapLeft2\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"q\") },\r\n      dest: { value: keyboardSnapLeft },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rSnapLeft1, rSnapLeft2, keyboardSnapLeft],\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchX\")\r\n      },\r\n      dest: {\r\n        value: lTouchXScaled\r\n      },\r\n      xform: xforms.scale(1.5) // horizontal character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        value: lTouchY\r\n      },\r\n      dest: { value: lTouchYScaled },\r\n      xform: xforms.scale(1.5) // vertical character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        x: lTouchXScaled,\r\n        y: lTouchYScaled\r\n      },\r\n      dest: { value: lTouchScaled },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        bool: leftTouchpadPressed2,\r\n        value: lTouchScaled\r\n      },\r\n      dest: { value: touchCharacterAcceleration },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"joyX\")\r\n      },\r\n      dest: {\r\n        value: lJoyXScaled\r\n      },\r\n      xform: xforms.scale(1.5) // horizontal character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"joyY\")\r\n      },\r\n      dest: { value: lJoyYScaled },\r\n      xform: xforms.scale(1.5) // vertical character speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        x: lJoyXScaled,\r\n        y: lJoyYScaled\r\n      },\r\n      dest: { value: lJoyScaled },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: lJoyScaled,\r\n        second: touchCharacterAcceleration\r\n      },\r\n      dest: { value: lCharacterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"arrowup\"),\r\n        a: paths.device.keyboard.key(\"arrowleft\"),\r\n        s: paths.device.keyboard.key(\"arrowdown\"),\r\n        d: paths.device.keyboard.key(\"arrowright\")\r\n      },\r\n      dest: { vec2: arrows_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"w\"),\r\n        a: paths.device.keyboard.key(\"a\"),\r\n        s: paths.device.keyboard.key(\"s\"),\r\n        d: paths.device.keyboard.key(\"d\")\r\n      },\r\n      dest: { vec2: wasd_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"t\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChat\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"/\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChatCommand\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: paths.actions.mediaExit },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"1\")\r\n      },\r\n      dest: { value: \"/var/shift+1\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+1\" },\r\n      dest: { value: paths.actions.mediaSearch1 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"2\")\r\n      },\r\n      dest: { value: \"/var/shift+2\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+2\" },\r\n      dest: { value: paths.actions.mediaSearch2 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"3\")\r\n      },\r\n      dest: { value: \"/var/shift+3\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+3\" },\r\n      dest: { value: paths.actions.mediaSearch3 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"4\")\r\n      },\r\n      dest: { value: \"/var/shift+4\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+4\" },\r\n      dest: { value: paths.actions.mediaSearch4 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"5\")\r\n      },\r\n      dest: { value: \"/var/shift+5\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+5\" },\r\n      dest: { value: paths.actions.mediaSearch5 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"6\")\r\n      },\r\n      dest: { value: \"/var/shift+6\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+6\" },\r\n      dest: { value: paths.actions.mediaSearch6 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"7\")\r\n      },\r\n      dest: { value: \"/var/shift+7\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+7\" },\r\n      dest: { value: paths.actions.mediaSearch7 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"8\")\r\n      },\r\n      dest: { value: \"/var/shift+8\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+8\" },\r\n      dest: { value: paths.actions.mediaSearch8 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"l\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logDebugFrame\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"k\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.logInteractionState\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"m\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.muteMic\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        first: wasd_vec2,\r\n        second: arrows_vec2\r\n      },\r\n      dest: { value: keyboardCharacterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: lCharacterAcceleration,\r\n        second: keyboardCharacterAcceleration\r\n      },\r\n      dest: {\r\n        value: characterAcceleration\r\n      },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: { value: characterAcceleration },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.normalize_vec2\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"shift\") },\r\n      dest: { value: keyboardBoost },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: lButton(\"primary\").pressed\r\n      },\r\n      dest: {\r\n        value: leftBoost\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: rButton(\"primary\").pressed\r\n      },\r\n      dest: {\r\n        value: rightBoost\r\n      },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [keyboardBoost, leftBoost, rightBoost],\r\n      dest: { value: paths.actions.boost },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: lPose },\r\n      dest: { value: paths.actions.cursor.left.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rPose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: rPose },\r\n      dest: { value: paths.actions.rightHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: lPose },\r\n      dest: { value: paths.actions.leftHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: [\r\n        lButton(\"primary\").pressed,\r\n        lButton(\"trigger\").pressed,\r\n        lButton(\"grip\").pressed,\r\n        lButton(\"touchpad\").pressed\r\n      ],\r\n      dest: { value: wakeLeft },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: wakeLeft },\r\n      dest: { value: paths.actions.cursor.left.wake },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [\r\n        rButton(\"primary\").pressed,\r\n        rButton(\"trigger\").pressed,\r\n        rButton(\"grip\").pressed,\r\n        rButton(\"touchpad\").pressed\r\n      ],\r\n      dest: { value: wakeRight },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: wakeRight },\r\n      dest: { value: paths.actions.cursor.right.wake },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [\r\n        rButton(\"secondary\").pressed,\r\n        lButton(\"secondary\").pressed,\r\n        rButton(\"bumper\").pressed,\r\n        lButton(\"bumper\").pressed\r\n      ],\r\n      dest: { value: freezeButtons },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [rButton(\"primary\").pressed, lButton(\"primary\").pressed],\r\n      dest: { value: inspectButtons },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: freezeButtons },\r\n      dest: { value: ensureFrozenViaButtons },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: freezeButtons },\r\n      dest: { value: thawViaButtons },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n  [sets.rightHandTeleporting]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: rTriggerStopTeleport },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: rButton(\"touchpad\").pressed },\r\n      dest: { value: rTouchpadStopTeleport },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\r\n      dest: { value: paths.actions.rightHand.stopTeleport },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n  [sets.leftHandHoveringOnNothing]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.startTeleport },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandTeleporting]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: leftTriggerFallingStopTeleport },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\r\n      dest: { value: paths.actions.leftHand.stopTeleport },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoveringOnNothing]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnNothing]: [],\r\n\r\n  [sets.leftCursorHoveringOnNothing]: [],\r\n\r\n  [sets.rightCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.grab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnVideo]: [\r\n    {\r\n      src: {\r\n        value: rAxis(\"touchY\"),\r\n        touching: rButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n      xform: xforms.touch_axis_scroll(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: rAxis(\"joyY\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n      xform: xforms.scale(0.02)\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnVideo]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\"),\r\n        touching: lButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\r\n      xform: xforms.touch_axis_scroll(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"joyY\")\r\n      },\r\n      dest: { value: paths.actions.cursor.left.mediaVolumeMod },\r\n      xform: xforms.scale(0.02)\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: lGripRisingGrab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: lTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [lGripRisingGrab],\r\n      dest: { value: paths.actions.leftHand.grab },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoldingInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnPen]: [],\r\n  [sets.leftHandHoldingPen]: [\r\n    {\r\n      src: { value: leftTouchpadPressed2 },\r\n      dest: { value: leftTouchpadFallingStopTeleport },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        value: leftTouchpadPressed2\r\n      },\r\n      dest: {\r\n        value: lTouchpadRising1\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        bool: lTouchpadRising1,\r\n        value: lDpadCenter1\r\n      },\r\n      dest: { value: paths.actions.leftHand.startTeleport },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.leftHand.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: lTriggerFallingStopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: lGripFallingStopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: leftGripFallingWhileHoldingPen },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\r\n      dest: { value: paths.actions.leftHand.stopDrawing },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {\r\n        value: leftTouchpadPressed2\r\n      },\r\n      dest: {\r\n        value: lTouchpadRising2\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        bool: lTouchpadRising2,\r\n        value: lDpadNorth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.penNextColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        bool: lTouchpadRising2,\r\n        value: lDpadSouth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.leftHand.penPrevColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchX\"),\r\n        touching: lButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.leftHand.scalePenTip },\r\n      xform: xforms.touch_axis_scroll(0.05)\r\n    },\r\n    {\r\n      src: [rButton(\"primary\").pressed, lButton(\"secondary\").pressed],\r\n      dest: { value: leftUndoDrawing },\r\n      xform: xforms.any,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftUndoDrawing },\r\n      dest: { value: paths.actions.leftHand.undoDrawing },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: lButton(\"primary\").pressed },\r\n      dest: { value: paths.actions.leftHand.switchDrawMode },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: rGripRisingGrab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: rTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [rGripRisingGrab],\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: inspectButtons },\r\n      dest: { value: paths.actions.startInspecting },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: lGripRisingGrab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: lTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [lGripRisingGrab],\r\n      dest: { value: paths.actions.cursor.left.grab },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: inspectButtons },\r\n      dest: { value: paths.actions.startInspecting },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingUI]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: {\r\n        value: rightCursorDrop2\r\n      },\r\n      xform: xforms.falling,\r\n      priority: 4\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoldingUI]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: {\r\n        value: leftCursorDrop2\r\n      },\r\n      xform: xforms.falling,\r\n      priority: 4\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    {\r\n      src: {\r\n        value: rAxis(\"touchY\"),\r\n        touching: rButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.touch_axis_scroll(-1)\r\n    },\r\n    {\r\n      src: {\r\n        value: rAxis(\"joyY\")\r\n      },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.scale(-0.02)\r\n    },\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: rightCursorDrop1 },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [rightCursorDrop1, rightCursorDrop2],\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: ensureFrozenViaDpad },\r\n      root: rootForFrozenOverrideWhenHolding,\r\n      xform: xforms.always(false)\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoldingInteractable]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\"),\r\n        touching: lButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.left.modDelta },\r\n      xform: xforms.touch_axis_scroll(-1)\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"joyY\")\r\n      },\r\n      dest: { value: paths.actions.cursor.left.modDelta },\r\n      xform: xforms.scale(-0.02),\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: leftCursorDrop1 },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [leftCursorDrop1, leftCursorDrop2],\r\n      dest: { value: paths.actions.cursor.left.drop },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: ensureFrozenViaDpad },\r\n      root: rootForFrozenOverrideWhenHolding,\r\n      xform: xforms.always(false)\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnPen]: [],\r\n\r\n  [sets.leftCursorHoveringOnPen]: [],\r\n\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: [rightCursorDrop1],\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.noop,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [rightCursorDrop2],\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.noop,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadCenter1\r\n      },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        value: rAxis(\"touchX\"),\r\n        touching: rButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.right.scalePenTip },\r\n      xform: xforms.touch_axis_scroll(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadNorth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.cursor.right.penNextColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadSouth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.cursor.right.penPrevColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rButton(\"primary\").pressed },\r\n      dest: { value: paths.actions.cursor.right.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.leftCursorHoldingPen]: [\r\n    {\r\n      src: [leftCursorDrop1],\r\n      dest: { value: paths.actions.cursor.left.drop },\r\n      xform: xforms.noop,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: [leftCursorDrop2],\r\n      dest: { value: paths.actions.cursor.left.drop },\r\n      xform: xforms.noop,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.cursor.left.drop },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchX\"),\r\n        touching: lButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.left.scalePenTip },\r\n      xform: xforms.touch_axis_scroll(0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: leftTouchpadPressed2\r\n      },\r\n      dest: {\r\n        value: lTouchpadRising1\r\n      },\r\n      xform: xforms.rising,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        bool: lTouchpadRising1,\r\n        value: lDpadNorth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.cursor.left.penNextColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        bool: lTouchpadRising1,\r\n        value: lDpadSouth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.cursor.left.penPrevColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: lButton(\"primary\").pressed },\r\n      dest: { value: paths.actions.cursor.left.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: rGripRisingGrab },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: rTriggerRisingGrab },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: [rGripRisingGrab],\r\n      dest: { value: paths.actions.rightHand.grab },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandHoldingInteractable]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.falling,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: ensureFrozenViaDpad },\r\n      root: rootForFrozenOverrideWhenHolding,\r\n      xform: xforms.always(false)\r\n    }\r\n  ],\r\n  [sets.rightHandHoveringOnPen]: [],\r\n  [sets.rightHandHoldingPen]: [\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadCenter1\r\n      },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadNorth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.penNextColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        bool: rTouchpadRising,\r\n        value: rDpadSouth1\r\n      },\r\n      dest: {\r\n        value: paths.actions.rightHand.penPrevColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: rAxis(\"touchX\"),\r\n        touching: rButton(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.rightHand.scalePenTip },\r\n      xform: xforms.touch_axis_scroll(0.05)\r\n    },\r\n    {\r\n      src: [lButton(\"primary\").pressed, rButton(\"secondary\").pressed],\r\n      dest: { value: rightUndoDrawing },\r\n      xform: xforms.any,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: rightUndoDrawing },\r\n      dest: { value: paths.actions.rightHand.undoDrawing },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rButton(\"primary\").pressed },\r\n      dest: { value: paths.actions.rightHand.switchDrawMode },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnCamera]: [],\r\n  [sets.leftCursorHoveringOnCamera]: [],\r\n  [sets.rightHandHoveringOnCamera]: [],\r\n  [sets.leftHandHoveringOnCamera]: [],\r\n\r\n  [sets.rightHandHoldingCamera]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.rightHand.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    }\r\n  ],\r\n  [sets.leftHandHoldingCamera]: [\r\n    {\r\n      src: { value: lButton(\"trigger\").pressed },\r\n      dest: { value: paths.actions.leftHand.takeSnapshot },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingCamera]: [\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: rightTriggerPressed2 },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    }\r\n  ],\r\n  [sets.leftCursorHoldingCamera]: [\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.actions.cursor.left.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 3\r\n    },\r\n    {\r\n      src: { value: leftTriggerPressed2 },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.falling,\r\n      priority: 3\r\n    }\r\n  ],\r\n  [sets.inputFocused]: [\r\n    {\r\n      src: { value: \"/device/keyboard\" },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.noop,\r\n      priority: 1000\r\n    }\r\n  ]\r\n});\r\n\r\nexport const viveWandUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\")\r\n      },\r\n      dest: { value: lTouchY },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n  [sets.leftHandHoldingPen]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n  [sets.rightHandHoldingPen]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ]\r\n});\r\n\r\nexport const indexUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\")\r\n      },\r\n      dest: { value: lTouchY },\r\n      xform: xforms.copy\r\n    }\r\n  ]\r\n});\r\n\r\nexport const viveFocusPlusUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\")\r\n      },\r\n      dest: { value: lTouchY },\r\n      xform: xforms.negate\r\n    }\r\n  ],\r\n  [sets.leftHandHoldingPen]: [\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ],\r\n  [sets.rightHandHoldingPen]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    }\r\n  ]\r\n});\r\n\r\nexport const viveCosmosUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: {\r\n        value: lAxis(\"touchY\")\r\n      },\r\n      dest: { value: lTouchY },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n  [sets.leftHandHoldingPen]: [\r\n    {\r\n      src: {\r\n        x: lAxis(\"joyX\"),\r\n        y: lAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: lJoy\r\n      },\r\n      xform: xforms.compose_vec2,\r\n      priority: 1\r\n    },\r\n    {\r\n      src: {\r\n        value: lJoy\r\n      },\r\n      dest: {\r\n        north: lDpadNorth2,\r\n        south: lDpadSouth2,\r\n        east: lDpadEast2,\r\n        west: lDpadWest2,\r\n        center: lDpadCenter2\r\n      },\r\n      xform: xforms.vec2dpad(0.35, false, true)\r\n    },\r\n    {\r\n      src: { value: leftGripPressed2 },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: lDpadEast2,\r\n        override: \"/device/overrides/foo\"\r\n      },\r\n      dest: { value: paths.actions.leftHand.penNextColor },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: lDpadWest2,\r\n        override: \"/device/overrides/foo\"\r\n      },\r\n      dest: { value: paths.actions.leftHand.penPrevColor },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: lAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: lJoyYDeadzoned\r\n      },\r\n      xform: xforms.deadzone(0.1),\r\n      priority: 1\r\n    },\r\n    {\r\n      src: { value: lJoyYDeadzoned },\r\n      dest: { value: paths.actions.leftHand.scalePenTip },\r\n      xform: xforms.scaleExp(-0.005, 5),\r\n      priority: 1\r\n    }\r\n  ],\r\n  [sets.rightHandHoldingPen]: [\r\n    {\r\n      src: { value: rightGripPressed2 },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rDpadEast2 },\r\n      dest: { value: paths.actions.rightHand.penNextColor },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: { value: rDpadWest2 },\r\n      dest: { value: paths.actions.rightHand.penPrevColor },\r\n      xform: xforms.rising,\r\n      priority: 2\r\n    },\r\n    {\r\n      src: {\r\n        value: rAxis(\"joyY\")\r\n      },\r\n      dest: {\r\n        value: rJoyYDeadzoned\r\n      },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: rJoyYDeadzoned },\r\n      dest: { value: paths.actions.rightHand.scalePenTip },\r\n      xform: xforms.scaleExp(-0.005, 5),\r\n      priority: 1\r\n    }\r\n  ],\r\n  [sets.inspecting]: [\r\n    {\r\n      src: { value: inspectButtons },\r\n      dest: { value: paths.actions.stopInspecting },\r\n      xform: xforms.falling\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\r\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\r\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\r\n\r\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\r\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\r\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\r\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\r\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\r\n\r\nfunction dpadVariables(hand) {\r\n  return {\r\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\r\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\r\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\r\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\r\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\r\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\r\n  };\r\n}\r\n\r\nfunction dpadBindings(hand) {\r\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\r\n  const pad = paths.device.wmr.v(hand + \"/pad\");\r\n  return [\r\n    {\r\n      src: {\r\n        x: paths.device.wmr[hand].touchpad.axisX,\r\n        y: paths.device.wmr[hand].touchpad.axisY\r\n      },\r\n      dest: { value: pad },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: { value: pad },\r\n      dest: {\r\n        west: padWest,\r\n        east: padEast,\r\n        north: padNorth,\r\n        south: padSouth,\r\n        center: padCenter\r\n      },\r\n      xform: xforms.vec2dpad(0.5, false, false)\r\n    },\r\n    {\r\n      src: [padNorth, padCenter, padSouth],\r\n      dest: { value: padCenterStrip },\r\n      xform: xforms.any\r\n    }\r\n  ];\r\n}\r\n\r\nconst neverFrozenBinding = {\r\n  src: {},\r\n  dest: { value: paths.actions.ensureFrozen },\r\n  xform: xforms.always(false)\r\n};\r\n\r\nfunction penBindings(hand, forCursor) {\r\n  const padY = paths.device.wmr[hand].touchpad.axisY;\r\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\r\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\r\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\r\n\r\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\r\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\r\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\r\n\r\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\r\n\r\n  return [\r\n    neverFrozenBinding,\r\n    ...dpadBindings(hand),\r\n    {\r\n      src: { value: triggerPressed },\r\n      dest: { value: actions.startDrawing },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: triggerPressed },\r\n      dest: { value: actions.stopDrawing },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: padPressed },\r\n      dest: { value: padRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { bool: padRising, value: padWest },\r\n      dest: { value: actions.penPrevColor },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { bool: padRising, value: padEast },\r\n      dest: { value: actions.penNextColor },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: [padCenterStrip, padTouched],\r\n      dest: { value: padCenterStripTouched },\r\n      xform: xforms.all\r\n    },\r\n    {\r\n      src: { value: padY, touching: padCenterStripTouched },\r\n      dest: { value: actions.scalePenTip },\r\n      xform: xforms.touch_axis_scroll(-0.05)\r\n    },\r\n    {\r\n      src: [padRising, padCenter],\r\n      dest: { value: actions.undoDrawing },\r\n      xform: xforms.all\r\n    }\r\n  ];\r\n}\r\n\r\nfunction handPoseBindings(hand) {\r\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\r\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\r\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\r\n  const actions = paths.actions[hand + \"Hand\"];\r\n  return [\r\n    {\r\n      src: { value: padTouched },\r\n      dest: { value: actions.thumb },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: triggerPressed },\r\n      dest: { value: actions.index },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: gripPressed },\r\n      dest: { value: actions.middleRingPinky },\r\n      xform: xforms.copy\r\n    }\r\n  ];\r\n}\r\n\r\nfunction freezeBindings() {\r\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\r\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\r\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\r\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\r\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\r\n  return [\r\n    {\r\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\r\n      dest: { value: paths.actions.ensureFrozen },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\" \") },\r\n      dest: { value: keyboardSaceFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Tab\") },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: leftPadPressed },\r\n      dest: { value: leftPadFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: rightPadPressed },\r\n      dest: { value: rightPadFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\r\n      dest: { value: paths.actions.thaw },\r\n      xform: xforms.any\r\n    }\r\n  ];\r\n}\r\n\r\nfunction characterAccelerationBindings() {\r\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\r\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\r\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\r\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\r\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\r\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\r\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\r\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\r\n  return [\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"arrowup\"),\r\n        a: paths.device.keyboard.key(\"arrowleft\"),\r\n        s: paths.device.keyboard.key(\"arrowdown\"),\r\n        d: paths.device.keyboard.key(\"arrowright\")\r\n      },\r\n      dest: { vec2: arrows_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        w: paths.device.keyboard.key(\"w\"),\r\n        a: paths.device.keyboard.key(\"a\"),\r\n        s: paths.device.keyboard.key(\"s\"),\r\n        d: paths.device.keyboard.key(\"d\")\r\n      },\r\n      dest: { vec2: wasd_vec2 },\r\n      xform: xforms.wasd_to_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: wasd_vec2,\r\n        second: arrows_vec2\r\n      },\r\n      dest: { value: keyboardCharacterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.left.joystick.axisX },\r\n      dest: { value: lJoyXDeadzoned },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: lJoyXDeadzoned },\r\n      dest: { value: lJoyXScaled },\r\n      xform: xforms.scale(1.5) // horizontal character speed modifier\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.left.joystick.axisY },\r\n      dest: { value: lJoyYDeadzoned },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: lJoyYDeadzoned },\r\n      dest: { value: lJoyYScaled },\r\n      xform: xforms.scale(-1.5) // vertical character speed modifier\r\n    },\r\n    {\r\n      src: { x: lJoyXScaled, y: lJoyYScaled },\r\n      dest: { value: lCharacterAcceleration },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        first: lCharacterAcceleration,\r\n        second: keyboardCharacterAcceleration\r\n      },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.max_vec2\r\n    },\r\n    {\r\n      src: [\r\n        paths.device.wmr.left.trigger.pressed,\r\n        paths.device.wmr.right.trigger.pressed,\r\n        paths.device.keyboard.key(\"shift\")\r\n      ],\r\n      dest: { value: paths.actions.boost },\r\n      xform: xforms.any\r\n    }\r\n  ];\r\n}\r\n\r\nfunction cursorModDeltaBindings() {\r\n  const { padNorth, padSouth } = dpadVariables(\"right\");\r\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\r\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\r\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\r\n  return [\r\n    ...dpadBindings(\"right\"),\r\n    {\r\n      src: [padNorth, padSouth],\r\n      dest: { value: rPadNorthOrSouth },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\r\n      dest: { value: rPadNorthOrSouthPressed },\r\n      xform: xforms.all\r\n    },\r\n    {\r\n      src: {\r\n        bool: rPadNorthOrSouthPressed,\r\n        value: paths.device.wmr.right.touchpad.axisY\r\n      },\r\n      dest: { value: rPadNorthOrSouthPressedY },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: rPadNorthOrSouthPressedY },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.scale(0.1)\r\n    }\r\n  ];\r\n}\r\n\r\nfunction cursorMediaVolumeModBindings() {\r\n  const hand = \"right\";\r\n  const padY = paths.device.wmr[hand].touchpad.axisY;\r\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\r\n\r\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\r\n  const { padCenterStrip } = dpadVariables(hand);\r\n\r\n  return [\r\n    ...dpadBindings(hand),\r\n    {\r\n      src: [padCenterStrip, padTouched],\r\n      dest: { value: padCenterStripTouched },\r\n      xform: xforms.all\r\n    },\r\n    {\r\n      src: { value: padY, touching: padCenterStripTouched },\r\n      dest: { value: paths.actions.cursor[hand].mediaVolumeMod },\r\n      xform: xforms.touch_axis_scroll(-0.1)\r\n    }\r\n  ];\r\n}\r\n\r\nfunction holdingCameraBindings(hand, forCursor) {\r\n  const actions = forCursor ? paths.actions.cursor[hand] : paths.actions[hand + \"Hand\"];\r\n  return [\r\n    neverFrozenBinding,\r\n    {\r\n      src: { value: paths.device.wmr[hand].trigger.pressed },\r\n      dest: { value: actions.takeSnapshot },\r\n      xform: xforms.copy\r\n    }\r\n  ];\r\n}\r\n\r\nfunction teleportationAndRotationBindings() {\r\n  const rJoy = paths.device.wmr.v(\"right/joy\");\r\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\r\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\r\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\r\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\r\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\r\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\r\n  return [\r\n    {\r\n      src: {\r\n        x: paths.device.wmr.right.joystick.axisX,\r\n        y: paths.device.wmr.right.joystick.axisY\r\n      },\r\n      dest: { value: rJoy },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: { value: rJoy },\r\n      dest: {\r\n        north: rJoyNorth,\r\n        west: rJoyWest,\r\n        east: rJoyEast\r\n      },\r\n      xform: xforms.vec2dpad(0.2, false, false)\r\n    },\r\n    {\r\n      src: { value: rJoyNorth },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rJoyWest },\r\n      dest: { value: rJoyWestRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rJoyEast },\r\n      dest: { value: rJoyEastRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"q\") },\r\n      dest: { value: keyboardQRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"e\") },\r\n      dest: { value: keyboardERising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rJoyWestRising, keyboardQRising],\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.any\r\n    },\r\n    {\r\n      src: [rJoyEastRising, keyboardERising],\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.any\r\n    }\r\n  ];\r\n}\r\n\r\nexport const wmrUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: { value: paths.device.wmr.left.matrix },\r\n      dest: { value: paths.actions.leftHand.matrix },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.right.matrix },\r\n      dest: { value: paths.actions.rightHand.matrix },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.left.pose },\r\n      dest: { value: paths.actions.leftHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.right.pose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.wmr.right.pose },\r\n      dest: { value: paths.actions.rightHand.pose },\r\n      xform: xforms.copy\r\n    },\r\n    ...handPoseBindings(\"left\"),\r\n    ...handPoseBindings(\"right\"),\r\n    ...freezeBindings(),\r\n    ...teleportationAndRotationBindings(),\r\n    ...characterAccelerationBindings(),\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"m\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.muteMic\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"t\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChat\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.keyboard.key(\"/\")\r\n      },\r\n      dest: {\r\n        value: paths.actions.focusChatCommand\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.keyboard.key(\"Escape\") },\r\n      dest: { value: paths.actions.mediaExit },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"1\")\r\n      },\r\n      dest: { value: \"/var/shift+1\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+1\" },\r\n      dest: { value: paths.actions.mediaSearch1 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"2\")\r\n      },\r\n      dest: { value: \"/var/shift+2\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+2\" },\r\n      dest: { value: paths.actions.mediaSearch2 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"3\")\r\n      },\r\n      dest: { value: \"/var/shift+3\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+3\" },\r\n      dest: { value: paths.actions.mediaSearch3 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"4\")\r\n      },\r\n      dest: { value: \"/var/shift+4\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+4\" },\r\n      dest: { value: paths.actions.mediaSearch4 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"5\")\r\n      },\r\n      dest: { value: \"/var/shift+5\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+5\" },\r\n      dest: { value: paths.actions.mediaSearch5 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"6\")\r\n      },\r\n      dest: { value: \"/var/shift+6\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+6\" },\r\n      dest: { value: paths.actions.mediaSearch6 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"7\")\r\n      },\r\n      dest: { value: \"/var/shift+7\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+7\" },\r\n      dest: { value: paths.actions.mediaSearch7 },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        bool: paths.device.keyboard.key(\"control\"),\r\n        value: paths.device.keyboard.key(\"8\")\r\n      },\r\n      dest: { value: \"/var/shift+8\" },\r\n      priority: 1001,\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: \"/var/shift+8\" },\r\n      dest: { value: paths.actions.mediaSearch8 },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnNothing]: [],\r\n  [sets.rightCursorHoveringOnNothing]: [],\r\n  [sets.rightHandHoveringOnNothing]: [],\r\n\r\n  [sets.rightHandTeleporting]: [\r\n    {\r\n      src: { value: rJoyNorth },\r\n      dest: { value: paths.actions.rightHand.stopTeleport },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: rTriggerPressed },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\r\n\r\n  [sets.leftHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: lGripPressed },\r\n      dest: { value: paths.actions.leftHand.grab },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n  [sets.rightCursorHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rGripPressed },\r\n      dest: { value: rGripRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: rTriggerPressed },\r\n      dest: { value: rTriggerRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: [rGripRising, rTriggerRising],\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n  [sets.rightHandHoveringOnInteractable]: [\r\n    {\r\n      src: { value: rGripPressed },\r\n      dest: { value: paths.actions.rightHand.grab },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoldingInteractable]: [\r\n    neverFrozenBinding,\r\n    {\r\n      src: { value: lGripPressed },\r\n      dest: { value: paths.actions.leftHand.drop },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    neverFrozenBinding,\r\n    ...cursorModDeltaBindings(),\r\n    {\r\n      src: { value: rGripPressed },\r\n      dest: { value: rGripFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: rTriggerPressed },\r\n      dest: { value: rTriggerFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: [rGripFalling, rTriggerFalling],\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.any\r\n    }\r\n  ],\r\n  [sets.rightHandHoldingInteractable]: [\r\n    neverFrozenBinding,\r\n    {\r\n      src: { value: rGripPressed },\r\n      dest: { value: paths.actions.rightHand.drop },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n\r\n  [sets.leftHandHoveringOnPen]: [],\r\n  [sets.rightCursorHoveringOnPen]: [],\r\n  [sets.rightHandHoveringOnPen]: [],\r\n\r\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\r\n  [sets.rightCursorHoldingPen]: penBindings(\"right\", true),\r\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\r\n\r\n  [sets.leftHandHoveringOnCamera]: [],\r\n  [sets.rightCursorHoveringOnCamera]: [],\r\n  [sets.rightHandHoveringOnCamera]: [],\r\n\r\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\r\n  [sets.rightCursorHoldingCamera]: holdingCameraBindings(\"right\", true),\r\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\r\n\r\n  [sets.inputFocused]: [\r\n    {\r\n      src: { value: \"/device/keyboard\" },\r\n      dest: { value: paths.noop },\r\n      xform: xforms.noop,\r\n      priority: 1000\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nconst button = paths.device.xbox.button;\r\nconst axis = paths.device.xbox.axis;\r\nconst scaledRightJoystickVertical = paths.device.xbox.v(\"scaledRightJoystickVertical\");\r\nconst scaledLeftJoystickCursorDelta = paths.device.xbox.v(\"scaledLeftJoystickCursorDelta\");\r\nconst deadzonedRightJoystickHorizontal = paths.device.xbox.v(\"deadzonedRightJoystickHorizontal\");\r\nconst deadzonedRightJoystickVertical = paths.device.xbox.v(\"deadzonedRightJoystickVertical\");\r\nconst deadzonedLeftJoystickHorizontal = paths.device.xbox.v(\"deadzonedLeftJoystickHorizontal\");\r\nconst deadzonedLeftJoystickVertical = paths.device.xbox.v(\"deadzonedLeftJoystickVertical\");\r\nconst vec2Zero = paths.device.xbox.v(\"vec2Zero\");\r\nconst zero = paths.device.xbox.v(\"zero\");\r\n\r\nfunction characterAccelerationBindings(disableForwardOnTrigger) {\r\n  const scaledLeftJoystickHorizontal = paths.device.xbox.v(\"scaledLeftJoystickHorizontal\");\r\n  const scaledLeftJoystickVertical = paths.device.xbox.v(\"scaledLeftJoystickVertical\");\r\n  const scaledLeftJoystickForwardAcceleration = paths.device.xbox.v(\"scaledLeftJoystickForwardAcceleration\");\r\n  return [\r\n    {\r\n      src: { value: deadzonedLeftJoystickHorizontal },\r\n      dest: { value: scaledLeftJoystickHorizontal },\r\n      xform: xforms.scale(1.5) // horizontal move speed modifier\r\n    },\r\n    {\r\n      src: { value: deadzonedLeftJoystickVertical },\r\n      dest: { value: scaledLeftJoystickVertical },\r\n      xform: xforms.scale(-1.25) // vertical move speed modifier\r\n    },\r\n    {\r\n      src: {\r\n        bool: button(\"leftTrigger\").pressed,\r\n        value: scaledLeftJoystickVertical\r\n      },\r\n      dest: { value: scaledLeftJoystickForwardAcceleration },\r\n      xform: disableForwardOnTrigger ? xforms.copyIfFalse : xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: scaledLeftJoystickHorizontal,\r\n        y: scaledLeftJoystickForwardAcceleration\r\n      },\r\n      dest: { value: paths.actions.characterAcceleration },\r\n      xform: xforms.compose_vec2\r\n    }\r\n  ];\r\n}\r\n\r\nexport const xboxControllerUserBindings = addSetsToBindings({\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: { value: button(\"rightTrigger\").pressed },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: button(\"rightTrigger\").pressed },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.falling,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: button(\"b\").pressed },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: button(\"y\").pressed },\r\n      dest: { value: paths.actions.cursor.right.undoDrawing },\r\n      xform: xforms.rising,\r\n      priority: 200\r\n    },\r\n    {\r\n      src: { value: button(\"a\").pressed },\r\n      dest: { value: paths.actions.cursor.right.penNextColor },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: button(\"x\").pressed },\r\n      dest: { value: paths.actions.cursor.right.penPrevColor },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n  [sets.global]: [\r\n    {\r\n      src: {},\r\n      dest: { value: paths.actions.cursor.right.hideLine },\r\n      xform: xforms.always(true)\r\n    },\r\n    {\r\n      src: { value: axis(\"rightJoystickHorizontal\") },\r\n      dest: { value: deadzonedRightJoystickHorizontal },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: deadzonedRightJoystickHorizontal },\r\n      dest: { value: paths.actions.angularVelocity },\r\n      xform: xforms.scale(0.6) // horizontal look speed modifier\r\n    },\r\n    {\r\n      src: { value: axis(\"rightJoystickVertical\") },\r\n      dest: { value: deadzonedRightJoystickVertical },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: deadzonedRightJoystickVertical },\r\n      dest: { value: scaledRightJoystickVertical },\r\n      xform: xforms.scale(-0.125) // vertical look speed modifier\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: zero },\r\n      xform: xforms.always(0)\r\n    },\r\n    {\r\n      src: {\r\n        x: zero,\r\n        y: scaledRightJoystickVertical\r\n      },\r\n      dest: { value: paths.actions.cameraDelta },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: { value: paths.actions.cameraDelta },\r\n      dest: { value: paths.actions.lobbyCameraDelta },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: axis(\"leftJoystickHorizontal\") },\r\n      dest: { value: deadzonedLeftJoystickHorizontal },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: axis(\"leftJoystickVertical\") },\r\n      dest: { value: deadzonedLeftJoystickVertical },\r\n      xform: xforms.deadzone(0.1)\r\n    },\r\n    {\r\n      src: { value: button(\"leftTrigger\").pressed },\r\n      dest: { value: paths.actions.boost },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: button(\"leftBumper\").pressed },\r\n      dest: { value: paths.actions.snapRotateLeft },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: button(\"rightBumper\").pressed },\r\n      dest: { value: paths.actions.snapRotateRight },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {},\r\n      dest: { value: vec2Zero },\r\n      xform: xforms.vec2Zero\r\n    },\r\n    {\r\n      src: { value: vec2Zero },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.poseFromCameraProjection()\r\n    },\r\n    {\r\n      src: { value: button(\"y\").pressed },\r\n      dest: { value: paths.actions.spawnPen },\r\n      xform: xforms.rising,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: button(\"dpadUp\").pressed },\r\n      dest: { value: paths.actions.ensureFrozen },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: button(\"dpadUp\").pressed },\r\n      dest: { value: paths.actions.thaw },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: { value: button(\"start\").pressed },\r\n      dest: { value: paths.actions.toggleFreeze },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: button(\"a\").pressed },\r\n      dest: { value: paths.actions.startGazeTeleport },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: button(\"a\").pressed },\r\n      dest: { value: paths.actions.stopGazeTeleport },\r\n      xform: xforms.falling\r\n    }\r\n  ],\r\n  [sets.rightCursorHoldingNothing]: [...characterAccelerationBindings()],\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    ...characterAccelerationBindings(true),\r\n    {\r\n      src: { value: button(\"rightTrigger\").pressed },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.falling,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: deadzonedLeftJoystickVertical },\r\n      dest: { value: scaledLeftJoystickCursorDelta },\r\n      xform: xforms.scale(0.25)\r\n    },\r\n    {\r\n      src: {\r\n        bool: button(\"leftTrigger\").pressed,\r\n        value: scaledLeftJoystickCursorDelta\r\n      },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.copyIfTrue\r\n    }\r\n  ],\r\n  [sets.rightCursorHoveringOnUI]: [\r\n    {\r\n      src: { value: button(\"rightTrigger\").pressed },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising\r\n    }\r\n  ],\r\n  [sets.rightCursorHoveringOnInteractable]: [\r\n    ...characterAccelerationBindings(),\r\n    {\r\n      src: { value: button(\"rightTrigger\").pressed },\r\n      dest: { value: paths.actions.cursor.right.grab },\r\n      xform: xforms.rising,\r\n      priority: 100\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\n// vars\r\nconst v = s => `/vars/daydream/${s}`;\r\nconst touchpad = v(\"touchpad/axis\");\r\nconst touchpadRising = v(\"touchpad/rising\");\r\nconst touchpadFalling = v(\"touchpad/falling\");\r\nconst touchpadPressed = v(\"touchpad/pressed\");\r\nconst dpadNorth = v(\"dpad/north\");\r\nconst dpadSouth = v(\"dpad/south\");\r\nconst dpadEast = v(\"dpad/east\");\r\nconst dpadWest = v(\"dpad/west\");\r\nconst dpadCenter = v(\"dpad/center\");\r\nconst brushSizeDelta = v(\"brushSizeDelta\");\r\nconst cursorModDelta = v(\"cursorModDelta\");\r\nconst dpadSouthDrop = v(\"dropSouth\");\r\nconst dpadCenterDrop = v(\"dropCenter\");\r\n\r\nconst grabBinding = [\r\n  {\r\n    src: { value: dpadCenter, bool: touchpadRising },\r\n    dest: { value: paths.actions.cursor.right.grab },\r\n    xform: xforms.copyIfTrue,\r\n    priority: 100\r\n  }\r\n];\r\n\r\nconst dropOnCenterOrSouth = [\r\n  {\r\n    src: { value: dpadCenter, bool: touchpadRising },\r\n    dest: { value: dpadCenterDrop },\r\n    xform: xforms.copyIfTrue,\r\n    priority: 100\r\n  },\r\n  {\r\n    src: { value: dpadSouth, bool: touchpadRising },\r\n    dest: { value: dpadSouthDrop },\r\n    xform: xforms.copyIfTrue,\r\n    priority: 100\r\n  },\r\n  {\r\n    src: [dpadCenterDrop, dpadSouthDrop],\r\n    dest: { value: paths.actions.cursor.right.drop },\r\n    xform: xforms.any\r\n  }\r\n];\r\n\r\nexport const daydreamUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: { value: paths.device.daydream.matrix },\r\n      dest: { value: paths.actions.rightHand.matrix },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        x: paths.device.daydream.axis(\"touchpadX\"),\r\n        y: paths.device.daydream.axis(\"touchpadY\")\r\n      },\r\n      dest: { value: touchpad },\r\n      xform: xforms.compose_vec2\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.button(\"touchpad\").pressed\r\n      },\r\n      dest: { value: touchpadRising },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.button(\"touchpad\").pressed\r\n      },\r\n      dest: { value: touchpadFalling },\r\n      xform: xforms.falling\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.button(\"touchpad\").pressed\r\n      },\r\n      dest: { value: touchpadPressed },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: touchpad\r\n      },\r\n      dest: {\r\n        north: dpadNorth,\r\n        south: dpadSouth,\r\n        east: dpadEast,\r\n        west: dpadWest,\r\n        center: dpadCenter\r\n      },\r\n      xform: xforms.vec2dpad(0.5)\r\n    },\r\n    {\r\n      src: {\r\n        value: dpadEast,\r\n        bool: touchpadRising\r\n      },\r\n      dest: {\r\n        value: paths.actions.snapRotateRight\r\n      },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: {\r\n        value: dpadWest,\r\n        bool: touchpadRising\r\n      },\r\n      dest: {\r\n        value: paths.actions.snapRotateLeft\r\n      },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: {\r\n        value: dpadCenter,\r\n        bool: touchpadRising\r\n      },\r\n      dest: { value: paths.actions.rightHand.startTeleport },\r\n      xform: xforms.copyIfTrue\r\n    },\r\n    {\r\n      src: { value: paths.device.daydream.pose },\r\n      dest: { value: paths.actions.cursor.right.pose },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: { value: paths.device.daydream.pose },\r\n      dest: { value: paths.actions.rightHand.pose },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoveringOnInteractable]: grabBinding,\r\n  [sets.rightCursorHoveringOnUI]: grabBinding,\r\n\r\n  [sets.rightCursorHoveringOnVideo]: [\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.axis(\"touchpadY\"),\r\n        touching: paths.device.daydream.button(\"touchpad\").touched\r\n      },\r\n      dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n      xform: xforms.touch_axis_scroll(-0.1)\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingInteractable]: [\r\n    {\r\n      src: { value: touchpadFalling },\r\n      dest: { value: paths.actions.cursor.right.drop },\r\n      xform: xforms.copy\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.axis(\"touchpadY\"),\r\n        touching: paths.device.daydream.button(\"touchpad\").touched\r\n      },\r\n      dest: { value: cursorModDelta },\r\n      xform: xforms.touch_axis_scroll()\r\n    },\r\n    {\r\n      src: { value: cursorModDelta },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n\r\n  [sets.rightHandTeleporting]: [\r\n    {\r\n      src: { value: touchpadFalling },\r\n      dest: { value: paths.actions.rightHand.stopTeleport },\r\n      xform: xforms.copy\r\n    }\r\n  ],\r\n\r\n  [sets.rightCursorHoldingPen]: [\r\n    {\r\n      src: { value: dpadNorth, bool: touchpadRising },\r\n      dest: { value: paths.actions.cursor.right.startDrawing },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: touchpadFalling },\r\n      dest: { value: paths.actions.cursor.right.stopDrawing },\r\n      xform: xforms.copy,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: {\r\n        value: paths.device.daydream.axis(\"touchpadX\"),\r\n        touching: paths.device.daydream.button(\"touchpad\").touched\r\n      },\r\n      dest: { value: brushSizeDelta },\r\n      xform: xforms.touch_axis_scroll(-0.1)\r\n    },\r\n    {\r\n      src: {\r\n        value: brushSizeDelta,\r\n        bool: touchpadPressed\r\n      },\r\n      dest: { value: paths.actions.cursor.right.scalePenTip },\r\n      xform: xforms.copyIfFalse,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: dpadEast, bool: touchpadRising },\r\n      dest: {\r\n        value: paths.actions.cursor.right.penPrevColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: { value: dpadWest, bool: touchpadRising },\r\n      dest: {\r\n        value: paths.actions.cursor.right.penNextColor\r\n      },\r\n      xform: xforms.copyIfTrue,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: {\r\n        value: cursorModDelta,\r\n        bool: touchpadPressed\r\n      },\r\n      dest: { value: paths.actions.cursor.right.modDelta },\r\n      xform: xforms.copyIfFalse,\r\n      priority: 100\r\n    },\r\n    ...dropOnCenterOrSouth\r\n  ],\r\n\r\n  [sets.rightCursorHoldingCamera]: [\r\n    // Don't drop on touchpad release\r\n    {\r\n      src: {\r\n        value: touchpadFalling\r\n      },\r\n      xform: xforms.noop,\r\n      priority: 100\r\n    },\r\n    {\r\n      src: {\r\n        value: dpadNorth,\r\n        bool: touchpadRising\r\n      },\r\n      dest: { value: paths.actions.cursor.right.takeSnapshot },\r\n      xform: xforms.copy,\r\n      priority: 100\r\n    },\r\n    ...dropOnCenterOrSouth\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nexport const cardboardUserBindings = addSetsToBindings({\r\n  [sets.global]: [\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouching },\r\n      dest: {\r\n        value: paths.actions.startGazeTeleport\r\n      },\r\n      xform: xforms.rising\r\n    },\r\n    {\r\n      src: { value: paths.device.touchscreen.isTouching },\r\n      dest: {\r\n        value: paths.actions.stopGazeTeleport\r\n      },\r\n      xform: xforms.falling\r\n    }\r\n  ]\r\n});\r\n","import { paths } from \"../paths\";\r\nimport { sets } from \"../sets\";\r\nimport { xforms } from \"./xforms\";\r\nimport { addSetsToBindings } from \"./utils\";\r\n\r\nexport default function generate3DOFTriggerBindings(device) {\r\n  const touchpad = device.v(\"touchpad\");\r\n  const touchpadButton = device.button(\"touchpad\");\r\n  const triggerButton = device.button(\"trigger\");\r\n  const touchpadX = device.axis(\"touchpadX\");\r\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\r\n  const touchpadY = device.axis(\"touchpadY\");\r\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\r\n  const touchpadRising = device.v(\"touchpad/rising\");\r\n  const touchpadFalling = device.v(\"touchpad/falling\");\r\n  const triggerRising = device.v(\"trigger/rising\");\r\n  const triggerFalling = device.v(\"trigger/falling\");\r\n  const dpadNorth = device.v(\"dpad/north\");\r\n  const dpadSouth = device.v(\"dpad/south\");\r\n  const dpadEast = device.v(\"dpad/east\");\r\n  const dpadWest = device.v(\"dpad/west\");\r\n  const dpadCenter = device.v(\"dpad/center\");\r\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\r\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\r\n  const togglePen = \"/vars/oculus-go/togglePen\";\r\n\r\n  const grabBinding = {\r\n    src: {\r\n      value: triggerRising\r\n    },\r\n    dest: { value: paths.actions.cursor.right.grab },\r\n    xform: xforms.copy,\r\n    priority: 200\r\n  };\r\n  const dropBinding = {\r\n    src: {\r\n      value: triggerFalling\r\n    },\r\n    dest: { value: paths.actions.cursor.right.drop },\r\n    xform: xforms.copy,\r\n    priority: 200\r\n  };\r\n\r\n  return addSetsToBindings({\r\n    [sets.global]: [\r\n      {\r\n        src: { value: device.matrix },\r\n        dest: { value: paths.actions.rightHand.matrix },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: {\r\n          value: triggerButton.pressed\r\n        },\r\n        dest: { value: triggerRising },\r\n        xform: xforms.rising\r\n      },\r\n      {\r\n        src: {\r\n          value: triggerButton.pressed\r\n        },\r\n        dest: { value: triggerFalling },\r\n        xform: xforms.falling\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpadButton.pressed\r\n        },\r\n        dest: { value: touchpadRising },\r\n        xform: xforms.rising,\r\n        priority: 100\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpadButton.pressed\r\n        },\r\n        dest: { value: touchpadFalling },\r\n        xform: xforms.falling,\r\n        priority: 100\r\n      },\r\n      {\r\n        src: {\r\n          x: touchpadX,\r\n          y: touchpadY\r\n        },\r\n        dest: { value: touchpad },\r\n        xform: xforms.compose_vec2\r\n      },\r\n      {\r\n        src: { value: touchpadX },\r\n        dest: { value: touchpadXForPen },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: { value: touchpadY },\r\n        dest: { value: touchpadYForPen },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpad\r\n        },\r\n        dest: {\r\n          north: dpadNorth,\r\n          south: dpadSouth,\r\n          east: dpadEast,\r\n          west: dpadWest,\r\n          center: dpadCenter\r\n        },\r\n        xform: xforms.vec2dpad(0.3)\r\n      },\r\n      {\r\n        src: [dpadCenter, dpadSouth],\r\n        dest: { value: dpadBottomCenterStrip },\r\n        xform: xforms.any\r\n      },\r\n      {\r\n        src: [dpadNorth, dpadBottomCenterStrip],\r\n        dest: { value: dpadCenterStrip },\r\n        xform: xforms.any\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadCenterStrip,\r\n          bool: touchpadButton.pressed\r\n        },\r\n        dest: {\r\n          value: paths.actions.ensureFrozen\r\n        },\r\n        priority: 100,\r\n        xform: xforms.copyIfTrue\r\n      },\r\n      {\r\n        src: { value: touchpadFalling },\r\n        dest: {\r\n          value: paths.actions.thaw\r\n        },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadEast,\r\n          bool: touchpadRising\r\n        },\r\n        dest: {\r\n          value: paths.actions.snapRotateRight\r\n        },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 100\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadWest,\r\n          bool: touchpadRising\r\n        },\r\n        dest: {\r\n          value: paths.actions.snapRotateLeft\r\n        },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 100\r\n      },\r\n      {\r\n        src: {\r\n          value: triggerRising\r\n        },\r\n        dest: { value: paths.actions.rightHand.startTeleport },\r\n        xform: xforms.copy,\r\n        priority: 100\r\n      },\r\n      {\r\n        src: { value: device.pose },\r\n        dest: { value: paths.actions.cursor.right.pose },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: { value: device.pose },\r\n        dest: { value: paths.actions.rightHand.pose },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: { value: touchpadButton.touched },\r\n        dest: { value: paths.actions.rightHand.thumb },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: { value: triggerButton.pressed },\r\n        dest: { value: paths.actions.rightHand.index },\r\n        xform: xforms.copy\r\n      },\r\n      {\r\n        src: { value: triggerButton.pressed },\r\n        dest: { value: paths.actions.rightHand.middleRingPinky },\r\n        xform: xforms.copy\r\n      }\r\n    ],\r\n\r\n    [sets.rightCursorHoveringOnInteractable]: [grabBinding],\r\n    [sets.rightCursorHoveringOnUI]: [grabBinding],\r\n    [sets.rightCursorHoldingUI]: [dropBinding],\r\n    [sets.rightCursorHoveringOnVideo]: [\r\n      {\r\n        src: {\r\n          value: touchpadY,\r\n          touching: touchpadButton.touched\r\n        },\r\n        dest: { value: paths.actions.cursor.right.mediaVolumeMod },\r\n        xform: xforms.touch_axis_scroll(-0.1)\r\n      }\r\n    ],\r\n\r\n    [sets.rightCursorHoldingInteractable]: [\r\n      {\r\n        src: {\r\n          value: triggerFalling\r\n        },\r\n        dest: { value: paths.actions.cursor.right.drop },\r\n        xform: xforms.copy,\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpadY,\r\n          touching: touchpadButton.touched\r\n        },\r\n        dest: { value: paths.actions.cursor.right.modDelta },\r\n        xform: xforms.touch_axis_scroll()\r\n      },\r\n      {\r\n        src: { value: dpadCenterStrip },\r\n        priority: 200,\r\n        xform: xforms.noop\r\n      }\r\n    ],\r\n\r\n    [sets.rightHandTeleporting]: [\r\n      {\r\n        src: {\r\n          value: triggerFalling\r\n        },\r\n        dest: { value: paths.actions.rightHand.stopTeleport },\r\n        xform: xforms.copy,\r\n        priority: 100\r\n      }\r\n    ],\r\n\r\n    [sets.rightCursorHoldingPen]: [\r\n      {\r\n        src: {\r\n          value: triggerRising\r\n        },\r\n        dest: { value: paths.actions.cursor.right.startDrawing },\r\n        xform: xforms.copy,\r\n        priority: 300\r\n      },\r\n      {\r\n        src: {\r\n          value: triggerFalling\r\n        },\r\n        dest: { value: paths.actions.cursor.right.stopDrawing },\r\n        xform: xforms.copy,\r\n        priority: 300\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpadXForPen,\r\n          touching: touchpadButton.touched\r\n        },\r\n        dest: { value: paths.actions.cursor.right.scalePenTip },\r\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: touchpadYForPen,\r\n          touching: touchpadButton.touched\r\n        },\r\n        dest: { value: paths.actions.cursor.right.modDelta },\r\n        xform: xforms.touch_axis_scroll(1, 0.1),\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadBottomCenterStrip,\r\n          bool: touchpadFalling\r\n        },\r\n        dest: { value: togglePen },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 300\r\n      },\r\n      {\r\n        src: { value: togglePen },\r\n        dest: { value: paths.actions.cursor.right.drop },\r\n        xform: xforms.rising,\r\n        priority: 200\r\n      },\r\n      {\r\n        src: { value: togglePen },\r\n        dest: { value: paths.actions.pen.remove },\r\n        xform: xforms.rising,\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadEast,\r\n          bool: touchpadRising\r\n        },\r\n        dest: {\r\n          value: paths.actions.cursor.right.penPrevColor\r\n        },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadWest,\r\n          bool: touchpadRising\r\n        },\r\n        dest: {\r\n          value: paths.actions.cursor.right.penNextColor\r\n        },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 200\r\n      },\r\n      {\r\n        src: {\r\n          value: dpadNorth,\r\n          bool: touchpadRising\r\n        },\r\n        dest: {\r\n          value: paths.actions.cursor.right.undoDrawing\r\n        },\r\n        xform: xforms.copyIfTrue,\r\n        priority: 200\r\n      }\r\n    ],\r\n\r\n    [sets.rightCursorHoldingCamera]: [\r\n      {\r\n        src: {\r\n          value: triggerRising\r\n        },\r\n        dest: { value: paths.actions.cursor.right.takeSnapshot },\r\n        xform: xforms.copy,\r\n        priority: 300\r\n      }\r\n    ]\r\n  });\r\n}\r\n","import { sets } from \"./sets\";\r\nimport { isUI } from \"./../interactions\";\r\nimport { CAMERA_MODE_INSPECT } from \"../camera-system\";\r\nimport qsTruthy from \"../../utils/qs_truthy\";\r\nconst debugUserInput = qsTruthy(\"dui\");\r\n\r\nlet leftTeleporter, rightTeleporter;\r\n\r\nexport function resolveActionSets() {\r\n  leftTeleporter =\r\n    leftTeleporter ||\r\n    (document.getElementById(\"player-left-controller\") &&\r\n      document.getElementById(\"player-left-controller\").components.teleporter);\r\n  rightTeleporter =\r\n    rightTeleporter ||\r\n    (document.getElementById(\"player-right-controller\") &&\r\n      document.getElementById(\"player-right-controller\").components.teleporter);\r\n  if (!leftTeleporter || !rightTeleporter) return;\r\n  const userinput = AFRAME.scenes[0].systems.userinput;\r\n  const { leftHand, rightHand, rightRemote, leftRemote } = AFRAME.scenes[0].systems.interaction.state;\r\n\r\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHand.held);\r\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHand.held);\r\n  userinput.toggleSet(sets.leftCursorHoldingInteractable, leftRemote.held);\r\n  userinput.toggleSet(sets.rightCursorHoldingInteractable, rightRemote.held);\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoveringOnNothing,\r\n    !leftRemote.held && !leftRemote.hovered && !leftHand.held && !leftHand.hovered\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoveringOnNothing,\r\n    !rightRemote.held && !rightRemote.hovered && !rightHand.held && !rightHand.hovered\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnNothing,\r\n    !leftHand.held && !leftHand.hovered && !leftRemote.held && !leftRemote.hovered\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnNothing,\r\n    !rightHand.held && !rightHand.hovered && !rightRemote.held && !rightRemote.hovered\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoveringOnPen,\r\n    !leftHand.held &&\r\n      leftHand.hovered &&\r\n      leftHand.hovered.components.tags &&\r\n      leftHand.hovered.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoveringOnPen,\r\n    !rightHand.held &&\r\n      rightHand.hovered &&\r\n      rightHand.hovered.components.tags &&\r\n      rightHand.hovered.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnPen,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      !leftRemote.held &&\r\n      leftRemote.hovered &&\r\n      leftRemote.hovered.components.tags &&\r\n      leftRemote.hovered.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnPen,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      !rightRemote.held &&\r\n      rightRemote.hovered &&\r\n      rightRemote.hovered.components.tags &&\r\n      rightRemote.hovered.components.tags.data.isPen\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoveringOnCamera,\r\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"camera-tool\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoveringOnCamera,\r\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"camera-tool\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnCamera,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      !leftRemote.held &&\r\n      leftRemote.hovered &&\r\n      leftRemote.hovered.components[\"camera-tool\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnCamera,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      !rightRemote.held &&\r\n      rightRemote.hovered &&\r\n      rightRemote.hovered.components[\"camera-tool\"]\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoveringOnInteractable,\r\n    !leftHand.held &&\r\n      leftHand.hovered &&\r\n      ((leftHand.hovered.components.tags && leftHand.hovered.components.tags.data.offersHandConstraint) ||\r\n        leftHand.hovered.components[\"super-spawner\"])\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoveringOnInteractable,\r\n    !rightHand.held &&\r\n      rightHand.hovered &&\r\n      ((rightHand.hovered.components.tags && rightHand.hovered.components.tags.data.offersHandConstraint) ||\r\n        rightHand.hovered.components[\"super-spawner\"])\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnInteractable,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      !leftRemote.held &&\r\n      leftRemote.hovered &&\r\n      ((leftRemote.hovered.components.tags && leftRemote.hovered.components.tags.data.offersRemoteConstraint) ||\r\n        (leftRemote.hovered.components.tags && leftRemote.hovered.components.tags.data.togglesHoveredActionSet) ||\r\n        leftRemote.hovered.components[\"super-spawner\"])\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnInteractable,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      !rightRemote.held &&\r\n      rightRemote.hovered &&\r\n      ((rightRemote.hovered.components.tags && rightRemote.hovered.components.tags.data.offersRemoteConstraint) ||\r\n        (rightRemote.hovered.components.tags && rightRemote.hovered.components.tags.data.togglesHoveredActionSet) ||\r\n        rightRemote.hovered.components[\"super-spawner\"])\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoveringOnVideo,\r\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"media-video\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoveringOnVideo,\r\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"media-video\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnVideo,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      !leftRemote.held &&\r\n      leftRemote.hovered &&\r\n      leftRemote.hovered.components[\"media-video\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnVideo,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      !rightRemote.held &&\r\n      rightRemote.hovered &&\r\n      rightRemote.hovered.components[\"media-video\"]\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftHandHoldingPen,\r\n    leftHand.held && leftHand.held.components.tags && leftHand.held.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightHandHoldingPen,\r\n    rightHand.held && rightHand.held.components.tags && rightHand.held.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoldingPen,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      rightRemote.held &&\r\n      rightRemote.held.components.tags &&\r\n      rightRemote.held.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoldingPen,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      leftRemote.held &&\r\n      leftRemote.held.components.tags &&\r\n      leftRemote.held.components.tags.data.isPen\r\n  );\r\n  userinput.toggleSet(sets.leftHandHoldingCamera, leftHand.held && leftHand.held.components[\"camera-tool\"]);\r\n  userinput.toggleSet(sets.rightHandHoldingCamera, rightHand.held && rightHand.held.components[\"camera-tool\"]);\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoldingCamera,\r\n    !leftHand.held && !leftHand.hovered && leftRemote.held && leftRemote.held.components[\"camera-tool\"]\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoldingCamera,\r\n    !rightHand.held && !rightHand.hovered && rightRemote.held && rightRemote.held.components[\"camera-tool\"]\r\n  );\r\n\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoveringOnUI,\r\n    !leftHand.held && !leftHand.hovered && !leftRemote.held && isUI(leftRemote.hovered)\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoveringOnUI,\r\n    !rightHand.held && !rightHand.hovered && !rightRemote.held && isUI(rightRemote.hovered)\r\n  );\r\n\r\n  userinput.toggleSet(sets.leftCursorHoldingNothing, !leftHand.held && !leftRemote.held);\r\n  userinput.toggleSet(sets.rightCursorHoldingNothing, !rightHand.held && !rightRemote.held);\r\n\r\n  userinput.toggleSet(\r\n    sets.leftCursorHoldingUI,\r\n    !leftHand.held &&\r\n      !leftHand.hovered &&\r\n      leftRemote.held &&\r\n      leftRemote.held.components.tags &&\r\n      leftRemote.held.components.tags.data.holdableButton\r\n  );\r\n  userinput.toggleSet(\r\n    sets.rightCursorHoldingUI,\r\n    !rightHand.held &&\r\n      !rightHand.hovered &&\r\n      rightRemote.held &&\r\n      rightRemote.held.components.tags &&\r\n      rightRemote.held.components.tags.data.holdableButton\r\n  );\r\n\r\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\r\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\r\n\r\n  userinput.toggleSet(\r\n    sets.inputFocused,\r\n    document.activeElement.nodeName === \"INPUT\" ||\r\n      document.activeElement.nodeName === \"TEXTAREA\" ||\r\n      document.activeElement.contentEditable === \"true\"\r\n  );\r\n\r\n  userinput.toggleSet(sets.debugUserInput, debugUserInput);\r\n\r\n  if (AFRAME.scenes[0] && AFRAME.scenes[0].systems[\"hubs-systems\"]) {\r\n    userinput.toggleSet(\r\n      sets.inspecting,\r\n      AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT\r\n    );\r\n  }\r\n}\r\n","import { paths } from \"../paths\";\r\n\r\nexport class GamepadDevice {\r\n  constructor(gamepad) {\r\n    this.gamepad = gamepad;\r\n  }\r\n\r\n  write(frame) {\r\n    if (this.gamepad.connected) {\r\n      this.gamepad.buttons.forEach((button, i) => {\r\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\r\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\r\n        frame.setValueType(buttonPath.touched, !!button.touched);\r\n        frame.setValueType(buttonPath.value, button.value);\r\n      });\r\n      this.gamepad.axes.forEach((axis, i) => {\r\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\r\n      });\r\n    }\r\n  }\r\n}\r\n","export const gamepadBindings = {};\r\n","import { sets } from \"./sets\";\r\nimport { paths } from \"./paths\";\r\n\r\nimport { MouseDevice } from \"./devices/mouse\";\r\nimport { KeyboardDevice } from \"./devices/keyboard\";\r\nimport { HudDevice } from \"./devices/hud\";\r\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\r\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\r\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\r\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\r\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\r\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\r\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\r\nimport { GyroDevice } from \"./devices/gyro\";\r\n\r\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\r\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\r\n\r\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\r\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\r\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\r\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\r\nimport {\r\n  viveUserBindings,\r\n  viveWandUserBindings,\r\n  indexUserBindings,\r\n  viveFocusPlusUserBindings,\r\n  viveCosmosUserBindings\r\n} from \"./bindings/vive-user\";\r\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\r\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\r\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\r\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\r\n\r\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\r\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\r\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\r\n\r\nimport { resolveActionSets } from \"./resolve-action-sets\";\r\nimport { GamepadDevice } from \"./devices/gamepad\";\r\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\r\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\r\nimport { hackyMobileSafariTest } from \"../../utils/detect-touchscreen\";\r\nimport { ArrayBackedSet } from \"./array-backed-set\";\r\n\r\nfunction arrayContentsDiffer(a, b) {\r\n  if (a.length !== b.length) return true;\r\n\r\n  for (let i = 0, il = a.length; i < il; i++) {\r\n    const elem = a[i];\r\n    let found = false;\r\n\r\n    for (let j = 0, jl = b.length; j < jl; j++) {\r\n      if (elem === b[j]) {\r\n        found = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!found) return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nconst satisfiesPath = (binding, path) => {\r\n  for (const key in binding.dest) {\r\n    if (binding.dest[key].indexOf(path) !== -1) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nconst satisfyPath = (bindings, path) => {\r\n  for (const binding of bindings) {\r\n    if (satisfiesPath(binding, path)) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nconst satisfiedBy = (binding, bindings) => {\r\n  for (const path of Object.values(binding.src)) {\r\n    if (path.startsWith(\"/device/\")) continue;\r\n    if (!satisfyPath(bindings, path)) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nfunction dependencySort(mappings) {\r\n  const unsorted = [];\r\n  for (const mapping of mappings) {\r\n    for (const setName in mapping) {\r\n      for (const binding of mapping[setName]) {\r\n        unsorted.push(binding);\r\n      }\r\n    }\r\n  }\r\n\r\n  const sorted = [];\r\n  while (unsorted.length > 0) {\r\n    const binding = unsorted.shift();\r\n    if (satisfiedBy(binding, sorted)) {\r\n      sorted.push(binding);\r\n    } else {\r\n      unsorted.push(binding);\r\n    }\r\n  }\r\n\r\n  return sorted;\r\n}\r\n\r\nfunction notEmpty(s) {\r\n  return s !== \"\";\r\n}\r\n\r\nfunction isSubpath(subpath, path) {\r\n  const a = subpath.split(\"/\").filter(notEmpty);\r\n  const b = path.split(\"/\").filter(notEmpty);\r\n  if (a.length > b.length) return false;\r\n  for (let i = 0; i < a.length; i++) {\r\n    if (a[i] !== b[i]) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction canMask(masker, masked) {\r\n  if (masker.priority === undefined) {\r\n    masker.priority = 0;\r\n  }\r\n  if (masked.priority === undefined) {\r\n    masked.priority = 0;\r\n  }\r\n  if (masked.priority >= masker.priority) return false;\r\n  for (const maskerKey in masker.src) {\r\n    const maskerPath = masker.src[maskerKey];\r\n    for (const maskedKey in masked.src) {\r\n      const maskedPath = masked.src[maskedKey];\r\n      if (maskedPath.indexOf(maskerPath) !== -1 && isSubpath(maskerPath, maskedPath)) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction computeMasks(bindings) {\r\n  const masks = new Array(bindings.length);\r\n  for (let row = 0; row < bindings.length; row++) {\r\n    const masksRow = (masks[row] = []);\r\n    const bindingsRow = bindings[row];\r\n    for (let col = 0; col < bindings.length; col++) {\r\n      if (canMask(bindings[col], bindingsRow)) {\r\n        masksRow.push(col);\r\n      }\r\n    }\r\n  }\r\n  return masks;\r\n}\r\n\r\nfunction isActive(binding, sets) {\r\n  for (let i = 0; i < binding.sets.length; i++) {\r\n    if (sets.includes(binding.sets[i])) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\r\n  const actives = new Array(sortedBindings.length);\r\n  for (let row = 0; row < sortedBindings.length; row++) {\r\n    actives[row] = isActive(sortedBindings[row], activeSets);\r\n  }\r\n\r\n  const masked = new Array(sortedBindings.length);\r\n  for (let row = 0; row < sortedBindings.length; row++) {\r\n    const maskedRow = (masked[row] = []);\r\n    const masksRow = masks[row];\r\n    for (let col = 0; col < sortedBindings.length; col++) {\r\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\r\n        maskedRow.push(col);\r\n      }\r\n    }\r\n  }\r\n\r\n  return { actives, masked };\r\n}\r\n\r\nAFRAME.registerSystem(\"userinput\", {\r\n  get(path) {\r\n    if (!this.frame) return;\r\n    return this.frame.get(path);\r\n  },\r\n\r\n  toggleSet(set, value) {\r\n    this.pendingSetChanges.push(set);\r\n    this.pendingSetChanges.push(!!value);\r\n  },\r\n\r\n  init() {\r\n    this.frame = {\r\n      generation: 0,\r\n      values: {},\r\n      generations: {},\r\n      get: function(path) {\r\n        if (this.generations[path] !== this.generation) return undefined;\r\n        return this.values[path];\r\n      },\r\n      setValueType: function(path, value) {\r\n        this.values[path] = value;\r\n        this.generations[path] = this.generation;\r\n      },\r\n      setVector2: function(path, a, b) {\r\n        const value = this.values[path] || [];\r\n        value[0] = a;\r\n        value[1] = b;\r\n        this.values[path] = value;\r\n        this.generations[path] = this.generation;\r\n      },\r\n      setPose: function(path, pose) {\r\n        this.setValueType(path, pose);\r\n      },\r\n      setMatrix4: function(path, mat4) {\r\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\r\n        const value = this.values[path] || new THREE.Matrix4();\r\n        value.copy(mat4);\r\n        this.values[path] = value;\r\n        this.generations[path] = this.generation;\r\n      }\r\n    };\r\n\r\n    this.prevActiveSets = [];\r\n    this.activeSets = [sets.global];\r\n    this.pendingSetChanges = [];\r\n    this.xformStates = new Map();\r\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\r\n\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n    const forceEnableTouchscreen = hackyMobileSafariTest();\r\n\r\n    if (!(isMobile || isMobileVR || forceEnableTouchscreen)) {\r\n      this.activeDevices.add(new MouseDevice());\r\n      this.activeDevices.add(new AppAwareMouseDevice());\r\n      this.activeDevices.add(new KeyboardDevice());\r\n    } else if (!isMobileVR || forceEnableTouchscreen) {\r\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\r\n      this.activeDevices.add(new KeyboardDevice());\r\n      this.activeDevices.add(new GyroDevice());\r\n    }\r\n\r\n    this.isMobile = isMobile;\r\n    this.isMobileVR = isMobileVR;\r\n\r\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\r\n    this.registeredMappingsChanged = true;\r\n\r\n    const vrGamepadMappings = new Map();\r\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\r\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\r\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\r\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\r\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\r\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\r\n\r\n    const nonVRGamepadMappings = new Map();\r\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\r\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\r\n\r\n    const addExtraMappings = activeDevice => {\r\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\r\n        if (activeDevice.gamepad.id === \"OpenVR Cosmos\") {\r\n          //HTC Vive Cosmos Controller\r\n          this.registeredMappings.add(viveCosmosUserBindings);\r\n        } else if (activeDevice.gamepad.id === \"HTC Vive Focus Plus Controller\") {\r\n          //HTC Vive Focus Plus Controller\r\n          this.registeredMappings.add(viveFocusPlusUserBindings);\r\n        } else if (activeDevice.gamepad.axes.length === 4) {\r\n          //Valve Index Controller\r\n          this.registeredMappings.add(indexUserBindings);\r\n        } else {\r\n          //HTC Vive Controller (wands)\r\n          this.registeredMappings.add(viveWandUserBindings);\r\n        }\r\n      }\r\n    };\r\n\r\n    const deleteExtraMappings = activeDevice => {\r\n      if (activeDevice instanceof ViveControllerDevice && activeDevice.gamepad) {\r\n        this.registeredMappings.delete(viveCosmosUserBindings);\r\n        this.registeredMappings.delete(viveFocusPlusUserBindings);\r\n        this.registeredMappings.delete(indexUserBindings);\r\n        this.registeredMappings.delete(viveWandUserBindings);\r\n      }\r\n    };\r\n\r\n    const updateBindingsForVRMode = () => {\r\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\r\n      const isMobile = AFRAME.utils.device.isMobile();\r\n      const forceEnableTouchscreen = hackyMobileSafariTest();\r\n\r\n      if (inVRMode) {\r\n        console.log(\"Using VR bindings.\");\r\n        this.registeredMappings.delete(\r\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\r\n        );\r\n        // add mappings for all active VR input devices\r\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n          const activeDevice = this.activeDevices.items[i];\r\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\r\n          mapping && this.registeredMappings.add(mapping);\r\n          addExtraMappings(activeDevice);\r\n        }\r\n\r\n        // Handle cardboard by looking of VR device caps\r\n        if (isMobile) {\r\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\r\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\r\n              this.registeredMappings.add(cardboardUserBindings);\r\n              this.registeredMappingsChanged = true;\r\n            }\r\n          });\r\n        }\r\n      } else {\r\n        console.log(\"Using Non-VR bindings.\");\r\n        // remove mappings for all active VR input devices\r\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n          const activeDevice = this.activeDevices.items[i];\r\n          deleteExtraMappings(activeDevice);\r\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\r\n        }\r\n        this.registeredMappings.add(\r\n          isMobile || forceEnableTouchscreen ? touchscreenUserBindings : keyboardMouseUserBindings\r\n        );\r\n      }\r\n\r\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n        const activeDevice = this.activeDevices.items[i];\r\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\r\n        mapping && this.registeredMappings.add(mapping);\r\n      }\r\n\r\n      this.registeredMappingsChanged = true;\r\n    };\r\n\r\n    const gamepadConnected = e => {\r\n      let gamepadDevice;\r\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n        const activeDevice = this.activeDevices.items[i];\r\n        if (activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\r\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\r\n          return; // multiple connect events without a disconnect event\r\n        }\r\n      }\r\n      // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\r\n      if (\r\n        e.gamepad.id.startsWith(\"OpenVR Gamepad\") ||\r\n        e.gamepad.id === \"HTC Vive Focus Plus Controller\" ||\r\n        e.gamepad.id === \"OpenVR Cosmos\"\r\n      ) {\r\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\") || e.gamepad.id.startsWith(\"Pico Neo 2\")) {\r\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\r\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.id === \"Oculus Go Controller\" || e.gamepad.id === \"Pico G2 Controller\") {\r\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\r\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.id === \"Daydream Controller\") {\r\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\r\n      } else if (e.gamepad.mapping === \"standard\") {\r\n        // Our XboxController device and bindings should be generic enough for most gamepads.\r\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\r\n      } else {\r\n        // This device doesn't actually have any bindings, but we need to fallback to something.\r\n        gamepadDevice = new GamepadDevice(e.gamepad);\r\n      }\r\n\r\n      this.activeDevices.add(gamepadDevice);\r\n\r\n      updateBindingsForVRMode();\r\n    };\r\n\r\n    const gamepadDisconnected = e => {\r\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n        const device = this.activeDevices.items[i];\r\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\r\n          this.registeredMappings.delete(\r\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\r\n          );\r\n          this.activeDevices.delete(device);\r\n          return;\r\n        }\r\n      }\r\n\r\n      updateBindingsForVRMode();\r\n    };\r\n\r\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\r\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\r\n    for (const gamepad of navigator.getGamepads()) {\r\n      gamepad && gamepadConnected({ gamepad });\r\n    }\r\n\r\n    this.el.sceneEl.addEventListener(\"enter-vr\", updateBindingsForVRMode);\r\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\r\n\r\n    updateBindingsForVRMode();\r\n  },\r\n\r\n  maybeToggleXboxMapping() {\r\n    if (hackyMobileSafariTest() || this.isMobile || this.isMobileVR) return;\r\n\r\n    const vrAxesSum =\r\n      (this.get(paths.device.vive.left.axesSum) || 0) +\r\n      (this.get(paths.device.vive.right.axesSum) || 0) +\r\n      (this.get(paths.device.leftOculusTouch.axesSum) || 0) +\r\n      (this.get(paths.device.rightOculusTouch.axesSum) || 0);\r\n    const mouseMovement = this.get(paths.device.mouse.movementXY);\r\n    const nonXboxActivity = (mouseMovement && (mouseMovement[0] || mouseMovement[1])) > 2 || vrAxesSum > 0.5;\r\n\r\n    const hasXboxMapping = this.registeredMappings.has(xboxControllerUserBindings);\r\n\r\n    if (nonXboxActivity && hasXboxMapping) {\r\n      this.registeredMappings.delete(xboxControllerUserBindings);\r\n      this.registeredMappingsChanged = true;\r\n    } else if (this.get(paths.device.xbox.axesSum) > 0.5 && !hasXboxMapping) {\r\n      this.registeredMappings.add(xboxControllerUserBindings);\r\n      this.registeredMappingsChanged = true;\r\n    }\r\n  },\r\n\r\n  tick2() {\r\n    this.frame.generation += 1;\r\n    const registeredMappingsChanged = this.registeredMappingsChanged;\r\n    if (registeredMappingsChanged) {\r\n      this.registeredMappingsChanged = false;\r\n      this.prevSortedBindings = this.sortedBindings;\r\n      this.sortedBindings = dependencySort(this.registeredMappings);\r\n      if (!this.prevSortedBindings) {\r\n        this.prevSortedBindings = this.sortedBindings;\r\n      }\r\n      this.masks = computeMasks(this.sortedBindings);\r\n    }\r\n\r\n    this.prevActiveSets.length = 0;\r\n    for (let i = 0; i < this.activeSets.length; i++) {\r\n      const item = this.activeSets[i];\r\n      this.prevActiveSets.push(item);\r\n    }\r\n    resolveActionSets();\r\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\r\n      const set = this.pendingSetChanges[i];\r\n      const value = this.pendingSetChanges[i + 1];\r\n\r\n      if (value) {\r\n        if (!this.activeSets.includes(set)) {\r\n          this.activeSets.push(set);\r\n        }\r\n      } else {\r\n        const idx = this.activeSets.indexOf(set);\r\n\r\n        if (idx > -1) {\r\n          this.activeSets.splice(idx, 1);\r\n        }\r\n      }\r\n    }\r\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\r\n    this.pendingSetChanges.length = 0;\r\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\r\n      this.prevActives = this.actives;\r\n      this.prevMasked = this.masked;\r\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\r\n      this.actives = actives;\r\n      this.masked = masked;\r\n    }\r\n\r\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\r\n      this.activeDevices.items[i].write(this.frame);\r\n    }\r\n\r\n    for (let i = 0; i < this.sortedBindings.length; i++) {\r\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\r\n\r\n      const binding = this.sortedBindings[i];\r\n\r\n      let bindingExistedLastFrame = true;\r\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\r\n        const j = this.prevSortedBindings.indexOf(binding);\r\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\r\n      }\r\n      if (!bindingExistedLastFrame) {\r\n        this.xformStates.delete(binding);\r\n      }\r\n\r\n      const { src, dest, xform, debug } = binding;\r\n\r\n      let oldValue;\r\n\r\n      if (debug) {\r\n        oldValue = this.frame.get(dest.value);\r\n      }\r\n\r\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\r\n\r\n      if (debug) {\r\n        // Note for now this only works with bindings that have { value: } sources and dests\r\n        console.log(\r\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\r\n            dest\r\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\r\n        );\r\n      }\r\n\r\n      if (newState !== undefined) {\r\n        this.xformStates.set(binding, newState);\r\n      }\r\n    }\r\n\r\n    this.prevSortedBindings = this.sortedBindings;\r\n\r\n    this.maybeToggleXboxMapping();\r\n  }\r\n});\r\n","import { paths } from \"./paths\";\r\nimport qsTruthy from \"../../utils/qs_truthy\";\r\n\r\nconst PATHS_TO_SHOW = [\"/actions/\", \"/device/\", \"/var/\"];\r\nconst DELIMITER = \"-----------------------------------\";\r\n\r\nconst replacer = (k, v) => {\r\n  if (typeof v === \"number\") {\r\n    return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\r\n  }\r\n  return v;\r\n};\r\nfunction describeCurrentMasks(userinput) {\r\n  const strings = [];\r\n  userinput.masked.forEach((maskers, i) => {\r\n    let val;\r\n    if (!userinput.actives[i]) return;\r\n    if (maskers.length) {\r\n      val = JSON.stringify(userinput.sortedBindings[i], replacer);\r\n      strings.push(DELIMITER);\r\n      strings.push(`Binding #${i}:`);\r\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\r\n      strings.push(`${val}\\n`);\r\n    }\r\n    maskers.forEach(masker => {\r\n      val = JSON.stringify(userinput.sortedBindings[masker], replacer);\r\n      if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\r\n      strings.push(`- Masked by #${masker}:\\n${val}`);\r\n    });\r\n    if (maskers.length) {\r\n      strings.push(`\\n`);\r\n    }\r\n  });\r\n  return strings.join(\"\\n\");\r\n}\r\n\r\nAFRAME.registerSystem(\"userinput-debug\", {\r\n  active: true,\r\n\r\n  tick() {\r\n    if (!this.active) return;\r\n\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n\r\n    if (this.userinputFrameStatus) {\r\n      const pathsOutput = [];\r\n      const { frame } = userinput;\r\n      for (const key in frame.values) {\r\n        if (!frame.get(key)) continue;\r\n        if (!PATHS_TO_SHOW.some(x => key.startsWith(x))) continue;\r\n        let val = JSON.stringify(frame.get(key), replacer);\r\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\r\n        pathsOutput.push(`${key} -> ${val}`);\r\n      }\r\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\r\n    }\r\n\r\n    if (userinput.get(paths.actions.debugUserInput.describeCurrentMasks)) {\r\n      console.log(describeCurrentMasks(userinput));\r\n    }\r\n\r\n    if (userinput.get(paths.actions.logDebugFrame)) {\r\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\r\n        this.userinputFrameStatus = document.createElement(\"div\");\r\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\r\n        this.userinputFrameStatus.style = `\r\n          position: absolute;\r\n          z-index: 2;\r\n          left: 0; bottom: 0;\r\n          background: white;\r\n          white-space: pre;\r\n          font-family: monospace;\r\n          font-size: 8pt;\r\n        `;\r\n        document.body.append(this.userinputFrameStatus);\r\n      }\r\n\r\n      console.log(userinput);\r\n      console.log(\"sorted\", userinput.sortedBindings);\r\n      console.log(\"actives\", userinput.actives);\r\n      console.log(\"masks\", userinput.masks);\r\n      console.log(\"masked\", userinput.masked);\r\n      console.log(\"devices\", userinput.activeDevices);\r\n      console.log(\"activeSets\", userinput.activeSets);\r\n      console.log(\"frame\", userinput.frame);\r\n      console.log(\"xformStates\", userinput.xformStates);\r\n      const { sortedBindings, actives, masked } = userinput;\r\n      for (const i in sortedBindings) {\r\n        const strings = [];\r\n        if (masked[i].length > 0) {\r\n          for (const j of masked[i]) {\r\n            strings.push(JSON.stringify(sortedBindings[j]));\r\n          }\r\n        }\r\n\r\n        if (this.logBindings) {\r\n          console.log(\r\n            \"binding: \",\r\n            i,\r\n            \"\\n\",\r\n            sortedBindings[i],\r\n            \"\\n\",\r\n            \"dest: \",\r\n            sortedBindings[i].dest && Object.values(sortedBindings[i].dest),\r\n            \"\\n\",\r\n            \"active: \",\r\n            actives[i],\r\n            \"\\n\",\r\n            \"maskedBy: \",\r\n            masked[i],\r\n            \"\\n\",\r\n            strings.join(\"\\n\"),\r\n            \"\\n\"\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n});\r\n","import { paths } from \"./userinput/paths\";\r\nimport { SOURCES } from \"../storage/media-search-store\";\r\n\r\nconst MEDIA_SEARCH_PATHS = [\r\n  paths.actions.mediaSearch1,\r\n  paths.actions.mediaSearch2,\r\n  paths.actions.mediaSearch3,\r\n  paths.actions.mediaSearch4,\r\n  paths.actions.mediaSearch5,\r\n  paths.actions.mediaSearch6,\r\n  paths.actions.mediaSearch7,\r\n  paths.actions.mediaSearch8\r\n];\r\n\r\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\r\nAFRAME.registerSystem(\"ui-hotkeys\", {\r\n  init() {\r\n    this.mediaSearchStore = window.APP.mediaSearchStore;\r\n  },\r\n\r\n  tick: function() {\r\n    if (!this.userinput) {\r\n      this.userinput = this.el.systems.userinput;\r\n    }\r\n\r\n    if (this.userinput.get(paths.actions.focusChat)) {\r\n      this.focusChat();\r\n    }\r\n\r\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\r\n      this.focusChat(\"/\");\r\n    }\r\n\r\n    if (this.userinput.get(paths.actions.mediaExit)) {\r\n      if (\r\n        window.APP.history.location.state &&\r\n        window.APP.history.location.state.value !== \"avatar-editor\" &&\r\n        window.APP.history.location.state.value !== \"link\"\r\n      ) {\r\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\r\n      }\r\n\r\n      this.el.emit(\"action_exit_watch\");\r\n    }\r\n\r\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\r\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i]) && window.APP.hubChannel.can(\"spawn_and_move_media\")) {\r\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\r\n      }\r\n    }\r\n\r\n    if (this.userinput.get(paths.actions.toggleCamera)) {\r\n      this.el.emit(\"action_toggle_camera\");\r\n    }\r\n\r\n    if (this.userinput.get(paths.actions.toggleUI)) {\r\n      if (this.el.sceneEl.is(\"entered\")) {\r\n        this.el.emit(\"action_toggle_ui\");\r\n      }\r\n    }\r\n  },\r\n\r\n  focusChat: function(prefix) {\r\n    const target = document.querySelector(\".chat-focus-target\");\r\n    if (!target) return;\r\n\r\n    target.focus();\r\n\r\n    if (prefix) {\r\n      target.value = prefix;\r\n    }\r\n  }\r\n});\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\n\r\nconst noop = function() {};\r\nAFRAME.registerComponent(\"overwrite-raycast-as-noop\", {\r\n  init() {\r\n    this.el.object3D.raycast = noop;\r\n    this.mesh = this.el.getObject3D(\"mesh\");\r\n    if (this.mesh) {\r\n      this.mesh.raycast = noop;\r\n    } else {\r\n      this.el.addEventListener(\"model-loaded\", () => {\r\n        this.mesh = this.el.getObject3D(\"mesh\");\r\n        if (this.mesh) {\r\n          this.mesh.raycast = noop;\r\n        }\r\n      });\r\n    }\r\n  }\r\n});\r\n\r\nexport class CursorTargettingSystem {\r\n  constructor() {\r\n    this.targets = [];\r\n    this.setDirty = this.setDirty.bind(this);\r\n    this.dirty = true;\r\n\r\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\r\n    this.observer = new MutationObserver(this.setDirty);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      const scene = document.querySelector(\"a-scene\");\r\n      this.rightRemote = document.getElementById(\"right-cursor-controller\");\r\n      this.leftRemote = document.getElementById(\"left-cursor-controller\");\r\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\r\n      scene.addEventListener(\"object3dset\", this.setDirty);\r\n      scene.addEventListener(\"object3dremove\", this.setDirty);\r\n    });\r\n  }\r\n\r\n  setDirty() {\r\n    this.dirty = true;\r\n  }\r\n\r\n  tick(t) {\r\n    if (this.dirty) {\r\n      this.populateEntities(this.targets);\r\n      this.dirty = false;\r\n    }\r\n\r\n    if (this.rightRemote) {\r\n      this.rightRemote.components[\"cursor-controller\"].tick2(t);\r\n    }\r\n\r\n    if (this.leftRemote) {\r\n      this.leftRemote.components[\"cursor-controller\"].tick2(t, true);\r\n    }\r\n  }\r\n\r\n  populateEntities(targets) {\r\n    targets.length = 0;\r\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\r\n    const els = AFRAME.scenes[0].querySelectorAll(\r\n      \".collidable, .interactable, .ui, .drawing, .occupiable-waypoint-icon, .teleport-waypoint-icon\"\r\n    );\r\n    for (let i = 0; i < els.length; i++) {\r\n      if (els[i].object3D) {\r\n        targets.push(els[i].object3D);\r\n      }\r\n    }\r\n  }\r\n\r\n  remove() {\r\n    this.observer.disconnect();\r\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\r\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\r\n  }\r\n}\r\n","import { paths } from \"./userinput/paths\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { isTagged } from \"../components/tags\";\r\nimport { hackyMobileSafariTest } from \"../utils/detect-touchscreen\";\r\n\r\nfunction shouldEnableRemote(scene, hand, remote, teleporting, woke) {\r\n  const vrRemotePenIntersection =\r\n    scene.is(\"vr-mode\") && isTagged(remote.held, \"isPen\") && remote.held.children[0].components.pen.intersection;\r\n  return scene.is(\"entered\") && !hand.hovered && !hand.held && !teleporting && !vrRemotePenIntersection && woke;\r\n}\r\n\r\nexport class CursorTogglingSystem {\r\n  constructor() {\r\n    this.wakeLeft = false;\r\n    this.wakeRight = false;\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.domContentLoadedButComponentsMayNotHave = true;\r\n    });\r\n  }\r\n\r\n  tick(interaction, userinput, scene) {\r\n    if (!this.domContentLoadedButComponentsMayNotHave) return;\r\n    if (!this.gotComponentReferences) {\r\n      this.gotComponentReferences = true;\r\n      this.rightCursorController = document.getElementById(\"right-cursor-controller\").components[\"cursor-controller\"];\r\n      this.leftCursorController = document.getElementById(\"left-cursor-controller\").components[\"cursor-controller\"];\r\n      this.rightHandTeleporter = document.getElementById(\"player-right-controller\").components[\"teleporter\"];\r\n      this.leftHandTeleporter = document.getElementById(\"player-left-controller\").components[\"teleporter\"];\r\n      this.gazeTeleporter = document.getElementById(\"gaze-teleport\").components[\"teleporter\"];\r\n    }\r\n\r\n    const rightRemote = interaction.state.rightRemote;\r\n    const leftRemote = interaction.state.leftRemote;\r\n    const leftHand = interaction.state.leftHand;\r\n    const rightHand = interaction.state.rightHand;\r\n\r\n    if (userinput.get(paths.actions.cursor.right.wake)) {\r\n      this.wakeRight = true;\r\n      if (!leftRemote.held) {\r\n        this.wakeLeft = false;\r\n      }\r\n    }\r\n\r\n    if (userinput.get(paths.actions.cursor.left.wake)) {\r\n      this.wakeLeft = true;\r\n      if (!rightRemote.held) {\r\n        this.wakeRight = false;\r\n      }\r\n    }\r\n\r\n    const inspectingInVR = interaction.el.systems[\"hubs-systems\"].cameraSystem.inspected; // && this.el.sceneEl.is(\"vr-mode\");\r\n    const shouldEnableLeftRemote =\r\n      !inspectingInVR &&\r\n      shouldEnableRemote(\r\n        scene,\r\n        leftHand,\r\n        leftRemote,\r\n        this.leftHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\r\n        this.wakeLeft\r\n      );\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const shouldEnableRightRemote =\r\n      isMobile ||\r\n      hackyMobileSafariTest() ||\r\n      (!inspectingInVR &&\r\n        shouldEnableRemote(\r\n          scene,\r\n          rightHand,\r\n          rightRemote,\r\n          this.rightHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting,\r\n          this.wakeRight\r\n        ));\r\n\r\n    if (!shouldEnableLeftRemote) {\r\n      leftRemote.hovered = null;\r\n    }\r\n    if (!shouldEnableRightRemote) {\r\n      rightRemote.hovered = null;\r\n    }\r\n    this.leftCursorController.enabled = shouldEnableLeftRemote;\r\n    this.rightCursorController.enabled = shouldEnableRightRemote;\r\n  }\r\n}\r\n","import { AmmoWorker, WorkerHelpers, CONSTANTS } from \"three-ammo\";\r\nimport { AmmoDebugConstants, DefaultBufferSize } from \"ammo-debug-drawer\";\r\nimport configs from \"../utils/configs\";\r\nimport * as ammoWasmUrl from \"ammo.js/builds/ammo.wasm.wasm\";\r\n\r\nconst MESSAGE_TYPES = CONSTANTS.MESSAGE_TYPES,\r\n  TYPE = CONSTANTS.TYPE,\r\n  BUFFER_CONFIG = CONSTANTS.BUFFER_CONFIG;\r\n\r\nconst WORLD_CONFIG = {\r\n  debugDrawMode: AmmoDebugConstants.DrawWireframe,\r\n  gravity: { x: 0, y: -9.8, z: 0 }\r\n};\r\n\r\nexport class PhysicsSystem {\r\n  constructor(scene) {\r\n    this.ammoWorker = new AmmoWorker();\r\n    this.workerHelpers = new WorkerHelpers(this.ammoWorker);\r\n\r\n    this.bodyHelpers = [];\r\n    this.shapeHelpers = [];\r\n    this.bodyUuids = [];\r\n    this.indexToUuid = {};\r\n    this.bodyUuidToData = new Map();\r\n\r\n    this.debugRequested = false;\r\n    this.debugEnabled = false;\r\n    this.scene = scene;\r\n    this.stepDuration = 0;\r\n\r\n    this.ready = false;\r\n    this.nextBodyUuid = 0;\r\n    this.nextShapeUuid = 0;\r\n\r\n    const arrayBuffer = new ArrayBuffer(4 * BUFFER_CONFIG.BODY_DATA_SIZE * BUFFER_CONFIG.MAX_BODIES);\r\n    this.objectMatricesFloatArray = new Float32Array(arrayBuffer);\r\n    this.objectMatricesIntArray = new Int32Array(arrayBuffer);\r\n\r\n    this.ammoWorker.postMessage(\r\n      {\r\n        type: MESSAGE_TYPES.INIT,\r\n        worldConfig: WORLD_CONFIG,\r\n        arrayBuffer,\r\n        wasmUrl: new URL(ammoWasmUrl, configs.BASE_ASSETS_PATH || window.location).href\r\n      },\r\n      [arrayBuffer]\r\n    );\r\n\r\n    this.ammoWorker.onmessage = async event => {\r\n      if (event.data.type === MESSAGE_TYPES.READY) {\r\n        this.ready = true;\r\n        for (const bodyHelper of this.bodyHelpers) {\r\n          if (bodyHelper.alive) bodyHelper.init2();\r\n        }\r\n        for (const shapeHelper of this.shapeHelpers) {\r\n          if (shapeHelper.alive) shapeHelper.init2();\r\n        }\r\n        this.shapeHelpers.length = 0;\r\n        this.bodyHelpers.length = 0;\r\n      } else if (event.data.type === MESSAGE_TYPES.BODY_READY) {\r\n        const uuid = event.data.uuid;\r\n        const index = event.data.index;\r\n        if (this.bodyUuidToData.has(uuid)) {\r\n          this.bodyUuids.push(uuid);\r\n          this.bodyUuidToData.get(uuid).index = index;\r\n          this.indexToUuid[index] = uuid;\r\n        } else {\r\n          console.warn(`Body initialized for uuid: ${uuid} but body missing.`);\r\n        }\r\n      } else if (event.data.type === MESSAGE_TYPES.SHAPES_READY) {\r\n        const bodyUuid = event.data.bodyUuid;\r\n        const shapesUuid = event.data.shapesUuid;\r\n        if (this.bodyUuidToData.has(bodyUuid)) {\r\n          this.bodyUuidToData.get(bodyUuid).shapes.push(shapesUuid);\r\n        } else {\r\n          console.warn(`Shape initialized but body with uuid: ${bodyUuid} missing.`);\r\n        }\r\n      } else if (event.data.type === MESSAGE_TYPES.TRANSFER_DATA) {\r\n        this.objectMatricesFloatArray = event.data.objectMatricesFloatArray;\r\n        this.objectMatricesIntArray = new Int32Array(this.objectMatricesFloatArray.buffer);\r\n        this.stepDuration = event.data.stepDuration;\r\n      }\r\n    };\r\n  }\r\n\r\n  setDebug(debug) {\r\n    this.debugRequested = debug;\r\n  }\r\n\r\n  enableDebug() {\r\n    if (!window.SharedArrayBuffer) {\r\n      console.warn(\"Physics debug rendering only available in browsers that support SharedArrayBuffers.\");\r\n      this.debugRequested = false;\r\n      return;\r\n    }\r\n\r\n    this.debugEnabled = true;\r\n\r\n    if (!this.debugMesh) {\r\n      this.debugSharedArrayBuffer = new window.SharedArrayBuffer(4 + 2 * DefaultBufferSize * 4);\r\n      this.debugIndex = new Uint32Array(this.debugSharedArrayBuffer, 0, 4);\r\n      const debugVertices = new Float32Array(this.debugSharedArrayBuffer, 4, DefaultBufferSize);\r\n      const debugColors = new Float32Array(this.debugSharedArrayBuffer, 4 + DefaultBufferSize, DefaultBufferSize);\r\n      this.debugGeometry = new THREE.BufferGeometry();\r\n      this.debugGeometry.addAttribute(\"position\", new THREE.BufferAttribute(debugVertices, 3));\r\n      this.debugGeometry.addAttribute(\"color\", new THREE.BufferAttribute(debugColors, 3));\r\n      const debugMaterial = new THREE.LineBasicMaterial({\r\n        vertexColors: THREE.VertexColors,\r\n        depthTest: true\r\n      });\r\n      this.debugMesh = new THREE.LineSegments(this.debugGeometry, debugMaterial);\r\n      this.debugMesh.frustumCulled = false;\r\n      this.debugMesh.renderOrder = 999;\r\n    }\r\n\r\n    if (!this.debugMesh.parent) {\r\n      this.scene.add(this.debugMesh);\r\n      this.workerHelpers.enableDebug(true, this.debugSharedArrayBuffer);\r\n    }\r\n  }\r\n\r\n  disableDebug() {\r\n    this.debugEnabled = false;\r\n    if (this.debugMesh) {\r\n      this.scene.remove(this.debugMesh);\r\n      this.workerHelpers.enableDebug(false);\r\n    }\r\n  }\r\n\r\n  tick = (() => {\r\n    const transform = new THREE.Matrix4();\r\n    const inverse = new THREE.Matrix4();\r\n    const matrix = new THREE.Matrix4();\r\n    const scale = new THREE.Vector3();\r\n    return function() {\r\n      if (this.ready) {\r\n        if (this.debugRequested !== this.debugEnabled) {\r\n          if (this.debugRequested) {\r\n            this.enableDebug();\r\n          } else {\r\n            this.disableDebug();\r\n          }\r\n        }\r\n\r\n        /** Buffer Schema\r\n         * Every physics body has 26 * 4 bytes (64bit float/int) assigned in the buffer\r\n         * 0-15   Matrix4 elements (floats)\r\n         * 16     Linear Velocity (float)\r\n         * 17     Angular Velocity (float)\r\n         * 18-25  first 8 Collisions (ints)\r\n         */\r\n\r\n        if (this.objectMatricesFloatArray.buffer.byteLength !== 0) {\r\n          for (let i = 0; i < this.bodyUuids.length; i++) {\r\n            const uuid = this.bodyUuids[i];\r\n            const body = this.bodyUuidToData.get(uuid);\r\n            const index = body.index;\r\n            const type = body.options.type ? body.options.type : TYPE.DYNAMIC;\r\n            const object3D = body.object3D;\r\n            if (type === TYPE.DYNAMIC) {\r\n              matrix.fromArray(\r\n                this.objectMatricesFloatArray,\r\n                index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\r\n              );\r\n              inverse.getInverse(object3D.parent.matrixWorld);\r\n              transform.multiplyMatrices(inverse, matrix);\r\n              transform.decompose(object3D.position, object3D.quaternion, scale);\r\n            }\r\n\r\n            object3D.updateMatrices();\r\n            this.objectMatricesFloatArray.set(\r\n              object3D.matrixWorld.elements,\r\n              index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.MATRIX_OFFSET\r\n            );\r\n\r\n            body.linearVelocity = this.objectMatricesFloatArray[\r\n              index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.LINEAR_VELOCITY_OFFSET\r\n            ];\r\n\r\n            body.angularVelocity = this.objectMatricesFloatArray[\r\n              index * BUFFER_CONFIG.BODY_DATA_SIZE + BUFFER_CONFIG.ANGULAR_VELOCITY_OFFSET\r\n            ];\r\n\r\n            body.collisions.length = 0;\r\n\r\n            for (let j = BUFFER_CONFIG.COLLISIONS_OFFSET; j < BUFFER_CONFIG.BODY_DATA_SIZE; j++) {\r\n              const collidingIndex = this.objectMatricesIntArray[index * BUFFER_CONFIG.BODY_DATA_SIZE + j];\r\n              if (collidingIndex !== -1) {\r\n                body.collisions.push(this.indexToUuid[collidingIndex]);\r\n              }\r\n            }\r\n          }\r\n\r\n          this.ammoWorker.postMessage(\r\n            { type: MESSAGE_TYPES.TRANSFER_DATA, objectMatricesFloatArray: this.objectMatricesFloatArray },\r\n            [this.objectMatricesFloatArray.buffer]\r\n          );\r\n        }\r\n\r\n        /* DEBUG RENDERING */\r\n        if (this.debugEnabled) {\r\n          const index = window.Atomics.load(this.debugIndex, 0);\r\n          if (index !== 0) {\r\n            this.debugGeometry.attributes.position.needsUpdate = true;\r\n            this.debugGeometry.attributes.color.needsUpdate = true;\r\n          }\r\n          this.debugGeometry.setDrawRange(0, index);\r\n          window.Atomics.store(this.debugIndex, 0, 0);\r\n        }\r\n      }\r\n    };\r\n  })();\r\n\r\n  addBody(object3D, options) {\r\n    this.workerHelpers.addBody(this.nextBodyUuid, object3D, options);\r\n\r\n    this.bodyUuidToData.set(this.nextBodyUuid, {\r\n      object3D: object3D,\r\n      options: options,\r\n      collisions: [],\r\n      linearVelocity: 0,\r\n      angularVelocity: 0,\r\n      index: -1,\r\n      shapes: []\r\n    });\r\n\r\n    return this.nextBodyUuid++;\r\n  }\r\n\r\n  updateBody(uuid, options) {\r\n    if (this.bodyUuidToData.has(uuid)) {\r\n      this.bodyUuidToData.get(uuid).options = options;\r\n      this.workerHelpers.updateBody(uuid, options);\r\n    } else {\r\n      console.warn(`updateBody called for uuid: ${uuid} but body missing.`);\r\n    }\r\n  }\r\n\r\n  removeBody(uuid) {\r\n    const idx = this.bodyUuids.indexOf(uuid);\r\n    if (this.bodyUuidToData.has(uuid) && idx !== -1) {\r\n      delete this.indexToUuid[this.bodyUuidToData.get(uuid).index];\r\n      this.bodyUuidToData.delete(uuid);\r\n      this.bodyUuids.splice(idx, 1);\r\n      this.workerHelpers.removeBody(uuid);\r\n    } else {\r\n      console.warn(`removeBody called for uuid: ${uuid} but body missing.`);\r\n    }\r\n  }\r\n\r\n  addShapes(bodyUuid, mesh, options) {\r\n    if (mesh) {\r\n      const scale = new THREE.Vector3();\r\n      scale.setFromMatrixScale(mesh.matrixWorld);\r\n    }\r\n    this.workerHelpers.addShapes(bodyUuid, this.nextShapeUuid, mesh, options);\r\n    this.bodyUuidToData.get(bodyUuid).shapes.push(this.nextShapeUuid);\r\n    return this.nextShapeUuid++;\r\n  }\r\n\r\n  removeShapes(bodyUuid, shapesUuid) {\r\n    if (this.bodyUuidToData.has(bodyUuid)) {\r\n      this.workerHelpers.removeShapes(bodyUuid, shapesUuid);\r\n      const idx = this.bodyUuidToData.get(bodyUuid).shapes.indexOf(shapesUuid);\r\n      if (idx !== -1) {\r\n        this.bodyUuidToData.get(bodyUuid).shapes.splice(idx, 1);\r\n      } else {\r\n        console.warn(`removeShapes called for shapesUuid: ${shapesUuid} on bodyUuid: ${bodyUuid} but shapes missing.`);\r\n      }\r\n    }\r\n  }\r\n\r\n  addConstraint(constraintId, bodyUuid, targetUuid, options) {\r\n    this.workerHelpers.addConstraint(constraintId, bodyUuid, targetUuid, options);\r\n  }\r\n\r\n  removeConstraint(constraintId) {\r\n    this.workerHelpers.removeConstraint(constraintId);\r\n  }\r\n\r\n  registerBodyHelper(bodyHelper) {\r\n    if (this.ready) {\r\n      bodyHelper.init2();\r\n    } else {\r\n      this.bodyHelpers.push(bodyHelper);\r\n    }\r\n  }\r\n\r\n  registerShapeHelper(shapeHelper) {\r\n    if (this.ready) {\r\n      shapeHelper.init2();\r\n    } else {\r\n      this.shapeHelpers.push(shapeHelper);\r\n    }\r\n  }\r\n\r\n  bodyInitialized(uuid) {\r\n    return this.bodyUuidToData.has(uuid) && this.bodyUuidToData.get(uuid).index !== -1;\r\n  }\r\n\r\n  getLinearVelocity(uuid) {\r\n    return this.bodyUuidToData.get(uuid).linearVelocity;\r\n  }\r\n\r\n  getAngularVelocity(uuid) {\r\n    return this.bodyUuidToData.get(uuid).angularVelocity;\r\n  }\r\n\r\n  getCollisions(uuid) {\r\n    return this.bodyUuidToData.get(uuid).collisions;\r\n  }\r\n\r\n  resetDynamicBody(uuid) {\r\n    this.workerHelpers.resetDynamicBody(uuid);\r\n  }\r\n\r\n  activateBody(uuid) {\r\n    this.workerHelpers.activateBody(uuid);\r\n  }\r\n}\r\n","/* global NAF AFRAME */\r\nimport { CONSTANTS } from \"three-ammo\";\r\nconst ACTIVATION_STATE = CONSTANTS.ACTIVATION_STATE;\r\n\r\nexport class ConstraintsSystem {\r\n  constructor(physicsSystem) {\r\n    this.prevLeftHand = {\r\n      held: null,\r\n      spawning: false\r\n    };\r\n    this.prevRightHand = {\r\n      held: null,\r\n      spawning: false\r\n    };\r\n    this.prevRightRemote = {\r\n      held: null,\r\n      spawning: false\r\n    };\r\n    this.prevLeftRemote = {\r\n      held: null,\r\n      spawning: false\r\n    };\r\n\r\n    this.physicsSystem = physicsSystem;\r\n    this.constraintPairs = {};\r\n  }\r\n\r\n  tickInteractor(constraintTag, entityId, state, prevState) {\r\n    if (!this.physicsSystem) return;\r\n\r\n    if (prevState.held === state.held) {\r\n      if (\r\n        !state.spawning &&\r\n        prevState.spawning &&\r\n        state.held &&\r\n        state.held.components.tags &&\r\n        state.held.components.tags.data[constraintTag]\r\n      ) {\r\n        state.held.setAttribute(\"body-helper\", {\r\n          type: \"dynamic\",\r\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\r\n        });\r\n        const heldEntityId = state.held.id;\r\n        const bodyUuid = state.held.components[\"body-helper\"].uuid;\r\n        const targetEl = document.querySelector(`#${entityId}`);\r\n        const targetUuid = targetEl.components[\"body-helper\"].uuid;\r\n        if (bodyUuid !== -1 && targetUuid !== -1) {\r\n          this.physicsSystem.addConstraint(entityId, bodyUuid, targetUuid, {});\r\n          if (!this.constraintPairs[heldEntityId]) {\r\n            this.constraintPairs[heldEntityId] = [];\r\n          }\r\n          this.constraintPairs[heldEntityId].push(entityId);\r\n        }\r\n      }\r\n      return;\r\n    }\r\n    if (prevState.held && prevState.held.components.tags && prevState.held.components.tags.data[constraintTag]) {\r\n      const heldEntityId = prevState.held.id;\r\n      if (this.constraintPairs[heldEntityId] && this.constraintPairs[heldEntityId].indexOf(entityId) !== -1) {\r\n        this.constraintPairs[heldEntityId].splice(this.constraintPairs[heldEntityId].indexOf(entityId), 1);\r\n        if (this.constraintPairs[heldEntityId].length === 0) {\r\n          delete this.constraintPairs[heldEntityId];\r\n        }\r\n        this.physicsSystem.removeConstraint(entityId);\r\n      }\r\n\r\n      if (!this.constraintPairs[heldEntityId] || this.constraintPairs[heldEntityId].length < 1) {\r\n        prevState.held.setAttribute(\"body-helper\", { activationState: ACTIVATION_STATE.ACTIVE_TAG });\r\n      }\r\n    }\r\n    if (!state.spawning && state.held && state.held.components.tags.data[constraintTag]) {\r\n      if (!state.held.components[\"networked\"] || NAF.utils.isMine(state.held) || NAF.utils.takeOwnership(state.held)) {\r\n        state.held.setAttribute(\"body-helper\", {\r\n          type: \"dynamic\",\r\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\r\n        });\r\n        const heldEntityId = state.held.id;\r\n        const bodyUuid = state.held.components[\"body-helper\"].uuid;\r\n        const targetEl = document.querySelector(`#${entityId}`);\r\n        const targetUuid = targetEl.components[\"body-helper\"].uuid;\r\n        if (bodyUuid !== -1 && targetUuid !== -1) {\r\n          this.physicsSystem.addConstraint(entityId, bodyUuid, targetUuid, {});\r\n          if (!this.constraintPairs[heldEntityId]) {\r\n            this.constraintPairs[heldEntityId] = [];\r\n          }\r\n          this.constraintPairs[heldEntityId].push(entityId);\r\n        }\r\n      } else {\r\n        console.log(\"Failed to obtain ownership while trying to create constraint on networked object.\");\r\n      }\r\n    }\r\n  }\r\n\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n\r\n    this.tickInteractor(\r\n      \"offersHandConstraint\",\r\n      interaction.options.leftHand.entity.id,\r\n      interaction.state.leftHand,\r\n      this.prevLeftHand\r\n    );\r\n    this.tickInteractor(\r\n      \"offersHandConstraint\",\r\n      interaction.options.rightHand.entity.id,\r\n      interaction.state.rightHand,\r\n      this.prevRightHand\r\n    );\r\n    this.tickInteractor(\r\n      \"offersRemoteConstraint\",\r\n      interaction.options.rightRemote.entity.id,\r\n      interaction.state.rightRemote,\r\n      this.prevRightRemote\r\n    );\r\n    this.tickInteractor(\r\n      \"offersRemoteConstraint\",\r\n      interaction.options.leftRemote.entity.id,\r\n      interaction.state.leftRemote,\r\n      this.prevLeftRemote\r\n    );\r\n\r\n    Object.assign(this.prevLeftHand, interaction.state.leftHand);\r\n    Object.assign(this.prevRightHand, interaction.state.rightHand);\r\n    Object.assign(this.prevRightRemote, interaction.state.rightRemote);\r\n    Object.assign(this.prevLeftRemote, interaction.state.leftRemote);\r\n  }\r\n\r\n  // for held objects deleted during the component tick\r\n  release(el) {\r\n    if (this.prevLeftHand.held === el) {\r\n      this.prevLeftHand.held = null;\r\n      this.prevLeftHand.spawning = false;\r\n    }\r\n    if (this.prevLeftHand.held === el) {\r\n      this.prevLeftHand.held = null;\r\n      this.prevLeftHand.spawning = false;\r\n    }\r\n    if (this.prevRightRemote.held === el) {\r\n      this.prevRightRemote.held = null;\r\n      this.prevRightRemote.spawning = false;\r\n    }\r\n    if (this.prevLeftRemote.held === el) {\r\n      this.prevLeftRemote.held = null;\r\n      this.prevLeftRemote.spawning = false;\r\n    }\r\n  }\r\n}\r\n","/* global THREE AFRAME */\r\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\r\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\r\nexport const distanceBetweenStretchers = (() => {\r\n  const a = new THREE.Vector3();\r\n  const b = new THREE.Vector3();\r\n  return function distanceBetweenStretchers(obj1, obj2) {\r\n    obj1.getWorldPosition(a);\r\n    obj2.getWorldPosition(b);\r\n    return a.distanceTo(b);\r\n  };\r\n})();\r\n\r\nfunction existsAndHeldInEither(object, holderA, holderB) {\r\n  return object && (object === holderA.held || object === holderB.held);\r\n}\r\n\r\nexport class TwoPointStretchingSystem {\r\n  constructor() {\r\n    this.initialScale = new THREE.Vector3();\r\n  }\r\n\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\r\n\r\n    const stretching =\r\n      existsAndHeldInEither(leftHand.held, rightHand, rightRemote) ||\r\n      existsAndHeldInEither(leftRemote.held, rightHand, rightRemote);\r\n    const stretched = leftHand.held || leftRemote.held;\r\n    let leftStretcher, rightStretcher;\r\n    if (stretching) {\r\n      leftStretcher = leftHand.held\r\n        ? interaction.options.leftHand.entity.object3D\r\n        : interaction.options.leftRemote.entity.object3D;\r\n      rightStretcher = rightHand.held\r\n        ? interaction.options.rightHand.entity.object3D\r\n        : interaction.options.rightRemote.entity.object3D;\r\n      if (\r\n        leftStretcher !== this.previousLeftStretcher ||\r\n        rightStretcher !== this.previousRightStretcher ||\r\n        stretched !== this.stretched\r\n      ) {\r\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\r\n        this.stretched = stretched;\r\n        this.initialScale.copy(this.stretched.object3D.scale);\r\n        if (this.stretched.components[\"ammo-body\"]) {\r\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\r\n        }\r\n      }\r\n\r\n      this.stretched.object3D.scale\r\n        .copy(this.initialScale)\r\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\r\n      this.stretched.object3D.matrixNeedsUpdate = true;\r\n    }\r\n\r\n    this.previousLeftStretcher = leftStretcher;\r\n    this.previousRightStretcher = rightStretcher;\r\n  }\r\n}\r\n","import { CAMERA_MODE_INSPECT } from \"./camera-system\";\r\n\r\nexport class SingleActionButtonSystem {\r\n  tick() {\r\n    this.didInteractThisFrame = false;\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    if (AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem.mode === CAMERA_MODE_INSPECT) {\r\n      // TODO: Fix issue where button objects are \"visible\" but not on the inspect layer,\r\n      // which makes it so we can interact with them but cannot see them.\r\n      return;\r\n    }\r\n    const hovered = interaction.state.rightRemote.hovered;\r\n    if (\r\n      hovered &&\r\n      userinput.get(interaction.options.rightRemote.grabPath) &&\r\n      hovered.components.tags &&\r\n      hovered.components.tags.data.singleActionButton\r\n    ) {\r\n      this.didInteractThisFrame = true;\r\n      hovered.object3D.dispatchEvent({\r\n        type: \"interact\",\r\n        object3D: interaction.options.rightRemote.entity.object3D\r\n      });\r\n    }\r\n    const hovered2 = interaction.state.leftRemote.hovered;\r\n    if (\r\n      hovered2 &&\r\n      userinput.get(interaction.options.leftRemote.grabPath) &&\r\n      hovered2.components.tags &&\r\n      hovered2.components.tags.data.singleActionButton\r\n    ) {\r\n      this.didInteractThisFrame = true;\r\n      hovered2.object3D.dispatchEvent({\r\n        type: \"interact\",\r\n        object3D: interaction.options.leftRemote.entity.object3D\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport class HoldableButtonSystem {\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const held = interaction.state.rightRemote.held;\r\n\r\n    if (this.prevHeld && this.prevHeld !== held) {\r\n      this.prevHeld.object3D.dispatchEvent({\r\n        type: \"holdable-button-up\",\r\n        object3D: interaction.options.rightRemote.entity.object3D\r\n      });\r\n    }\r\n    if (held && this.prevHeld !== held) {\r\n      held.object3D.dispatchEvent({\r\n        type: \"holdable-button-down\",\r\n        object3D: interaction.options.rightRemote.entity.object3D\r\n      });\r\n    }\r\n\r\n    this.prevHeld = held;\r\n\r\n    const heldLeft = interaction.state.leftRemote.held;\r\n\r\n    if (this.prevHeldLeft && this.prevHeldLeft !== heldLeft) {\r\n      this.prevHeldLeft.object3D.dispatchEvent({\r\n        type: \"holdable-button-up\",\r\n        object3D: interaction.options.leftRemote.entity.object3D\r\n      });\r\n    }\r\n    if (heldLeft && this.prevHeldLeft !== heldLeft) {\r\n      heldLeft.object3D.dispatchEvent({\r\n        type: \"holdable-button-down\",\r\n        object3D: interaction.options.leftRemote.entity.object3D\r\n      });\r\n    }\r\n\r\n    this.prevHeldLeft = heldLeft;\r\n  }\r\n}\r\n\r\nconst hasButtonComponent = (function() {\r\n  const BUTTON_COMPONENT_NAMES = [\r\n    \"icon-button\",\r\n    \"text-button\",\r\n    \"pin-networked-object-button\",\r\n    \"mic-button\",\r\n    \"inspect-button\"\r\n  ];\r\n  return function hasButtonComponent(components) {\r\n    for (let i = 0; i < BUTTON_COMPONENT_NAMES.length; i++) {\r\n      if (components[BUTTON_COMPONENT_NAMES[i]]) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n})();\r\n\r\nfunction getHoverableButton(hovered) {\r\n  if (!hovered) return null;\r\n  if (\r\n    hasButtonComponent(hovered.components) ||\r\n    hovered.classList.contains(\"teleport-waypoint-icon\") ||\r\n    hovered.classList.contains(\"occupiable-waypoint-icon\")\r\n  ) {\r\n    return hovered;\r\n  }\r\n  if (hovered.children) {\r\n    // TODO: not sure if looping thru children here is desireable, but we did this to accomodate the rounded-button mixins\r\n    for (let i = 0; i < hovered.children.length; i++) {\r\n      if (\r\n        hasButtonComponent(hovered.children[i].components) ||\r\n        hovered.children[i].classList.contains(\"teleport-waypoint-icon\") ||\r\n        hovered.children[i].classList.contains(\"occupiable-waypoint-icon\")\r\n      ) {\r\n        return hovered.children[i];\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction dispatch(el, event) {\r\n  el.object3D.dispatchEvent(event);\r\n  if (el.children) {\r\n    for (let i = 0; i < el.children.length; i++) {\r\n      if (\r\n        hasButtonComponent(el.children[i].components) ||\r\n        el.children[i].classList.contains(\"teleport-waypoint-icon\") ||\r\n        el.children[i].classList.contains(\"occupiable-waypoint-icon\")\r\n      ) {\r\n        el.children[i].object3D.dispatchEvent(event);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst HOVERED = { type: \"hovered\" };\r\nconst UNHOVERED = { type: \"unhovered\" };\r\nexport class HoverButtonSystem {\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\r\n    const button2 = getHoverableButton(interaction.state.leftRemote.hovered);\r\n\r\n    if (this.prevButton && this.prevButton !== button) {\r\n      dispatch(this.prevButton, UNHOVERED);\r\n    }\r\n\r\n    if (button && this.prevButton !== button) {\r\n      dispatch(button, HOVERED);\r\n    }\r\n\r\n    this.prevButton = button;\r\n\r\n    // TODO: hover should respect both remotes\r\n    if (this.prevButtonLeft && this.prevButtonLeft !== button2) {\r\n      dispatch(this.prevButtonLeft, UNHOVERED);\r\n    }\r\n\r\n    if (button2 && this.prevButtonLeft !== button2) {\r\n      dispatch(button2, HOVERED);\r\n    }\r\n\r\n    this.prevButtonLeft = button2;\r\n  }\r\n}\r\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { SOUND_PEN_UNDO_DRAW } from \"./sound-effects-system\";\r\n\r\n/**\r\n * Drawing Menu System\r\n * A system for showing menus for drawings.\r\n */\r\n\r\nfunction almostEquals(epsilon, u, v) {\r\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\r\n}\r\n\r\nexport class DrawingMenuSystem {\r\n  constructor(sceneEl) {\r\n    this.sceneEl = sceneEl;\r\n\r\n    this.sceneEl.addEventListener(\"stateremoved\", this.hideMenus.bind(this));\r\n\r\n    this.lastIntersection = new THREE.Vector3();\r\n\r\n    this.drawingMenus = [];\r\n    this.buttonMap = {};\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.cursorControllers = document.querySelectorAll(\"[cursor-controller]\");\r\n      this.camera = this.sceneEl.querySelector(\"#avatar-pov-node\");\r\n    });\r\n  }\r\n\r\n  tick() {\r\n    if (!this.cursorControllers || this.cursorControllers.length === 0 || !this.camera) return;\r\n\r\n    if (this.sceneEl.is(\"frozen\") && window.APP.hubChannel.can(\"spawn_drawing\")) {\r\n      const hovered = this.getHovered();\r\n      if (hovered) {\r\n        for (let i = 0; i < this.cursorControllers.length; i++) {\r\n          if (this.cursorControllers[i].components[\"cursor-controller\"].intersection) {\r\n            const intersectionPoint = this.cursorControllers[i].components[\"cursor-controller\"].intersection.point;\r\n            this.showMenu(hovered, intersectionPoint);\r\n          }\r\n        }\r\n      }\r\n      this.handleButtons();\r\n      this.scaleMenus();\r\n    }\r\n  }\r\n\r\n  getMenuScale(distance) {\r\n    if (distance <= 1.5) {\r\n      return 0.5;\r\n    }\r\n    return Math.min(3, distance - 1);\r\n  }\r\n\r\n  scaleMenus = (() => {\r\n    const cameraWorldPos = new THREE.Vector3();\r\n    return function() {\r\n      if (!this.drawingMenus || this.drawingMenus.length === 0) return;\r\n\r\n      this.camera.object3D.getWorldPosition(cameraWorldPos);\r\n\r\n      for (let i = 0; i < this.drawingMenus.length; i++) {\r\n        const menu = this.drawingMenus[i];\r\n        if (menu.object3D.visible && !menu.getAttribute(\"animation__show\")) {\r\n          const dist = cameraWorldPos.distanceTo(menu.object3D.position);\r\n          menu.object3D.scale.setScalar(this.getMenuScale(dist));\r\n          menu.object3D.matrixNeedsUpdate = true;\r\n        }\r\n      }\r\n    };\r\n  })();\r\n\r\n  handleButtons = (() => {\r\n    const remotes = [\"rightRemote\", \"leftRemote\"];\r\n    return function() {\r\n      const interaction = AFRAME.scenes[0].systems.interaction;\r\n      const userinput = AFRAME.scenes[0].systems.userinput;\r\n\r\n      for (let i = 0; i < remotes.length; i++) {\r\n        const remote = remotes[i];\r\n        if (interaction.state[remote]) {\r\n          const hovered = interaction.state[remote].hovered;\r\n          if (\r\n            hovered &&\r\n            userinput.get(interaction.options[remote].grabPath) &&\r\n            hovered.components.tags &&\r\n            hovered.components.tags.data.singleActionButton\r\n          ) {\r\n            if (this.buttonMap[hovered.object3D.uuid]) {\r\n              const networkedEntity = this.buttonMap[hovered.object3D.uuid];\r\n              if (hovered.classList.contains(\"undo-drawing\")) {\r\n                networkedEntity.components[\"networked-drawing\"].undoDraw();\r\n                this.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\r\n              } else if (hovered.classList.contains(\"delete-drawing\")) {\r\n                NAF.utils.takeOwnership(networkedEntity);\r\n                this.sceneEl.removeChild(networkedEntity);\r\n              } else if (hovered.classList.contains(\"serialize-drawing\")) {\r\n                networkedEntity.components[\"networked-drawing\"].serializeDrawing().then(() => {\r\n                  const networkedEntity = this.buttonMap[hovered.object3D.uuid];\r\n                  NAF.utils.takeOwnership(networkedEntity);\r\n                  this.sceneEl.removeChild(networkedEntity);\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n  })();\r\n\r\n  getHovered() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    let hovered = null;\r\n    if (\r\n      interaction.state.leftRemote &&\r\n      interaction.state.leftRemote.hovered &&\r\n      interaction.state.leftRemote.hovered.classList.contains(\"drawing\")\r\n    ) {\r\n      hovered = interaction.state.leftRemote.hovered;\r\n    } else if (\r\n      interaction.state.rightRemote &&\r\n      interaction.state.rightRemote.hovered &&\r\n      interaction.state.rightRemote.hovered.classList.contains(\"drawing\")\r\n    ) {\r\n      hovered = interaction.state.rightRemote.hovered;\r\n    }\r\n    return hovered;\r\n  }\r\n\r\n  showMenu = (() => {\r\n    const position = new THREE.Vector3();\r\n    const cameraWorldPos = new THREE.Vector3();\r\n    return function(hovered, intersectionPoint) {\r\n      const menu = hovered.children[0];\r\n\r\n      if (!menu.object3D.visible || !almostEquals(0.25, intersectionPoint, this.lastIntersection)) {\r\n        this.camera.object3D.getWorldPosition(cameraWorldPos);\r\n        position\r\n          .subVectors(cameraWorldPos, intersectionPoint)\r\n          .normalize()\r\n          .multiplyScalar(0.1);\r\n        menu.object3D.position.copy(intersectionPoint).add(position);\r\n        menu.object3D.lookAt(cameraWorldPos);\r\n        menu.object3D.matrixNeedsUpdate = true;\r\n        menu.object3D.visible = true;\r\n        this.lastIntersection.copy(intersectionPoint);\r\n\r\n        const isMine = hovered.components.networked.isMine();\r\n        menu.querySelector(\".undo-drawing\").object3D.visible = isMine;\r\n        menu.querySelector(\".serialize-drawing\").object3D.visible =\r\n          isMine && window.APP.hubChannel.can(\"spawn_and_move_media\");\r\n\r\n        const dist = cameraWorldPos.distanceTo(menu.object3D.position);\r\n        const finalScale = this.getMenuScale(dist);\r\n\r\n        menu.removeAttribute(\"animation__show\");\r\n\r\n        menu.setAttribute(\"animation__show\", {\r\n          property: \"scale\",\r\n          dur: 300,\r\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\r\n          to: { x: finalScale, y: finalScale, z: finalScale },\r\n          easing: \"easeOutElastic\"\r\n        });\r\n\r\n        menu.addEventListener(\r\n          \"animationcomplete\",\r\n          () => {\r\n            menu.removeAttribute(\"animation__show\");\r\n          },\r\n          { once: true }\r\n        );\r\n      }\r\n    };\r\n  })();\r\n\r\n  hideMenus() {\r\n    if (!this.drawingMenus) return;\r\n\r\n    for (let i = 0; i < this.drawingMenus.length; i++) {\r\n      this.drawingMenus[i].object3D.visible = false;\r\n    }\r\n  }\r\n\r\n  registerDrawingMenu(networkedDrawingEl) {\r\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\r\n    this.drawingMenus.push(menuEl);\r\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\r\n    this.buttonMap[undoButton.object3D.uuid] = networkedDrawingEl;\r\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\r\n    this.buttonMap[deleteButton.object3D.uuid] = networkedDrawingEl;\r\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\r\n    this.buttonMap[serializeButton.object3D.uuid] = networkedDrawingEl;\r\n  }\r\n\r\n  unregisterDrawingMenu(networkedDrawingEl) {\r\n    const menuEl = networkedDrawingEl.querySelector(\".drawing-menu\");\r\n    const idx = this.drawingMenus.indexOf(menuEl);\r\n    if (idx !== -1) {\r\n      this.drawingMenus.splice(idx, 1);\r\n    }\r\n    const undoButton = menuEl.querySelector(\".undo-drawing\");\r\n    delete this.buttonMap[undoButton.object3D.uuid];\r\n    const deleteButton = menuEl.querySelector(\".delete-drawing\");\r\n    delete this.buttonMap[deleteButton.object3D.uuid];\r\n    const serializeButton = menuEl.querySelector(\".serialize-drawing\");\r\n    delete this.buttonMap[serializeButton.object3D.uuid];\r\n  }\r\n}\r\n","function getSpecificHoverMenu(el) {\r\n  return (\r\n    el &&\r\n    (el.components[\"hover-menu\"] ||\r\n      el.components[\"hover-menu__video\"] ||\r\n      el.components[\"hover-menu__pager\"] ||\r\n      el.components[\"hover-menu__hubs-item\"] ||\r\n      el.components[\"hover-menu__link\"] ||\r\n      el.components[\"hover-menu__photo\"])\r\n  );\r\n}\r\n\r\nfunction findHoverMenu(hovered) {\r\n  if (!hovered) return null;\r\n  const hoverMenu = getSpecificHoverMenu(hovered);\r\n  if (hoverMenu) {\r\n    return hoverMenu;\r\n  }\r\n  if (!(hovered.components.tags && hovered.components.tags.data.isHoverMenuChild)) {\r\n    return null;\r\n  }\r\n  let el = hovered.parentNode;\r\n  while (!getSpecificHoverMenu(el)) {\r\n    el = el.parentNode;\r\n  }\r\n  return getSpecificHoverMenu(el);\r\n}\r\n\r\nexport class HoverMenuSystem {\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\r\n\r\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\r\n      this.prevHoverMenu.hovering = false;\r\n      this.prevHoverMenu.applyHoverState();\r\n    }\r\n\r\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\r\n      hoverMenu.hovering = true;\r\n      hoverMenu.applyHoverState();\r\n    }\r\n\r\n    this.prevHoverMenu = hoverMenu;\r\n\r\n    //TODO: Menu be visible if either remote is hovering.\r\n    const hoverMenu2 = findHoverMenu(interaction.state.leftRemote.hovered);\r\n\r\n    if (this.prevHoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\r\n      this.prevHoverMenu2.hovering = false;\r\n      this.prevHoverMenu2.applyHoverState();\r\n    }\r\n\r\n    if (hoverMenu2 && this.prevHoverMenu2 !== hoverMenu2) {\r\n      hoverMenu2.hovering = true;\r\n      hoverMenu2.applyHoverState();\r\n    }\r\n\r\n    this.prevHoverMenu2 = hoverMenu2;\r\n  }\r\n}\r\n","import { addMedia } from \"../utils/media-utils\";\r\nimport { ObjectContentOrigins } from \"../object-types\";\r\n\r\n// WARNING: This system mutates interaction system state!\r\nexport class SuperSpawnerSystem {\r\n  maybeSpawn(state, grabPath) {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\r\n\r\n    const isPermitted =\r\n      window.APP.hubChannel &&\r\n      (superSpawner && superSpawner.data.template === \"#interactable-emoji\"\r\n        ? window.APP.hubChannel.can(\"spawn_emoji\")\r\n        : window.APP.hubChannel.can(\"spawn_and_move_media\"));\r\n\r\n    if (\r\n      superSpawner &&\r\n      superSpawner.spawnedMediaScale &&\r\n      !superSpawner.cooldownTimeout &&\r\n      userinput.get(grabPath) &&\r\n      isPermitted\r\n    ) {\r\n      this.performSpawn(state, grabPath, userinput, superSpawner);\r\n    }\r\n  }\r\n\r\n  performSpawn(state, grabPath, userinput, superSpawner) {\r\n    const data = superSpawner.data;\r\n\r\n    const spawnedEntity = addMedia(\r\n      data.src,\r\n      data.template,\r\n      ObjectContentOrigins.SPAWNER,\r\n      null,\r\n      data.resolve,\r\n      true,\r\n      false,\r\n      data.mediaOptions\r\n    ).entity;\r\n\r\n    superSpawner.el.object3D.getWorldPosition(spawnedEntity.object3D.position);\r\n    superSpawner.el.object3D.getWorldQuaternion(spawnedEntity.object3D.quaternion);\r\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n\r\n    superSpawner.el.emit(\"spawned-entity-created\", { target: spawnedEntity });\r\n\r\n    state.held = spawnedEntity;\r\n\r\n    superSpawner.activateCooldown();\r\n    state.spawning = true;\r\n\r\n    spawnedEntity.addEventListener(\r\n      \"media-loaded\",\r\n      () => {\r\n        spawnedEntity.object3D.scale.copy(superSpawner.spawnedMediaScale);\r\n        spawnedEntity.object3D.matrixNeedsUpdate = true;\r\n        state.spawning = false;\r\n        superSpawner.el.emit(\"spawned-entity-loaded\", { target: spawnedEntity });\r\n      },\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  tick() {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    this.maybeSpawn(interaction.state.leftHand, interaction.options.leftHand.grabPath);\r\n    this.maybeSpawn(interaction.state.rightHand, interaction.options.rightHand.grabPath);\r\n    this.maybeSpawn(interaction.state.rightRemote, interaction.options.rightRemote.grabPath);\r\n    this.maybeSpawn(interaction.state.leftRemote, interaction.options.leftRemote.grabPath);\r\n  }\r\n}\r\n","import { paths } from \"./userinput/paths\";\r\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\r\n\r\nfunction copyState(previous, current, isTeleporting) {\r\n  previous.held = current.held;\r\n  previous.hovered = current.hovered;\r\n  previous.isTeleporting = isTeleporting;\r\n}\r\n\r\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\r\nconst STRENGTH = {\r\n  DROP: 0.1,\r\n  PICKUP: 0.2,\r\n  BUTTON_PRESSED: 0.2,\r\n  HOVER: 0.08,\r\n  STRETCH_BASE: 0.05,\r\n  STRETCH_DISTANCE: 0.2,\r\n  TELEPORTING: 0.08,\r\n  TELEPORTED: 0.2\r\n};\r\n\r\nfunction determineStrength(previous, current, isTeleporting) {\r\n  if (previous.held && !current.held) {\r\n    return STRENGTH.DROP;\r\n  } else if (!previous.held && current.held) {\r\n    return STRENGTH.PICKUP;\r\n  } else if (!previous.hovered && current.hovered) {\r\n    return STRENGTH.HOVER;\r\n  } else if (isTeleporting) {\r\n    return STRENGTH.TELEPORTING;\r\n  } else if (previous.isTeleporting && !isTeleporting) {\r\n    return STRENGTH.TELEPORTED;\r\n  } else {\r\n    return 0;\r\n  }\r\n}\r\n\r\nfunction determineStretchStrength(stretchSystem) {\r\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\r\n    return 0;\r\n  }\r\n\r\n  return THREE.Math.clamp(\r\n    STRENGTH.STRETCH_BASE +\r\n      STRENGTH.STRETCH_DISTANCE *\r\n        Math.abs(\r\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\r\n            stretchSystem.initialStretchDistance\r\n        ),\r\n    0,\r\n    0.5\r\n  );\r\n}\r\n\r\nexport class HapticFeedbackSystem {\r\n  constructor() {\r\n    this.state = {\r\n      rightHand: {\r\n        held: null,\r\n        hovered: null,\r\n        isTeleporting: false\r\n      },\r\n      rightRemote: {\r\n        held: null,\r\n        hovered: null,\r\n        isTeleporting: false\r\n      },\r\n      leftHand: {\r\n        held: null,\r\n        hovered: null,\r\n        isTeleporting: false\r\n      },\r\n      leftRemote: {\r\n        held: null,\r\n        hovered: null,\r\n        isTeleporting: false\r\n      }\r\n    };\r\n  }\r\n\r\n  tick(twoPointStretchingSystem, interactLeft, interactRight) {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\r\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\r\n    if (!leftActuator && !rightActuator) {\r\n      return;\r\n    }\r\n\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    const { leftHand, rightHand, rightRemote, leftRemote } = interaction.state;\r\n    this.leftTeleporter =\r\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\r\n    this.rightTeleporter =\r\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\r\n\r\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\r\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\r\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\r\n    const leftRemoteStrength = determineStrength(this.state.leftRemote, leftRemote, false);\r\n    const buttonLeftStrength = interactLeft ? STRENGTH.BUTTON_PRESSED : 0;\r\n    const buttonRightStrength = interactRight ? STRENGTH.BUTTON_PRESSED : 0;\r\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\r\n\r\n    const leftStrength = Math.max(leftHandStrength, leftRemoteStrength, stretchingStrength, buttonLeftStrength);\r\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonRightStrength);\r\n\r\n    if (leftStrength && leftActuator) {\r\n      leftActuator.pulse(leftStrength, 15);\r\n    }\r\n\r\n    if (rightStrength && rightActuator) {\r\n      rightActuator.pulse(rightStrength, 15);\r\n    }\r\n\r\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\r\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\r\n    copyState(this.state.rightRemote, rightRemote, false);\r\n    copyState(this.state.leftRemote, leftRemote, false);\r\n  }\r\n}\r\n","import { BatchRawUniformGroup } from \"@mozillareality/three-batch-manager\";\r\nimport { CAMERA_MODE_INSPECT, CAMERA_LAYER_BATCH_INSPECT } from \"../camera-system\";\r\n\r\nconst tempVec3 = new Array(3);\r\nconst tempVec4 = new Array(4);\r\n\r\nexport const INSTANCE_DATA_BYTE_LENGTH = 112;\r\nconst DEFAULT_COLOR = new THREE.Color(1, 1, 1);\r\nconst HIDE_MATRIX = new THREE.Matrix4().makeScale(0, 0, 0);\r\n\r\nexport function sizeofInstances(instanceCount) {\r\n  const hubsDataSize =\r\n    instanceCount * 4 * 4 + // sweepParams\r\n    4 *\r\n      (3 + // interactorOnePos\r\n      1 + // isFrozen\r\n      3 + // interactorTwoPos\r\n        1); // time\r\n  return instanceCount * INSTANCE_DATA_BYTE_LENGTH + hubsDataSize;\r\n}\r\n\r\nconst inspectLayer = new THREE.Layers();\r\ninspectLayer.set(CAMERA_LAYER_BATCH_INSPECT);\r\n\r\nexport default class HubsBatchRawUniformGroup extends BatchRawUniformGroup {\r\n  constructor(maxInstances, meshToEl) {\r\n    const data = new ArrayBuffer(sizeofInstances(maxInstances));\r\n    super(maxInstances, \"InstanceData\", data);\r\n\r\n    let offset = this.offset;\r\n    this.hubs_sweepParams = new Float32Array(this.data, offset, 4 * maxInstances);\r\n    offset += this.hubs_sweepParams.byteLength;\r\n\r\n    this.hubs_interactorOnePos = new Float32Array(this.data, offset, 3);\r\n    offset += this.hubs_interactorOnePos.byteLength;\r\n\r\n    this.hubs_isFrozen = new Uint32Array(this.data, offset, 1);\r\n    offset += this.hubs_isFrozen.byteLength;\r\n\r\n    this.hubs_interactorTwoPos = new Float32Array(this.data, offset, 3);\r\n    offset += this.hubs_interactorTwoPos.byteLength;\r\n\r\n    this.hubs_time = new Float32Array(this.data, offset, 1);\r\n    offset += this.hubs_time.byteLength;\r\n\r\n    this.offset = offset;\r\n\r\n    this.meshToEl = meshToEl;\r\n    const isMobile = AFRAME.utils.device.isMobile();\r\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\r\n    this.isTouchscreen = isMobile && !isMobileVR;\r\n  }\r\n\r\n  update(time) {\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    if (!interaction.ready) return; //DOMContentReady workaround\r\n    const cameraSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].cameraSystem;\r\n    const inspecting = cameraSystem.mode === CAMERA_MODE_INSPECT && !cameraSystem.enableLights;\r\n    let interactorOne, interactorTwo;\r\n\r\n    for (let instanceId = 0; instanceId < this.meshes.length; instanceId++) {\r\n      const mesh = this.meshes[instanceId];\r\n      if (!mesh) continue;\r\n\r\n      mesh.updateMatrices();\r\n\r\n      // TODO need to account for nested visibility deeper than 1 level\r\n      const isVisible =\r\n        mesh.visible &&\r\n        (mesh.parent && mesh.parent.visible) &&\r\n        mesh.el.object3D.visible &&\r\n        (mesh.el.object3D.parent && mesh.el.object3D.parent.visible);\r\n      this.setInstanceTransform(\r\n        instanceId,\r\n        isVisible && (!inspecting || mesh.layers.test(inspectLayer)) ? mesh.matrixWorld : HIDE_MATRIX\r\n      );\r\n      this.setInstanceColor(instanceId, mesh.material.color || DEFAULT_COLOR, mesh.material.opacity || 1);\r\n\r\n      const el = this.meshToEl.get(mesh);\r\n      if (el) {\r\n        const obj = el.object3D;\r\n        const hoverableVisuals = el.components[\"hoverable-visuals\"];\r\n        if (hoverableVisuals) {\r\n          const worldY = obj.matrixWorld.elements[13];\r\n          const ms1 = obj.matrixWorld.elements[4];\r\n          const ms2 = obj.matrixWorld.elements[5];\r\n          const ms3 = obj.matrixWorld.elements[6];\r\n          const worldScale = Math.sqrt(ms1 * ms1 + ms2 * ms2 + ms3 * ms3);\r\n          const scaledRadius = worldScale * hoverableVisuals.geometryRadius;\r\n\r\n          const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\r\n          const isSpawner = !!el.components[\"super-spawner\"];\r\n          const isFrozen = el.sceneEl.is(\"frozen\");\r\n          const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\r\n\r\n          let highlightInteractorOne, highlightInteractorTwo;\r\n          if (interaction.state.leftRemote.hovered === el && !interaction.state.leftRemote.held) {\r\n            interactorOne = interaction.options.leftRemote.entity.object3D;\r\n            highlightInteractorOne = true;\r\n          } else if (interaction.state.leftHand.hovered === el && !interaction.state.leftHand.held) {\r\n            interactorOne = interaction.options.leftHand.entity.object3D;\r\n            highlightInteractorOne = true;\r\n          }\r\n\r\n          if (interaction.state.rightRemote.hovered === el && !interaction.state.rightRemote.held) {\r\n            interactorTwo = interaction.options.rightRemote.entity.object3D;\r\n            highlightInteractorTwo = true;\r\n          } else if (interaction.state.rightHand.hovered === el && !interaction.state.rightHand.held) {\r\n            interactorTwo = interaction.options.rightHand.entity.object3D;\r\n            highlightInteractorTwo = true;\r\n          }\r\n\r\n          tempVec4[0] = worldY - scaledRadius;\r\n          tempVec4[1] = worldY + scaledRadius;\r\n          tempVec4[2] = !!highlightInteractorOne && !hideDueToPinning && !this.isTouchscreen;\r\n          tempVec4[3] = !!highlightInteractorTwo && !hideDueToPinning && !this.isTouchscreen;\r\n          this.hubs_sweepParams.set(tempVec4, instanceId * 4);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (interactorOne) {\r\n      tempVec3[0] = interactorOne.matrixWorld.elements[12];\r\n      tempVec3[1] = interactorOne.matrixWorld.elements[13];\r\n      tempVec3[2] = interactorOne.matrixWorld.elements[14];\r\n      this.hubs_interactorOnePos.set(tempVec3);\r\n    }\r\n\r\n    if (interactorTwo) {\r\n      tempVec3[0] = interactorTwo.matrixWorld.elements[12];\r\n      tempVec3[1] = interactorTwo.matrixWorld.elements[13];\r\n      tempVec3[2] = interactorTwo.matrixWorld.elements[14];\r\n      this.hubs_interactorTwoPos.set(tempVec3);\r\n    }\r\n\r\n    this.hubs_time[0] = time;\r\n    this.hubs_isFrozen[0] = AFRAME.scenes[0].is(\"frozen\") ? 1 : 0;\r\n  }\r\n}\r\n","import { BatchManager } from \"@mozillareality/three-batch-manager\";\r\n\r\nimport HubsBatchRawUniformGroup from \"./render-manager/hubs-batch-raw-uniform-group\";\r\nimport { sizeofInstances } from \"./render-manager/hubs-batch-raw-uniform-group\";\r\nimport unlitBatchVert from \"./render-manager/unlit-batch.vert\";\r\nimport unlitBatchFrag from \"./render-manager/unlit-batch.frag\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n\r\nconst MAX_INSTANCES = 500;\r\nconst UBO_BYTE_LENGTH = sizeofInstances(MAX_INSTANCES);\r\n\r\nexport class BatchManagerSystem {\r\n  constructor(scene, renderer) {\r\n    this.meshToEl = new WeakMap();\r\n    const gl = renderer.context;\r\n\r\n    if (qsTruthy(\"disableBatching\")) {\r\n      console.warn(\"Batching disabled by user via disableBatching. Disabling batching.\");\r\n      return;\r\n    }\r\n\r\n    if (!(window.WebGL2RenderingContext && gl instanceof WebGL2RenderingContext)) {\r\n      console.warn(\"Batching requires WebGL 2. Disabling batching.\");\r\n      return;\r\n    }\r\n\r\n    if (UBO_BYTE_LENGTH > gl.getParameter(gl.MAX_UNIFORM_BLOCK_SIZE)) {\r\n      console.warn(\"Insufficient MAX_UNIFORM_BLOCK_SIZE, Disabling batching.\");\r\n      return;\r\n    }\r\n\r\n    this.batchingEnabled = qsTruthy(\"forceMeshBatching\") || qsTruthy(\"forceImageBatching\");\r\n\r\n    if (!this.batchingEnabled) {\r\n      console.warn(\"Batching must be forced on with forceMeshBatching or forceImageBatching. Disabling batching.\");\r\n      return;\r\n    }\r\n\r\n    this.ubo = new HubsBatchRawUniformGroup(MAX_INSTANCES, this.meshToEl);\r\n    this.batchManager = new BatchManager(scene, renderer, {\r\n      maxInstances: MAX_INSTANCES,\r\n      ubo: this.ubo,\r\n      shaders: {\r\n        unlit: {\r\n          vertexShader: unlitBatchVert,\r\n          fragmentShader: unlitBatchFrag\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  addObject(rootObject) {\r\n    if (!this.batchingEnabled) return 0;\r\n\r\n    let batchedCount = 0;\r\n    rootObject.traverse(object => {\r\n      if (object.isMesh) {\r\n        if (this.batchManager.addMesh(object)) batchedCount++;\r\n      }\r\n    });\r\n    return batchedCount;\r\n  }\r\n\r\n  removeObject(rootObject) {\r\n    if (!this.batchingEnabled) return;\r\n\r\n    rootObject.traverse(object => {\r\n      if (object.isMesh) {\r\n        this.batchManager.removeMesh(object);\r\n      }\r\n    });\r\n  }\r\n\r\n  tick(time) {\r\n    if (!this.batchingEnabled) return;\r\n\r\n    this.batchManager.update(time);\r\n  }\r\n}\r\n","import { paths } from \"./userinput/paths\";\r\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\r\nimport { isUI } from \"./interactions\";\r\n\r\nexport class InteractionSfxSystem {\r\n  constructor() {}\r\n\r\n  tick(interaction, userinput, sfx) {\r\n    const state = interaction.state;\r\n    const previousState = interaction.previousState;\r\n\r\n    if (\r\n      state.leftHand.held !== previousState.leftHand.held ||\r\n      state.rightHand.held !== previousState.rightHand.held ||\r\n      state.rightRemote.held !== previousState.rightRemote.held ||\r\n      (isUI(state.rightRemote.hovered) && state.rightRemote.hovered !== previousState.rightRemote.hovered) ||\r\n      state.leftRemote.held !== previousState.leftRemote.held ||\r\n      (isUI(state.leftRemote.hovered) && state.leftRemote.hovered !== previousState.leftRemote.hovered)\r\n    ) {\r\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\r\n    }\r\n\r\n    if (userinput.get(paths.actions.logInteractionState)) {\r\n      console.log(\r\n        \"Interaction System State\\nleftHand held\",\r\n        state.leftHand.held,\r\n        \"\\nleftHand hovered\",\r\n        state.leftHand.hovered,\r\n        \"\\nrightHand held\",\r\n        state.rightHand.held,\r\n        \"\\nrightHand hovered\",\r\n        state.rightHand.hovered,\r\n        \"\\nrightRemote held\",\r\n        state.rightRemote.held,\r\n        \"\\nrightRemote hovered\",\r\n        state.rightRemote.hovered,\r\n        \"\\nleftRemote held\",\r\n        state.leftRemote.held,\r\n        \"\\nleftRemote hovered\",\r\n        state.leftRemote.hovered\r\n      );\r\n    }\r\n  }\r\n}\r\n","import \"./configs\";\r\nimport { getThemeColor } from \"./theme\";\r\nimport ColorShiftWorker from \"../workers/color-shift.worker.js\";\r\nimport { promisifyWorker } from \"./promisify-worker.js\";\r\nconst colorShift = promisifyWorker(new ColorShiftWorker());\r\n\r\nfunction getThemeColorShifter(type) {\r\n  // Goal of this algorithm is to take a ctx pointing to a spritesheet\r\n  // that has a single saturated color, and convert it to another.\r\n  return async (ctx, w, h) => {\r\n    const data = ctx.getImageData(0, 0, w, h);\r\n    const color = type === \"action\" ? getThemeColor(\"action-color\") : getThemeColor(\"notice-background-color\");\r\n    const res = await colorShift(data.data.buffer, [data.data.buffer], { type, color });\r\n    ctx.putImageData(new ImageData(res, w, h), 0, 0);\r\n  };\r\n}\r\n\r\nexport { getThemeColorShifter };\r\n","/* global AFRAME THREE */\r\n\r\n// See doc/spritesheet-generation.md for information about this spritesheet\r\nimport spritesheetAction from \"../assets/images/spritesheets/sprite-system-action-spritesheet.json\";\r\nimport spritesheetNotice from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.json\";\r\nimport { createImageTexture } from \"../utils/media-utils\";\r\nimport spritesheetActionPng from \"../assets/images/spritesheets/sprite-system-action-spritesheet.png\";\r\nimport spritesheetNoticePng from \"../assets/images/spritesheets/sprite-system-notice-spritesheet.png\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport vert from \"./sprites/sprite.vert\";\r\nimport frag from \"./sprites/sprite.frag\";\r\nimport { getThemeColorShifter } from \"../utils/theme-sprites\";\r\n\r\nconst multiviewVertPrefix = [\r\n  // GLSL 3.0 conversion\r\n  \"#version 300 es\",\r\n  \"#define attribute in\",\r\n  \"#define varying out\",\r\n  \"#define texture2D texture\",\r\n  \"#extension GL_OVR_multiview : require\",\r\n  \"layout(num_views = 2) in;\",\r\n  \"uniform mat4 modelViewMatrix;\",\r\n  \"uniform mat4 modelViewMatrix2;\",\r\n  \"#define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)\",\r\n  \"uniform mat4 projectionMatrix;\",\r\n  \"uniform mat4 projectionMatrix2;\",\r\n  \"#define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)\",\r\n  \"\"\r\n].join(\"\\n\");\r\nconst nonmultiviewVertPrefix = [\"uniform mat4 modelViewMatrix;\", \"uniform mat4 projectionMatrix;\", \"\"].join(\"\\n\");\r\n\r\nconst multiviewFragPrefix = [\r\n  \"#version 300 es\",\r\n  \"#define varying in\",\r\n  \"out highp vec4 pc_fragColor;\",\r\n  \"#define gl_FragColor pc_fragColor\",\r\n  \"#define texture2D texture\",\r\n  \"\"\r\n].join(\"\\n\");\r\n\r\nconst nonmultiviewFragPrefix = \"\";\r\n\r\nfunction isVisible(o) {\r\n  if (!o.visible) return false;\r\n  if (!o.parent) return true;\r\n  return isVisible(o.parent);\r\n}\r\n\r\nAFRAME.registerComponent(\"sprite\", {\r\n  schema: { name: { type: \"string\" } },\r\n  tick() {\r\n    // TODO when we run out of sprites we currently just stop rendering them. We need to do something better.\r\n    if (!(this.didRegisterWithSystem || this.didFailToRegister) && this.el.sceneEl.systems[\"hubs-systems\"]) {\r\n      const registered = this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.add(this);\r\n      this.didRegisterWithSystem = registered > 0;\r\n      this.didFailToRegister = registered < 0;\r\n    }\r\n  },\r\n\r\n  update() {\r\n    if (this.didRegisterWithSystem) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.updateUVs(this);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (this.didRegisterWithSystem) {\r\n      this.el.sceneEl.systems[\"hubs-systems\"].spriteSystem.remove(this);\r\n    }\r\n  }\r\n});\r\n\r\nconst normalizedFrame = (function() {\r\n  const memo = new Map();\r\n  return function normalizedFrame(name, spritesheet, missingSprites) {\r\n    let ret = memo.get(name);\r\n    if (ret) {\r\n      return ret;\r\n    } else {\r\n      if (!spritesheet.frames[name]) {\r\n        if (missingSprites.indexOf(name) === -1) {\r\n          missingSprites.push(name);\r\n        }\r\n        ret = { x: 0, y: 0, w: 0, h: 0 };\r\n        memo.set(name, ret);\r\n        return ret;\r\n      }\r\n      const size = spritesheet.meta.size;\r\n      const frame = spritesheet.frames[name].frame;\r\n      ret = {\r\n        x: frame.x / size.w,\r\n        y: frame.y / size.h,\r\n        w: frame.w / size.w,\r\n        h: frame.h / size.h\r\n      };\r\n      memo.set(name, ret);\r\n      return ret;\r\n    }\r\n  };\r\n})();\r\n\r\nconst getSheetType = sprite => (spritesheetAction.frames[sprite.data.name] ? \"action\" : \"notice\");\r\nconst SHEET_TYPES = [\"action\", \"notice\"];\r\n\r\nconst raycastOnSprite = (function() {\r\n  const vA = new THREE.Vector3();\r\n  const vB = new THREE.Vector3();\r\n  const vC = new THREE.Vector3();\r\n  const vD = new THREE.Vector3();\r\n  const point = new THREE.Vector3();\r\n  const intersectionInfo = { distance: 0, point, object: null };\r\n\r\n  return function raycast(raycaster, intersects) {\r\n    this.updateMatrices();\r\n    vA.set(-0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\r\n    vB.set(0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\r\n    vC.set(-0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\r\n    let intersect = raycaster.ray.intersectTriangle(vA, vC, vB, false, point);\r\n    if (intersect === null) {\r\n      vD.set(0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\r\n      intersect = raycaster.ray.intersectTriangle(vB, vC, vD, false, point);\r\n      if (intersect === null) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    const distance = raycaster.ray.origin.distanceTo(point);\r\n    if (distance < raycaster.near || distance > raycaster.far) return;\r\n\r\n    intersectionInfo.distance = distance;\r\n    intersectionInfo.point = point;\r\n    intersectionInfo.object = this;\r\n    intersects.push(intersectionInfo);\r\n  };\r\n})();\r\n\r\nfunction getHoverableVisuals(el) {\r\n  if (!el || !el.components) return null;\r\n  if (el.components[\"hoverable-visuals\"]) {\r\n    return el.components[\"hoverable-visuals\"];\r\n  }\r\n  return getHoverableVisuals(el.parentEl);\r\n}\r\n\r\nfunction enableSweepingEffect(comp) {\r\n  const hoverableVisuals = getHoverableVisuals(comp.el);\r\n  if (!hoverableVisuals) {\r\n    return false;\r\n  }\r\n\r\n  const isPinned = hoverableVisuals.el.components.pinnable && hoverableVisuals.el.components.pinnable.data.pinned;\r\n  const isSpawner = !!hoverableVisuals.el.components[\"super-spawner\"];\r\n  const isFrozen = hoverableVisuals.el.sceneEl.is(\"frozen\");\r\n  const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\r\n  return hoverableVisuals.data.enableSweepingEffect && !hideDueToPinning;\r\n}\r\n\r\nfunction createGeometry(maxSprites) {\r\n  const geometry = new THREE.BufferGeometry();\r\n  geometry.addAttribute(\"a_vertices\", new THREE.BufferAttribute(new Float32Array(maxSprites * 3 * 4), 3, false));\r\n  geometry.addAttribute(\r\n    \"a_hubs_EnableSweepingEffect\",\r\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4), 1, false)\r\n  );\r\n  geometry.addAttribute(\r\n    \"a_hubs_SweepParams\",\r\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4 * 2), 2, false)\r\n  );\r\n  geometry.addAttribute(\"a_uvs\", new THREE.BufferAttribute(new Float32Array(maxSprites * 2 * 4), 2, false));\r\n  const mvCols = new THREE.InterleavedBuffer(new Float32Array(maxSprites * 16 * 4), 16);\r\n  geometry.addAttribute(\"mvCol0\", new THREE.InterleavedBufferAttribute(mvCols, 4, 0, false));\r\n  geometry.addAttribute(\"mvCol1\", new THREE.InterleavedBufferAttribute(mvCols, 4, 4, false));\r\n  geometry.addAttribute(\"mvCol2\", new THREE.InterleavedBufferAttribute(mvCols, 4, 8, false));\r\n  geometry.addAttribute(\"mvCol3\", new THREE.InterleavedBufferAttribute(mvCols, 4, 12, false));\r\n  const indices = new Array(3 * 2 * maxSprites);\r\n  for (let i = 0; i < maxSprites; i++) {\r\n    indices[i * 3 * 2 + 0] = i * 4 + 0;\r\n    indices[i * 3 * 2 + 1] = i * 4 + 2;\r\n    indices[i * 3 * 2 + 2] = i * 4 + 1;\r\n    indices[i * 3 * 2 + 3] = i * 4 + 1;\r\n    indices[i * 3 * 2 + 4] = i * 4 + 2;\r\n    indices[i * 3 * 2 + 5] = i * 4 + 3;\r\n  }\r\n  geometry.setIndex(indices);\r\n  return geometry;\r\n}\r\n\r\nconst ZEROS = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\nexport class SpriteSystem {\r\n  raycast(raycaster, intersects) {\r\n    for (let i = 0; i < SHEET_TYPES.length; i++) {\r\n      const sheetType = SHEET_TYPES[i];\r\n      const slots = this.slots[sheetType];\r\n\r\n      for (let i = 0, l = slots.length; i < l; i++) {\r\n        if (!slots[i]) continue;\r\n\r\n        const o = this.indexWithSprite[sheetType].get(i).el.object3D;\r\n        if (isVisible(o)) {\r\n          raycastOnSprite.call(o, raycaster, intersects);\r\n        }\r\n      }\r\n    }\r\n\r\n    return intersects;\r\n  }\r\n  constructor(scene) {\r\n    this.missingSprites = [];\r\n    this.maxSprites = 1024;\r\n    this.slots = { action: new Array(this.maxSprites), notice: new Array(this.maxSprites) };\r\n    this.spriteWithIndex = { action: new Map(), notice: new Map() };\r\n    this.indexWithSprite = { action: new Map(), notice: new Map() };\r\n    this.stack = { action: new Array(this.maxSprites), notice: new Array(this.maxSprites) };\r\n    this.meshes = {};\r\n\r\n    for (const stack of Object.values(this.stack)) {\r\n      for (let i = 0; i < this.maxSprites; i++) {\r\n        stack[i] = this.maxSprites - 1 - i;\r\n      }\r\n    }\r\n\r\n    const vertexShader = String.prototype.concat(\r\n      scene.renderer.vr.multiview ? multiviewVertPrefix : nonmultiviewVertPrefix,\r\n      vert\r\n    );\r\n    const fragmentShader = String.prototype.concat(\r\n      scene.renderer.vr.multiview ? multiviewFragPrefix : nonmultiviewFragPrefix,\r\n      frag\r\n    );\r\n\r\n    const domReady = waitForDOMContentLoaded();\r\n\r\n    Promise.all([domReady]).then(() => {\r\n      for (const [spritesheetPng, type] of [[spritesheetActionPng, \"action\"], [spritesheetNoticePng, \"notice\"]]) {\r\n        Promise.all([createImageTexture(spritesheetPng, getThemeColorShifter(type)), waitForDOMContentLoaded()]).then(\r\n          ([spritesheetTexture]) => {\r\n            const material = new THREE.RawShaderMaterial({\r\n              uniforms: {\r\n                u_spritesheet: { value: spritesheetTexture },\r\n                hubs_Time: { value: 0 }\r\n              },\r\n              vertexShader,\r\n              fragmentShader,\r\n              side: THREE.DoubleSide,\r\n              transparent: true\r\n            });\r\n            const mesh = (this.meshes[type] = new THREE.Mesh(createGeometry(this.maxSprites), material));\r\n            const el = document.createElement(\"a-entity\");\r\n            el.classList.add(\"ui\");\r\n            scene.appendChild(el);\r\n            el.setObject3D(\"mesh\", mesh);\r\n            mesh.frustumCulled = false;\r\n            mesh.renderOrder = window.APP.RENDER_ORDER.HUD_ICONS;\r\n            mesh.raycast = this.raycast.bind(this);\r\n          }\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  tick(t) {\r\n    if (!this.meshes.action || !this.meshes.notice) return;\r\n\r\n    for (let i = 0; i < SHEET_TYPES.length; i++) {\r\n      const sheetType = SHEET_TYPES[i];\r\n      const mesh = this.meshes[sheetType];\r\n      mesh.material.uniforms.hubs_Time.value = t;\r\n      mesh.material.uniformsNeedUpdate = true;\r\n\r\n      const mvCols = mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\r\n      const aEnableSweepingEffect = mesh.geometry.attributes[\"a_hubs_EnableSweepingEffect\"];\r\n      const aSweepParams = mesh.geometry.attributes[\"a_hubs_SweepParams\"];\r\n      for (let i = 0, l = this.slots[sheetType].length; i < l; i++) {\r\n        const slots = this.slots[sheetType];\r\n        if (!slots[i]) continue;\r\n\r\n        const indexWithSprite = this.indexWithSprite[sheetType];\r\n\r\n        const sprite = indexWithSprite.get(i);\r\n\r\n        if (isVisible(sprite.el.object3D)) {\r\n          const enableSweepingEffectValue = enableSweepingEffect(sprite) ? 1 : 0;\r\n          aEnableSweepingEffect.array[i * 4 + 0] = enableSweepingEffectValue;\r\n          aEnableSweepingEffect.array[i * 4 + 1] = enableSweepingEffectValue;\r\n          aEnableSweepingEffect.array[i * 4 + 2] = enableSweepingEffectValue;\r\n          aEnableSweepingEffect.array[i * 4 + 3] = enableSweepingEffectValue;\r\n          aEnableSweepingEffect.needsUpdate = true;\r\n          if (enableSweepingEffectValue) {\r\n            const hoverableVisuals = getHoverableVisuals(sprite.el);\r\n            const s = hoverableVisuals.sweepParams[0];\r\n            const t = hoverableVisuals.sweepParams[1];\r\n            aSweepParams.setXY(4 * i + 0, s, t);\r\n            aSweepParams.setXY(4 * i + 1, s, t);\r\n            aSweepParams.setXY(4 * i + 2, s, t);\r\n            aSweepParams.setXY(4 * i + 3, s, t);\r\n            aSweepParams.needsUpdate = true;\r\n          }\r\n\r\n          sprite.el.object3D.updateMatrices();\r\n          const mat4 = sprite.el.object3D.matrixWorld;\r\n          mvCols.array.set(mat4.elements, i * 4 * 16 + 0);\r\n          mvCols.array.set(mat4.elements, i * 4 * 16 + 1 * 16);\r\n          mvCols.array.set(mat4.elements, i * 4 * 16 + 2 * 16);\r\n          mvCols.array.set(mat4.elements, i * 4 * 16 + 3 * 16);\r\n          mvCols.needsUpdate = true;\r\n        } else {\r\n          mvCols.array.set(ZEROS, i * 4 * 16 + 0);\r\n          mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\r\n          mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\r\n          mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\r\n          mvCols.needsUpdate = true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  updateUVs(sprite) {\r\n    const sheetType = getSheetType(sprite);\r\n    const mesh = this.meshes[sheetType];\r\n    const spriteWithIndex = this.spriteWithIndex[sheetType];\r\n\r\n    const flipY = mesh.material.uniforms.u_spritesheet.value.flipY;\r\n    const i = spriteWithIndex.get(sprite);\r\n    const frame = normalizedFrame(\r\n      sprite.data.name,\r\n      sheetType === \"action\" ? spritesheetAction : spritesheetNotice,\r\n      this.missingSprites\r\n    );\r\n    const aUvs = mesh.geometry.attributes[\"a_uvs\"];\r\n\r\n    aUvs.setXY(i * 4 + 0, frame.x, flipY ? 1 - frame.y : frame.y);\r\n    aUvs.setXY(i * 4 + 1, frame.x + frame.w, flipY ? 1 - frame.y : frame.y);\r\n    aUvs.setXY(i * 4 + 2, frame.x, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\r\n    aUvs.setXY(i * 4 + 3, frame.x + frame.w, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\r\n    aUvs.needsUpdate = true;\r\n  }\r\n\r\n  add(sprite) {\r\n    if (!this.meshes.action || !this.meshes.notice) {\r\n      return 0;\r\n    }\r\n    const sheetType = getSheetType(sprite);\r\n    const stack = this.stack[sheetType];\r\n    const i = stack.pop();\r\n    if (i === undefined) {\r\n      console.error(\"Too many sprites\");\r\n      return -1;\r\n    }\r\n    const slots = this.slots[sheetType];\r\n    const spriteWithIndex = this.spriteWithIndex[sheetType];\r\n    const indexWithSprite = this.indexWithSprite[sheetType];\r\n    const mesh = this.meshes[sheetType];\r\n    slots[i] = true;\r\n    spriteWithIndex.set(sprite, i);\r\n    indexWithSprite.set(i, sprite);\r\n\r\n    this.updateUVs(sprite);\r\n\r\n    const aVertices = mesh.geometry.attributes[\"a_vertices\"];\r\n    aVertices.setXYZ(i * 4 + 0, -0.5, 0.5, 0);\r\n    aVertices.setXYZ(i * 4 + 1, 0.5, 0.5, 0);\r\n    aVertices.setXYZ(i * 4 + 2, -0.5, -0.5, 0);\r\n    aVertices.setXYZ(i * 4 + 3, 0.5, -0.5, 0);\r\n    aVertices.needsUpdate = true;\r\n    return 1;\r\n  }\r\n\r\n  remove(sprite) {\r\n    const sheetType = getSheetType(sprite);\r\n    const slots = this.slots[sheetType];\r\n    const spriteWithIndex = this.spriteWithIndex[sheetType];\r\n    const indexWithSprite = this.indexWithSprite[sheetType];\r\n    const stack = this.stack[sheetType];\r\n    const mesh = this.meshes[sheetType];\r\n\r\n    const i = spriteWithIndex.get(sprite);\r\n    spriteWithIndex.delete(sprite);\r\n    indexWithSprite.delete(i);\r\n    slots[i] = false;\r\n    stack.push(i);\r\n\r\n    const mvCols = mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\r\n    mvCols.array.set(ZEROS, i * 4 * 16 + 0);\r\n    mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\r\n    mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\r\n    mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\r\n    mvCols.needsUpdate = true;\r\n  }\r\n}\r\n","import { setMatrixWorld, affixToWorldUp } from \"../utils/three-utils\";\r\nimport { isTagged } from \"../components/tags\";\r\nimport { applyPersistentSync } from \"../utils/permissions-utils\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nconst calculateIconTransform = (function() {\r\n  const up = new THREE.Vector3();\r\n  const backward = new THREE.Vector3();\r\n  const forward = new THREE.Vector3();\r\n  const camToWaypoint = new THREE.Vector3();\r\n  const v1 = new THREE.Vector3();\r\n  const m1 = new THREE.Matrix4();\r\n  const position = new THREE.Vector3();\r\n  let scale = 1;\r\n\r\n  return function calculateIconTransform(waypoint, viewingCamera, outMat4) {\r\n    waypoint.updateMatrices();\r\n    viewingCamera.updateMatrices();\r\n    affixToWorldUp(m1.copy(waypoint.matrixWorld), m1).extractBasis(v1, up, backward);\r\n    position\r\n      .setFromMatrixPosition(waypoint.matrixWorld)\r\n      .add(v1.addVectors(up.multiplyScalar(1.6), backward.multiplyScalar(0.15)));\r\n    camToWaypoint.subVectors(position, v1.setFromMatrixPosition(viewingCamera.matrixWorld));\r\n    const distance = camToWaypoint.length();\r\n    const minDistance = distance < 0.2 * v1.setFromMatrixColumn(viewingCamera.matrixWorld, 0).length();\r\n    if (distance < minDistance) {\r\n      scale = 0.00001;\r\n      camToWaypoint.set(0, 0, -1);\r\n    } else {\r\n      scale = 0.1 + 0.05 * distance;\r\n    }\r\n    forward\r\n      .copy(camToWaypoint)\r\n      .projectOnPlane(up.set(0, 1, 0))\r\n      .normalize();\r\n\r\n    return outMat4\r\n      .makeBasis(\r\n        v1.crossVectors(forward, up).multiplyScalar(scale),\r\n        up.multiplyScalar(scale),\r\n        forward.multiplyScalar(scale * -1)\r\n      )\r\n      .setPosition(position);\r\n  };\r\n})();\r\nfunction isMineOrTakeOwnership(el) {\r\n  return NAF.utils.isMine(el) || NAF.utils.takeOwnership(el);\r\n}\r\nfunction isOccupiableSpawnPoint(waypointData) {\r\n  return waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\r\n}\r\nfunction isUnoccupiableSpawnPoint(waypointData) {\r\n  return !waypointData.canBeOccupied && waypointData.canBeSpawnPoint;\r\n}\r\nfunction loadTemplateAndAddToScene(scene, templateId) {\r\n  return new Promise(resolve => {\r\n    const content = document.importNode(document.getElementById(templateId).content.children[0]);\r\n    scene.appendChild(content, true);\r\n    setTimeout(() => {\r\n      // Without this timeout, this resolves too early in Firefox for Android\r\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\r\n      resolve(content);\r\n    }, 0);\r\n  });\r\n}\r\nfunction templatesToLoadForWaypointData(data) {\r\n  const templateIds = [];\r\n  if (data.canBeClicked && data.canBeOccupied) {\r\n    templateIds.push(\"occupiable-waypoint-icon\");\r\n  } else if (data.canBeClicked && !data.canBeOccupied) {\r\n    templateIds.push(\"teleport-waypoint-icon\");\r\n  } else if (isUnoccupiableSpawnPoint(data)) {\r\n    //    templateIds.push(\"teleport-waypoint-icon\");\r\n  } else if (isOccupiableSpawnPoint(data)) {\r\n    //    templateIds.push(\"occupiable-waypoint-icon\");\r\n  } else {\r\n    //templateIds.push(\"teleport-waypoint-icon\");\r\n  }\r\n  return templateIds;\r\n}\r\nfunction loadTemplatesForWaypointData(scene, data) {\r\n  return templatesToLoadForWaypointData(data).map(templateId => loadTemplateAndAddToScene(scene, templateId));\r\n}\r\n\r\nfunction shouldTryToOccupy(waypointComponent) {\r\n  return (\r\n    waypointComponent.data.canBeOccupied &&\r\n    (NAF.utils.isMine(waypointComponent.el) ||\r\n      !(\r\n        waypointComponent.data.isOccupied &&\r\n        NAF.utils.getNetworkOwner(waypointComponent.el) &&\r\n        NAF.connection.connectedClients[NAF.utils.getNetworkOwner(waypointComponent.el)]\r\n      ))\r\n  );\r\n}\r\n\r\nfunction isOccupiedByMe(waypointComponent) {\r\n  return (\r\n    waypointComponent.data.canBeOccupied &&\r\n    waypointComponent.data.isOccupied &&\r\n    waypointComponent.el.components.networked &&\r\n    NAF.utils.isMine(waypointComponent.el)\r\n  );\r\n}\r\nfunction unoccupyWaypoint(waypointComponent) {\r\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: false });\r\n}\r\nfunction unoccupyWaypoints(waypointComponents) {\r\n  waypointComponents.filter(isOccupiedByMe).forEach(unoccupyWaypoint);\r\n}\r\nfunction occupyWaypoint(waypointComponent) {\r\n  waypointComponent.el.setAttribute(\"waypoint\", { isOccupied: true });\r\n}\r\n\r\nfunction uuid(el) {\r\n  return el.object3D.uuid;\r\n}\r\n\r\nexport class WaypointSystem {\r\n  constructor(scene, characterController) {\r\n    this.helperMat4 = new THREE.Matrix4();\r\n    this.scene = scene;\r\n    this.loading = [];\r\n    this.ready = [];\r\n    this.waypointForTemplateEl = {};\r\n    this.elementsFromTemplatesFor = {};\r\n    this.eventHandlers = [];\r\n    this.lostOwnershipOfWaypoint = this.lostOwnershipOfWaypoint.bind(this);\r\n    waitForDOMContentLoaded().then(() => {\r\n      loadTemplateAndAddToScene(scene, \"waypoint-preview-avatar-template\").then(el => {\r\n        this.waypointPreviewAvatar = el;\r\n        this.waypointPreviewAvatar.object3D.visible = false;\r\n      });\r\n    });\r\n    this.characterController = characterController;\r\n  }\r\n\r\n  releaseAnyOccupiedWaypoints() {\r\n    unoccupyWaypoints(this.ready);\r\n    if (this.currentWaypoint) {\r\n      this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\r\n    }\r\n  }\r\n\r\n  teleportToWaypoint(iconEl, waypointComponent) {\r\n    return function onInteract() {\r\n      this.releaseAnyOccupiedWaypoints();\r\n      waypointComponent.el.object3D.updateMatrices();\r\n      this.characterController.shouldLandWhenPossible = true;\r\n      this.characterController.enqueueWaypointTravelTo(\r\n        waypointComponent.el.object3D.matrixWorld,\r\n        false,\r\n        waypointComponent.data\r\n      );\r\n    }.bind(this);\r\n  }\r\n  tryTeleportToOccupiableWaypoint(iconEl, waypointComponent) {\r\n    return function onInteract() {\r\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\r\n      this.tryToOccupy(waypointComponent).then(didOccupy => {\r\n        if (didOccupy) {\r\n          waypointComponent.el.object3D.updateMatrices();\r\n          this.characterController.shouldLandWhenPossible = true;\r\n          this.characterController.enqueueWaypointTravelTo(\r\n            waypointComponent.el.object3D.matrixWorld,\r\n            false,\r\n            waypointComponent.data\r\n          );\r\n          unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\r\n        }\r\n      });\r\n    }.bind(this);\r\n  }\r\n  setupEventHandlersFor(component) {\r\n    return function setupEventHandlers(el) {\r\n      const id = uuid(el);\r\n      this.eventHandlers[id] = this.eventHandlers[id] || {};\r\n      if (\r\n        component.data.canBeClicked &&\r\n        (el.classList.contains(\"teleport-waypoint-icon\") || el.classList.contains(\"occupiable-waypoint-icon\"))\r\n      ) {\r\n        const onHover = () => {\r\n          component.el.object3D.updateMatrices();\r\n          if (this.waypointPreviewAvatar && !this.waypointForTemplateEl[id].data.willMaintainInitialOrientation) {\r\n            this.waypointPreviewAvatar.object3D.visible = true;\r\n            component.el.object3D.updateMatrices();\r\n            setMatrixWorld(this.waypointPreviewAvatar.object3D, component.el.object3D.matrixWorld);\r\n          }\r\n        };\r\n        const onUnhover = () => {\r\n          if (this.waypointPreviewAvatar) {\r\n            this.waypointPreviewAvatar.object3D.visible = false;\r\n          }\r\n        };\r\n        el.object3D.addEventListener(\"hovered\", onHover);\r\n        el.object3D.addEventListener(\"unhovered\", onUnhover);\r\n        this.eventHandlers[id][\"hovered\"] = onHover;\r\n        this.eventHandlers[id][\"unhovered\"] = onUnhover;\r\n      }\r\n      if (isTagged(el, \"singleActionButton\") && component.data.canBeClicked) {\r\n        let onInteract = () => {\r\n          console.log(\"interacted with\", el, \"associated with waypoint\", component);\r\n        };\r\n        if (el.classList.contains(\"teleport-waypoint-icon\")) {\r\n          onInteract = this.teleportToWaypoint(el, component);\r\n        } else if (el.classList.contains(\"occupiable-waypoint-icon\")) {\r\n          onInteract = this.tryTeleportToOccupiableWaypoint(el, component);\r\n        }\r\n        el.object3D.addEventListener(\"interact\", onInteract);\r\n        this.eventHandlers[id][\"interact\"] = onInteract;\r\n      }\r\n    }.bind(this);\r\n  }\r\n  registerComponent(component) {\r\n    this.loading.push(component);\r\n    const setupEventHandlers = this.setupEventHandlersFor(component);\r\n    const waypointId = uuid(component.el);\r\n    this.elementsFromTemplatesFor[waypointId] = this.elementsFromTemplatesFor[waypointId] || [];\r\n    Promise.all(loadTemplatesForWaypointData(this.scene, component.data)).then(elementsFromTemplates => {\r\n      const li = this.loading.indexOf(component);\r\n      if (li === -1) {\r\n        return null;\r\n      }\r\n      this.loading.splice(li, 1);\r\n      this.ready.push(component);\r\n      this.elementsFromTemplatesFor[waypointId].push(...elementsFromTemplates);\r\n      elementsFromTemplates.forEach(el => {\r\n        this.waypointForTemplateEl[uuid(el)] = component;\r\n      });\r\n      elementsFromTemplates.forEach(setupEventHandlers);\r\n    });\r\n  }\r\n  unregisterComponent(component) {\r\n    const li = this.loading.indexOf(component);\r\n    if (li !== -1) {\r\n      this.loading.splice(li, 1);\r\n    }\r\n    const ri = this.ready.indexOf(component);\r\n    if (ri !== -1) {\r\n      this.ready.splice(ri, 1);\r\n      const waypointId = uuid(component.el);\r\n      const elementsFromTemplates = this.elementsFromTemplatesFor[waypointId];\r\n      for (let i = 0; i < elementsFromTemplates.length; i++) {\r\n        const el = elementsFromTemplates[i];\r\n        const id = uuid(el);\r\n        if (this.eventHandlers[id]) {\r\n          const removeEventListener = eventName => {\r\n            if (this.eventHandlers[id][eventName]) {\r\n              el.object3D.removeEventListener(eventName, this.eventHandlers[id][eventName]);\r\n              delete this.eventHandlers[id][eventName];\r\n            }\r\n          };\r\n          [\"interact\", \"hovered\", \"unhovered\"].map(removeEventListener);\r\n        }\r\n        el.parentNode.removeChild(el);\r\n      }\r\n      this.elementsFromTemplatesFor[waypointId].length = 0;\r\n    }\r\n  }\r\n  getUnoccupiableSpawnPoint() {\r\n    const candidates = this.ready.filter(component => isUnoccupiableSpawnPoint(component.data));\r\n    return candidates.length && candidates.splice(Math.floor(Math.random() * candidates.length), 1)[0];\r\n  }\r\n  lostOwnershipOfWaypoint(e) {\r\n    if (this.currentWaypoint && this.currentWaypoint.el === e.detail.el) {\r\n      this.mightNeedRespawn = true;\r\n      this.ownershipLostTime = performance.now();\r\n    }\r\n  }\r\n  tryToOccupy(waypointComponent) {\r\n    return new Promise(resolve => {\r\n      if (shouldTryToOccupy(waypointComponent) && isMineOrTakeOwnership(waypointComponent.el)) {\r\n        occupyWaypoint(waypointComponent);\r\n        if (this.currentWaypoint) {\r\n          this.currentWaypoint.el.removeEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\r\n        }\r\n        this.currentWaypoint = waypointComponent;\r\n        waypointComponent.el.addEventListener(\"ownership-lost\", this.lostOwnershipOfWaypoint);\r\n        resolve(true);\r\n      } else {\r\n        resolve(false);\r\n      }\r\n    });\r\n  }\r\n  tryToOccupyAnyOf(waypoints) {\r\n    if (!waypoints.length) return Promise.resolve(null);\r\n    const candidate = waypoints.splice(Math.floor(Math.random() * waypoints.length), 1)[0];\r\n    return this.tryToOccupy(candidate).then(didOccupy => {\r\n      if (didOccupy) {\r\n        return Promise.resolve(candidate);\r\n      } else {\r\n        return this.tryToOccupyAnyOf(waypoints);\r\n      }\r\n    });\r\n  }\r\n  moveToSpawnPoint() {\r\n    if (this.currentMoveToSpawn) {\r\n      return this.currentMoveToSpawn;\r\n    }\r\n    if (!this.nextMoveToSpawn) {\r\n      this.waitOneTick = true;\r\n      this.nextMoveToSpawn = new Promise(resolve => {\r\n        this.nextMoveToSpawnResolve = resolve;\r\n      });\r\n    }\r\n    return this.nextMoveToSpawn;\r\n  }\r\n  moveToUnoccupiableSpawnPoint() {\r\n    const waypointComponent = this.getUnoccupiableSpawnPoint();\r\n    if (waypointComponent) {\r\n      this.releaseAnyOccupiedWaypoints();\r\n      waypointComponent.el.object3D.updateMatrices();\r\n      this.characterController.shouldLandWhenPossible = true;\r\n      this.characterController.enqueueWaypointTravelTo(\r\n        waypointComponent.el.object3D.matrixWorld,\r\n        true,\r\n        waypointComponent.data\r\n      );\r\n    }\r\n    return waypointComponent;\r\n  }\r\n  tick() {\r\n    if (this.waitOneTick) {\r\n      this.waitOneTick = false;\r\n      return;\r\n    }\r\n    if (!this.currentMoveToSpawn && this.nextMoveToSpawn) {\r\n      this.mightNeedRespawn = false;\r\n      this.currentMoveToSpawn = this.nextMoveToSpawn;\r\n      this.currentMoveToSpawnResolve = this.nextMoveToSpawnResolve;\r\n      this.nextMoveToSpawn = null;\r\n      this.nextMoveToSpawnResolve = null;\r\n\r\n      let resolvedWaypointOrNull;\r\n\r\n      const previouslyOccupiedWaypoints = this.ready.filter(isOccupiedByMe);\r\n      this.tryToOccupyAnyOf(this.ready.filter(component => isOccupiableSpawnPoint(component.data))).then(\r\n        waypointComponentOrNull => {\r\n          if (waypointComponentOrNull) {\r\n            const waypointComponent = waypointComponentOrNull;\r\n            unoccupyWaypoints(previouslyOccupiedWaypoints.filter(wp => wp !== waypointComponent));\r\n            waypointComponent.el.object3D.updateMatrices();\r\n            this.characterController.shouldLandWhenPossible = true;\r\n            this.characterController.enqueueWaypointTravelTo(\r\n              waypointComponent.el.object3D.matrixWorld,\r\n              true,\r\n              waypointComponent.data\r\n            );\r\n            resolvedWaypointOrNull = waypointComponent;\r\n          } else if (waypointComponentOrNull === null) {\r\n            resolvedWaypointOrNull = this.moveToUnoccupiableSpawnPoint();\r\n          }\r\n          this.currentMoveToSpawnResolve(resolvedWaypointOrNull);\r\n          this.currentMoveToSpawn = null;\r\n          this.currentMoveToSpawnResolve = null;\r\n        }\r\n      );\r\n    } else if (this.mightNeedRespawn && performance.now() - this.ownershipLostTime < 8000) {\r\n      this.mightNeedRespawn = false;\r\n      this.moveToSpawnPoint();\r\n    }\r\n    const tickTemplateEl = (elementFromTemplate, waypointComponent) => {\r\n      if (\r\n        elementFromTemplate.classList.contains(\"teleport-waypoint-icon\") ||\r\n        elementFromTemplate.classList.contains(\"occupiable-waypoint-icon\")\r\n      ) {\r\n        elementFromTemplate.object3D.visible = this.scene.is(\"frozen\");\r\n        if (elementFromTemplate.object3D.visible) {\r\n          this.viewingCamera = this.viewingCamera || document.getElementById(\"viewing-camera\").object3D;\r\n          setMatrixWorld(\r\n            elementFromTemplate.object3D,\r\n            calculateIconTransform(waypointComponent.el.object3D, this.viewingCamera, this.helperMat4)\r\n          );\r\n        }\r\n      }\r\n    };\r\n    function tickWaypoint(waypointComponent) {\r\n      const elementsFromTemplates = this.elementsFromTemplatesFor[uuid(waypointComponent.el)];\r\n      elementsFromTemplates.forEach(el => tickTemplateEl(el, waypointComponent));\r\n    }\r\n    this.ready.forEach(tickWaypoint.bind(this));\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"waypoint\", {\r\n  schema: {\r\n    canBeSpawnPoint: { default: false },\r\n    canBeOccupied: { default: false },\r\n    canBeClicked: { default: false },\r\n    willDisableMotion: { default: false },\r\n    willDisableTeleporting: { default: false },\r\n    snapToNavMesh: { default: false },\r\n    willMaintainInitialOrientation: { default: false },\r\n    willMaintainWorldUp: { default: true },\r\n    isOccupied: { default: false }\r\n  },\r\n  init() {\r\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].waypointSystem;\r\n    this.didRegisterWithSystem = false;\r\n  },\r\n  play() {\r\n    if (!this.didRegisterWithSystem) {\r\n      if (this.el.components.networked) {\r\n        applyPersistentSync(this.el.components.networked.data.networkId);\r\n      }\r\n      this.system.registerComponent(this, this.el.sceneEl);\r\n      this.didRegisterWithSystem = true;\r\n    }\r\n  },\r\n  remove() {\r\n    if (!this.didRegisterWithSystem) {\r\n      console.warn(\"Waypoint removed without ever having registered with the system.\");\r\n    } else {\r\n      this.system.unregisterComponent(this);\r\n    }\r\n  }\r\n});\r\n","const mat4Pool = [];\r\nexport function getPooledMatrix4() {\r\n  return mat4Pool.shift() || new THREE.Matrix4();\r\n}\r\nexport function freePooledMatrix4(mat4) {\r\n  mat4Pool.push(mat4);\r\n}\r\n","export const getCurrentPlayerHeight = (function() {\r\n  let avatarPOV;\r\n  let avatarRig;\r\n  return function getCurrentPlayerHeight(world) {\r\n    avatarPOV = avatarPOV || document.getElementById(\"avatar-pov-node\");\r\n    avatarRig = avatarRig || document.getElementById(\"avatar-rig\");\r\n    avatarPOV.object3D.updateMatrices();\r\n    avatarRig.object3D.updateMatrices();\r\n    if (world) {\r\n      return avatarPOV.object3D.matrixWorld.elements[13] - avatarRig.object3D.matrixWorld.elements[13];\r\n    }\r\n    return avatarPOV.object3D.matrix.elements[13];\r\n  };\r\n})();\r\n","import { paths } from \"./userinput/paths\";\r\nimport { SOUND_SNAP_ROTATE, SOUND_WAYPOINT_START, SOUND_WAYPOINT_END } from \"./sound-effects-system\";\r\nimport { easeOutQuadratic } from \"../utils/easing\";\r\nimport { getPooledMatrix4, freePooledMatrix4 } from \"../utils/mat4-pool\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport {\r\n  childMatch,\r\n  rotateInPlaceAroundWorldUp,\r\n  calculateCameraTransformForWaypoint,\r\n  interpolateAffine,\r\n  affixToWorldUp\r\n} from \"../utils/three-utils\";\r\nimport { getCurrentPlayerHeight } from \"../utils/get-current-player-height\";\r\nimport qsTruthy from \"../utils/qs_truthy\";\r\n//import { m4String } from \"../utils/pretty-print\";\r\nconst NAV_ZONE = \"character\";\r\nconst qsAllowWaypointLerp = qsTruthy(\"waypointLerp\");\r\n\r\nconst calculateDisplacementToDesiredPOV = (function() {\r\n  const translationCoordinateSpace = new THREE.Matrix4();\r\n  const translated = new THREE.Matrix4();\r\n  const localTranslation = new THREE.Matrix4();\r\n  return function calculateDisplacementToDesiredPOV(\r\n    povMat4,\r\n    allowVerticalMovement,\r\n    localDisplacement,\r\n    displacementToDesiredPOV\r\n  ) {\r\n    localTranslation.makeTranslation(localDisplacement.x, localDisplacement.y, localDisplacement.z);\r\n    translationCoordinateSpace.extractRotation(povMat4);\r\n    if (!allowVerticalMovement) {\r\n      affixToWorldUp(translationCoordinateSpace, translationCoordinateSpace);\r\n    }\r\n    translated.copy(translationCoordinateSpace).multiply(localTranslation);\r\n    return displacementToDesiredPOV.setFromMatrixPosition(translated);\r\n  };\r\n})();\r\n\r\n/**\r\n * A character controller that moves the avatar.\r\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\r\n * @namespace avatar\r\n */\r\nconst SNAP_ROTATION_RADIAN = THREE.Math.DEG2RAD * 45;\r\nconst BASE_SPEED = 3.2; //TODO: in what units?\r\nexport class CharacterControllerSystem {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.fly = false;\r\n    this.shouldLandWhenPossible = false;\r\n    this.waypoints = [];\r\n    this.waypointTravelStartTime = 0;\r\n    this.waypointTravelTime = 0;\r\n    this.navGroup = null;\r\n    this.navNode = null;\r\n    this.relativeMotion = new THREE.Vector3(0, 0, 0);\r\n    this.nextRelativeMotion = new THREE.Vector3(0, 0, 0);\r\n    this.dXZ = 0;\r\n    this.scene.addEventListener(\"nav-mesh-loaded\", () => {\r\n      this.navGroup = null;\r\n      this.navNode = null;\r\n    });\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.avatarPOV = document.getElementById(\"avatar-pov-node\");\r\n      this.avatarRig = document.getElementById(\"avatar-rig\");\r\n    });\r\n  }\r\n  // Use this API for waypoint travel so that your matrix doesn't end up in the pool\r\n  enqueueWaypointTravelTo(inTransform, isInstant, waypointComponentData) {\r\n    this.waypoints.push({ transform: getPooledMatrix4().copy(inTransform), isInstant, waypointComponentData }); //TODO: don't create new object\r\n  }\r\n  enqueueRelativeMotion(motion) {\r\n    motion.z *= -1;\r\n    this.relativeMotion.add(motion);\r\n  }\r\n  enqueueInPlaceRotationAroundWorldUp(dXZ) {\r\n    this.dXZ += dXZ;\r\n  }\r\n  // We assume the rig is at the root, and its local position === its world position.\r\n  teleportTo = (function() {\r\n    const rig = new THREE.Vector3();\r\n    const head = new THREE.Vector3();\r\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\r\n    const targetForHead = new THREE.Vector3();\r\n    const targetForRig = new THREE.Vector3();\r\n    //TODO: Use enqueue waypoint\r\n    return function teleportTo(targetWorldPosition) {\r\n      this.isMotionDisabled = false;\r\n      this.avatarRig.object3D.getWorldPosition(rig);\r\n      this.avatarPOV.object3D.getWorldPosition(head);\r\n      targetForHead.copy(targetWorldPosition);\r\n      targetForHead.y += this.avatarPOV.object3D.position.y;\r\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\r\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\r\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\r\n      this.findPositionOnNavMesh(targetForRig, targetForRig, this.avatarRig.object3D.position, navMeshExists);\r\n      this.avatarRig.object3D.matrixNeedsUpdate = true;\r\n    };\r\n  })();\r\n\r\n  travelByWaypoint = (function() {\r\n    const inMat4Copy = new THREE.Matrix4();\r\n    const inPosition = new THREE.Vector3();\r\n    const outPosition = new THREE.Vector3();\r\n    const translation = new THREE.Matrix4();\r\n    const initialOrientation = new THREE.Matrix4();\r\n    const finalScale = new THREE.Vector3();\r\n    const finalPosition = new THREE.Vector3();\r\n    const finalPOV = new THREE.Matrix4();\r\n    return function travelByWaypoint(inMat4, snapToNavMesh, willMaintainInitialOrientation) {\r\n      this.avatarPOV.object3D.updateMatrices();\r\n      if (!this.fly && !snapToNavMesh) {\r\n        this.fly = true;\r\n        this.shouldLandWhenPossible = true;\r\n        this.shouldUnoccupyWaypointsOnceMoving = true;\r\n      }\r\n      inMat4Copy.copy(inMat4);\r\n      rotateInPlaceAroundWorldUp(inMat4Copy, Math.PI, finalPOV);\r\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\r\n      if (!navMeshExists && snapToNavMesh) {\r\n        console.warn(\"Tried to travel to a waypoint that wants to snap to the nav mesh, but there is no nav mesh\");\r\n      }\r\n      if (navMeshExists && snapToNavMesh) {\r\n        inPosition.setFromMatrixPosition(inMat4Copy);\r\n        this.findPositionOnNavMesh(inPosition, inPosition, outPosition, true);\r\n        finalPOV.setPosition(outPosition);\r\n        translation.makeTranslation(0, getCurrentPlayerHeight(), -0.15);\r\n      } else {\r\n        translation.makeTranslation(0, 1.6, -0.15);\r\n      }\r\n      finalPOV.multiply(translation);\r\n      if (willMaintainInitialOrientation) {\r\n        initialOrientation.extractRotation(this.avatarPOV.object3D.matrixWorld);\r\n        finalScale.setFromMatrixScale(finalPOV);\r\n        finalPosition.setFromMatrixPosition(finalPOV);\r\n        finalPOV\r\n          .copy(initialOrientation)\r\n          .scale(finalScale)\r\n          .setPosition(finalPosition);\r\n      }\r\n      calculateCameraTransformForWaypoint(this.avatarPOV.object3D.matrixWorld, finalPOV, finalPOV);\r\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, finalPOV);\r\n    };\r\n  })();\r\n\r\n  tick = (function() {\r\n    const snapRotatedPOV = new THREE.Matrix4();\r\n    const newPOV = new THREE.Matrix4();\r\n    const displacementToDesiredPOV = new THREE.Vector3();\r\n\r\n    const startPOVPosition = new THREE.Vector3();\r\n    const desiredPOVPosition = new THREE.Vector3();\r\n    const navMeshSnappedPOVPosition = new THREE.Vector3();\r\n    const AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND = 50;\r\n    const startTransform = new THREE.Matrix4();\r\n    const interpolatedWaypoint = new THREE.Matrix4();\r\n    const startTranslation = new THREE.Matrix4();\r\n    const waypointPosition = new THREE.Vector3();\r\n    const v = new THREE.Vector3();\r\n\r\n    let uiRoot;\r\n    return function tick(t, dt) {\r\n      const entered = this.scene.is(\"entered\");\r\n      uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n      const isGhost = !entered && uiRoot && uiRoot.firstChild && uiRoot.firstChild.classList.contains(\"isGhost\");\r\n      if (!isGhost && !entered) return;\r\n      const vrMode = this.scene.is(\"vr-mode\");\r\n      this.sfx = this.sfx || this.scene.systems[\"hubs-systems\"].soundEffectsSystem;\r\n      this.waypointSystem = this.waypointSystem || this.scene.systems[\"hubs-systems\"].waypointSystem;\r\n\r\n      if (!this.activeWaypoint && this.waypoints.length) {\r\n        this.activeWaypoint = this.waypoints.splice(0, 1)[0];\r\n        this.isMotionDisabled = this.activeWaypoint.waypointComponentData.willDisableMotion;\r\n        this.isTeleportingDisabled = this.activeWaypoint.waypointComponentData.willDisableTeleporting;\r\n        this.avatarPOV.object3D.updateMatrices();\r\n        this.waypointTravelTime =\r\n          (vrMode && !qsAllowWaypointLerp) || this.activeWaypoint.isInstant\r\n            ? 0\r\n            : 1000 *\r\n              (new THREE.Vector3()\r\n                .setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld)\r\n                .distanceTo(waypointPosition.setFromMatrixPosition(this.activeWaypoint.transform)) /\r\n                AVERAGE_WAYPOINT_TRAVEL_SPEED_METERS_PER_SECOND);\r\n        rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, Math.PI, startTransform);\r\n        startTransform.multiply(startTranslation.makeTranslation(0, -1 * getCurrentPlayerHeight(), -0.15));\r\n        this.waypointTravelStartTime = t;\r\n        if (!vrMode && this.waypointTravelTime > 100) {\r\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_START);\r\n        }\r\n      }\r\n\r\n      const animationIsOver =\r\n        this.waypointTravelTime === 0 || t >= this.waypointTravelStartTime + this.waypointTravelTime;\r\n      if (this.activeWaypoint && !animationIsOver) {\r\n        const progress = THREE.Math.clamp((t - this.waypointTravelStartTime) / this.waypointTravelTime, 0, 1);\r\n        interpolateAffine(\r\n          startTransform,\r\n          this.activeWaypoint.transform,\r\n          easeOutQuadratic(progress),\r\n          interpolatedWaypoint\r\n        );\r\n        this.travelByWaypoint(\r\n          interpolatedWaypoint,\r\n          false,\r\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\r\n        );\r\n      }\r\n      if (this.activeWaypoint && (this.waypoints.length || animationIsOver)) {\r\n        this.travelByWaypoint(\r\n          this.activeWaypoint.transform,\r\n          this.activeWaypoint.waypointComponentData.snapToNavMesh,\r\n          this.activeWaypoint.waypointComponentData.willMaintainInitialOrientation\r\n        );\r\n        freePooledMatrix4(this.activeWaypoint.transform);\r\n        this.activeWaypoint = null;\r\n        if (vrMode || this.waypointTravelTime > 0) {\r\n          this.sfx.playSoundOneShot(SOUND_WAYPOINT_END);\r\n        }\r\n      }\r\n\r\n      const userinput = AFRAME.scenes[0].systems.userinput;\r\n      const wasFlying = this.fly;\r\n      if (userinput.get(paths.actions.toggleFly)) {\r\n        this.shouldLandWhenPossible = false;\r\n        this.avatarRig.messageDispatch.dispatch(\"/fly\"); // TODO: Separate the logic about displaying the message from toggling the fly state in such a way that it is clear that this.fly will be toggled here\r\n      }\r\n      const didStopFlying = wasFlying && !this.fly;\r\n      if (!this.fly && this.shouldLandWhenPossible) {\r\n        this.shouldLandWhenPossible = false;\r\n      }\r\n      if (this.fly) {\r\n        this.navNode = null;\r\n      }\r\n      const preferences = window.APP.store.state.preferences;\r\n      const snapRotateLeft = userinput.get(paths.actions.snapRotateLeft);\r\n      const snapRotateRight = userinput.get(paths.actions.snapRotateRight);\r\n      if (snapRotateLeft) {\r\n        this.dXZ +=\r\n          preferences.snapRotationDegrees === undefined\r\n            ? SNAP_ROTATION_RADIAN\r\n            : (preferences.snapRotationDegrees * Math.PI) / 180;\r\n      }\r\n      if (snapRotateRight) {\r\n        this.dXZ -=\r\n          preferences.snapRotationDegrees === undefined\r\n            ? SNAP_ROTATION_RADIAN\r\n            : (preferences.snapRotationDegrees * Math.PI) / 180;\r\n      }\r\n      if (snapRotateLeft || snapRotateRight) {\r\n        this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\r\n      }\r\n      const characterAcceleration = userinput.get(paths.actions.characterAcceleration);\r\n      if (characterAcceleration) {\r\n        const zCharacterAcceleration = -1 * characterAcceleration[1];\r\n        this.relativeMotion.set(\r\n          this.relativeMotion.x +\r\n            (preferences.disableMovement || preferences.disableStrafing ? 0 : characterAcceleration[0]),\r\n          this.relativeMotion.y,\r\n          this.relativeMotion.z +\r\n            (preferences.disableMovement\r\n              ? 0\r\n              : preferences.disableBackwardsMovement\r\n                ? Math.min(0, zCharacterAcceleration)\r\n                : zCharacterAcceleration)\r\n        );\r\n      }\r\n      const lerpC = vrMode ? 0 : 0.85; // TODO: To support drifting (\"ice skating\"), motion needs to keep initial direction\r\n      this.nextRelativeMotion.copy(this.relativeMotion).multiplyScalar(lerpC);\r\n      this.relativeMotion.multiplyScalar(1 - lerpC);\r\n\r\n      this.avatarPOV.object3D.updateMatrices();\r\n      rotateInPlaceAroundWorldUp(this.avatarPOV.object3D.matrixWorld, this.dXZ, snapRotatedPOV);\r\n\r\n      newPOV.copy(snapRotatedPOV);\r\n\r\n      const navMeshExists = NAV_ZONE in this.scene.systems.nav.pathfinder.zones;\r\n      if (!this.isMotionDisabled) {\r\n        const playerScale = v.setFromMatrixColumn(this.avatarPOV.object3D.matrixWorld, 1).length();\r\n        const triedToMove = this.relativeMotion.lengthSq() > 0.000001;\r\n\r\n        if (triedToMove) {\r\n          calculateDisplacementToDesiredPOV(\r\n            snapRotatedPOV,\r\n            this.fly || !navMeshExists,\r\n            this.relativeMotion.multiplyScalar(\r\n              ((userinput.get(paths.actions.boost) ? 2 : 1) * BASE_SPEED * Math.sqrt(playerScale) * dt) / 1000\r\n            ),\r\n            displacementToDesiredPOV\r\n          );\r\n\r\n          newPOV\r\n            .makeTranslation(displacementToDesiredPOV.x, displacementToDesiredPOV.y, displacementToDesiredPOV.z)\r\n            .multiply(snapRotatedPOV);\r\n        }\r\n\r\n        const shouldRecomputeNavGroupAndNavNode = didStopFlying || this.shouldLandWhenPossible;\r\n        const shouldResnapToNavMesh = navMeshExists && (shouldRecomputeNavGroupAndNavNode || triedToMove);\r\n\r\n        let squareDistNavMeshCorrection = 0;\r\n\r\n        if (shouldResnapToNavMesh) {\r\n          this.findPOVPositionAboveNavMesh(\r\n            startPOVPosition.setFromMatrixPosition(this.avatarPOV.object3D.matrixWorld),\r\n            desiredPOVPosition.setFromMatrixPosition(newPOV),\r\n            navMeshSnappedPOVPosition,\r\n            shouldRecomputeNavGroupAndNavNode\r\n          );\r\n\r\n          squareDistNavMeshCorrection = desiredPOVPosition.distanceToSquared(navMeshSnappedPOVPosition);\r\n\r\n          if (this.fly && this.shouldLandWhenPossible && squareDistNavMeshCorrection < 0.5 && !this.activeWaypoint) {\r\n            this.shouldLandWhenPossible = false;\r\n            this.fly = false;\r\n            newPOV.setPosition(navMeshSnappedPOVPosition);\r\n          } else if (!this.fly) {\r\n            newPOV.setPosition(navMeshSnappedPOVPosition);\r\n          }\r\n        }\r\n\r\n        if (!this.activeWaypoint && this.shouldUnoccupyWaypointsOnceMoving && triedToMove) {\r\n          this.shouldUnoccupyWaypointsOnceMoving = false;\r\n          this.waypointSystem.releaseAnyOccupiedWaypoints();\r\n          if (this.fly && this.shouldLandWhenPossible && (shouldResnapToNavMesh && squareDistNavMeshCorrection < 3)) {\r\n            newPOV.setPosition(navMeshSnappedPOVPosition);\r\n            this.shouldLandWhenPossible = false;\r\n            this.fly = false;\r\n          }\r\n        }\r\n      }\r\n\r\n      childMatch(this.avatarRig.object3D, this.avatarPOV.object3D, newPOV);\r\n      this.relativeMotion.copy(this.nextRelativeMotion);\r\n      this.dXZ = 0;\r\n    };\r\n  })();\r\n\r\n  getClosestNode(pos) {\r\n    const pathfinder = this.scene.systems.nav.pathfinder;\r\n    if (!pathfinder.zones[NAV_ZONE].groups[this.navGroup]) {\r\n      return null;\r\n    }\r\n    return (\r\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\r\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup)\r\n    );\r\n  }\r\n\r\n  findPOVPositionAboveNavMesh = (function() {\r\n    const startingFeetPosition = new THREE.Vector3();\r\n    const desiredFeetPosition = new THREE.Vector3();\r\n    // TODO: Here we assume the player is standing straight up, but in VR it is often the case\r\n    // that you want to lean over the edge of a balcony/table that does not have nav mesh below.\r\n    // We should find way to allow leaning over the edge of a balcony and maybe disallow putting\r\n    // your head through a wall.\r\n    return function findPOVPositionAboveNavMesh(\r\n      startPOVPosition,\r\n      desiredPOVPosition,\r\n      outPOVPosition,\r\n      shouldRecomputeGroupAndNode\r\n    ) {\r\n      const playerHeight = getCurrentPlayerHeight(true);\r\n      startingFeetPosition.copy(startPOVPosition);\r\n      startingFeetPosition.y -= playerHeight;\r\n      desiredFeetPosition.copy(desiredPOVPosition);\r\n      desiredFeetPosition.y -= playerHeight;\r\n      this.findPositionOnNavMesh(\r\n        startingFeetPosition,\r\n        desiredFeetPosition,\r\n        outPOVPosition,\r\n        shouldRecomputeGroupAndNode\r\n      );\r\n      outPOVPosition.y += playerHeight;\r\n      return outPOVPosition;\r\n    };\r\n  })();\r\n\r\n  findPositionOnNavMesh(start, end, outPos, shouldRecomputeGroupAndNode) {\r\n    const pathfinder = this.scene.systems.nav.pathfinder;\r\n    if (!(NAV_ZONE in pathfinder.zones)) return;\r\n    this.navGroup =\r\n      shouldRecomputeGroupAndNode || this.navGroup === null\r\n        ? pathfinder.getGroup(NAV_ZONE, end, true, true)\r\n        : this.navGroup;\r\n    this.navNode =\r\n      shouldRecomputeGroupAndNode || this.navNode === null || this.navNode === undefined\r\n        ? this.getClosestNode(end)\r\n        : this.navNode;\r\n    if (this.navNode === null || this.navNode === undefined) {\r\n      // this.navNode can be null if it has never been set or if getClosestNode fails,\r\n      // and it can be undefined if clampStep fails, so we have to check both. We do not\r\n      // simply check if it is falsey (!this.navNode), because 0 (zero) is a valid value,\r\n      // and 0 is falsey.\r\n      outPos.copy(end);\r\n    } else {\r\n      this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, outPos);\r\n    }\r\n    return outPos;\r\n  }\r\n}\r\n","export class CursorPoseTrackingSystem {\r\n  constructor() {\r\n    this.pairs = [];\r\n  }\r\n  register(object3D, path) {\r\n    this.pairs.push({ object3D, path });\r\n  }\r\n  unregister(object3D) {\r\n    this.pairs = this.pairs.filter(p => p.object3D !== object3D);\r\n  }\r\n  tick() {\r\n    for (let i = 0; i < this.pairs.length; i++) {\r\n      const matrix = AFRAME.scenes[0].systems.userinput.get(this.pairs[i].path);\r\n      if (matrix) {\r\n        const o = this.pairs[i].object3D;\r\n        o.matrix.copy(matrix);\r\n        o.matrix.decompose(o.position, o.quaternion, o.scale);\r\n        o.matrixIsModified = true;\r\n        o.matrixWorldNeedsUpdate = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { squareDistanceBetween } from \"../utils/three-utils\";\r\nconst MIN_DISTANCE = 0.2;\r\nexport class ScaleInScreenSpaceSystem {\r\n  constructor() {\r\n    this.components = [];\r\n  }\r\n  register(c) {\r\n    this.components.push(c);\r\n  }\r\n  unregister(c) {\r\n    this.components = this.components.filter(comp => comp !== c);\r\n  }\r\n\r\n  tick = (function() {\r\n    const parentScale = new THREE.Vector3();\r\n    return function tick() {\r\n      this.viewingCamera = this.viewingCamera || document.getElementById(\"viewing-camera\");\r\n      for (let i = 0; i < this.components.length; i++) {\r\n        const component = this.components[i];\r\n        // TODO: This calculates the distance to the viewing camera, the correct distance might be to the viewing plane.\r\n        // This seemed accurate enough in my testing.\r\n        const distance = Math.sqrt(squareDistanceBetween(component.el.object3D, this.viewingCamera.object3D));\r\n        if (distance < MIN_DISTANCE) {\r\n          component.el.object3D.scale.set(0.00001, 0.000001, 0.00001);\r\n        } else {\r\n          const parent = component.el.object3D.parent;\r\n          parent.updateMatrices();\r\n          parentScale.setFromMatrixScale(parent.matrixWorld);\r\n          component.el.object3D.scale.set(\r\n            (1 / parentScale.x) * (component.data.baseScale.x + distance * component.data.addedScale.x),\r\n            (1 / parentScale.y) * (component.data.baseScale.y + distance * component.data.addedScale.y),\r\n            (1 / parentScale.z) * (component.data.baseScale.z + distance * component.data.addedScale.z)\r\n          );\r\n        }\r\n        component.el.object3D.matrixNeedsUpdate = true;\r\n      }\r\n    };\r\n  })();\r\n}\r\n","function updateMediaAudioSettings(audio, settings) {\r\n  audio.setDistanceModel(settings.mediaDistanceModel);\r\n  audio.setRolloffFactor(settings.mediaRolloffFactor);\r\n  audio.setRefDistance(settings.mediaRefDistance);\r\n  audio.setMaxDistance(settings.mediaMaxDistance);\r\n  audio.panner.coneInnerAngle = settings.mediaConeInnerAngle;\r\n  audio.panner.coneOuterAngle = settings.mediaConeOuterAngle;\r\n  audio.panner.coneOuterGain = settings.mediaConeOuterGain;\r\n}\r\n\r\nfunction updateAvatarAudioSettings(audio, settings) {\r\n  audio.setDistanceModel(settings.avatarDistanceModel);\r\n  audio.setRolloffFactor(settings.avatarRolloffFactor);\r\n  audio.setRefDistance(settings.avatarRefDistance);\r\n  audio.setMaxDistance(settings.avatarMaxDistance);\r\n}\r\n\r\nexport class AudioSettingsSystem {\r\n  constructor(sceneEl) {\r\n    this.sceneEl = sceneEl;\r\n    this.defaultSettings = {\r\n      avatarDistanceModel: \"inverse\",\r\n      avatarRolloffFactor: 2,\r\n      avatarRefDistance: 1,\r\n      avatarMaxDistance: 10000,\r\n      mediaVolume: 0.5,\r\n      mediaDistanceModel: \"inverse\",\r\n      mediaRolloffFactor: 1,\r\n      mediaRefDistance: 1,\r\n      mediaMaxDistance: 10000,\r\n      mediaConeInnerAngle: 360,\r\n      mediaConeOuterAngle: 0,\r\n      mediaConeOuterGain: 0\r\n    };\r\n    this.audioSettings = this.defaultSettings;\r\n    this.mediaAudioSources = [];\r\n    this.avatarAudioSources = [];\r\n\r\n    this.sceneEl.addEventListener(\"reset_scene\", this.onSceneReset);\r\n  }\r\n\r\n  registerMediaAudioSource(audioSource) {\r\n    this.mediaAudioSources.push(audioSource);\r\n    updateMediaAudioSettings(audioSource, this.audioSettings);\r\n  }\r\n\r\n  unregisterMediaAudioSource(audioSource) {\r\n    this.mediaAudioSources.splice(this.mediaAudioSources.indexOf(audioSource, 1));\r\n  }\r\n\r\n  registerAvatarAudioSource(audioSource) {\r\n    this.avatarAudioSources.push(audioSource);\r\n    updateAvatarAudioSettings(audioSource, this.audioSettings);\r\n  }\r\n\r\n  unregisterAvatarAudioSource(audioSource) {\r\n    this.avatarAudioSources.splice(this.avatarAudioSources.indexOf(audioSource, 1));\r\n  }\r\n\r\n  updateAudioSettings(settings) {\r\n    this.audioSettings = Object.assign({}, this.defaultSettings, settings);\r\n\r\n    for (const mediaAudioSource of this.mediaAudioSources) {\r\n      updateMediaAudioSettings(mediaAudioSource, settings);\r\n    }\r\n\r\n    for (const avatarAudioSource of this.avatarAudioSources) {\r\n      updateAvatarAudioSettings(avatarAudioSource, settings);\r\n    }\r\n  }\r\n\r\n  onSceneReset = () => {\r\n    this.updateAudioSettings(this.defaultSettings);\r\n  };\r\n}\r\n\r\nAFRAME.registerComponent(\"audio-source\", {\r\n  schema: {\r\n    type: { type: \"string\" } // avatar, media\r\n  },\r\n\r\n  init() {\r\n    this.audioSource = null;\r\n\r\n    if (this.data.type === \"avatar\") {\r\n      this.onSoundSourceSet = this.onSoundSourceSet.bind(this);\r\n      this.el.addEventListener(\"sound-source-set\", this.onSoundSourceSet);\r\n    } else if (this.data.type === \"media\") {\r\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\r\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\r\n    }\r\n  },\r\n\r\n  onSoundSourceSet() {\r\n    const audioSettingsSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSettingsSystem;\r\n    const networkedAudioSource = this.el.components[\"networked-audio-source\"];\r\n\r\n    if (this.audioSource) {\r\n      audioSettingsSystem.unregisterAvatarAudioSource(this.audioSource);\r\n    }\r\n\r\n    if (networkedAudioSource) {\r\n      this.audioSource = networkedAudioSource.sound;\r\n      audioSettingsSystem.registerAvatarAudioSource(this.audioSource);\r\n    }\r\n  },\r\n\r\n  onVideoLoaded() {\r\n    const audioSettingsSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSettingsSystem;\r\n    const mediaVideo = this.el.components[\"media-video\"];\r\n\r\n    if (this.audioSource) {\r\n      audioSettingsSystem.unregisterMediaAudioSource(this.audioSource);\r\n    }\r\n\r\n    if (mediaVideo && mediaVideo.audio) {\r\n      this.audioSource = mediaVideo.audio;\r\n      audioSettingsSystem.registerMediaAudioSource(this.audioSource);\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    if (!this.audioSource) {\r\n      return;\r\n    }\r\n\r\n    const audioSettingsSystem = this.el.sceneEl.systems[\"hubs-systems\"].audioSettingsSystem;\r\n\r\n    if (this.data.type === \"avatar\") {\r\n      audioSettingsSystem.unregisterAvatarAudioSource(this.audioSource);\r\n      this.el.removeEventListener(\"sound-source-set\", this.onSoundSourceSet);\r\n    } else if (this.data.type === \"media\") {\r\n      audioSettingsSystem.unregisterMediaAudioSource(this.audioSource);\r\n      this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\r\n    }\r\n  }\r\n});\r\n","import configs from \"../utils/configs\";\r\n\r\nlet uiRoot;\r\nexport class EnterVRButtonSystem {\r\n  constructor(scene) {\r\n    this.scene = scene;\r\n    this.wasGhost = false;\r\n  }\r\n  enableButton() {\r\n    this.scene.setAttribute(\"vr-mode-ui\", \"enabled\", true);\r\n    this.scene.components[\"vr-mode-ui\"].enterVREl.style.display = \"block\";\r\n    this.scene.components[\"vr-mode-ui\"].enterVREl.style.bottom = \"80px\";\r\n  }\r\n  disableButton() {\r\n    this.scene.components[\"vr-mode-ui\"].enterVREl.style.display = \"none\";\r\n  }\r\n  tick() {\r\n    if (this.scene.is(\"entered\")) {\r\n      return;\r\n    }\r\n    uiRoot = uiRoot || document.getElementById(\"ui-root\");\r\n    const enable =\r\n      configs.feature(\"enable_lobby_ghosts\") &&\r\n      uiRoot &&\r\n      uiRoot.firstChild &&\r\n      (uiRoot.firstChild.classList.contains(\"isGhost\") && !uiRoot.firstChild.classList.contains(\"hide\"));\r\n    if (enable && !this.enabled) {\r\n      this.enableButton();\r\n    } else if (this.enabled && !enable) {\r\n      this.disableButton();\r\n    }\r\n    this.enabled = enable;\r\n  }\r\n}\r\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\r\nimport { CursorTogglingSystem } from \"./cursor-toggling-system\";\r\nimport { PhysicsSystem } from \"./physics-system\";\r\nimport { ConstraintsSystem } from \"./constraints-system\";\r\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\r\nimport { SingleActionButtonSystem, HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\r\nimport { DrawingMenuSystem } from \"./drawing-menu-system\";\r\nimport { HoverMenuSystem } from \"./hover-menu-system\";\r\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\r\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\r\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\r\nimport { BatchManagerSystem } from \"./render-manager-system\";\r\nimport { ScenePreviewCameraSystem } from \"./scene-preview-camera-system\";\r\nimport { InteractionSfxSystem } from \"./interaction-sfx-system\";\r\nimport { SpriteSystem } from \"./sprites\";\r\nimport { CameraSystem } from \"./camera-system\";\r\nimport { WaypointSystem } from \"./waypoint-system\";\r\nimport { CharacterControllerSystem } from \"./character-controller-system\";\r\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\r\nimport { CursorPoseTrackingSystem } from \"./cursor-pose-tracking\";\r\nimport { ScaleInScreenSpaceSystem } from \"./scale-in-screen-space\";\r\nimport { AudioSettingsSystem } from \"./audio-settings-system\";\r\nimport { EnterVRButtonSystem } from \"./enter-vr-button-system\";\r\n\r\nAFRAME.registerSystem(\"hubs-systems\", {\r\n  init() {\r\n    waitForDOMContentLoaded().then(() => {\r\n      this.DOMContentDidLoad = true;\r\n    });\r\n    this.cursorTogglingSystem = new CursorTogglingSystem();\r\n    this.interactionSfxSystem = new InteractionSfxSystem();\r\n    this.superSpawnerSystem = new SuperSpawnerSystem();\r\n    this.cursorTargettingSystem = new CursorTargettingSystem();\r\n    this.physicsSystem = new PhysicsSystem(this.el.object3D);\r\n    this.constraintsSystem = new ConstraintsSystem(this.physicsSystem);\r\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\r\n    this.singleActionButtonSystem = new SingleActionButtonSystem();\r\n    this.holdableButtonSystem = new HoldableButtonSystem();\r\n    this.hoverButtonSystem = new HoverButtonSystem();\r\n    this.hoverMenuSystem = new HoverMenuSystem();\r\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\r\n    this.soundEffectsSystem = new SoundEffectsSystem(this.el);\r\n    this.scenePreviewCameraSystem = new ScenePreviewCameraSystem();\r\n    this.spriteSystem = new SpriteSystem(this.el);\r\n    this.batchManagerSystem = new BatchManagerSystem(this.el.object3D, this.el.renderer);\r\n    this.cameraSystem = new CameraSystem(this.el);\r\n    this.drawingMenuSystem = new DrawingMenuSystem(this.el);\r\n    this.characterController = new CharacterControllerSystem(this.el);\r\n    this.waypointSystem = new WaypointSystem(this.el, this.characterController);\r\n    this.cursorPoseTrackingSystem = new CursorPoseTrackingSystem();\r\n    this.scaleInScreenSpaceSystem = new ScaleInScreenSpaceSystem();\r\n    this.audioSettingsSystem = new AudioSettingsSystem(this.el);\r\n    this.enterVRButtonSystem = new EnterVRButtonSystem(this.el);\r\n  },\r\n\r\n  tick(t, dt) {\r\n    if (!this.DOMContentDidLoad) return;\r\n    const systems = AFRAME.scenes[0].systems;\r\n    systems.userinput.tick2();\r\n    systems.interaction.tick2();\r\n    this.characterController.tick(t, dt);\r\n    this.cursorTogglingSystem.tick(systems.interaction, systems.userinput, this.el);\r\n    this.interactionSfxSystem.tick(systems.interaction, systems.userinput, this.soundEffectsSystem);\r\n    this.superSpawnerSystem.tick();\r\n    this.cursorPoseTrackingSystem.tick();\r\n    this.cursorTargettingSystem.tick(t);\r\n    this.scaleInScreenSpaceSystem.tick();\r\n    this.constraintsSystem.tick();\r\n    this.twoPointStretchingSystem.tick();\r\n    this.singleActionButtonSystem.tick();\r\n    this.holdableButtonSystem.tick();\r\n    this.hoverButtonSystem.tick();\r\n    this.drawingMenuSystem.tick();\r\n    this.hoverMenuSystem.tick();\r\n    this.hapticFeedbackSystem.tick(\r\n      this.twoPointStretchingSystem,\r\n      this.singleActionButtonSystem.didInteractLeftThisFrame,\r\n      this.singleActionButtonSystem.didInteractRightThisFrame\r\n    );\r\n    this.soundEffectsSystem.tick();\r\n    this.scenePreviewCameraSystem.tick();\r\n    this.physicsSystem.tick(dt);\r\n    this.spriteSystem.tick(t, dt);\r\n    this.batchManagerSystem.tick(t);\r\n    this.cameraSystem.tick(this.el, dt);\r\n    this.waypointSystem.tick(t, dt);\r\n    this.enterVRButtonSystem.tick();\r\n  },\r\n\r\n  remove() {\r\n    this.cursorTargettingSystem.remove();\r\n  }\r\n});\r\n","import qsTruthy from \"../utils/qs_truthy\";\r\n\r\nAFRAME.registerSystem(\"capture-system\", {\r\n  init() {\r\n    this._gotAudioTrack = false;\r\n    this._recorderTimeout = null;\r\n  },\r\n\r\n  _initRecorder() {\r\n    if (!this.available()) return;\r\n\r\n    this._stream = new MediaStream();\r\n\r\n    const video = this.el.canvas.captureStream().getVideoTracks()[0];\r\n    this._stream.addTrack(video);\r\n\r\n    this._recorder = new MediaRecorder(this._stream, { mimeType: \"video/webm; codecs=vp8\" });\r\n\r\n    const chunks = [];\r\n\r\n    this._recorder.ondataavailable = e => {\r\n      chunks.push(e.data);\r\n    };\r\n    this._recorder.onstop = () => {\r\n      if (chunks.length === 0) return;\r\n      const mimeType = chunks[0].type;\r\n      const blob = new Blob(chunks, { type: mimeType });\r\n      chunks.length = 0;\r\n      this.el.emit(\"add_media\", new File([blob], \"capture\", { type: mimeType }));\r\n    };\r\n  },\r\n\r\n  available() {\r\n    return qsTruthy(\"video_capture\") && window.MediaRecorder && MediaRecorder.isTypeSupported(\"video/webm; codecs=vp8\");\r\n  },\r\n\r\n  started() {\r\n    return this._recorder && this._recorder.state !== \"inactive\";\r\n  },\r\n\r\n  _tryAddingAudioTrack() {\r\n    if (this._gotAudioTrack || !this.el.audioListener) return;\r\n\r\n    const listener = this.el.audioListener;\r\n    const destination = listener.context.createMediaStreamDestination();\r\n    listener.getInput().connect(destination);\r\n    const audio = destination.stream.getAudioTracks()[0];\r\n\r\n    this._stream.addTrack(audio);\r\n    this._gotAudioTrack = true;\r\n  },\r\n\r\n  start() {\r\n    if (!this._recorder) {\r\n      this._initRecorder();\r\n    }\r\n\r\n    // The scene doesn't get an audioListener until something in the scene is playing audio.\r\n    // So we have to get the audio track lazily.\r\n    this._tryAddingAudioTrack();\r\n\r\n    if (!this.started()) {\r\n      this._recorder.start();\r\n      this._recorderTimeout = setTimeout(() => {\r\n        if (this.started()) {\r\n          this._recorder.stop();\r\n        }\r\n      }, 15000);\r\n    }\r\n  },\r\n\r\n  stop() {\r\n    if (this.started()) {\r\n      clearTimeout(this._recorderTimeout);\r\n      this._recorder.stop();\r\n    }\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\n\r\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\r\n  tick: function() {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n    let deltaScale;\r\n    if (interaction.state.rightRemote.held === this.el) {\r\n      deltaScale = userinput.get(paths.actions.cursor.right.scaleGrabbedGrabbable);\r\n    }\r\n    if (interaction.state.leftRemote.held === this.el) {\r\n      deltaScale = userinput.get(paths.actions.cursor.left.scaleGrabbedGrabbable);\r\n    }\r\n    if (!deltaScale) return;\r\n\r\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\r\n    this.el.object3D.matrixNeedsUpdate = true;\r\n  }\r\n});\r\n","import { paths } from \"../systems/userinput/paths\";\r\nimport { sets } from \"../systems/userinput/sets\";\r\nimport { getLastWorldPosition } from \"../utils/three-utils\";\r\n\r\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\r\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\r\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\r\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\r\nAFRAME.registerComponent(\"cursor-controller\", {\r\n  schema: {\r\n    cursor: { type: \"selector\" },\r\n    camera: { type: \"selector\" },\r\n    far: { default: 100 },\r\n    near: { default: 0.01 },\r\n    defaultDistance: { default: 4 },\r\n    minDistance: { default: 0.18 }\r\n  },\r\n\r\n  init: function() {\r\n    this.enabled = false;\r\n\r\n    this.data.cursor.addEventListener(\r\n      \"loaded\",\r\n      () => {\r\n        this.data.cursor.object3DMap.mesh.renderOrder = window.APP.RENDER_ORDER.CURSOR;\r\n      },\r\n      { once: true }\r\n    );\r\n\r\n    this.intersection = null;\r\n    this.raycaster = new THREE.Raycaster();\r\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\r\n    this.distance = this.data.far;\r\n    this.color = new THREE.Color(0, 0, 0);\r\n\r\n    const lineGeometry = new THREE.BufferGeometry();\r\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\r\n\r\n    this.line = new THREE.Line(\r\n      lineGeometry,\r\n      new THREE.LineBasicMaterial({\r\n        color: \"white\",\r\n        opacity: 0.2,\r\n        transparent: true,\r\n        visible: false\r\n      })\r\n    );\r\n    this.el.setObject3D(\"line\", this.line);\r\n  },\r\n\r\n  update: function() {\r\n    this.raycaster.far = this.data.far;\r\n    this.raycaster.near = this.data.near;\r\n  },\r\n\r\n  tick2: (() => {\r\n    const rawIntersections = [];\r\n    const cameraPos = new THREE.Vector3();\r\n    const v = new THREE.Vector3();\r\n\r\n    return function(t, left) {\r\n      const userinput = AFRAME.scenes[0].systems.userinput;\r\n      const cursorPose = userinput.get(left ? paths.actions.cursor.left.pose : paths.actions.cursor.right.pose);\r\n      const hideLine = userinput.get(left ? paths.actions.cursor.left.hideLine : paths.actions.cursor.right.hideLine);\r\n\r\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\r\n      this.line.material.visible = !!(this.enabled && !hideLine);\r\n\r\n      this.intersection = null;\r\n\r\n      if (!this.enabled || !cursorPose) {\r\n        return;\r\n      }\r\n\r\n      this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.updateMatrices();\r\n      const playerScale = v\r\n        .setFromMatrixColumn(\r\n          this.el.sceneEl.systems[\"hubs-systems\"].characterController.avatarPOV.object3D.matrixWorld,\r\n          1\r\n        )\r\n        .length();\r\n      this.raycaster.far = this.data.far * playerScale;\r\n      this.raycaster.near = this.data.near * playerScale;\r\n\r\n      const interaction = AFRAME.scenes[0].systems.interaction;\r\n      const isGrabbing = left ? !!interaction.state.leftRemote.held : !!interaction.state.rightRemote.held;\r\n      if (!isGrabbing) {\r\n        rawIntersections.length = 0;\r\n        this.raycaster.ray.origin = cursorPose.position;\r\n        this.raycaster.ray.direction = cursorPose.direction;\r\n        this.raycaster.intersectObjects(\r\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\r\n          true,\r\n          rawIntersections\r\n        );\r\n        this.intersection = rawIntersections[0];\r\n        this.intersectionIsValid = !!interaction.updateCursorIntersection(this.intersection, left);\r\n        this.distance = this.intersectionIsValid ? this.intersection.distance : this.data.defaultDistance * playerScale;\r\n      }\r\n\r\n      const { cursor, minDistance, far, camera } = this.data;\r\n\r\n      const cursorModDelta =\r\n        userinput.get(left ? paths.actions.cursor.left.modDelta : paths.actions.cursor.right.modDelta) || 0;\r\n      if (isGrabbing && !userinput.activeSets.includes(left ? sets.leftCursorHoldingUI : sets.rightCursorHoldingUI)) {\r\n        this.distance = THREE.Math.clamp(this.distance - cursorModDelta, minDistance, far * playerScale);\r\n      }\r\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\r\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\r\n      getLastWorldPosition(camera.object3D, cameraPos);\r\n      cameraPos.y = cursor.object3D.position.y;\r\n      cursor.object3D.lookAt(cameraPos);\r\n      cursor.object3D.matrixNeedsUpdate = true;\r\n\r\n      // TODO : Check if the selected object being transformed is for this cursor!\r\n      const transformObjectSystem = AFRAME.scenes[0].systems[\"transform-selected-object\"];\r\n      if (\r\n        transformObjectSystem.transforming &&\r\n        ((left && transformObjectSystem.hand.el.id === \"player-left-controller\") ||\r\n          (!left && transformObjectSystem.hand.el.id === \"player-right-controller\"))\r\n      ) {\r\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\r\n      } else if (this.intersectionIsValid || isGrabbing) {\r\n        this.color.copy(HIGHLIGHT);\r\n      } else {\r\n        this.color.copy(NO_HIGHLIGHT);\r\n      }\r\n\r\n      if (!this.data.cursor.object3DMap.mesh.material.color.equals(this.color)) {\r\n        this.data.cursor.object3DMap.mesh.material.color.copy(this.color);\r\n        this.data.cursor.object3DMap.mesh.material.needsUpdate = true;\r\n      }\r\n\r\n      if (this.line.material.visible) {\r\n        const posePosition = cursorPose.position;\r\n        const cursorPosition = cursor.object3D.position;\r\n        const positionArray = this.line.geometry.attributes.position.array;\r\n\r\n        positionArray[0] = posePosition.x;\r\n        positionArray[1] = posePosition.y;\r\n        positionArray[2] = posePosition.z;\r\n        positionArray[3] = cursorPosition.x;\r\n        positionArray[4] = cursorPosition.y;\r\n        positionArray[5] = cursorPosition.z;\r\n\r\n        this.line.geometry.attributes.position.needsUpdate = true;\r\n        this.line.geometry.computeBoundingSphere();\r\n      }\r\n    };\r\n  })()\r\n});\r\n","import { paths } from \"../../systems/userinput/paths\";\r\nimport { getLastWorldPosition, getLastWorldQuaternion } from \"../../utils/three-utils\";\r\nimport {\r\n  SOUND_PEN_START_DRAW,\r\n  SOUND_PEN_STOP_DRAW,\r\n  SOUND_PEN_UNDO_DRAW,\r\n  SOUND_PEN_CHANGE_COLOR\r\n} from \"../../systems/sound-effects-system\";\r\nimport { waitForDOMContentLoaded } from \"../../utils/async-utils\";\r\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\r\n\r\nconst pathsMap = {\r\n  \"player-right-controller\": {\r\n    startDrawing: paths.actions.rightHand.startDrawing,\r\n    stopDrawing: paths.actions.rightHand.stopDrawing,\r\n    undoDrawing: paths.actions.rightHand.undoDrawing,\r\n    switchDrawMode: paths.actions.rightHand.switchDrawMode,\r\n    penNextColor: paths.actions.rightHand.penNextColor,\r\n    penPrevColor: paths.actions.rightHand.penPrevColor,\r\n    scalePenTip: paths.actions.rightHand.scalePenTip\r\n  },\r\n  \"player-left-controller\": {\r\n    startDrawing: paths.actions.leftHand.startDrawing,\r\n    stopDrawing: paths.actions.leftHand.stopDrawing,\r\n    undoDrawing: paths.actions.leftHand.undoDrawing,\r\n    switchDrawMode: paths.actions.leftHand.switchDrawMode,\r\n    penNextColor: paths.actions.leftHand.penNextColor,\r\n    penPrevColor: paths.actions.leftHand.penPrevColor,\r\n    scalePenTip: paths.actions.leftHand.scalePenTip\r\n  },\r\n  \"right-cursor\": {\r\n    pose: paths.actions.cursor.right.pose,\r\n    startDrawing: paths.actions.cursor.right.startDrawing,\r\n    stopDrawing: paths.actions.cursor.right.stopDrawing,\r\n    undoDrawing: paths.actions.cursor.right.undoDrawing,\r\n    penNextColor: paths.actions.cursor.right.penNextColor,\r\n    penPrevColor: paths.actions.cursor.right.penPrevColor,\r\n    scalePenTip: paths.actions.cursor.right.scalePenTip\r\n  },\r\n  \"left-cursor\": {\r\n    pose: paths.actions.cursor.left.pose,\r\n    startDrawing: paths.actions.cursor.left.startDrawing,\r\n    stopDrawing: paths.actions.cursor.left.stopDrawing,\r\n    undoDrawing: paths.actions.cursor.left.undoDrawing,\r\n    penNextColor: paths.actions.cursor.left.penNextColor,\r\n    penPrevColor: paths.actions.cursor.left.penPrevColor,\r\n    scalePenTip: paths.actions.cursor.left.scalePenTip\r\n  }\r\n};\r\n\r\nconst DRAW_MODE = {\r\n  DEFAULT_3D: 0,\r\n  PROJECTION: 1\r\n};\r\n\r\nconst MAX_DISTANCE_BETWEEN_SURFACES = 1;\r\n\r\n/**\r\n * Pen tool\r\n * A tool that allows drawing on networked-drawing components.\r\n * @namespace drawing\r\n * @component pen\r\n */\r\n\r\nfunction almostEquals(epsilon, u, v) {\r\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\r\n}\r\n\r\nAFRAME.registerComponent(\"pen\", {\r\n  schema: {\r\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\r\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\r\n    camera: { type: \"selector\" },\r\n    drawingManager: { type: \"string\" },\r\n    color: { type: \"color\", default: \"#FF0033\" },\r\n    availableColors: {\r\n      default: [\r\n        \"#FF0033\",\r\n        \"#FFFF00\",\r\n        \"#0099FF\",\r\n        \"#00FF33\",\r\n        \"#9900FF\",\r\n        \"#FF6600\",\r\n        \"#8D5524\",\r\n        \"#C68642\",\r\n        \"#E0AC69\",\r\n        \"#F1C27D\",\r\n        \"#FFDBAC\",\r\n        \"#FFFFFF\",\r\n        \"#222222\",\r\n        \"#111111\",\r\n        \"#000000\"\r\n      ]\r\n    },\r\n    radius: { default: 0.01 }, //drawing geometry radius\r\n    minRadius: { default: 0.005 },\r\n    maxRadius: { default: 0.2 },\r\n    far: { default: 100 },\r\n    near: { default: 0.01 },\r\n    drawMode: { default: DRAW_MODE.DEFAULT_3D, oneOf: [DRAW_MODE.DEFAULT_3D, DRAW_MODE.PROJECTION] },\r\n    penVisible: { default: true },\r\n    penTipPosition: { default: { x: 0, y: 0, z: 0 } }\r\n  },\r\n\r\n  init() {\r\n    this.timeSinceLastDraw = 0;\r\n\r\n    this.lastPosition = new THREE.Vector3();\r\n    this.lastPosition.copy(this.el.object3D.position);\r\n\r\n    this.direction = new THREE.Vector3(1, 0, 0);\r\n\r\n    this.currentDrawing = null;\r\n\r\n    this.normal = new THREE.Vector3();\r\n\r\n    this.worldPosition = new THREE.Vector3();\r\n\r\n    this.colorIndex = 0;\r\n\r\n    this.grabbed = false;\r\n\r\n    this.raycaster = new THREE.Raycaster();\r\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\r\n\r\n    this.originalPosition = this.el.object3D.position.clone();\r\n    this.lastIntersectionDistance = 0;\r\n\r\n    this.targets = [];\r\n    this.setDirty = this.setDirty.bind(this);\r\n    this.dirty = true;\r\n\r\n    let material = new THREE.MeshStandardMaterial();\r\n    if (window.APP && window.APP.quality === \"low\") {\r\n      material = MobileStandardMaterial.fromStandardMaterial(material);\r\n    }\r\n    this.penTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 16, 12), material);\r\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\r\n    this.penTip.matrixNeedsUpdate = true;\r\n\r\n    this.el.setObject3D(\"mesh\", this.penTip);\r\n\r\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n    if (environmentMapComponent) {\r\n      environmentMapComponent.applyEnvironmentMap(this.el.parentEl.object3D);\r\n    }\r\n\r\n    this.penLaserAttributesUpdated = false;\r\n    this.penLaserAttributes = {\r\n      color: \"#FF0033\",\r\n      laserVisible: false,\r\n      laserInHand: false,\r\n      laserOrigin: { x: 0, y: 0, z: 0 },\r\n      remoteLaserOrigin: { x: 0, y: 0, z: 0 },\r\n      laserTarget: { x: 0, y: 0, z: 0 }\r\n    };\r\n\r\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\r\n    this.observer = new MutationObserver(this.setDirty);\r\n\r\n    waitForDOMContentLoaded().then(() => {\r\n      const scene = document.querySelector(\"a-scene\");\r\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\r\n      scene.addEventListener(\"object3dset\", this.setDirty);\r\n      scene.addEventListener(\"object3dremove\", this.setDirty);\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\r\n  },\r\n\r\n  update(prevData) {\r\n    if (prevData.color != this.data.color) {\r\n      this.penTip.material.color.set(this.data.color);\r\n      this.penLaserAttributes.color = this.data.color;\r\n      this.el.setAttribute(\"pen-laser\", { color: this.data.color });\r\n    }\r\n    if (prevData.radius != this.data.radius) {\r\n      this.el.setAttribute(\"radius\", this.data.radius);\r\n    }\r\n\r\n    this.raycaster.far = this.data.far;\r\n    this.raycaster.near = this.data.near;\r\n  },\r\n\r\n  tick(t, dt) {\r\n    const isMine = this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\r\n\r\n    if (this.penTip.material.visible !== isMine) {\r\n      this.penTip.material.visible = isMine;\r\n    }\r\n\r\n    if (isMine) {\r\n      this._handleInput();\r\n\r\n      const cursorPose =\r\n        this.data.drawMode === DRAW_MODE.PROJECTION &&\r\n        (this.grabberId === \"right-cursor\" || this.grabberId === \"left-cursor\")\r\n          ? AFRAME.scenes[0].systems.userinput.get(pathsMap[this.grabberId].pose)\r\n          : null;\r\n\r\n      const intersection = this._getIntersection(cursorPose);\r\n\r\n      this._updatePenTip(intersection);\r\n\r\n      const laserVisible = this.data.drawMode === DRAW_MODE.PROJECTION && !!intersection;\r\n      const laserInHand = this.el.sceneEl.is(\"vr-mode\") && laserVisible;\r\n\r\n      if (this.penLaserAttributes.laserVisible !== laserVisible) {\r\n        this.penLaserAttributes.laserVisible = laserVisible;\r\n        this.penLaserAttributesUpdated = true;\r\n      }\r\n\r\n      if (this.penLaserAttributes.laserInHand !== laserInHand) {\r\n        this.penLaserAttributes.laserInHand = laserInHand;\r\n        this.penLaserAttributesUpdated = true;\r\n      }\r\n\r\n      if (laserVisible) {\r\n        this._updateLaser(cursorPose, intersection);\r\n      }\r\n\r\n      const penVisible = (this.grabberId !== \"left-cursor\" && this.grabberId !== \"right-cursor\") || !intersection;\r\n      this._setPenVisible(penVisible);\r\n      this.el.setAttribute(\"pen\", { penVisible: penVisible });\r\n\r\n      this._doDraw(intersection, dt);\r\n\r\n      if (this.penLaserAttributesUpdated) {\r\n        this.penLaserAttributesUpdated = false;\r\n        this.el.setAttribute(\"pen-laser\", this.penLaserAttributes, true);\r\n      }\r\n    } else {\r\n      this._setPenVisible(this.data.penVisible);\r\n    }\r\n  },\r\n\r\n  _handleInput() {\r\n    const userinput = AFRAME.scenes[0].systems.userinput;\r\n    const interaction = AFRAME.scenes[0].systems.interaction;\r\n\r\n    if (interaction.state.rightHand.held === this.el.parentNode) {\r\n      this.grabberId = \"player-right-controller\";\r\n    } else if (interaction.state.leftHand.held === this.el.parentNode) {\r\n      this.grabberId = \"player-left-controller\";\r\n    } else if (interaction.state.rightRemote.held === this.el.parentNode) {\r\n      this.grabberId = \"right-cursor\";\r\n      this.data.drawMode = DRAW_MODE.PROJECTION;\r\n    } else if (interaction.state.leftRemote.held === this.el.parentNode) {\r\n      this.grabberId = \"left-cursor\";\r\n      this.data.drawMode = DRAW_MODE.PROJECTION;\r\n    } else {\r\n      this.grabberId = null;\r\n    }\r\n\r\n    if (this.grabberId && pathsMap[this.grabberId]) {\r\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\r\n      const paths = pathsMap[this.grabberId];\r\n      if (userinput.get(paths.startDrawing)) {\r\n        this._startDraw();\r\n        sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\r\n      }\r\n      if (userinput.get(paths.stopDrawing)) {\r\n        this._endDraw();\r\n        sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\r\n      }\r\n      const penScaleMod = userinput.get(paths.scalePenTip);\r\n      if (penScaleMod) {\r\n        this._changeRadius(penScaleMod);\r\n      }\r\n      if (userinput.get(paths.penNextColor)) {\r\n        this._changeColor(1);\r\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\r\n      }\r\n      if (userinput.get(paths.penPrevColor)) {\r\n        this._changeColor(-1);\r\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\r\n      }\r\n      if (userinput.get(paths.undoDrawing)) {\r\n        this._undoDraw();\r\n        sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\r\n      }\r\n      if (paths.switchDrawMode && userinput.get(paths.switchDrawMode)) {\r\n        this.data.drawMode = this.data.drawMode === DRAW_MODE.DEFAULT_3D ? DRAW_MODE.PROJECTION : DRAW_MODE.DEFAULT_3D;\r\n      }\r\n    }\r\n  },\r\n\r\n  _getIntersection: (() => {\r\n    const rawIntersections = [];\r\n    const worldQuaternion = new THREE.Quaternion();\r\n    return function(cursorPose) {\r\n      rawIntersections.length = 0;\r\n\r\n      if (this.data.drawMode === DRAW_MODE.PROJECTION) {\r\n        if (cursorPose) {\r\n          this.raycaster.ray.origin.copy(cursorPose.position);\r\n          this.raycaster.ray.direction.copy(cursorPose.direction);\r\n        } else if (this.grabberId !== null) {\r\n          getLastWorldPosition(this.el.parentEl.object3D, this.raycaster.ray.origin);\r\n          getLastWorldQuaternion(this.el.parentEl.object3D, worldQuaternion);\r\n          this.raycaster.ray.direction.set(0, -1, 0);\r\n          this.raycaster.ray.direction.applyQuaternion(worldQuaternion);\r\n        }\r\n\r\n        if (this.grabberId !== null) {\r\n          this.raycaster.intersectObjects(this.targets, true, rawIntersections);\r\n          return rawIntersections[0];\r\n        }\r\n      }\r\n\r\n      return null;\r\n    };\r\n  })(),\r\n\r\n  _updatePenTip(intersection) {\r\n    if (this.data.drawMode === DRAW_MODE.PROJECTION) {\r\n      if (intersection) {\r\n        this.el.object3D.position.copy(intersection.point);\r\n\r\n        this.el.parentEl.object3D.worldToLocal(this.el.object3D.position);\r\n\r\n        this.el.object3D.matrixNeedsUpdate = true;\r\n        this.worldPosition.copy(intersection.point);\r\n      } else {\r\n        this.el.object3D.position.copy(this.originalPosition);\r\n        this.el.object3D.matrixNeedsUpdate = true;\r\n        getLastWorldPosition(this.el.object3D, this.worldPosition);\r\n      }\r\n    } else {\r\n      this.el.object3D.position.copy(this.originalPosition);\r\n      this.el.object3D.matrixNeedsUpdate = true;\r\n      getLastWorldPosition(this.el.object3D, this.worldPosition);\r\n    }\r\n  },\r\n\r\n  _updateLaser: (() => {\r\n    const laserStartPosition = new THREE.Vector3();\r\n    const laserEndPosition = new THREE.Vector3();\r\n    const camerWorldPosition = new THREE.Vector3();\r\n    const remoteLaserOrigin = new THREE.Vector3();\r\n    return function(cursorPose, intersection) {\r\n      if (cursorPose) {\r\n        laserStartPosition.copy(cursorPose.position);\r\n      } else {\r\n        this.el.parentEl.object3D.getWorldPosition(laserStartPosition);\r\n      }\r\n\r\n      laserEndPosition.copy(intersection.point);\r\n\r\n      if (this.el.sceneEl.is(\"vr-mode\")) {\r\n        remoteLaserOrigin.copy(laserStartPosition);\r\n      } else {\r\n        this.data.camera.object3D.getWorldPosition(camerWorldPosition);\r\n        remoteLaserOrigin\r\n          .subVectors(laserEndPosition, camerWorldPosition)\r\n          .normalize()\r\n          .multiplyScalar(0.5);\r\n        remoteLaserOrigin.add(camerWorldPosition);\r\n      }\r\n\r\n      if (!almostEquals(0.001, this.penLaserAttributes.laserOrigin, laserStartPosition)) {\r\n        this.penLaserAttributes.laserOrigin.x = laserStartPosition.x;\r\n        this.penLaserAttributes.laserOrigin.y = laserStartPosition.y;\r\n        this.penLaserAttributes.laserOrigin.z = laserStartPosition.z;\r\n        this.penLaserAttributesUpdated = true;\r\n      }\r\n\r\n      if (!almostEquals(0.001, this.penLaserAttributes.remoteLaserOrigin, remoteLaserOrigin)) {\r\n        this.penLaserAttributes.remoteLaserOrigin.x = remoteLaserOrigin.x;\r\n        this.penLaserAttributes.remoteLaserOrigin.y = remoteLaserOrigin.y;\r\n        this.penLaserAttributes.remoteLaserOrigin.z = remoteLaserOrigin.z;\r\n        this.penLaserAttributesUpdated = true;\r\n      }\r\n\r\n      if (!almostEquals(0.001, this.penLaserAttributes.laserTarget, laserEndPosition)) {\r\n        this.penLaserAttributes.laserTarget.x = laserEndPosition.x;\r\n        this.penLaserAttributes.laserTarget.y = laserEndPosition.y;\r\n        this.penLaserAttributes.laserTarget.z = laserEndPosition.z;\r\n        this.penLaserAttributesUpdated = true;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _doDraw(intersection, dt) {\r\n    //Prevent drawings from \"jumping\" large distances\r\n    if (\r\n      this.currentDrawing &&\r\n      (this.lastIntersectedObject !== (intersection ? intersection.object : null) &&\r\n        (!intersection ||\r\n          Math.abs(intersection.distance - this.lastIntersectionDistance) > MAX_DISTANCE_BETWEEN_SURFACES))\r\n    ) {\r\n      this.worldPosition.copy(this.lastPosition);\r\n      this._endDraw();\r\n    }\r\n    this.lastIntersectionDistance = intersection ? intersection.distance : 0;\r\n    this.lastIntersectedObject = intersection ? intersection.object : null;\r\n\r\n    if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\r\n      this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\r\n      this.lastPosition.copy(this.worldPosition);\r\n    }\r\n\r\n    if (this.currentDrawing) {\r\n      const time = this.timeSinceLastDraw + dt;\r\n      if (\r\n        time >= this.data.drawFrequency &&\r\n        this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\r\n      ) {\r\n        this._getNormal(this.normal, this.worldPosition, this.direction);\r\n        this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\r\n      }\r\n\r\n      this.timeSinceLastDraw = time % this.data.drawFrequency;\r\n    }\r\n\r\n    if (this.currentDrawing && !this.grabberId) {\r\n      this._endDraw();\r\n    }\r\n\r\n    if (this.dirty) {\r\n      this.populateEntities(this.targets);\r\n      this.dirty = false;\r\n    }\r\n  },\r\n\r\n  _setPenVisible(visible) {\r\n    if (this.el.parentEl.object3DMap.mesh && this.el.parentEl.object3DMap.mesh.visible !== visible) {\r\n      this.el.parentEl.object3DMap.mesh.visible = visible;\r\n    }\r\n  },\r\n\r\n  //helper function to get normal of direction of drawing cross direction to camera\r\n  _getNormal: (() => {\r\n    const directionToCamera = new THREE.Vector3();\r\n    return function(normal, position, direction) {\r\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\r\n      normal.crossVectors(direction, directionToCamera);\r\n    };\r\n  })(),\r\n\r\n  _startDraw() {\r\n    this.drawingManager.getDrawing(this).then(drawing => {\r\n      this.currentDrawing = drawing;\r\n      this._getNormal(this.normal, this.worldPosition, this.direction);\r\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\r\n    });\r\n  },\r\n\r\n  _endDraw() {\r\n    if (this.currentDrawing) {\r\n      this.timeSinceLastDraw = 0;\r\n      this._getNormal(this.normal, this.worldPosition, this.direction);\r\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\r\n      this.drawingManager.returnDrawing(this);\r\n      this.currentDrawing = null;\r\n    }\r\n  },\r\n\r\n  _undoDraw() {\r\n    this.drawingManager.getDrawing(this).then(drawing => {\r\n      drawing.undoDraw();\r\n      this.drawingManager.returnDrawing(this);\r\n    });\r\n  },\r\n\r\n  _changeColor(mod) {\r\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\r\n    this.data.color = this.data.availableColors[this.colorIndex];\r\n    this.penTip.material.color.set(this.data.color);\r\n    this.penLaserAttributes.color = this.data.color;\r\n    this.penLaserAttributesUpdated = true;\r\n  },\r\n\r\n  _changeRadius(mod) {\r\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\r\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\r\n    this.penTip.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  setDirty() {\r\n    this.dirty = true;\r\n  },\r\n\r\n  populateEntities(targets) {\r\n    targets.length = 0;\r\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\r\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, #environment-root\");\r\n    for (let i = 0; i < els.length; i++) {\r\n      if (!els[i].classList.contains(\"pen\") && els[i].object3D) {\r\n        targets.push(els[i].object3D);\r\n      }\r\n    }\r\n  },\r\n\r\n  remove() {\r\n    this.observer.disconnect();\r\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\r\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\r\n  }\r\n});\r\n","const InterpolationBuffer = require(\"buffered-interpolation\");\r\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\r\n\r\nfunction almostEquals(epsilon, u, v) {\r\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\r\n}\r\n\r\nAFRAME.registerComponent(\"pen-laser\", {\r\n  schema: {\r\n    color: { type: \"color\", default: \"#FF0033\" },\r\n    laserVisible: { default: false },\r\n    laserInHand: { default: false },\r\n    laserOrigin: { default: { x: 0, y: 0, z: 0 } },\r\n    remoteLaserOrigin: { default: { x: 0, y: 0, z: 0 } },\r\n    laserTarget: { default: { x: 0, y: 0, z: 0 } }\r\n  },\r\n\r\n  init() {\r\n    let material = new THREE.MeshStandardMaterial({ color: \"red\", opacity: 0.5, transparent: true, visible: true });\r\n    if (window.APP && window.APP.quality === \"low\") {\r\n      material = MobileStandardMaterial.fromStandardMaterial(material);\r\n    }\r\n\r\n    const tipMaterial = material.clone();\r\n\r\n    const lineCurve = new THREE.LineCurve3(new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 2));\r\n    const geometry = new THREE.TubeBufferGeometry(lineCurve, 2, 0.003, 8, true);\r\n    this.laser = new THREE.Mesh(geometry, material);\r\n\r\n    this.laserTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 8, 6), tipMaterial);\r\n    this.laserTip.scale.setScalar(0.01);\r\n    this.laserTip.matrixNeedsUpdate = true;\r\n\r\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n    if (environmentMapComponent) {\r\n      environmentMapComponent.applyEnvironmentMap(this.laser);\r\n      environmentMapComponent.applyEnvironmentMap(this.laserTip);\r\n    }\r\n\r\n    //prevents the line from being a raycast target for the cursor\r\n    this.laser.raycast = function() {};\r\n\r\n    this.el.sceneEl.setObject3D(`pen-laser-${this.laser.uuid}`, this.laser);\r\n    this.el.sceneEl.setObject3D(`pen-laser-tip-${this.laser.uuid}`, this.laserTip);\r\n\r\n    this.originBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\r\n    this.targetBuffer = new InterpolationBuffer(InterpolationBuffer.MODE_LERP, 0.1);\r\n  },\r\n\r\n  update: (() => {\r\n    const originBufferPosition = new THREE.Vector3();\r\n    const targetBufferPosition = new THREE.Vector3();\r\n\r\n    return function(prevData) {\r\n      if (prevData.color != this.data.color) {\r\n        this.laser.material.color.set(this.data.color);\r\n        this.laserTip.material.color.set(this.data.color);\r\n      }\r\n\r\n      if (prevData.remoteLaserOrigin && !almostEquals(0.001, prevData.remoteLaserOrigin, this.data.remoteLaserOrigin)) {\r\n        this.originBuffer.setPosition(\r\n          originBufferPosition.set(\r\n            this.data.remoteLaserOrigin.x,\r\n            this.data.remoteLaserOrigin.y,\r\n            this.data.remoteLaserOrigin.z\r\n          )\r\n        );\r\n      }\r\n\r\n      if (prevData.laserTarget && !almostEquals(0.001, prevData.laserTarget, this.data.laserTarget)) {\r\n        this.targetBuffer.setPosition(\r\n          targetBufferPosition.set(this.data.laserTarget.x, this.data.laserTarget.y, this.data.laserTarget.z)\r\n        );\r\n      }\r\n    };\r\n  })(),\r\n\r\n  tick: (() => {\r\n    const origin = new THREE.Vector3();\r\n    const target = new THREE.Vector3();\r\n    return function(t, dt) {\r\n      const isMine =\r\n        this.el.parentEl.components.networked.initialized && this.el.parentEl.components.networked.isMine();\r\n      let laserVisible = false;\r\n\r\n      if (isMine && this.data.laserVisible) {\r\n        origin.copy(this.data.laserOrigin);\r\n\r\n        if (!this.data.laserInHand) {\r\n          // On 2d mode, shift downards\r\n          origin.y = origin.y - 0.4;\r\n        }\r\n\r\n        target.copy(this.data.laserTarget);\r\n        laserVisible = true;\r\n      } else if (!isMine && this.data.laserVisible) {\r\n        this.originBuffer.update(dt);\r\n        this.targetBuffer.update(dt);\r\n        origin.copy(this.originBuffer.getPosition());\r\n        target.copy(this.targetBuffer.getPosition());\r\n        laserVisible = true;\r\n      }\r\n\r\n      if (laserVisible) {\r\n        this.laser.position.copy(origin);\r\n        this.laser.lookAt(target);\r\n        this.laser.scale.set(1, 1, origin.distanceTo(target));\r\n        this.laser.matrixNeedsUpdate = true;\r\n        this.laserTip.position.copy(target);\r\n        this.laserTip.matrixNeedsUpdate = true;\r\n      }\r\n\r\n      if (this.laser.material.visible !== laserVisible) {\r\n        this.laser.material.visible = laserVisible;\r\n      }\r\n\r\n      const laserTipVisible = laserVisible ? !(isMine && this.data.laserVisible) : false;\r\n      if (this.laserTip.material.visible !== laserTipVisible) {\r\n        this.laserTip.material.visible = laserTipVisible;\r\n      }\r\n    };\r\n  })(),\r\n\r\n  remove() {\r\n    this.el.sceneEl.removeObject3D(`pen-laser-${this.laser.uuid}`);\r\n    this.el.sceneEl.removeObject3D(`pen-laser-tip-${this.laser.uuid}`);\r\n  }\r\n});\r\n","export default class SharedBufferGeometry {\r\n  constructor(material, primitiveMode, maxBufferSize) {\r\n    this.material = material;\r\n    this.primitiveMode = primitiveMode;\r\n\r\n    this.maxBufferSize = maxBufferSize;\r\n    this.geometries = [];\r\n    this.current = null;\r\n    this.drawing = new THREE.Object3D();\r\n    this.addBuffer();\r\n  }\r\n\r\n  restartPrimitive() {\r\n    if (this.idx.position >= this.current.attributes.position.count) {\r\n      console.error(\"maxBufferSize limit exceeded\");\r\n    } else if (this.idx.position !== 0) {\r\n      let prev = (this.idx.position - 1) * 3;\r\n      const position = this.current.attributes.position.array;\r\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\r\n\r\n      this.idx.color++;\r\n      this.idx.normal++;\r\n    }\r\n  }\r\n\r\n  remove(prevIdx, idx) {\r\n    // Loop through all the attributes: position, color, normal,...\r\n    if (this.idx.position > idx.position) {\r\n      for (const key in this.idx) {\r\n        const componentSize = 3;\r\n        let pos = prevIdx[key] * componentSize;\r\n        const start = (idx[key] + 1) * componentSize;\r\n        const end = this.idx[key] * componentSize;\r\n        for (let i = start; i < end; i++) {\r\n          this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\r\n        }\r\n        const diff = idx[key] - prevIdx[key] + 1;\r\n        this.idx[key] -= diff;\r\n      }\r\n    } else {\r\n      for (const key in this.idx) {\r\n        const diff = idx[key] - prevIdx[key];\r\n        this.idx[key] -= diff;\r\n      }\r\n    }\r\n\r\n    this.update();\r\n  }\r\n\r\n  undo(prevIdx) {\r\n    this.idx = prevIdx;\r\n    this.update();\r\n  }\r\n\r\n  addBuffer() {\r\n    const geometry = new THREE.BufferGeometry();\r\n\r\n    const vertices = new Float32Array(this.maxBufferSize * 3);\r\n    const normals = new Float32Array(this.maxBufferSize * 3);\r\n    const colors = new Float32Array(this.maxBufferSize * 3);\r\n\r\n    const mesh = new THREE.Mesh(geometry, this.material);\r\n\r\n    mesh.drawMode = this.primitiveMode;\r\n\r\n    mesh.frustumCulled = false;\r\n    mesh.vertices = vertices;\r\n\r\n    const object3D = new THREE.Object3D();\r\n    this.drawing.add(object3D);\r\n    object3D.add(mesh);\r\n\r\n    geometry.setDrawRange(0, 0);\r\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setDynamic(true));\r\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setDynamic(true));\r\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setDynamic(true));\r\n\r\n    this.previous = null;\r\n    if (this.geometries.length > 0) {\r\n      this.previous = this.current;\r\n    }\r\n\r\n    this.idx = {\r\n      position: 0,\r\n      normal: 0,\r\n      color: 0\r\n    };\r\n\r\n    this.geometries.push(geometry);\r\n    this.current = geometry;\r\n  }\r\n\r\n  addColor(r, g, b) {\r\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\r\n  }\r\n\r\n  addNormal(x, y, z) {\r\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\r\n  }\r\n\r\n  addVertex(x, y, z) {\r\n    const buffer = this.current.attributes.position;\r\n    if (this.idx.position === buffer.count) {\r\n      console.error(\"maxBufferSize limit exceeded\");\r\n    }\r\n    buffer.setXYZ(this.idx.position++, x, y, z);\r\n  }\r\n\r\n  update() {\r\n    this.current.setDrawRange(0, this.idx.position);\r\n\r\n    this.current.attributes.color.needsUpdate = true;\r\n    this.current.attributes.normal.needsUpdate = true;\r\n    this.current.attributes.position.needsUpdate = true;\r\n  }\r\n\r\n  computeBoundingSpheres() {\r\n    for (let i = 0; i < this.geometries.length; i++) {\r\n      this.geometries[i].computeBoundingSphere();\r\n    }\r\n  }\r\n}\r\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\r\n\r\nexport default class SharedBufferGeometryManager {\r\n  constructor() {\r\n    this.sharedBuffers = {};\r\n  }\r\n\r\n  addSharedBuffer(name, material, primitiveMode, maxBufferSize) {\r\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, primitiveMode, maxBufferSize);\r\n  }\r\n\r\n  getSharedBuffer(name) {\r\n    return this.sharedBuffers[name];\r\n  }\r\n}\r\n","/* global THREE */\r\n/**\r\n * Networked Drawing\r\n * Creates procedurally generated 'lines' (or tubes) that are networked.\r\n * @namespace drawing\r\n * @component networked-drawing\r\n */\r\n\r\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\r\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\r\nimport { GLTFExporter } from \"three/examples/jsm/exporters/GLTFExporter\";\r\nimport { addMedia, addMeshScaleAnimation } from \"../../utils/media-utils\";\r\nimport { ObjectContentOrigins } from \"../../object-types\";\r\nimport { SOUND_PEN_START_DRAW } from \"../../systems/sound-effects-system\";\r\n\r\nconst MSG_CONFIRM_CONNECT = 0;\r\nconst MSG_BUFFER_DATA = 1;\r\nconst MSG_BUFFER_DATA_FULL = 2;\r\n\r\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\r\n  let i = fromIndex - 1;\r\n  let j = -1;\r\n  while (i + 1 <= toIndex) {\r\n    toArray[++j] = fromArray[++i];\r\n  }\r\n}\r\n\r\nAFRAME.registerComponent(\"networked-drawing\", {\r\n  schema: {\r\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\r\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\r\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\r\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\r\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\r\n  },\r\n\r\n  init() {\r\n    this._receiveData = this._receiveData.bind(this);\r\n\r\n    this.networkBuffer = [];\r\n\r\n    this.sendNetworkBufferQueue = [];\r\n\r\n    this.drawStarted = false;\r\n    this.lineStarted = false;\r\n    this.remoteLineStarted = false;\r\n\r\n    this.receivedBufferParts = 0;\r\n    this.bufferIndex = 0;\r\n    this.connectedToOwner = false;\r\n    this.networkBufferInitialized = false;\r\n\r\n    const options = {\r\n      vertexColors: THREE.VertexColors\r\n    };\r\n\r\n    this.color = new THREE.Color();\r\n    this.radius = this.data.defaultRadius;\r\n    this.segments = this.data.segments;\r\n\r\n    let material = new THREE.MeshStandardMaterial(options);\r\n    if (window.APP && window.APP.quality === \"low\") {\r\n      material = MobileStandardMaterial.fromStandardMaterial(material);\r\n    }\r\n\r\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\r\n    // NOTE: 20 is approximate for how many floats per point are added.\r\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\r\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\r\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\r\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, THREE.TriangleStripDrawMode, maxBufferSize);\r\n\r\n    this.lastPoint = new THREE.Vector3();\r\n\r\n    this.lastSegments = [];\r\n    this.currentSegments = [];\r\n    for (let x = 0; x < this.segments; x++) {\r\n      this.lastSegments[x] = {\r\n        position: new THREE.Vector3(),\r\n        normal: new THREE.Vector3()\r\n      };\r\n      this.currentSegments[x] = {\r\n        position: new THREE.Vector3(),\r\n        normal: new THREE.Vector3()\r\n      };\r\n    }\r\n\r\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\r\n    this.drawing = this.sharedBuffer.drawing;\r\n\r\n    this.el.setObject3D(\"mesh\", this.drawing);\r\n\r\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\r\n    if (environmentMapComponent) {\r\n      environmentMapComponent.applyEnvironmentMap(this.drawing);\r\n    }\r\n\r\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\r\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\r\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\r\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\r\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\r\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\r\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\r\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\r\n\r\n    NAF.connection.onConnect(() => {\r\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n        this.networkedEl = networkedEl;\r\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\r\n        this.drawingId = \"drawing-\" + this.networkId;\r\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\r\n      });\r\n    });\r\n  },\r\n\r\n  play() {\r\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.registerDrawingMenu(this.el);\r\n  },\r\n\r\n  remove() {\r\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\r\n\r\n    this.drawStarted = false;\r\n\r\n    this.el.removeObject3D(\"mesh\");\r\n\r\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\r\n    drawingManager.destroyDrawing(this);\r\n\r\n    AFRAME.scenes[0].systems[\"hubs-systems\"].drawingMenuSystem.unregisterDrawingMenu(this.el);\r\n  },\r\n\r\n  tick(t) {\r\n    const connected = NAF.connection.isConnected() && this.networkedEl;\r\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\r\n\r\n    if (!this.connectedToOwner && connected) {\r\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\r\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\r\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\r\n          type: MSG_CONFIRM_CONNECT,\r\n          clientId: NAF.clientId\r\n        });\r\n        this.connectedToOwner = true;\r\n      }\r\n    }\r\n\r\n    if (this.networkBuffer.length > 0 && connected) {\r\n      if (!isMine) {\r\n        this._drawFromNetwork();\r\n      } else if (this.bufferIndex < this.networkBuffer.length) {\r\n        this._broadcastDrawing();\r\n      }\r\n    }\r\n\r\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\r\n    //if that client disconnects before this executes and an activeDataChannel is opened.\r\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\r\n      const connected = [];\r\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\r\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\r\n          connected.push(this.sendNetworkBufferQueue[i]);\r\n        }\r\n      }\r\n      for (let j = 0; j < connected.length; j++) {\r\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\r\n        this._sendNetworkBuffer(connected[j]);\r\n        this.sendNetworkBufferQueue.splice(pos, 1);\r\n      }\r\n    }\r\n\r\n    this._deleteExpiredLines(t);\r\n  },\r\n\r\n  async serializeDrawing() {\r\n    const exporter = new GLTFExporter();\r\n\r\n    const material = new THREE.MeshStandardMaterial({\r\n      vertexColors: THREE.VertexColors\r\n    });\r\n    const geometry = this.convertToTriangles(this.sharedBuffer.current);\r\n    const mesh = new THREE.Mesh(geometry, material);\r\n\r\n    mesh.userData.gltfExtensions = {\r\n      MOZ_hubs_components: { \"networked-drawing-buffer\": { buffer: this.networkBuffer } }\r\n    };\r\n\r\n    const chunks = await new Promise(resolve => {\r\n      exporter.parseChunks(\r\n        mesh,\r\n        resolve,\r\n        e => {\r\n          new Error(`Error serializing drawing. ${e}`);\r\n        },\r\n        {\r\n          mode: \"glb\",\r\n          includeCustomExtensions: true\r\n        }\r\n      );\r\n    });\r\n\r\n    const json = chunks.json;\r\n    if (!json.extensions) {\r\n      json.extensions = {};\r\n    }\r\n    json.extensions.MOZ_hubs_components = { version: 4 };\r\n    json.asset.generator = `Mozilla Hubs Serialize Drawing`;\r\n\r\n    const glb = await new Promise((resolve, reject) => {\r\n      exporter.createGLBBlob(chunks, resolve, e => {\r\n        reject(new Error(`Error creating glb blob. ${e}`));\r\n      });\r\n    });\r\n\r\n    const file = new File([glb], \"drawing.glb\", {\r\n      type: \"model/gltf-binary\"\r\n    });\r\n\r\n    const { entity } = addMedia(file, \"#interactable-media\", ObjectContentOrigins.FILE, \"drawing\", false, false);\r\n\r\n    const min = new THREE.Vector3(Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);\r\n    const max = new THREE.Vector3(Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY);\r\n    const temp = new THREE.Vector3();\r\n\r\n    const { start, count } = this.sharedBuffer.current.drawRange;\r\n    const attribute = this.sharedBuffer.current.attributes.position;\r\n    for (let i = start; i < count; i++) {\r\n      temp.set(attribute.getX(i), attribute.getY(i), attribute.getZ(i));\r\n      min.min(temp);\r\n      max.max(temp);\r\n    }\r\n\r\n    entity.object3D.position.addVectors(min, max).multiplyScalar(0.5);\r\n    entity.object3D.matrixNeedsUpdate = true;\r\n  },\r\n\r\n  convertToTriangles(originalGeometry) {\r\n    const geometry = new THREE.BufferGeometry();\r\n\r\n    const { start, count } = originalGeometry.drawRange;\r\n\r\n    const originalPositions = originalGeometry.getAttribute(\"position\");\r\n    const originalColors = originalGeometry.getAttribute(\"color\");\r\n    const originalNormals = originalGeometry.getAttribute(\"normal\");\r\n\r\n    const length = count * 3;\r\n    const positions = new Float32Array(length);\r\n    const colors = new Float32Array(length);\r\n    const normals = new Float32Array(length);\r\n    const indices = [];\r\n\r\n    let index = 0;\r\n    let order = 0;\r\n\r\n    const copy = i => {\r\n      colors[index] = originalColors.getX(i);\r\n      normals[index] = originalNormals.getX(i);\r\n      positions[index] = originalPositions.getX(i);\r\n      index++;\r\n      colors[index] = originalColors.getY(i);\r\n      normals[index] = originalNormals.getY(i);\r\n      positions[index] = originalPositions.getY(i);\r\n      index++;\r\n      colors[index] = originalColors.getZ(i);\r\n      normals[index] = originalNormals.getZ(i);\r\n      positions[index] = originalPositions.getZ(i);\r\n      index++;\r\n    };\r\n\r\n    for (let i = start; i < count - 2; i++) {\r\n      const i2 = i + 1 + order;\r\n      const i3 = i + 2 - order;\r\n\r\n      if (i === 0) {\r\n        copy(i);\r\n        copy(i2);\r\n        copy(i3);\r\n      } else if (i2 > i3) {\r\n        copy(i2);\r\n      } else {\r\n        copy(i3);\r\n      }\r\n\r\n      indices.push(i, i2, i3);\r\n      order = (order + 1) % 2;\r\n    }\r\n\r\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(positions, 3));\r\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3));\r\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3));\r\n    geometry.setIndex(indices);\r\n\r\n    return geometry;\r\n  },\r\n\r\n  deserializeDrawing: (() => {\r\n    const position = new THREE.Vector3();\r\n    const direction = new THREE.Vector3();\r\n    const normal = new THREE.Vector3();\r\n    return function(buffer) {\r\n      let head = buffer[0];\r\n      if (head === \"-\") {\r\n        this._undoDraw();\r\n        buffer.shift();\r\n        head = buffer[0];\r\n      }\r\n\r\n      while (head != null && buffer.length >= 11) {\r\n        position.set(buffer[1], buffer[2], buffer[3]);\r\n        direction.set(buffer[4], buffer[5], buffer[6]);\r\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\r\n        direction.normalize();\r\n        normal.set(buffer[7], buffer[8], buffer[9]);\r\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\r\n        normal.normalize();\r\n\r\n        buffer.splice(0, 10);\r\n\r\n        if (!this.drawStarted) {\r\n          this.startDraw(position, direction, normal);\r\n        } else if (buffer[0] !== null) {\r\n          this.draw(position, direction, normal);\r\n        }\r\n\r\n        if (buffer[0] === null) {\r\n          this.endDraw(position, direction, normal);\r\n          buffer.shift();\r\n        }\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _broadcastDrawing: (() => {\r\n    const copyArray = [];\r\n    return function() {\r\n      copyArray.length = 0;\r\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\r\n\r\n      //remove undo's from networkBuffer after they've been sent so that\r\n      //newly joining clients don't get them\r\n      let index = -1;\r\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\r\n        this.networkBuffer.splice(index, 1);\r\n      }\r\n      this.bufferIndex = this.networkBuffer.length;\r\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\r\n    };\r\n  })(),\r\n\r\n  _drawFromNetwork: (() => {\r\n    const position = new THREE.Vector3();\r\n    const direction = new THREE.Vector3();\r\n    const normal = new THREE.Vector3();\r\n    return function() {\r\n      let head = this.networkBuffer[0];\r\n      if (head === \"-\") {\r\n        this._undoDraw();\r\n        this.networkBuffer.shift();\r\n        head = this.networkBuffer[0];\r\n      }\r\n      let didWork = false;\r\n      while (head != null && this.networkBuffer.length >= 11) {\r\n        const pointCount = this.networkBuffer[0];\r\n\r\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\r\n        // If the point is out-of-order, report the error and stop drawing this line.\r\n        if (pointCount !== this.lastReadPointCount + 1) {\r\n          this.invalidPointRead = true;\r\n\r\n          console.error(\r\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\r\n              1} but received ${pointCount}`\r\n          );\r\n        }\r\n\r\n        this.lastReadPointCount = pointCount;\r\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\r\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\r\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\r\n        direction.normalize();\r\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\r\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\r\n        normal.normalize();\r\n\r\n        this.networkBuffer.splice(0, 10);\r\n\r\n        if (!this.remoteLineStarted) {\r\n          this.startDraw(position, direction, normal);\r\n          this.remoteLineStarted = true;\r\n        }\r\n\r\n        if (this.networkBuffer[0] === null) {\r\n          if (!this.invalidPointRead) {\r\n            this._endDraw(position, direction, normal);\r\n          }\r\n\r\n          this.remoteLineStarted = false;\r\n          this.networkBuffer.shift();\r\n          this.lastReadPointCount = 0;\r\n          this.invalidPointRead = false;\r\n        } else {\r\n          if (!this.invalidPointRead) {\r\n            this._draw(position, direction, normal);\r\n            didWork = true;\r\n          }\r\n        }\r\n      }\r\n      if (didWork) this._updateBuffer();\r\n    };\r\n  })(),\r\n\r\n  _deleteExpiredLines(time) {\r\n    const length = this.networkBufferHistory.length;\r\n    if (length > 0) {\r\n      const drawTime = this.networkBufferHistory[0].time;\r\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\r\n        const datum = this.networkBufferHistory[0];\r\n        if (length > 1) {\r\n          datum.idxLength += 2 - (this.segments % 2); //account for extra verts added for degenerate triangles\r\n          this.networkBufferHistory[1].idxLength -= 2 - (this.segments % 2);\r\n        }\r\n        this.idx.position = datum.idxLength;\r\n        this.idx.uv = datum.idxLength;\r\n        this.idx.normal = datum.idxLength;\r\n        this.idx.color = datum.idxLength;\r\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\r\n        this.networkBufferHistory.shift();\r\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n          this.networkBuffer.splice(0, datum.networkBufferCount);\r\n          this.bufferIndex -= datum.networkBufferCount;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _sendNetworkBuffer: (() => {\r\n    const copyArray = [];\r\n    //This number needs to be approx. < ~6000 based on napkin math\r\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\r\n    const chunkAmount = 3000;\r\n    return function(clientId) {\r\n      if (NAF.utils.isMine(this.networkedEl)) {\r\n        if (this.networkBuffer.length <= chunkAmount) {\r\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\r\n            type: MSG_BUFFER_DATA_FULL,\r\n            parts: 1,\r\n            buffer: this.networkBuffer\r\n          });\r\n        } else {\r\n          let start = 0;\r\n          let end = 0;\r\n          while (end < this.networkBuffer.length) {\r\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\r\n            copyArray.length = 0;\r\n            copyData(this.networkBuffer, copyArray, start, end - 1);\r\n            start = end;\r\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\r\n              type: MSG_BUFFER_DATA_FULL,\r\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\r\n              buffer: copyArray\r\n            });\r\n          }\r\n        }\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _receiveData(_, dataType, data) {\r\n    switch (data.type) {\r\n      case MSG_CONFIRM_CONNECT:\r\n        this.sendNetworkBufferQueue.push(data.clientId);\r\n        break;\r\n      case MSG_BUFFER_DATA:\r\n        if (this.networkBufferInitialized) {\r\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\r\n        }\r\n        break;\r\n      case MSG_BUFFER_DATA_FULL:\r\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\r\n        if (++this.receivedBufferParts >= data.parts) {\r\n          this.networkBufferInitialized = true;\r\n        }\r\n        break;\r\n    }\r\n  },\r\n\r\n  getLastPoint() {\r\n    return this.lastPoint;\r\n  },\r\n\r\n  startDraw(position, direction, normal, color, radius) {\r\n    if (!NAF.connection.isConnected()) {\r\n      return;\r\n    }\r\n\r\n    this.drawStarted = true;\r\n\r\n    if (color) {\r\n      this.color.set(color);\r\n    }\r\n    if (radius) this.radius = radius;\r\n\r\n    this.lastPoint.copy(position);\r\n    this._addToNetworkBuffer(position, direction, normal);\r\n  },\r\n\r\n  draw(position, direction, normal, color, radius) {\r\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\r\n      return;\r\n    }\r\n\r\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\r\n      this.color.set(color);\r\n    }\r\n    if (radius) this.radius = radius;\r\n\r\n    this._addToNetworkBuffer(position, direction, normal);\r\n    this._draw(position, direction, normal);\r\n\r\n    this._updateBuffer();\r\n  },\r\n\r\n  _draw: (() => {\r\n    const capNormal = new THREE.Vector3();\r\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\r\n      if (!this.lineStarted) {\r\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\r\n\r\n        if (this.networkBufferHistory.length === 0) {\r\n          //start with CW faceculling order\r\n          this._addDegenerateTriangle();\r\n        } else {\r\n          //only do the following if the sharedBuffer is not empty\r\n          this._restartPrimitive();\r\n          this._addDegenerateTriangle();\r\n          if (this.segments % 2 === 0) {\r\n            //flip faceculling order if even numbered segments\r\n            this._addDegenerateTriangle();\r\n          }\r\n        }\r\n\r\n        //get normal for tip of cap\r\n        capNormal.copy(direction).negate();\r\n        //get normals for rim of cap\r\n        for (let i = 0; i < this.segments; i++) {\r\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\r\n        }\r\n\r\n        this._drawCap(this.lastPoint, this.lastSegments, capNormal);\r\n        if (this.segments % 2 !== 0) {\r\n          //flip faceculling order if odd numbered segments\r\n          this._addDegenerateTriangle();\r\n        }\r\n\r\n        this.lineStarted = true;\r\n      } else {\r\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\r\n        this._drawCylinder();\r\n\r\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\r\n          this._drawEndCap(position, direction);\r\n          this._endLine();\r\n        }\r\n      }\r\n      this.lastPoint.copy(position);\r\n    };\r\n  })(),\r\n\r\n  undoDraw() {\r\n    if (!NAF.connection.isConnected() || this.drawStarted) {\r\n      return;\r\n    }\r\n    this._undoDraw();\r\n    this._pushToNetworkBuffer(\"-\");\r\n  },\r\n\r\n  _undoDraw() {\r\n    const length = this.networkBufferHistory.length;\r\n    if (length > 0) {\r\n      const datum = this.networkBufferHistory.pop();\r\n      this.idx.position = 0;\r\n      this.idx.uv = 0;\r\n      this.idx.normal = 0;\r\n      this.idx.color = 0;\r\n      if (length > 1) {\r\n        datum.idxLength += 1 - (this.segments % 2); //account for extra verts added for degenerate triangles\r\n        this.idx.position = this.sharedBuffer.idx.position - datum.idxLength;\r\n        this.idx.uv = this.sharedBuffer.idx.uv - datum.idxLength;\r\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.idxLength;\r\n        this.idx.color = this.sharedBuffer.idx.color - datum.idxLength;\r\n      }\r\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\r\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\r\n        this.bufferIndex -= datum.networkBufferCount;\r\n      }\r\n    }\r\n  },\r\n\r\n  endDraw(position, direction, normal) {\r\n    this._endDraw(position, direction, normal);\r\n    this._updateBuffer();\r\n  },\r\n\r\n  _endDraw(position, direction, normal) {\r\n    if (!this.lineStarted && this.drawStarted) {\r\n      this._drawPoint(position);\r\n    } else if (this.lineStarted && this.drawStarted) {\r\n      this._addToNetworkBuffer(position, direction, normal);\r\n      this._draw(position, direction, normal);\r\n      this._drawEndCap(position, direction);\r\n    }\r\n    this._endLine();\r\n  },\r\n\r\n  _drawEndCap: (() => {\r\n    const projectedDirection = new THREE.Vector3();\r\n    const projectedPoint = new THREE.Vector3();\r\n    return function(position, direction) {\r\n      if (this.lineStarted && this.drawStarted) {\r\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\r\n        projectedPoint.copy(position).add(projectedDirection);\r\n        this._addDegenerateTriangle(); //flip faceculling order before drawing end-cap\r\n        this._drawCap(projectedPoint, this.lastSegments, direction);\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _endLine() {\r\n    if (!this.drawStarted) return;\r\n\r\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\r\n\r\n    const datum = {\r\n      networkBufferCount: this.networkBufferCount,\r\n      idxLength: this.vertexCount - 1,\r\n      time: this.el.sceneEl.clock.elapsedTime * 1000\r\n    };\r\n    this.networkBufferHistory.push(datum);\r\n    this.vertexCount = 0;\r\n    this.networkBufferCount = 0;\r\n    this.currentPointCount = 0;\r\n    this.lineStarted = false;\r\n    this.drawStarted = false;\r\n\r\n    this.sharedBuffer.computeBoundingSpheres();\r\n  },\r\n\r\n  _addToNetworkBuffer: (() => {\r\n    const copyDirection = new THREE.Vector3();\r\n    const copyNormal = new THREE.Vector3();\r\n    return function(position, direction, normal) {\r\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\r\n        ++this.currentPointCount;\r\n        this._pushToNetworkBuffer(this.currentPointCount);\r\n        this._pushToNetworkBuffer(position.x);\r\n        this._pushToNetworkBuffer(position.y);\r\n        this._pushToNetworkBuffer(position.z);\r\n        copyDirection.copy(direction);\r\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\r\n        this._pushToNetworkBuffer(copyDirection.x);\r\n        this._pushToNetworkBuffer(copyDirection.y);\r\n        this._pushToNetworkBuffer(copyDirection.z);\r\n        copyNormal.copy(normal);\r\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\r\n        this._pushToNetworkBuffer(copyNormal.x);\r\n        this._pushToNetworkBuffer(copyNormal.y);\r\n        this._pushToNetworkBuffer(copyNormal.z);\r\n      }\r\n    };\r\n  })(),\r\n\r\n  _pushToNetworkBuffer(val) {\r\n    //don't increment networkBufferCount if undo, because the undo character\r\n    //will be removed in tick() on the next frame\r\n    if (val !== \"-\") {\r\n      ++this.networkBufferCount;\r\n    }\r\n    this.networkBuffer.push(val);\r\n  },\r\n\r\n  //draw a cylinder from last to current segments\r\n  _drawCylinder() {\r\n    //average the normals with the normals from the lastSegment\r\n    //not a perfect normal calculation, but works well enough\r\n    for (let i = 0; i < this.segments; i++) {\r\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\r\n    }\r\n\r\n    for (let i = 0; i != this.segments + 1; i++) {\r\n      this._addVertex(this.lastSegments[i % this.segments]);\r\n      this._addVertex(this.currentSegments[i % this.segments]);\r\n    }\r\n\r\n    for (let i = 0; i < this.segments; i++) {\r\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\r\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\r\n    }\r\n  },\r\n\r\n  //draw a standalone point in space\r\n  _drawPoint: (() => {\r\n    const up = new THREE.Vector3(0, 1, 0);\r\n    const down = new THREE.Vector3(0, -1, 0);\r\n    const left = new THREE.Vector3(1, 0, 0);\r\n    const projectedDirection = new THREE.Vector3();\r\n    const projectedPoint = new THREE.Vector3();\r\n    return function(position) {\r\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\r\n      projectedPoint.copy(position).add(projectedDirection);\r\n      this.lastPoint.copy(projectedPoint);\r\n\r\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\r\n      projectedPoint.copy(position).add(projectedDirection);\r\n      this._draw(projectedPoint, down, left, 0.75);\r\n\r\n      this._draw(position, down, left);\r\n\r\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\r\n      projectedPoint.copy(position).add(projectedDirection);\r\n      this._draw(projectedPoint, down, left, 0.75);\r\n\r\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\r\n      projectedPoint.copy(position).add(projectedDirection);\r\n\r\n      this._addDegenerateTriangle(); //discarded\r\n      this._drawCap(projectedPoint, this.lastSegments, down);\r\n    };\r\n  })(),\r\n\r\n  //draw a cap to start/end a line\r\n  _drawCap(point, segments, normal) {\r\n    let segmentIndex = 0;\r\n    for (let i = 0; i < this.segments * 2 - (this.segments % 2); i++) {\r\n      if ((i - 2) % 4 === 0) {\r\n        this._addVertex({ position: point, normal: normal });\r\n      } else {\r\n        this._addVertex(segments[segmentIndex % this.segments]);\r\n        if ((i + 1) % 5 !== 0) {\r\n          ++segmentIndex;\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _restartPrimitive() {\r\n    this.sharedBuffer.restartPrimitive();\r\n    ++this.vertexCount;\r\n  },\r\n\r\n  _updateBuffer() {\r\n    this.sharedBuffer.update();\r\n  },\r\n\r\n  _addVertex(segment) {\r\n    const point = segment.position;\r\n    const normal = segment.normal;\r\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\r\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\r\n\r\n    if (normal) {\r\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\r\n    } else {\r\n      ++this.sharedBuffer.idx.normal;\r\n    }\r\n\r\n    ++this.sharedBuffer.idx.uv;\r\n    ++this.vertexCount;\r\n  },\r\n\r\n  _addDegenerateTriangle() {\r\n    this._addVertex(this.lastSegments[0]);\r\n  },\r\n\r\n  //calculate the segments for a given point\r\n  _generateSegments(segmentsList, point, forward, up, radius) {\r\n    const angleIncrement = (Math.PI * 2) / this.segments;\r\n    for (let i = 0; i < this.segments; i++) {\r\n      const segment = segmentsList[i].position;\r\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\r\n      segmentsList[i].normal.subVectors(segment, point).normalize();\r\n    }\r\n  },\r\n\r\n  _rotatePointAroundAxis: (() => {\r\n    const calculatedDirection = new THREE.Vector3();\r\n    return function(out, point, axis, up, angle, radius) {\r\n      calculatedDirection.copy(up);\r\n      calculatedDirection.applyAxisAngle(axis, angle);\r\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\r\n    };\r\n  })()\r\n});\r\n\r\nAFRAME.registerComponent(\"networked-drawing-buffer\", {\r\n  schema: {\r\n    buffer: { default: [] }\r\n  },\r\n\r\n  play() {\r\n    const button = this._getDeserializeButton(this.el.parentEl);\r\n    if (button) {\r\n      button.object3D.visible = true;\r\n      button.components[\"deserialize-drawing-button\"].networkedDrawingBuffer = this;\r\n    }\r\n  },\r\n\r\n  _getDeserializeButton(entity) {\r\n    if (entity.classList.contains(\"interactable\")) {\r\n      return entity.querySelector(\".deserialize-drawing\");\r\n    } else if (entity.parentEl) {\r\n      return this._getDeserializeButton(entity.parentEl);\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n});\r\n\r\nAFRAME.registerComponent(\"deserialize-drawing-button\", {\r\n  init() {\r\n    const drawingManager = this.el.sceneEl.querySelector(\"#drawing-manager\").components[\"drawing-manager\"];\r\n    this.networkedDrawingBuffer = null;\r\n\r\n    this.onClick = () => {\r\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\r\n\r\n      const finishDrawing = () => {\r\n        drawingManager.drawing.deserializeDrawing(this.networkedDrawingBuffer.data.buffer);\r\n        addMeshScaleAnimation(drawingManager.drawing.el.object3DMap.mesh, { x: 0.001, y: 0.001, z: 0.001 });\r\n\r\n        if (this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned) {\r\n          this.targetEl.setAttribute(\"pinnable\", \"pinned\", false);\r\n        }\r\n        this.targetEl.parentEl.removeChild(this.targetEl);\r\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PEN_START_DRAW);\r\n      };\r\n\r\n      //serialize any existing drawing and clear the drawing.\r\n      if (drawingManager.drawing) {\r\n        drawingManager.drawing.serializeDrawing().then(() => {\r\n          drawingManager.drawing.el.parentEl.removeChild(drawingManager.drawing.el);\r\n          drawingManager.destroyDrawing();\r\n\r\n          drawingManager.createDrawing().then(finishDrawing);\r\n        });\r\n      } else {\r\n        drawingManager.createDrawing().then(finishDrawing);\r\n      }\r\n    };\r\n\r\n    this._updateUI = this._updateUI.bind(this);\r\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\r\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\r\n      this.targetEl = networkedEl;\r\n      this._updateUI();\r\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\r\n    });\r\n  },\r\n\r\n  play() {\r\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  pause() {\r\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\r\n  },\r\n\r\n  remove() {\r\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\r\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\r\n\r\n    if (this.targetEl) {\r\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\r\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\r\n    }\r\n  },\r\n\r\n  _updateUIOnStateChange(e) {\r\n    if (e.detail !== \"frozen\") return;\r\n    this._updateUI();\r\n  },\r\n\r\n  _updateUI() {\r\n    if (this.networkedDrawingBuffer) {\r\n      const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\r\n      const canPin = window.APP.hubChannel.can(\"pin_objects\") && window.APP.hubChannel.signedIn;\r\n      this.el.object3D.visible = (!isPinned || canPin) && window.APP.hubChannel.can(\"spawn_drawing\");\r\n    } else {\r\n      this.el.object3D.visible = false;\r\n    }\r\n  }\r\n});\r\n","import { CONSTANTS } from \"three-ammo\";\r\nconst ACTIVATION_STATE = CONSTANTS.ACTIVATION_STATE,\r\n  TYPE = CONSTANTS.TYPE;\r\n\r\nconst ACTIVATION_STATES = [\r\n  ACTIVATION_STATE.ACTIVE_TAG,\r\n  ACTIVATION_STATE.ISLAND_SLEEPING,\r\n  ACTIVATION_STATE.WANTS_DEACTIVATION,\r\n  ACTIVATION_STATE.DISABLE_DEACTIVATION,\r\n  ACTIVATION_STATE.DISABLE_SIMULATION\r\n];\r\n\r\nAFRAME.registerComponent(\"body-helper\", {\r\n  schema: {\r\n    loadedEvent: { default: \"\" },\r\n    mass: { default: 1 },\r\n    gravity: { type: \"vec3\", default: { x: 0, y: -9.8, z: 0 } },\r\n    linearDamping: { default: 0.01 },\r\n    angularDamping: { default: 0.01 },\r\n    linearSleepingThreshold: { default: 1.6 },\r\n    angularSleepingThreshold: { default: 2.5 },\r\n    angularFactor: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\r\n    activationState: {\r\n      default: ACTIVATION_STATE.ACTIVE_TAG,\r\n      oneOf: ACTIVATION_STATES\r\n    },\r\n    type: { default: \"dynamic\", oneOf: [TYPE.STATIC, TYPE.DYNAMIC, TYPE.KINEMATIC] },\r\n    emitCollisionEvents: { default: false },\r\n    disableCollision: { default: false },\r\n    collisionFilterGroup: { default: 1 }, //32-bit mask,\r\n    collisionFilterMask: { default: 1 }, //32-bit mask\r\n    scaleAutoUpdate: { default: true }\r\n  },\r\n\r\n  init: function() {\r\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n    this.alive = true;\r\n    this.uuid = -1;\r\n    this.system.registerBodyHelper(this);\r\n  },\r\n\r\n  init2: function() {\r\n    this.el.object3D.updateMatrices();\r\n    this.uuid = this.system.addBody(this.el.object3D, this.data);\r\n  },\r\n\r\n  update: function(prevData) {\r\n    if (prevData !== null && this.uuid !== -1) {\r\n      this.system.updateBody(this.uuid, this.data);\r\n    }\r\n  },\r\n\r\n  remove: function() {\r\n    if (this.uuid !== -1) {\r\n      this.system.removeBody(this.uuid);\r\n    }\r\n    this.alive = false;\r\n  }\r\n});\r\n","import { SHAPE, FIT } from \"three-ammo/constants\";\r\n\r\nAFRAME.registerComponent(\"shape-helper\", {\r\n  schema: {\r\n    type: {\r\n      default: SHAPE.HULL,\r\n      oneOf: [\r\n        SHAPE.BOX,\r\n        SHAPE.CYLINDER,\r\n        SHAPE.SPHERE,\r\n        SHAPE.CAPSULE,\r\n        SHAPE.CONE,\r\n        SHAPE.HULL,\r\n        SHAPE.HACD,\r\n        SHAPE.VHACD,\r\n        SHAPE.MESH,\r\n        SHAPE.HEIGHTFIELD\r\n      ]\r\n    },\r\n    fit: { default: FIT.ALL, oneOf: [FIT.ALL, FIT.MANUAL] },\r\n    halfExtents: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\r\n    minHalfExtent: { default: 0 },\r\n    maxHalfExtent: { default: Number.POSITIVE_INFINITY },\r\n    sphereRadius: { default: NaN },\r\n    cylinderAxis: { default: \"y\", oneOf: [\"x\", \"y\", \"z\"] },\r\n    margin: { default: 0.01 },\r\n    offset: { type: \"vec3\", default: { x: 0, y: 0, z: 0 } },\r\n    orientation: { type: \"vec4\", default: { x: 0, y: 0, z: 0, w: 1 } },\r\n    heightfieldData: { default: [] },\r\n    heightfieldDistance: { default: 1 },\r\n    includeInvisible: { default: false }\r\n  },\r\n\r\n  multiple: true,\r\n\r\n  init: function() {\r\n    this.system = this.el.sceneEl.systems[\"hubs-systems\"].physicsSystem;\r\n    this.alive = true;\r\n    this.uuid = -1;\r\n    this.system.registerShapeHelper(this);\r\n  },\r\n\r\n  init2: function() {\r\n    this.mesh = null;\r\n\r\n    let bodyEl = this.el;\r\n    this.bodyHelper = bodyEl.components[\"body-helper\"] || null;\r\n    while (!this.bodyHelper && bodyEl.parentNode != this.el.sceneEl) {\r\n      bodyEl = bodyEl.parentNode;\r\n      if (bodyEl.components[\"body-helper\"]) {\r\n        this.bodyHelper = bodyEl.components[\"body-helper\"];\r\n      }\r\n    }\r\n    if (!this.bodyHelper || this.bodyHelper.uuid === null || this.bodyHelper.uuid === undefined) {\r\n      console.warn(\"body not found\");\r\n      return;\r\n    }\r\n    if (this.data.fit === FIT.ALL) {\r\n      if (!this.el.object3DMap.mesh) {\r\n        console.error(\"Cannot use FIT.ALL without object3DMap.mesh\");\r\n        return;\r\n      }\r\n      this.mesh = this.el.object3DMap.mesh;\r\n      this.mesh.updateMatrices();\r\n    }\r\n\r\n    this.uuid = this.system.addShapes(this.bodyHelper.uuid, this.mesh, this.data);\r\n  },\r\n\r\n  remove: function() {\r\n    if (this.uuid !== -1) {\r\n      this.system.removeShapes(this.bodyHelper.uuid, this.uuid);\r\n    }\r\n    this.alive = false;\r\n  }\r\n});\r\n","function registerNetworkSchemas() {\r\n  const vectorRequiresUpdate = epsilon => {\r\n    return () => {\r\n      let prev = null;\r\n\r\n      return curr => {\r\n        if (prev === null) {\r\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\r\n          return true;\r\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\r\n          prev.copy(curr);\r\n          return true;\r\n        }\r\n\r\n        return false;\r\n      };\r\n    };\r\n  };\r\n\r\n  // Note: networked template ids are semantically important. We use the template suffix as a filter\r\n  // for allowing and authorizing messages in reticulum.\r\n  // See `spawn_permitted?` in https://github.com/mozilla/reticulum/blob/master/lib/ret_web/channels/hub_channel.ex\r\n\r\n  // NAF schemas have been extended with a custom nonAuthorizedComponents property that is used to skip authorization\r\n  // on certain components and properties regardless of hub or user permissions. See permissions-utils.js.\r\n\r\n  NAF.schemas.add({\r\n    template: \"#remote-avatar\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      \"player-info\",\r\n      \"networked-avatar\",\r\n      {\r\n        selector: \".camera\",\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        selector: \".camera\",\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        selector: \".left-controller\",\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        selector: \".left-controller\",\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        selector: \".left-controller\",\r\n        component: \"visible\"\r\n      },\r\n      {\r\n        selector: \".right-controller\",\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        selector: \".right-controller\",\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        selector: \".right-controller\",\r\n        component: \"visible\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#interactable-media\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\r\n      \"media-loader\",\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      },\r\n      {\r\n        component: \"media-video\",\r\n        property: \"videoPaused\"\r\n      },\r\n      {\r\n        component: \"media-pdf\",\r\n        property: \"index\"\r\n      },\r\n      \"pinnable\"\r\n    ],\r\n    nonAuthorizedComponents: [\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      },\r\n      {\r\n        component: \"media-video\",\r\n        property: \"videoPaused\"\r\n      },\r\n      {\r\n        component: \"media-pager\",\r\n        property: \"index\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#interactable-emoji\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"emoji\",\r\n        property: \"emitEndTime\"\r\n      },\r\n      {\r\n        component: \"emoji\",\r\n        property: \"particleEmitterConfig\"\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      \"media-loader\",\r\n      \"pinnable\",\r\n      {\r\n        selector: \".particle-emitter\",\r\n        component: \"particle-emitter\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#static-media\",\r\n    components: [\r\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\r\n      \"media-loader\",\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      }\r\n    ],\r\n    nonAuthorizedComponents: [\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#static-controlled-media\",\r\n    components: [\r\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\r\n      \"media-loader\",\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      },\r\n      {\r\n        component: \"media-video\",\r\n        property: \"videoPaused\"\r\n      },\r\n      {\r\n        component: \"media-pdf\",\r\n        property: \"index\"\r\n      }\r\n    ],\r\n    nonAuthorizedComponents: [\r\n      {\r\n        component: \"media-video\",\r\n        property: \"time\"\r\n      },\r\n      {\r\n        component: \"media-video\",\r\n        property: \"videoPaused\"\r\n      },\r\n      {\r\n        component: \"media-pager\",\r\n        property: \"index\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#interactable-drawing\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      \"networked-drawing\"\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#interactable-camera\",\r\n    components: [\r\n      \"position\",\r\n      \"rotation\",\r\n      {\r\n        component: \"camera-tool\",\r\n        property: \"isSnapping\"\r\n      },\r\n      {\r\n        component: \"camera-tool\",\r\n        property: \"isRecording\"\r\n      },\r\n      {\r\n        component: \"camera-tool\",\r\n        property: \"label\"\r\n      }\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#template-waypoint-avatar\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      \"waypoint\"\r\n    ],\r\n    nonAuthorizedComponents: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      \"waypoint\"\r\n    ]\r\n  });\r\n\r\n  NAF.schemas.add({\r\n    template: \"#interactable-pen\",\r\n    components: [\r\n      {\r\n        component: \"position\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        component: \"rotation\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\r\n      },\r\n      {\r\n        component: \"scale\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen\",\r\n        property: \"radius\"\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen\",\r\n        property: \"color\"\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen\",\r\n        property: \"drawMode\"\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen\",\r\n        property: \"penVisible\"\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen-laser\",\r\n        property: \"laserVisible\"\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen-laser\",\r\n        property: \"remoteLaserOrigin\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      },\r\n      {\r\n        selector: \"#pen\",\r\n        component: \"pen-laser\",\r\n        property: \"laserTarget\",\r\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\r\n      }\r\n    ]\r\n  });\r\n}\r\n\r\nexport default registerNetworkSchemas;\r\n","import \"./webxr-bypass-hacks\";\r\nimport configs from \"./utils/configs\";\r\nimport \"./utils/theme\";\r\nimport \"@babel/polyfill\";\r\nimport \"./utils/debug-log\";\r\n\r\nconsole.log(`App version: ${process.env.BUILD_VERSION || \"?\"}`);\r\n\r\nimport \"./assets/stylesheets/hub.scss\";\r\nimport initialBatchImage from \"./assets/images/warning_icon.png\";\r\nimport loadingEnvironment from \"./assets/models/LoadingEnvironment.glb\";\r\n\r\nimport \"aframe\";\r\nimport \"./utils/logging\";\r\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\r\npatchWebGLRenderingContext();\r\n\r\nimport \"three/examples/js/loaders/GLTFLoader\";\r\nimport \"networked-aframe/src/index\";\r\nimport \"naf-janus-adapter\";\r\nimport \"aframe-rounded\";\r\nimport \"webrtc-adapter\";\r\nimport \"aframe-slice9-component\";\r\nimport \"./utils/audio-context-fix\";\r\nimport \"./utils/threejs-positional-audio-updatematrixworld\";\r\nimport \"./utils/threejs-world-update\";\r\nimport patchThreeAllocations from \"./utils/threejs-allocation-patches\";\r\nimport { detectOS } from \"detect-browser\";\r\nimport {\r\n  getReticulumFetchUrl,\r\n  getReticulumMeta,\r\n  invalidateReticulumMeta,\r\n  migrateChannelToSocket\r\n} from \"./utils/phoenix-utils\";\r\n\r\nimport nextTick from \"./utils/next-tick\";\r\nimport { addAnimationComponents } from \"./utils/animation\";\r\nimport { authorizeOrSanitizeMessage } from \"./utils/permissions-utils\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nimport \"./components/scene-components\";\r\nimport \"./components/scale-in-screen-space\";\r\nimport \"./components/mute-mic\";\r\nimport \"./components/bone-mute-state-indicator\";\r\nimport \"./components/bone-visibility\";\r\nimport \"./components/fader\";\r\nimport \"./components/in-world-hud\";\r\nimport \"./components/emoji\";\r\nimport \"./components/emoji-hud\";\r\nimport \"./components/virtual-gamepad-controls\";\r\nimport \"./components/ik-controller\";\r\nimport \"./components/hand-controls2\";\r\nimport \"./components/hoverable-visuals\";\r\nimport \"./components/hover-visuals\";\r\nimport \"./components/offset-relative-to\";\r\nimport \"./components/player-info\";\r\nimport \"./components/debug\";\r\nimport \"./components/hand-poses\";\r\nimport \"./components/hud-controller\";\r\nimport \"./components/freeze-controller\";\r\nimport \"./components/icon-button\";\r\nimport \"./components/text-button\";\r\nimport \"./components/block-button\";\r\nimport \"./components/mute-button\";\r\nimport \"./components/kick-button\";\r\nimport \"./components/close-vr-notice-button\";\r\nimport \"./components/leave-room-button\";\r\nimport \"./components/visible-if-permitted\";\r\nimport \"./components/visibility-on-content-types\";\r\nimport \"./components/hide-when-pinned-and-forbidden\";\r\nimport \"./components/visibility-while-frozen\";\r\nimport \"./components/stats-plus\";\r\nimport \"./components/networked-avatar\";\r\nimport \"./components/media-views\";\r\nimport \"./components/avatar-volume-controls\";\r\nimport \"./components/pinch-to-move\";\r\nimport \"./components/pitch-yaw-rotator\";\r\nimport \"./components/position-at-box-shape-border\";\r\nimport \"./components/pinnable\";\r\nimport \"./components/pin-networked-object-button\";\r\nimport \"./components/mirror-media-button\";\r\nimport \"./components/close-mirrored-media-button\";\r\nimport \"./components/drop-object-button\";\r\nimport \"./components/remove-networked-object-button\";\r\nimport \"./components/camera-focus-button\";\r\nimport \"./components/unmute-video-button\";\r\nimport \"./components/destroy-at-extreme-distances\";\r\nimport \"./components/visible-to-owner\";\r\nimport \"./components/camera-tool\";\r\nimport \"./components/emit-state-change\";\r\nimport \"./components/action-to-event\";\r\nimport \"./components/action-to-remove\";\r\nimport \"./components/emit-scene-event-on-remove\";\r\nimport \"./components/follow-in-fov\";\r\nimport \"./components/matrix-auto-update\";\r\nimport \"./components/clone-media-button\";\r\nimport \"./components/open-media-button\";\r\nimport \"./components/refresh-media-button\";\r\nimport \"./components/tweet-media-button\";\r\nimport \"./components/remix-avatar-button\";\r\nimport \"./components/transform-object-button\";\r\nimport \"./components/scale-button\";\r\nimport \"./components/hover-menu\";\r\nimport \"./components/disable-frustum-culling\";\r\nimport \"./components/teleporter\";\r\nimport \"./components/set-active-camera\";\r\nimport \"./components/track-pose\";\r\nimport \"./components/replay\";\r\nimport \"./components/visibility-by-path\";\r\nimport \"./components/tags\";\r\nimport \"./components/hubs-text\";\r\nimport \"./components/billboard\";\r\nimport \"./components/periodic-full-syncs\";\r\nimport \"./components/inspect-button\";\r\nimport \"./components/set-max-resolution\";\r\nimport { sets as userinputSets } from \"./systems/userinput/sets\";\r\n\r\nimport ReactDOM from \"react-dom\";\r\nimport React from \"react\";\r\nimport { Router, Route } from \"react-router-dom\";\r\nimport { createBrowserHistory, createMemoryHistory } from \"history\";\r\nimport { pushHistoryState } from \"./utils/history\";\r\nimport UIRoot from \"./react-components/ui-root\";\r\nimport AuthChannel from \"./utils/auth-channel\";\r\nimport HubChannel from \"./utils/hub-channel\";\r\nimport LinkChannel from \"./utils/link-channel\";\r\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\r\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\r\nimport { proxiedUrlFor } from \"./utils/media-url-utils\";\r\nimport { traverseMeshesAndAddShapes } from \"./utils/physics-utils\";\r\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR } from \"./utils/vr-interstitial\";\r\nimport { getAvatarSrc } from \"./utils/avatar-utils.js\";\r\nimport MessageDispatch from \"./message-dispatch\";\r\nimport SceneEntryManager from \"./scene-entry-manager\";\r\nimport Subscriptions from \"./subscriptions\";\r\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\r\n\r\nimport \"./systems/nav\";\r\nimport \"./systems/frame-scheduler\";\r\nimport \"./systems/personal-space-bubble\";\r\nimport \"./systems/app-mode\";\r\nimport \"./systems/permissions\";\r\nimport \"./systems/exit-on-blur\";\r\nimport \"./systems/auto-pixel-ratio\";\r\nimport \"./systems/idle-detector\";\r\nimport \"./systems/camera-tools\";\r\nimport \"./systems/userinput/userinput\";\r\nimport \"./systems/userinput/userinput-debug\";\r\nimport \"./systems/ui-hotkeys\";\r\nimport \"./systems/tips\";\r\nimport \"./systems/interactions\";\r\nimport \"./systems/hubs-systems\";\r\nimport \"./systems/capture-system\";\r\nimport \"./systems/listed-media\";\r\nimport \"./systems/linked-media\";\r\nimport { SOUND_CHAT_MESSAGE } from \"./systems/sound-effects-system\";\r\n\r\nimport \"./gltf-component-mappings\";\r\n\r\nimport { App } from \"./App\";\r\n\r\nwindow.APP = new App();\r\nwindow.APP.RENDER_ORDER = {\r\n  HUD_BACKGROUND: 1,\r\n  HUD_ICONS: 2,\r\n  CURSOR: 3\r\n};\r\nconst store = window.APP.store;\r\nconst mediaSearchStore = window.APP.mediaSearchStore;\r\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\r\nconst NOISY_OCCUPANT_COUNT = 12; // Above this # of occupants, we stop posting join/leaves/renames\r\n\r\nconst qs = new URLSearchParams(location.search);\r\nconst isMobile = AFRAME.utils.device.isMobile();\r\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\r\nconst isEmbed = window.self !== window.top;\r\nif (isEmbed && !qs.get(\"embed_token\")) {\r\n  // Should be covered by X-Frame-Options, but just in case.\r\n  throw new Error(\"no embed token\");\r\n}\r\n\r\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\r\nwindow.APP.quality =\r\n  window.APP.store.state.preferences.materialQualitySetting === \"low\"\r\n    ? \"low\"\r\n    : window.APP.store.state.preferences.materialQualitySetting === \"high\"\r\n      ? \"high\"\r\n      : isMobile || isMobileVR\r\n        ? \"low\"\r\n        : \"high\";\r\n\r\nimport \"./components/owned-object-limiter\";\r\nimport \"./components/owned-object-cleanup-timeout\";\r\nimport \"./components/set-unowned-body-kinematic\";\r\nimport \"./components/scalable-when-grabbed\";\r\nimport \"./components/networked-counter\";\r\nimport \"./components/event-repeater\";\r\nimport \"./components/set-yxz-order\";\r\n\r\nimport \"./components/cursor-controller\";\r\n\r\nimport \"./components/nav-mesh-helper\";\r\n\r\nimport \"./components/tools/pen\";\r\nimport \"./components/tools/pen-laser\";\r\nimport \"./components/tools/networked-drawing\";\r\nimport \"./components/tools/drawing-manager\";\r\n\r\nimport \"./components/body-helper\";\r\nimport \"./components/shape-helper\";\r\n\r\nimport registerNetworkSchemas from \"./network-schemas\";\r\nimport registerTelemetry from \"./telemetry\";\r\nimport { warmSerializeElement } from \"./utils/serialize-element\";\r\n\r\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"./utils/vr-caps-detect\";\r\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector\";\r\n\r\nimport qsTruthy from \"./utils/qs_truthy\";\r\n\r\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\r\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\r\nNAF.options.syncSource = PHOENIX_RELIABLE_NAF;\r\n\r\nconst isBotMode = qsTruthy(\"bot\");\r\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\r\nconst isDebug = qsTruthy(\"debug\");\r\n\r\nif (!isBotMode && !isTelemetryDisabled) {\r\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\r\n}\r\n\r\ndisableiOSZoom();\r\ndetectConcurrentLoad();\r\n\r\nfunction getPlatformUnsupportedReason() {\r\n  if (typeof RTCDataChannelEvent === \"undefined\") return \"no_data_channels\";\r\n  return null;\r\n}\r\n\r\nfunction setupLobbyCamera() {\r\n  const camera = document.getElementById(\"scene-preview-node\");\r\n  const previewCamera = document.getElementById(\"environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\r\n\r\n  if (previewCamera) {\r\n    camera.object3D.position.copy(previewCamera.position);\r\n    camera.object3D.rotation.copy(previewCamera.rotation);\r\n    camera.object3D.rotation.reorder(\"YXZ\");\r\n  } else {\r\n    const cameraPos = camera.object3D.position;\r\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\r\n  }\r\n\r\n  camera.object3D.matrixNeedsUpdate = true;\r\n\r\n  camera.removeAttribute(\"scene-preview-camera\");\r\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\r\n}\r\n\r\nlet uiProps = {};\r\n\r\n// Hub ID and slug are the basename\r\nlet routerBaseName = document.location.pathname\r\n  .split(\"/\")\r\n  .slice(0, 2)\r\n  .join(\"/\");\r\n\r\n// if (document.location.pathname.includes(\"hub.html\")) {\r\n//   routerBaseName = \"/\";\r\n// }\r\n\r\n// when loading the client as a \"default room\" on the homepage, use MemoryHistory since exposing all the client paths at the root is undesirable\r\nconst history = routerBaseName === \"/\" ? createMemoryHistory() : createBrowserHistory({ basename: routerBaseName });\r\nwindow.APP.history = history;\r\n\r\nconst qsVREntryType = qs.get(\"vr_entry_type\");\r\n\r\nfunction mountUI(props = {}) {\r\n  const scene = document.querySelector(\"a-scene\");\r\n  const disableAutoExitOnIdle =\r\n    qsTruthy(\"allow_idle\") || (process.env.NODE_ENV === \"development\" && !qs.get(\"idle_timeout\"));\r\n  const isCursorHoldingPen =\r\n    scene &&\r\n    (scene.systems.userinput.activeSets.includes(userinputSets.rightCursorHoldingPen) ||\r\n      scene.systems.userinput.activeSets.includes(userinputSets.leftCursorHoldingPen));\r\n  const hasActiveCamera = scene && !!scene.systems[\"camera-tools\"].getMyCamera();\r\n  const forcedVREntryType = qsVREntryType;\r\n\r\n  ReactDOM.render(\r\n    <Router history={history} basename={process.env.PUBLIC_URL}>\r\n      <Route\r\n        render={routeProps => (\r\n          <UIRoot\r\n            {...{\r\n              scene,\r\n              isBotMode,\r\n              disableAutoExitOnIdle,\r\n              forcedVREntryType,\r\n              store,\r\n              mediaSearchStore,\r\n              isCursorHoldingPen,\r\n              hasActiveCamera,\r\n              ...props,\r\n              ...routeProps\r\n            }}\r\n          />\r\n        )}\r\n      />\r\n    </Router>,\r\n    document.getElementById(\"ui-root\")\r\n  );\r\n}\r\n\r\nfunction remountUI(props) {\r\n  uiProps = { ...uiProps, ...props };\r\n  mountUI(uiProps);\r\n}\r\n\r\nasync function updateEnvironmentForHub(hub, entryManager) {\r\n  let sceneUrl;\r\n  let isLegacyBundle; // Deprecated\r\n\r\n  const sceneErrorHandler = () => {\r\n    remountUI({ roomUnavailableReason: \"scene_error\" });\r\n    entryManager.exitScene();\r\n  };\r\n\r\n  const environmentScene = document.querySelector(\"#environment-scene\");\r\n  const sceneEl = document.querySelector(\"a-scene\");\r\n\r\n  if (hub.scene) {\r\n    isLegacyBundle = false;\r\n    sceneUrl = hub.scene.model_url;\r\n  } else if (hub.scene === null) {\r\n    // delisted/removed scene\r\n    sceneUrl = loadingEnvironment;\r\n  } else {\r\n    const defaultSpaceTopic = hub.topics[0];\r\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\r\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\r\n    sceneUrl = (glbAsset || bundleAsset).src || loadingEnvironment;\r\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\r\n    isLegacyBundle = !(glbAsset || hasExtension);\r\n  }\r\n\r\n  if (isLegacyBundle) {\r\n    // Deprecated\r\n    const res = await fetch(sceneUrl);\r\n    const data = await res.json();\r\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\r\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\r\n  } else {\r\n    sceneUrl = proxiedUrlFor(sceneUrl);\r\n  }\r\n\r\n  console.log(`Scene URL: ${sceneUrl}`);\r\n\r\n  let environmentEl = null;\r\n\r\n  if (environmentScene.childNodes.length === 0) {\r\n    const environmentEl = document.createElement(\"a-entity\");\r\n\r\n    environmentEl.addEventListener(\r\n      \"model-loaded\",\r\n      () => {\r\n        environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\r\n\r\n        // Show the canvas once the model has loaded\r\n        document.querySelector(\".a-canvas\").classList.remove(\"a-hidden\");\r\n\r\n        sceneEl.addState(\"visible\");\r\n\r\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\r\n        traverseMeshesAndAddShapes(environmentEl);\r\n      },\r\n      { once: true }\r\n    );\r\n\r\n    environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\r\n\r\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\r\n    environmentScene.appendChild(environmentEl);\r\n  } else {\r\n    // Change environment\r\n    environmentEl = environmentScene.childNodes[0];\r\n\r\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\r\n    THREE.Cache.clear();\r\n    const waypointSystem = sceneEl.systems[\"hubs-systems\"].waypointSystem;\r\n    waypointSystem.releaseAnyOccupiedWaypoints();\r\n\r\n    environmentEl.addEventListener(\r\n      \"model-loaded\",\r\n      () => {\r\n        environmentEl.addEventListener(\r\n          \"model-loaded\",\r\n          () => {\r\n            environmentEl.removeEventListener(\"model-error\", sceneErrorHandler);\r\n            traverseMeshesAndAddShapes(environmentEl);\r\n\r\n            // We've already entered, so move to new spawn point once new environment is loaded\r\n            if (sceneEl.is(\"entered\")) {\r\n              waypointSystem.moveToSpawnPoint();\r\n            }\r\n\r\n            const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\r\n\r\n            // Add a slight delay before de-in to reduce hitching.\r\n            setTimeout(() => fader.fadeIn(), 2000);\r\n          },\r\n          { once: true }\r\n        );\r\n\r\n        sceneEl.emit(\"leaving_loading_environment\");\r\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\r\n      },\r\n      { once: true }\r\n    );\r\n\r\n    if (!sceneEl.is(\"entered\")) {\r\n      environmentEl.addEventListener(\"model-error\", sceneErrorHandler, { once: true });\r\n    }\r\n\r\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironment });\r\n  }\r\n}\r\n\r\nasync function updateUIForHub(hub, hubChannel) {\r\n  remountUI({ hub, entryDisallowed: !hubChannel.canEnterRoom(hub) });\r\n}\r\n\r\nfunction handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data) {\r\n  const scene = document.querySelector(\"a-scene\");\r\n  const isRejoin = NAF.connection.isConnected();\r\n\r\n  if (isRejoin) {\r\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\r\n    // on re-join. Ideally this would be updated into the channel socket state but this\r\n    // would require significant changes to the hub channel events and socket management.\r\n    if (scene.is(\"entered\")) {\r\n      hubChannel.sendEnteredEvent();\r\n    }\r\n\r\n    // Send complete sync on phoenix re-join.\r\n    NAF.connection.entities.completeSync(null, true);\r\n    return;\r\n  }\r\n\r\n  // Turn off NAF for embeds as an optimization, so the user's browser isn't getting slammed\r\n  // with NAF traffic on load.\r\n  if (isEmbed) {\r\n    hubChannel.allowNAFTraffic(false);\r\n  }\r\n\r\n  const hub = data.hubs[0];\r\n\r\n  let embedToken = hub.embed_token;\r\n\r\n  if (!embedToken) {\r\n    const embedTokenEntry = store.state.embedTokens && store.state.embedTokens.find(t => t.hubId === hub.hub_id);\r\n\r\n    if (embedTokenEntry) {\r\n      embedToken = embedTokenEntry.embedToken;\r\n    }\r\n  }\r\n\r\n  console.log(`Janus host: ${hub.host}:${hub.port}`);\r\n\r\n  remountUI({\r\n    onSendMessage: messageDispatch.dispatch,\r\n    onLoaded: () => store.executeOnLoadActions(scene),\r\n    onMediaSearchResultEntrySelected: (entry, selectAction) =>\r\n      scene.emit(\"action_selected_media_result_entry\", { entry, selectAction }),\r\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry),\r\n    onAvatarSaved: entry => scene.emit(\"action_avatar_saved\", entry),\r\n    embedToken: embedToken\r\n  });\r\n\r\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\r\n    const { entry, selectAction } = e.detail;\r\n    if ((entry.type !== \"scene_listing\" && entry.type !== \"scene\") || selectAction !== \"use\") return;\r\n    if (!hubChannel.can(\"update_hub\")) return;\r\n\r\n    hubChannel.updateScene(entry.url);\r\n  });\r\n\r\n  // Handle request for user gesture\r\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\r\n    remountUI({\r\n      showInterstitialPrompt: true,\r\n      onInterstitialPromptClicked: () => {\r\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\r\n        scene.emit(\"2d-interstitial-gesture-complete\");\r\n      }\r\n    });\r\n  });\r\n\r\n  const objectsScene = document.querySelector(\"#objects-scene\");\r\n  const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\r\n  const objectsEl = document.createElement(\"a-entity\");\r\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\r\n\r\n  if (!isBotMode) {\r\n    objectsScene.appendChild(objectsEl);\r\n  }\r\n\r\n  // Wait for scene objects to load before connecting, so there is no race condition on network state.\r\n  const connectToScene = async () => {\r\n    scene.setAttribute(\"networked-scene\", {\r\n      room: hub.hub_id,\r\n      serverURL: `wss://${hub.host}:${hub.port}`,\r\n      debug: !!isDebug\r\n    });\r\n\r\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\r\n\r\n    scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\r\n      let newHostPollInterval = null;\r\n\r\n      // When reconnecting, update the server URL if necessary\r\n      adapter.setReconnectionListeners(\r\n        () => {\r\n          if (newHostPollInterval) return;\r\n\r\n          newHostPollInterval = setInterval(async () => {\r\n            const currentServerURL = NAF.connection.adapter.serverUrl;\r\n            const newHubHost = await hubChannel.getHost();\r\n            const newServerURL = `wss://${newHubHost}`;\r\n\r\n            if (currentServerURL !== newServerURL) {\r\n              console.log(\"Connecting to new Janus server \" + newServerURL);\r\n              scene.setAttribute(\"networked-scene\", { serverURL: newServerURL });\r\n              adapter.serverUrl = newServerURL;\r\n            }\r\n          }, 1000);\r\n        },\r\n        () => {\r\n          clearInterval(newHostPollInterval);\r\n          newHostPollInterval = null;\r\n        },\r\n        null\r\n      );\r\n\r\n      const sendViaPhoenix = reliable => (clientId, dataType, data) => {\r\n        const payload = { dataType, data };\r\n\r\n        if (clientId) {\r\n          payload.clientId = clientId;\r\n        }\r\n\r\n        const isOpen = hubChannel.channel.socket.connectionState() === \"open\";\r\n\r\n        if (isOpen || reliable) {\r\n          const hasFirstSync =\r\n            payload.dataType === \"um\" ? payload.data.d.find(r => r.isFirstSync) : payload.data.isFirstSync;\r\n\r\n          if (hasFirstSync) {\r\n            if (isOpen) {\r\n              hubChannel.channel.push(\"naf\", payload);\r\n            } else {\r\n              // Memory is re-used, so make a copy\r\n              hubChannel.channel.push(\"naf\", AFRAME.utils.clone(payload));\r\n            }\r\n          } else {\r\n            // Optimization: Strip isFirstSync and send payload as a string to reduce server parsing.\r\n            // The server will not parse messages without isFirstSync keys when sent to the nafr event.\r\n            //\r\n            // The client must assume any payload that does not have a isFirstSync key is not a first sync.\r\n            const nafrPayload = AFRAME.utils.clone(payload);\r\n            if (nafrPayload.dataType === \"um\") {\r\n              for (let i = 0; i < nafrPayload.data.d.length; i++) {\r\n                delete nafrPayload.data.d[i].isFirstSync;\r\n              }\r\n            } else {\r\n              delete nafrPayload.data.isFirstSync;\r\n            }\r\n\r\n            hubChannel.channel.push(\"nafr\", { naf: JSON.stringify(nafrPayload) });\r\n          }\r\n        }\r\n      };\r\n\r\n      adapter.reliableTransport = sendViaPhoenix(true);\r\n      adapter.unreliableTransport = sendViaPhoenix(false);\r\n    });\r\n\r\n    const loadEnvironmentAndConnect = () => {\r\n      updateEnvironmentForHub(hub, entryManager);\r\n      function onConnectionError() {\r\n        console.error(\"Unknown error occurred while attempting to connect to networked scene.\");\r\n        remountUI({ roomUnavailableReason: \"connect_error\" });\r\n        entryManager.exitScene();\r\n      }\r\n\r\n      const connectionErrorTimeout = setTimeout(onConnectionError, 90000);\r\n      scene.components[\"networked-scene\"]\r\n        .connect()\r\n        .then(() => {\r\n          clearTimeout(connectionErrorTimeout);\r\n          scene.emit(\"didConnectToNetworkedScene\");\r\n        })\r\n        .catch(connectError => {\r\n          clearTimeout(connectionErrorTimeout);\r\n          // hacky until we get return codes\r\n          const isFull = connectError.error && connectError.error.msg.match(/\\bfull\\b/i);\r\n          console.error(connectError);\r\n          remountUI({ roomUnavailableReason: isFull ? \"full\" : \"connect_error\" });\r\n          entryManager.exitScene();\r\n\r\n          return;\r\n        });\r\n    };\r\n\r\n    updateUIForHub(hub, hubChannel);\r\n\r\n    if (!isEmbed) {\r\n      loadEnvironmentAndConnect();\r\n    } else {\r\n      remountUI({\r\n        onPreloadLoadClicked: () => {\r\n          hubChannel.allowNAFTraffic(true);\r\n          remountUI({ showPreload: false });\r\n          loadEnvironmentAndConnect();\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  if (!isBotMode) {\r\n    objectsEl.addEventListener(\"model-loaded\", async el => {\r\n      if (el.target !== objectsEl) return;\r\n      connectToScene();\r\n    });\r\n  } else {\r\n    connectToScene();\r\n  }\r\n}\r\n\r\nasync function runBotMode(scene, entryManager) {\r\n  const noop = () => {};\r\n  scene.renderer = { setAnimationLoop: noop, render: noop };\r\n\r\n  while (!NAF.connection.isConnected()) await nextTick();\r\n  entryManager.enterSceneWhenLoaded(new MediaStream(), false);\r\n}\r\n\r\nfunction checkForAccountRequired() {\r\n  // If the app requires an account to join a room, redirect to the sign in page.\r\n  if (!configs.feature(\"require_account_for_join\")) return;\r\n  if (store.state.credentials && store.state.credentials.token) return;\r\n  document.location = `/?sign_in&sign_in_destination=hub&sign_in_destination_url=${encodeURIComponent(\r\n    document.location.toString()\r\n  )}`;\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\r\n  await store.initProfile();\r\n\r\n  const canvas = document.querySelector(\".a-canvas\");\r\n  canvas.classList.add(\"a-hidden\");\r\n\r\n  warmSerializeElement();\r\n\r\n  if (!window.WebAssembly) {\r\n    remountUI({ showWebAssemblyDialog: true });\r\n    return;\r\n  }\r\n\r\n  // If we are on iOS but we don't have the mediaDevices API, then we are likely in a Firefox or Chrome WebView,\r\n  // or a WebView preview used in apps like Twitter and Discord. So we show the dialog that tells users to open\r\n  // the room in the real Safari.\r\n  const detectedOS = detectOS(navigator.userAgent);\r\n  if (detectedOS === \"iOS\" && !navigator.mediaDevices) {\r\n    remountUI({ showSafariDialog: true });\r\n    return;\r\n  }\r\n\r\n  const defaultRoomId = configs.feature(\"default_room_id\");\r\n\r\n  const hubId =\r\n    qs.get(\"hub_id\") ||\r\n    (document.location.pathname === \"/\" && defaultRoomId\r\n      ? defaultRoomId\r\n      : document.location.pathname.substring(1).split(\"/\")[0]);\r\n  console.log(`Hub ID: ${hubId}`);\r\n\r\n  if (!defaultRoomId) {\r\n    // Default room won't work if account is required to access\r\n    checkForAccountRequired();\r\n  }\r\n\r\n  const subscriptions = new Subscriptions(hubId);\r\n\r\n  if (navigator.serviceWorker) {\r\n    try {\r\n      navigator.serviceWorker\r\n        .register(\"/hub.service.js\")\r\n        .then(() => {\r\n          navigator.serviceWorker.ready\r\n            .then(registration => subscriptions.setRegistration(registration))\r\n            .catch(() => subscriptions.setRegistrationFailed());\r\n        })\r\n        .catch(() => subscriptions.setRegistrationFailed());\r\n    } catch (e) {\r\n      subscriptions.setRegistrationFailed();\r\n    }\r\n  } else {\r\n    subscriptions.setRegistrationFailed();\r\n  }\r\n\r\n  const scene = document.querySelector(\"a-scene\");\r\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" }); // Disable shadows on low quality\r\n\r\n  // HACK - Trigger initial batch preparation with an invisible object\r\n  scene\r\n    .querySelector(\"#batch-prep\")\r\n    .setAttribute(\"media-image\", { batch: true, src: initialBatchImage, contentType: \"image/png\" });\r\n\r\n  const onSceneLoaded = () => {\r\n    const physicsSystem = scene.systems[\"hubs-systems\"].physicsSystem;\r\n    physicsSystem.setDebug(isDebug || physicsSystem.debug);\r\n    patchThreeAllocations();\r\n  };\r\n\r\n  if (scene.hasLoaded) {\r\n    onSceneLoaded();\r\n  } else {\r\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\r\n  }\r\n\r\n  // If the stored avatar doesn't have a valid src, reset to a legacy avatar.\r\n  const avatarSrc = await getAvatarSrc(store.state.profile.avatarId);\r\n  if (!avatarSrc) {\r\n    await store.resetToRandomDefaultAvatar();\r\n  }\r\n\r\n  const authChannel = new AuthChannel(store);\r\n  const hubChannel = new HubChannel(store, hubId);\r\n  const availableVREntryTypes = await getAvailableVREntryTypes();\r\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, availableVREntryTypes, history);\r\n  const performConditionalSignIn = async (predicate, action, messageId, onFailure) => {\r\n    if (predicate()) return action();\r\n\r\n    const signInContinueTextId = scene.is(\"vr-mode\") ? \"entry.return-to-vr\" : \"dialog.close\";\r\n\r\n    await handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\r\n\r\n    remountUI({\r\n      showSignInDialog: true,\r\n      signInMessageId: `sign-in.${messageId}`,\r\n      signInCompleteMessageId: `sign-in.${messageId}-complete`,\r\n      signInContinueTextId,\r\n      onContinueAfterSignIn: async () => {\r\n        remountUI({ showSignInDialog: false });\r\n        let actionError = null;\r\n        if (predicate()) {\r\n          try {\r\n            await action();\r\n          } catch (e) {\r\n            actionError = e;\r\n          }\r\n        } else {\r\n          actionError = new Error(\"Predicate failed post sign-in\");\r\n        }\r\n\r\n        if (actionError && onFailure) onFailure(actionError);\r\n        exit2DInterstitialAndEnterVR();\r\n      }\r\n    });\r\n  };\r\n\r\n  window.addEventListener(\"action_create_avatar\", () => {\r\n    performConditionalSignIn(\r\n      () => hubChannel.signedIn,\r\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\r\n      \"create-avatar\"\r\n    );\r\n  });\r\n\r\n  scene.addEventListener(\"scene_media_selected\", e => {\r\n    const sceneInfo = e.detail;\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.can(\"update_hub\"),\r\n      () => hubChannel.updateScene(sceneInfo),\r\n      \"change-scene\"\r\n    );\r\n  });\r\n\r\n  scene.addEventListener(\"action_media_tweet\", async e => {\r\n    let isInModal = false;\r\n    let isInOAuth = false;\r\n\r\n    const exitOAuth = () => {\r\n      isInOAuth = false;\r\n      store.clearOnLoadActions();\r\n      remountUI({ showOAuthDialog: false, oauthInfo: null });\r\n    };\r\n\r\n    await handleExitTo2DInterstitial(true, () => {\r\n      if (isInModal) history.goBack();\r\n      if (isInOAuth) exitOAuth();\r\n    });\r\n\r\n    performConditionalSignIn(\r\n      () => hubChannel.signedIn,\r\n      async () => {\r\n        // Strip el from stored payload because it won't serialize into the store.\r\n        const serializableDetail = {};\r\n        Object.assign(serializableDetail, e.detail);\r\n        delete serializableDetail.el;\r\n\r\n        if (hubChannel.can(\"tweet\")) {\r\n          isInModal = true;\r\n          pushHistoryState(history, \"modal\", \"tweet\", serializableDetail);\r\n        } else {\r\n          if (e.detail.el) {\r\n            // Pin the object if we have to go through OAuth, since the page will refresh and\r\n            // the object will otherwise be removed\r\n            e.detail.el.setAttribute(\"pinnable\", \"pinned\", true);\r\n          }\r\n\r\n          const url = await hubChannel.getTwitterOAuthURL();\r\n\r\n          isInOAuth = true;\r\n          store.enqueueOnLoadAction(\"emit_scene_event\", { event: \"action_media_tweet\", detail: serializableDetail });\r\n          remountUI({\r\n            showOAuthDialog: true,\r\n            oauthInfo: [{ type: \"twitter\", url: url }],\r\n            onCloseOAuthDialog: () => exitOAuth()\r\n          });\r\n        }\r\n      },\r\n      \"tweet\"\r\n    );\r\n  });\r\n\r\n  remountUI({ performConditionalSignIn, embed: isEmbed, showPreload: isEmbed });\r\n  entryManager.performConditionalSignIn = performConditionalSignIn;\r\n  entryManager.init();\r\n\r\n  const linkChannel = new LinkChannel(store);\r\n\r\n  window.APP.scene = scene;\r\n  window.APP.hubChannel = hubChannel;\r\n  window.dispatchEvent(new CustomEvent(\"hub_channel_ready\"));\r\n\r\n  const handleEarlyVRMode = () => {\r\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\r\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\r\n    // to be entered and we haven't entered the room yet.\r\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\") && !isMobileVR) {\r\n      console.log(\"Pre-emptively exiting VR mode.\");\r\n      scene.exitVR();\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  scene.addEventListener(\"enter-vr\", () => {\r\n    if (handleEarlyVRMode()) return true;\r\n\r\n    if (isMobileVR) {\r\n      // Optimization, stop drawing UI if not visible\r\n      remountUI({ hide: true });\r\n    }\r\n\r\n    document.body.classList.add(\"vr-mode\");\r\n\r\n    // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\r\n    if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\r\n      document.body.classList.add(\"vr-mode-stretch\");\r\n    }\r\n  });\r\n\r\n  handleEarlyVRMode();\r\n\r\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\r\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\r\n  window.addEventListener(\r\n    \"vrdisplaypresentchange\",\r\n    () => {\r\n      if (scene.is(\"vr-entered\")) return;\r\n      if (scene.is(\"vr-mode\")) return;\r\n\r\n      const device = AFRAME.utils.device.getVRDisplay();\r\n\r\n      if (device && device.isPresenting) {\r\n        if (!scene.is(\"vr-mode\")) {\r\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\r\n          scene.enterVR();\r\n        }\r\n      }\r\n    },\r\n    { once: true }\r\n  );\r\n\r\n  scene.addEventListener(\"exit-vr\", () => {\r\n    document.body.classList.remove(\"vr-mode\");\r\n    document.body.classList.remove(\"vr-mode-stretch\");\r\n\r\n    remountUI({ hide: false });\r\n\r\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\r\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\r\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\r\n        const videoComponent = m.components[\"media-video\"];\r\n\r\n        if (videoComponent) {\r\n          videoComponent._ignorePauseStateChanges = true;\r\n\r\n          setTimeout(() => {\r\n            const video = videoComponent.video;\r\n\r\n            if (video && video.paused && !videoComponent.data.videoPaused) {\r\n              video.play();\r\n            }\r\n\r\n            videoComponent._ignorePauseStateChanges = false;\r\n          }, 1000);\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  registerNetworkSchemas();\r\n\r\n  remountUI({\r\n    authChannel,\r\n    hubChannel,\r\n    linkChannel,\r\n    subscriptions,\r\n    enterScene: entryManager.enterScene,\r\n    exitScene: reason => {\r\n      entryManager.exitScene();\r\n\r\n      if (reason) {\r\n        remountUI({ roomUnavailableReason: reason });\r\n      }\r\n    },\r\n    initialIsSubscribed: subscriptions.isSubscribed(),\r\n    activeTips: scene.systems.tips.activeTips\r\n  });\r\n\r\n  scene.addEventListener(\"action_focus_chat\", () => {\r\n    const chatFocusTarget = document.querySelector(\".chat-focus-target\");\r\n    chatFocusTarget && chatFocusTarget.focus();\r\n  });\r\n\r\n  scene.addEventListener(\"tips_changed\", e => {\r\n    remountUI({ activeTips: e.detail });\r\n  });\r\n\r\n  scene.addEventListener(\"leave_room_requested\", () => {\r\n    entryManager.exitScene(\"left\");\r\n    remountUI({ roomUnavailableReason: \"left\" });\r\n  });\r\n\r\n  scene.addEventListener(\"camera_toggled\", () => remountUI({}));\r\n\r\n  scene.addEventListener(\"camera_removed\", () => remountUI({}));\r\n\r\n  scene.addEventListener(\"hub_closed\", () => {\r\n    scene.exitVR();\r\n    entryManager.exitScene(\"closed\");\r\n    remountUI({ roomUnavailableReason: \"closed\" });\r\n  });\r\n\r\n  scene.addEventListener(\"action_camera_recording_started\", () => hubChannel.beginRecording());\r\n  scene.addEventListener(\"action_camera_recording_ended\", () => hubChannel.endRecording());\r\n\r\n  const platformUnsupportedReason = getPlatformUnsupportedReason();\r\n\r\n  if (platformUnsupportedReason) {\r\n    remountUI({ platformUnsupportedReason });\r\n    entryManager.exitScene();\r\n    return;\r\n  }\r\n\r\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\r\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\r\n\r\n    if (qs.get(\"required_version\") !== buildNumber) {\r\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\r\n      setTimeout(() => document.location.reload(), 5000);\r\n      entryManager.exitScene();\r\n      return;\r\n    }\r\n  }\r\n\r\n  getReticulumMeta().then(reticulumMeta => {\r\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\r\n\r\n    if (\r\n      qs.get(\"required_ret_version\") &&\r\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\r\n    ) {\r\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\r\n      setTimeout(() => document.location.reload(), 5000);\r\n      entryManager.exitScene();\r\n      return;\r\n    }\r\n  });\r\n\r\n  if (isMobileVR) {\r\n    remountUI({ availableVREntryTypes, forcedVREntryType: \"vr\" });\r\n\r\n    if (/Oculus/.test(navigator.userAgent)) {\r\n      // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of\r\n      // Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\r\n      // so we need to resolve that and get the real VRDisplay before entering as well.\r\n      const displays = await navigator.getVRDisplays();\r\n      const vrDisplay = displays.length && displays[0];\r\n      AFRAME.utils.device.getVRDisplay = () => vrDisplay;\r\n    }\r\n  } else {\r\n    const hasVREntryDevice =\r\n      availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no ||\r\n      availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\r\n      availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no;\r\n\r\n    remountUI({ availableVREntryTypes, forcedVREntryType: qsVREntryType || (!hasVREntryDevice ? \"2d\" : null) });\r\n  }\r\n\r\n  const environmentScene = document.querySelector(\"#environment-scene\");\r\n\r\n  const onFirstEnvironmentLoad = () => {\r\n    // Replace renderer with a noop renderer to reduce bot resource usage.\r\n    if (isBotMode) {\r\n      runBotMode(scene, entryManager);\r\n    }\r\n\r\n    environmentScene.removeEventListener(\"model-loaded\", onFirstEnvironmentLoad);\r\n  };\r\n\r\n  environmentScene.addEventListener(\"model-loaded\", onFirstEnvironmentLoad);\r\n\r\n  environmentScene.addEventListener(\"model-loaded\", () => {\r\n    if (!scene.is(\"entered\")) {\r\n      setupLobbyCamera();\r\n    }\r\n\r\n    // This will be run every time the environment is changed (including the first load.)\r\n    remountUI({ environmentSceneLoaded: true });\r\n    scene.emit(\"environment-scene-loaded\");\r\n\r\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\r\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\r\n\r\n    for (const modelEl of environmentScene.children) {\r\n      addAnimationComponents(modelEl);\r\n    }\r\n  });\r\n\r\n  // Socket disconnects on refresh but we don't want to show exit scene in that scenario.\r\n  let isReloading = false;\r\n  window.addEventListener(\"beforeunload\", () => (isReloading = true));\r\n\r\n  const socket = await connectToReticulum(isDebug);\r\n\r\n  socket.onClose(e => {\r\n    // We don't currently have an easy way to distinguish between being kicked (server closes socket)\r\n    // and a variety of other network issues that seem to produce the 1000 closure code, but the\r\n    // latter are probably more common. Either way, we just tell the user they got disconnected.\r\n    const NORMAL_CLOSURE = 1000;\r\n\r\n    if (e.code === NORMAL_CLOSURE && !isReloading) {\r\n      entryManager.exitScene();\r\n      remountUI({ roomUnavailableReason: \"disconnected\" });\r\n    }\r\n  });\r\n\r\n  let retDeployReconnectInterval;\r\n  const retReconnectMaxDelayMs = 15000;\r\n\r\n  // Reticulum global channel\r\n  let retPhxChannel = socket.channel(`ret`, { hub_id: hubId });\r\n  retPhxChannel\r\n    .join()\r\n    .receive(\"ok\", async data => subscriptions.setVapidPublicKey(data.vapid_public_key))\r\n    .receive(\"error\", res => {\r\n      subscriptions.setVapidPublicKey(null);\r\n      console.error(res);\r\n    });\r\n\r\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\r\n\r\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\r\n\r\n  if (oauthFlowPermsToken) {\r\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\r\n  }\r\n\r\n  const createHubChannelParams = permsToken => {\r\n    const params = {\r\n      profile: store.state.profile,\r\n      push_subscription_endpoint: pushSubscriptionEndpoint,\r\n      auth_token: null,\r\n      perms_token: null,\r\n      context: {\r\n        mobile: isMobile || isMobileVR,\r\n        embed: isEmbed\r\n      }\r\n    };\r\n\r\n    if (isMobileVR) {\r\n      params.context.hmd = true;\r\n    }\r\n\r\n    if (permsToken) {\r\n      params.perms_token = permsToken;\r\n    }\r\n\r\n    const { token } = store.state.credentials;\r\n    if (token) {\r\n      console.log(`Logged into account ${store.credentialsAccountId}`);\r\n      params.auth_token = token;\r\n    }\r\n\r\n    return params;\r\n  };\r\n\r\n  const migrateToNewReticulumServer = async deployNotification => {\r\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\r\n    console.log(`Reticulum deploy detected v${deployNotification.ret_version} on ${deployNotification.ret_pool}`);\r\n    clearInterval(retDeployReconnectInterval);\r\n\r\n    setTimeout(() => {\r\n      const tryReconnect = async () => {\r\n        invalidateReticulumMeta();\r\n        const reticulumMeta = await getReticulumMeta();\r\n\r\n        if (\r\n          reticulumMeta.pool === deployNotification.ret_pool &&\r\n          reticulumMeta.version === deployNotification.ret_version\r\n        ) {\r\n          console.log(\"Reticulum reconnecting.\");\r\n          clearInterval(retDeployReconnectInterval);\r\n          const oldSocket = retPhxChannel.socket;\r\n          const socket = await connectToReticulum(isDebug, oldSocket.params());\r\n          retPhxChannel = await migrateChannelToSocket(retPhxChannel, socket);\r\n          await hubChannel.migrateToSocket(socket, createHubChannelParams());\r\n          authChannel.setSocket(socket);\r\n          linkChannel.setSocket(socket);\r\n\r\n          // Disconnect old socket after a delay to ensure this user is always registered in presence.\r\n          setTimeout(() => {\r\n            console.log(\"Reconnection complete. Disconnecting old reticulum socket.\");\r\n            oldSocket.teardown();\r\n          }, 10000);\r\n        }\r\n      };\r\n\r\n      retDeployReconnectInterval = setInterval(tryReconnect, 5000);\r\n      tryReconnect();\r\n    }, Math.floor(Math.random() * retReconnectMaxDelayMs));\r\n  };\r\n\r\n  retPhxChannel.on(\"notice\", async data => {\r\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\r\n    if (data.event === \"ret-deploy\") {\r\n      await migrateToNewReticulumServer(data);\r\n    }\r\n  });\r\n\r\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, createHubChannelParams(oauthFlowPermsToken));\r\n\r\n  const presenceLogEntries = [];\r\n  const addToPresenceLog = entry => {\r\n    entry.key = Date.now().toString();\r\n\r\n    presenceLogEntries.push(entry);\r\n    remountUI({ presenceLogEntries });\r\n    if (entry.type === \"chat\" && scene.is(\"loaded\")) {\r\n      scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\r\n    }\r\n\r\n    // Fade out and then remove\r\n    setTimeout(() => {\r\n      entry.expired = true;\r\n      remountUI({ presenceLogEntries });\r\n\r\n      setTimeout(() => {\r\n        presenceLogEntries.splice(presenceLogEntries.indexOf(entry), 1);\r\n        remountUI({ presenceLogEntries });\r\n      }, 5000);\r\n    }, 20000);\r\n  };\r\n\r\n  const messageDispatch = new MessageDispatch(\r\n    scene,\r\n    entryManager,\r\n    hubChannel,\r\n    addToPresenceLog,\r\n    remountUI,\r\n    mediaSearchStore\r\n  );\r\n  document.getElementById(\"avatar-rig\").messageDispatch = messageDispatch;\r\n\r\n  let isInitialJoin = true;\r\n\r\n  // We need to be able to wait for initial presence syncs across reconnects and socket migrations,\r\n  // so we create this object in the outer scope and assign it a new promise on channel join.\r\n  const presenceSync = {\r\n    promise: null,\r\n    resolve: null\r\n  };\r\n\r\n  hubChannel.setPhoenixChannel(hubPhxChannel);\r\n\r\n  hubPhxChannel\r\n    .join()\r\n    .receive(\"ok\", async data => {\r\n      socket.params().session_id = data.session_id;\r\n      socket.params().session_token = data.session_token;\r\n\r\n      const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\r\n\r\n      presenceSync.promise = new Promise(resolve => {\r\n        presenceSync.resolve = resolve;\r\n      });\r\n\r\n      if (isInitialJoin) {\r\n        store.addEventListener(\"profilechanged\", hubChannel.sendProfileUpdate.bind(hubChannel));\r\n\r\n        hubChannel.presence.onSync(() => {\r\n          const presence = hubChannel.presence;\r\n\r\n          remountUI({\r\n            sessionId: socket.params().session_id,\r\n            presences: presence.state,\r\n            entryDisallowed: !hubChannel.canEnterRoom(uiProps.hub)\r\n          });\r\n\r\n          const occupantCount = Object.entries(presence.state).length;\r\n          vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\r\n\r\n          if (occupantCount > 1) {\r\n            scene.addState(\"copresent\");\r\n          } else {\r\n            scene.removeState(\"copresent\");\r\n          }\r\n\r\n          // HACK - Set a flag on the presence object indicating if the initial sync has completed,\r\n          // which is used to determine if we should fire join/leave messages into the presence log.\r\n          // This flag is required since we reuse these onJoin and onLeave handler functions on\r\n          // socket migrations.\r\n          presence.__hadInitialSync = true;\r\n\r\n          presenceSync.resolve();\r\n\r\n          presence.onJoin((sessionId, current, info) => {\r\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync (o/w the user\r\n            // will see join messages for every user.)\r\n            if (!hubChannel.presence.__hadInitialSync) return;\r\n\r\n            const meta = info.metas[info.metas.length - 1];\r\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\r\n\r\n            if (occupantCount <= NOISY_OCCUPANT_COUNT) {\r\n              if (current) {\r\n                // Change to existing presence\r\n                const isSelf = sessionId === socket.params().session_id;\r\n                const currentMeta = current.metas[0];\r\n\r\n                if (\r\n                  !isSelf &&\r\n                  currentMeta.presence !== meta.presence &&\r\n                  meta.presence === \"room\" &&\r\n                  meta.profile.displayName\r\n                ) {\r\n                  addToPresenceLog({\r\n                    type: \"entered\",\r\n                    presence: meta.presence,\r\n                    name: meta.profile.displayName\r\n                  });\r\n                }\r\n\r\n                if (\r\n                  currentMeta.profile &&\r\n                  meta.profile &&\r\n                  currentMeta.profile.displayName !== meta.profile.displayName\r\n                ) {\r\n                  addToPresenceLog({\r\n                    type: \"display_name_changed\",\r\n                    oldName: currentMeta.profile.displayName,\r\n                    newName: meta.profile.displayName\r\n                  });\r\n                }\r\n              } else if (info.metas.length === 1) {\r\n                // New presence\r\n                const meta = info.metas[0];\r\n\r\n                if (meta.presence && meta.profile.displayName) {\r\n                  addToPresenceLog({\r\n                    type: \"join\",\r\n                    presence: meta.presence,\r\n                    name: meta.profile.displayName\r\n                  });\r\n                }\r\n              }\r\n            }\r\n\r\n            scene.emit(\"presence_updated\", {\r\n              sessionId,\r\n              profile: meta.profile,\r\n              roles: meta.roles,\r\n              permissions: meta.permissions,\r\n              streaming: meta.streaming,\r\n              recording: meta.recording\r\n            });\r\n          });\r\n\r\n          presence.onLeave((sessionId, current, info) => {\r\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync\r\n            if (!hubChannel.presence.__hadInitialSync) return;\r\n\r\n            if (current && current.metas.length > 0) return;\r\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\r\n            if (occupantCount > NOISY_OCCUPANT_COUNT) return;\r\n\r\n            const meta = info.metas[0];\r\n\r\n            if (meta.profile.displayName) {\r\n              addToPresenceLog({\r\n                type: \"leave\",\r\n                name: meta.profile.displayName\r\n              });\r\n            }\r\n          });\r\n        });\r\n      }\r\n\r\n      isInitialJoin = false;\r\n\r\n      const permsToken = oauthFlowPermsToken || data.perms_token;\r\n      hubChannel.setPermissionsFromToken(permsToken);\r\n\r\n      scene.addEventListener(\"adapter-ready\", async ({ detail: adapter }) => {\r\n        // HUGE HACK Safari does not like it if the first peer seen does not immediately\r\n        // send audio over its media stream. Otherwise, the stream doesn't work and stays\r\n        // silent. (Though subsequent peers work fine.)\r\n        //\r\n        // This hooks up a simple audio pipeline to push a short tone over the WebRTC\r\n        // media stream as its created to mitigate this Safari bug.\r\n        //\r\n        // Users will never hear this tone -- the outgoing media track is overwritten\r\n        // before we spawn our avatar, which is when other users will begin hearing\r\n        // the audio.\r\n        //\r\n        // This only covers the case where a Safari user is in the room and the first\r\n        // other user joins. If a user is in the room and Safari user joins,\r\n        // then Safari can fail to receive audio from a single peer (it does not seem\r\n        // to be related to silence, but may be a factor.)\r\n        const ctx = THREE.AudioContext.getContext();\r\n        const oscillator = ctx.createOscillator();\r\n        const gain = ctx.createGain();\r\n        gain.gain.setValueAtTime(0.01, ctx.currentTime);\r\n        const dest = ctx.createMediaStreamDestination();\r\n        oscillator.connect(gain);\r\n        gain.connect(dest);\r\n        oscillator.start();\r\n        const stream = dest.stream;\r\n        const track = stream.getAudioTracks()[0];\r\n        adapter.setClientId(socket.params().session_id);\r\n        adapter.setJoinToken(data.perms_token);\r\n        hubChannel.addEventListener(\"permissions-refreshed\", e => adapter.setJoinToken(e.detail.permsToken));\r\n\r\n        // Stop the tone after we've connected, which seems to mitigate the issue without actually\r\n        // having to keep this playing and using bandwidth.\r\n        scene.addEventListener(\r\n          \"didConnectToNetworkedScene\",\r\n          () => {\r\n            oscillator.stop();\r\n            track.enabled = false;\r\n          },\r\n          { once: true }\r\n        );\r\n\r\n        await adapter.setLocalMediaStream(stream);\r\n      });\r\n      subscriptions.setHubChannel(hubChannel);\r\n\r\n      subscriptions.setSubscribed(data.subscriptions.web_push);\r\n\r\n      remountUI({\r\n        hubIsBound: data.hub_requires_oauth,\r\n        initialIsFavorited: data.subscriptions.favorites,\r\n        initialIsSubscribed: subscriptions.isSubscribed()\r\n      });\r\n\r\n      await presenceSync.promise;\r\n\r\n      handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data);\r\n    })\r\n    .receive(\"error\", res => {\r\n      if (res.reason === \"closed\") {\r\n        entryManager.exitScene();\r\n        remountUI({ roomUnavailableReason: \"closed\" });\r\n      } else if (res.reason === \"oauth_required\") {\r\n        entryManager.exitScene();\r\n        remountUI({ oauthInfo: res.oauth_info, showOAuthDialog: true });\r\n      } else if (res.reason === \"join_denied\") {\r\n        entryManager.exitScene();\r\n        remountUI({ roomUnavailableReason: \"denied\" });\r\n      }\r\n\r\n      console.error(res);\r\n    });\r\n\r\n  const handleIncomingNAF = data => {\r\n    if (!NAF.connection.adapter) return;\r\n\r\n    NAF.connection.adapter.onData(authorizeOrSanitizeMessage(data), PHOENIX_RELIABLE_NAF);\r\n  };\r\n\r\n  hubPhxChannel.on(\"naf\", data => handleIncomingNAF(data));\r\n  hubPhxChannel.on(\"nafr\", ({ from_session_id, naf: unparsedData }) => {\r\n    // Server optimization: server passes through unparsed NAF message, we must now parse it.\r\n    const data = JSON.parse(unparsedData);\r\n    data.from_session_id = from_session_id;\r\n    handleIncomingNAF(data);\r\n  });\r\n\r\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\r\n    const getAuthor = () => {\r\n      const userInfo = hubChannel.presence.state[session_id];\r\n      if (from) {\r\n        return from;\r\n      } else if (userInfo) {\r\n        return userInfo.metas[0].profile.displayName;\r\n      } else {\r\n        return \"Mystery user\";\r\n      }\r\n    };\r\n\r\n    const name = getAuthor();\r\n    const maySpawn = scene.is(\"entered\");\r\n\r\n    const incomingMessage = { name, type, body, maySpawn, sessionId: session_id };\r\n\r\n    if (scene.is(\"vr-mode\")) {\r\n      createInWorldLogMessage(incomingMessage);\r\n    }\r\n\r\n    addToPresenceLog(incomingMessage);\r\n  });\r\n\r\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\r\n    const hub = hubs[0];\r\n    const userInfo = hubChannel.presence.state[session_id];\r\n\r\n    updateUIForHub(hub, hubChannel);\r\n\r\n    if (stale_fields.includes(\"scene\")) {\r\n      const fader = document.getElementById(\"viewing-camera\").components[\"fader\"];\r\n\r\n      fader.fadeOut().then(() => {\r\n        scene.emit(\"reset_scene\");\r\n        updateEnvironmentForHub(hub, entryManager);\r\n      });\r\n\r\n      addToPresenceLog({\r\n        type: \"scene_changed\",\r\n        name: userInfo.metas[0].profile.displayName,\r\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\r\n      });\r\n    }\r\n\r\n    if (stale_fields.includes(\"member_permissions\")) {\r\n      hubChannel.fetchPermissions();\r\n    }\r\n\r\n    if (stale_fields.includes(\"name\")) {\r\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\r\n      titleParts[0] = hub.name;\r\n      document.title = titleParts.join(\" | \");\r\n\r\n      // Re-write the slug in the browser history\r\n      const pathParts = history.location.pathname.split(\"/\");\r\n      const oldSlug = pathParts[1];\r\n      const { search, state } = history.location;\r\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\r\n\r\n      history.replace({ pathname, search, state });\r\n\r\n      addToPresenceLog({\r\n        type: \"hub_name_changed\",\r\n        name: userInfo.metas[0].profile.displayName,\r\n        hubName: hub.name\r\n      });\r\n    }\r\n\r\n    if (hub.entry_mode === \"deny\") {\r\n      scene.emit(\"hub_closed\");\r\n    }\r\n  });\r\n\r\n  hubPhxChannel.on(\"permissions_updated\", () => hubChannel.fetchPermissions());\r\n\r\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\r\n    if (session_id === NAF.clientId && !scene.is(\"muted\")) {\r\n      scene.emit(\"action_mute\");\r\n    }\r\n  });\r\n\r\n  authChannel.setSocket(socket);\r\n  linkChannel.setSocket(socket);\r\n});\r\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\r\n// When detected, fire a \"concurrentload\" event.\r\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\r\n  const key = `___concurrent_load_detector_${instanceKey}`;\r\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\r\n  const onStorageEvent = e => {\r\n    if (e.key !== key) return;\r\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\r\n    window.removeEventListener(\"storage\", onStorageEvent);\r\n  };\r\n  window.addEventListener(\"storage\", onStorageEvent);\r\n}\r\n","export default function patchThreeAllocations() {\r\n  const renderer = AFRAME.scenes[0].renderer;\r\n  const gl = renderer.context;\r\n\r\n  // These functions in three.js uses the arguments object, which allocates.\r\n  renderer.state.texImage2D = function(a, b, c, d, e, f, g, h, i) {\r\n    try {\r\n      if (g === undefined) {\r\n        gl.texImage2D(a, b, c, d, e, f);\r\n      } else {\r\n        gl.texImage2D(a, b, c, d, e, f, g, h, i);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"THREE.WebGLState:\", error);\r\n    }\r\n  };\r\n\r\n  renderer.state.compressedTexImage2D = function(a, b, c, d, e, f, g, h, i, j) {\r\n    try {\r\n      if (h === undefined) {\r\n        gl.compressedTexImage2D(a, b, c, d, e, f, g);\r\n      } else if (i === undefined) {\r\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h);\r\n      } else if (j === undefined) {\r\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i);\r\n      } else {\r\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i, j);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"THREE.WebGLState:\", error);\r\n    }\r\n  };\r\n}\r\n"],"sourceRoot":""}